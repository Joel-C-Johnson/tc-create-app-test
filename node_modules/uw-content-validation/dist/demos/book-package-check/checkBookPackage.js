"use strict";var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");var _typeof = require("@babel/runtime/helpers/typeof");Object.defineProperty(exports, "__esModule", { value: true });exports.checkBookPackage = checkBookPackage;var _regenerator = _interopRequireDefault(require("@babel/runtime/regenerator"));var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var _react = _interopRequireDefault(require("react"));

var _defaults = require("../../core/defaults");
var books = _interopRequireWildcard(require("../../core/books/books"));
var _core = require("../../core");
var _checkFileContents = require("../file-check/checkFileContents");
var _checkRepo = require("../repo-check/checkRepo");

var _utilities = require("../../core/utilities");function _getRequireWildcardCache(nodeInterop) {if (typeof WeakMap !== "function") return null;var cacheBabelInterop = new WeakMap();var cacheNodeInterop = new WeakMap();return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) {return nodeInterop ? cacheNodeInterop : cacheBabelInterop;})(nodeInterop);}function _interopRequireWildcard(obj, nodeInterop) {if (!nodeInterop && obj && obj.__esModule) {return obj;}if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") {return { default: obj };}var cache = _getRequireWildcardCache(nodeInterop);if (cache && cache.has(obj)) {return cache.get(obj);}var newObj = {};var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;for (var key in obj) {if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;if (desc && (desc.get || desc.set)) {Object.defineProperty(newObj, key, desc);} else {newObj[key] = obj[key];}}}newObj.default = obj;if (cache) {cache.set(obj, newObj);}return newObj;}function _createForOfIteratorHelper(o, allowArrayLike) {var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"];if (!it) {if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") {if (it) o = it;var i = 0;var F = function F() {};return { s: F, n: function n() {if (i >= o.length) return { done: true };return { done: false, value: o[i++] };}, e: function e(_e) {throw _e;}, f: F };}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var normalCompletion = true,didErr = false,err;return { s: function s() {it = it.call(o);}, n: function n() {var step = it.next();normalCompletion = step.done;return step;}, e: function e(_e2) {didErr = true;err = _e2;}, f: function f() {try {if (!normalCompletion && it.return != null) it.return();} finally {if (didErr) throw err;}} };}function _unsupportedIterableToArray(o, minLen) {if (!o) return;if (typeof o === "string") return _arrayLikeToArray(o, minLen);var n = Object.prototype.toString.call(o).slice(8, -1);if (n === "Object" && o.constructor) n = o.constructor.name;if (n === "Map" || n === "Set") return Array.from(o);if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);}function _arrayLikeToArray(arr, len) {if (len == null || len > arr.length) len = arr.length;for (var i = 0, arr2 = new Array(len); i < len; i++) {arr2[i] = arr[i];}return arr2;}function ownKeys(object, enumerableOnly) {var keys = Object.keys(object);if (Object.getOwnPropertySymbols) {var symbols = Object.getOwnPropertySymbols(object);if (enumerableOnly) {symbols = symbols.filter(function (sym) {return Object.getOwnPropertyDescriptor(object, sym).enumerable;});}keys.push.apply(keys, symbols);}return keys;}function _objectSpread(target) {for (var i = 1; i < arguments.length; i++) {var source = arguments[i] != null ? arguments[i] : {};if (i % 2) {ownKeys(Object(source), true).forEach(function (key) {(0, _defineProperty2.default)(target, key, source[key]);});} else if (Object.getOwnPropertyDescriptors) {Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));} else {ownKeys(Object(source)).forEach(function (key) {Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));});}}return target;}


// const BP_VALIDATOR_VERSION_STRING = '0.7.8';

var STANDARD_MANIFEST_FILENAME = 'manifest.yaml';


/*
    checkBookPackage
*/
/**
 *
 * @param {string} username, e.g., 'unfoldingWord'
 * @param {string} languageCode, e.g., 'en'
 * @param {string} bookID -- 3-character USFM book ID or 'OBS'
 * @param {Function} setResultValue function
 * @param {Object} checkingOptions -- can contain: getFile (function), originalLanguageRepoUsername, taRepoUsername, checkManifestFlag
 * @return {Object} - containing successList and noticeList
 */function
checkBookPackage(_x, _x2, _x3, _x4, _x5) {return _checkBookPackage.apply(this, arguments);}function _checkBookPackage() {_checkBookPackage = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee4(username, languageCode, bookID, setResultValue, checkingOptions) {var abortFlag, startTime, checkedFileCount, checkedFilenames, checkedFilenameExtensions, totalCheckedSize, checkedRepoNames, checkBookPackageResult, dataSet, newCheckingOptions, getFile_, originalBranch, generalLocation,










































    addSuccessMessage,





    addNoticePartial,

































    ourCheckBPFileContents, _ourCheckBPFileContents,


























































    ourCheckManifestFile, _ourCheckManifestFile,






























































    ourCheckMarkdownFile, _ourCheckMarkdownFile, repoCodeList, bookNumberAndName, whichTestament, origLangRepoCode, checkedManifestDetails, numCheckedRepos, _iterator, _step, repoCode, adjustedRepoCode, adjustedBranch, repoName, repoLocation, filename, crResultObject, tqResultObject, _filename, repoFileContent, details, numCheckedCharacters, _filename2, _numCheckedCharacters, _filename3, _numCheckedCharacters2;return _regenerator.default.wrap(function _callee4$(_context4) {while (1) {switch (_context4.prev = _context4.next) {case 0:_ourCheckMarkdownFile = function _ourCheckMarkdownFile3() {_ourCheckMarkdownFile = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee3(repoCode, repoName, repoBranch, filename, markdownLocation, checkingOptions) {var markdownFileContent, details, cmtResultObject, _iterator6, _step6, cfcNoticeEntry, fullYearString;return _regenerator.default.wrap(function _callee3$(_context3) {while (1) {switch (_context3.prev = _context3.next) {case 0:_context3.prev = 0;_context3.next = 3;return (

















                          getFile_({ username: username, repository: repoName, path: filename, branch: repoBranch }));case 3:markdownFileContent = _context3.sent;_context3.next = 18;break;case 6:_context3.prev = 6;_context3.t0 = _context3["catch"](0);



                        console.error("checkBookPackage ourCheckMarkdownFile(".concat(username, ", ").concat(languageCode, ", ").concat(bookID, ", (fn), ").concat(JSON.stringify(checkingOptions), ") failed to load markdown"), username, repoName, filename, originalBranch, _context3.t0 + '');
                        details = "username=".concat(username);_context3.next = 12;return (
                          (0, _core.repositoryExistsOnDoor43)({ username: username, repository: repoName }));case 12:if (_context3.sent) {_context3.next = 16;break;}
                        checkBookPackageResult.noticeList.push({ priority: 997, message: "Repository doesn’t exist", details: details, username: username, repoCode: repoCode, repoName: repoName, location: markdownLocation, extra: repoCode });_context3.next = 18;break;case 16:

                        // eslint-disable-next-line eqeqeq
                        if (_context3.t0 != 'TypeError: repoFileContent is null') details += " error=".concat(_context3.t0);
                        addNoticePartial({ priority: 996, message: "Unable to load", details: "username=".concat(username, " error=").concat(_context3.t0), username: username, repoName: repoName, filename: filename, location: markdownLocation, extra: repoCode });case 18:if (!


                        markdownFileContent) {_context3.next = 26;break;}_context3.next = 21;return (
                          (0, _core.checkMarkdownText)(languageCode, repoCode, filename.substring(0, filename.length - 3), markdownFileContent, markdownLocation, checkingOptions));case 21:cmtResultObject = _context3.sent;
                        // debugLog(`ourCheckMarkdownFile checkMarkdownText(${repoName}) returned ${cmtResultObject.successList.length} success message(s) and ${cmtResultObject.noticeList.length} notice(s)`);
                        // debugLog(`ourCheckMarkdownFile checkMarkdownText(${repoName}) returned ${JSON.stringify(cmtResultObject)}`);
                        // NOTE: We ignore the returned success messages here
                        // for (const successEntry of cfResultObject.successList) userLog("  ourCheckBPFileContents:", successEntry);
                        // debugLog("cfcResultObject", JSON.stringify(cfcResultObject));

                        // Process noticeList line by line,  appending the repoCode as an extra field as we go
                        _iterator6 = _createForOfIteratorHelper(cmtResultObject.noticeList);try {for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {cfcNoticeEntry = _step6.value;
                            // NOTE: We don’t use addNoticePartial, because it adds a misleading BookID
                            // addNoticePartial({ ...cfcNoticeEntry, filename, extra: `${repoCode} markdown` });
                            checkBookPackageResult.noticeList.push(_objectSpread(_objectSpread({}, cfcNoticeEntry), {}, { username: username, repoCode: repoCode, repoName: repoName, filename: filename, extra: repoCode }));
                          }} catch (err) {_iterator6.e(err);} finally {_iterator6.f();}

                        if (filename === 'LICENSE.md') {
                          fullYearString = "".concat(new Date().getFullYear());
                          // debugLog(`Year ${fullYearString} is ${typeof fullYearString}`);
                          if (markdownFileContent.indexOf(fullYearString) === -1) // Can't find this year string in file
                            // NOTE: We don’t use addNoticePartial, because it adds a misleading BookID
                            checkBookPackageResult.noticeList.push({ priority: 256, message: "Possibly missing current copyright year", details: "possibly expecting '".concat(fullYearString, "'"), username: username, repoName: repoName, filename: filename, location: markdownLocation, extra: repoCode });
                        }return _context3.abrupt("return",

                        markdownFileContent.length);case 26:

                        // NOTE: We don’t use addNoticePartial, because it adds a misleading BookID
                        // addNoticePartial({ priority: 956, message: "Got empty markdown file", repoName, filename, location: markdownLocation, extra: `${repoCode} markdown` });
                        checkBookPackageResult.noticeList.push({ priority: 956, message: "Got empty markdown file", repoName: repoName, filename: filename, location: markdownLocation, extra: repoCode });return _context3.abrupt("return",
                        0);case 28:case "end":return _context3.stop();}}}, _callee3, null, [[0, 6]]);}));return _ourCheckMarkdownFile.apply(this, arguments);};ourCheckMarkdownFile = function _ourCheckMarkdownFile2(_x25, _x26, _x27, _x28, _x29, _x30) {return _ourCheckMarkdownFile.apply(this, arguments);};_ourCheckManifestFile = function _ourCheckManifestFile3() {_ourCheckManifestFile = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee2(repoCode, repoName, repoBranch, manifestLocation, checkingOptions) {var manifestFileContent, details, cmtResultObject, _iterator5, _step5, cfcNoticeEntry;return _regenerator.default.wrap(function _callee2$(_context2) {while (1) {switch (_context2.prev = _context2.next) {case 0:_context2.prev = 0;_context2.next = 3;return getFile_({ username: username, repository: repoName, path: STANDARD_MANIFEST_FILENAME, branch: repoBranch });case 3:manifestFileContent = _context2.sent;_context2.next = 18;break;case 6:_context2.prev = 6;_context2.t0 = _context2["catch"](0);console.error("checkBookPackage ourCheckManifestFile(".concat(username, ", ").concat(languageCode, ", ").concat(bookID, ", (fn), ").concat(JSON.stringify(checkingOptions), ") failed to load manifest"), username, repoName, repoBranch, _context2.t0 + '');details = "username=".concat(username);_context2.next = 12;return (0, _core.repositoryExistsOnDoor43)({ username: username, repository: repoName });case 12:if (_context2.sent) {_context2.next = 16;break;}checkBookPackageResult.noticeList.push({ priority: 997, message: "Repository doesn’t exist", details: details, username: username, repoCode: repoCode, repoName: repoName, location: manifestLocation, extra: repoCode });_context2.next = 18;break;case 16: // eslint-disable-next-line eqeqeq
                        if (_context2.t0 != 'TypeError: repoFileContent is null') details += " error=".concat(_context2.t0);addNoticePartial({ priority: 996, message: "Unable to load", details: "username=".concat(username, " error=").concat(_context2.t0), repoName: repoName, filename: STANDARD_MANIFEST_FILENAME, location: manifestLocation, extra: repoCode });case 18:if (!manifestFileContent) {_context2.next = 25;break;}_context2.next = 21;return (0, _core.checkManifestText)(languageCode, repoCode, username, repoName, repoBranch, manifestFileContent, manifestLocation, checkingOptions);case 21:cmtResultObject = _context2.sent; // debugLog(`ourCheckManifestFile checkManifestText(${repoName}) returned ${cmtResultObject.successList.length} success message(s) and ${cmtResultObject.noticeList.length} notice(s)`);
                        // debugLog(`ourCheckManifestFile checkManifestText(${repoName}) returned ${JSON.stringify(cmtResultObject)}`);
                        // NOTE: We ignore the returned success messages here
                        // for (const successEntry of cfResultObject.successList) userLog("  ourCheckBPFileContents:", successEntry);
                        // debugLog("cfcResultObject", JSON.stringify(cfcResultObject));
                        // Process noticeList line by line,  appending the repoCode as an extra field as we go
                        _iterator5 = _createForOfIteratorHelper(cmtResultObject.noticeList);try {for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {cfcNoticeEntry = _step5.value; // NOTE: We don’t use addNoticePartial, because it adds a misleading BookID
                            // addNoticePartial({ ...cfcNoticeEntry, filename: STANDARD_MANIFEST_FILENAME, extra: `${repoCode} MANIFEST` });
                            checkBookPackageResult.noticeList.push(_objectSpread(_objectSpread({}, cfcNoticeEntry), {}, { username: username, repoCode: repoCode, repoName: repoName, filename: STANDARD_MANIFEST_FILENAME, extra: "".concat(repoCode, " MANIFEST") }));}} catch (err) {_iterator5.e(err);} finally {_iterator5.f();}return _context2.abrupt("return", manifestFileContent.length);case 25: // NOTE: We don’t use addNoticePartial, because it adds a misleading BookID
                        // addNoticePartial({ priority: 956, message: "Got empty manifest file", repoName, filename: STANDARD_MANIFEST_FILENAME, location: manifestLocation, extra: `${repoCode} MANIFEST` });
                        checkBookPackageResult.noticeList.push({ priority: 956, message: "Got empty manifest file", repoName: repoName, filename: STANDARD_MANIFEST_FILENAME, location: manifestLocation, extra: "".concat(repoCode, " MANIFEST") });return _context2.abrupt("return", 0);case 27:case "end":return _context2.stop();}}}, _callee2, null, [[0, 6]]);}));return _ourCheckManifestFile.apply(this, arguments);};ourCheckManifestFile = function _ourCheckManifestFile2(_x20, _x21, _x22, _x23, _x24) {return _ourCheckManifestFile.apply(this, arguments);};_ourCheckBPFileContents = function _ourCheckBPFileConten2() {_ourCheckBPFileContents = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee(repoCode, repoName, repoBranch, cfFilename, fileContent, fileLocation, checkingOptions) {var adjustedLanguageCode, cfcResultObject, _iterator2, _step2, cfcNoticeEntry, _iterator3, _step3, checkedRepoName, _iterator4, _step4, checkedFilenameExtension;return _regenerator.default.wrap(function _callee$(_context) {while (1) {switch (_context.prev = _context.next) {case 0: // functionLog(`checkBookPackage ourCheckBPFileContents(rC='${repoCode}', rN='${repoName}', rBr='${repoBranch}', fn='${cfFilename}', ${fileContent.length}, ${fileLocation}, ${JSON.stringify(checkingOptions)})…`);
                        // Updates the global list of notices
                        //parameterAssert(repoCode !== undefined, "cBP ourCheckBPFileContents: 'repoCode' parameter should be defined");
                        //parameterAssert(typeof repoCode === 'string', `cBP ourCheckBPFileContents: 'repoCode' parameter should be a string not a '${typeof repoCode}'`);
                        //parameterAssert(REPO_CODES_LIST.includes(repoCode), `cBP ourCheckBPFileContents: 'repoCode' parameter should not be '${repoCode}'`);
                        //parameterAssert(repoName !== undefined, "cBP ourCheckBPFileContents: 'repoName' parameter should be defined");
                        //parameterAssert(typeof repoName === 'string', `cBP ourCheckBPFileContents: 'repoName' parameter should be a string not a '${typeof repoName}': ${repoName}`);
                        //parameterAssert(repoBranch !== undefined, "cBP ourCheckBPFileContents: 'repoBranch' parameter should be defined");
                        //parameterAssert(typeof repoBranch === 'string', `cBP ourCheckBPFileContents: 'repoBranch' parameter should be a string not a '${typeof repoBranch}': ${repoBranch}`);
                        //parameterAssert(cfFilename !== undefined, "cBP ourCheckBPFileContents: 'cfFilename' parameter should be defined");
                        //parameterAssert(typeof cfFilename === 'string', `cBP ourCheckBPFileContents: 'cfFilename' parameter should be a string not a '${typeof cfFilename}'`);
                        //parameterAssert(fileContent !== undefined, "cBP ourCheckBPFileContents: 'fileContent' parameter should be defined");
                        //parameterAssert(typeof fileContent === 'string', `cBP ourCheckBPFileContents: 'fileContent' parameter should be a string not a '${typeof fileContent}'`);
                        //parameterAssert(fileLocation !== undefined, "cBP ourCheckBPFileContents: 'fileLocation' parameter should be defined");
                        //parameterAssert(typeof fileLocation === 'string', `cBP ourCheckBPFileContents: 'fileLocation' parameter should be a string not a '${typeof fileLocation}'`);
                        //parameterAssert(checkingOptions !== undefined, "cBP ourCheckBPFileContents: 'checkingOptions' parameter should be defined");
                        adjustedLanguageCode = languageCode; // if (repoCode === 'UHB') adjustedLanguageCode = 'hbo'; // NO -- we need the languageCode of the BP being checked (so we can resolve TW links with * for language) !!!
                        // else if (repoCode === 'UGNT') adjustedLanguageCode = 'el-x-koine';
                        _context.next = 3;return (0, _checkFileContents.checkFileContents)(username, adjustedLanguageCode, repoCode, repoBranch, cfFilename, fileContent, fileLocation, checkingOptions);case 3:cfcResultObject = _context.sent; // debugLog("checkFileContents() returned", cfResultObject.successList.length, "success message(s) and", cfResultObject.noticeList.length, "notice(s)");
                        // for (const successEntry of cfResultObject.successList) userLog("  ourCheckBPFileContents:", successEntry);
                        // debugLog("cfcResultObject", JSON.stringify(cfcResultObject));
                        // Process noticeList line by line,  appending the repoCode as an extra field as we go
                        _iterator2 = _createForOfIteratorHelper(cfcResultObject.noticeList);try {for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {cfcNoticeEntry = _step2.value; // noticeEntry is an object
                            if (cfcNoticeEntry.extra) // it must be an indirect check on a TA or TW article from a TN2 check
                              checkBookPackageResult.noticeList.push(cfcNoticeEntry); // Just copy the complete notice as is
                            else // For our direct checks, we add the repoCode as an extra value (unless it’s already there from a TA or TW check)
                              addNoticePartial(_objectSpread(_objectSpread({}, cfcNoticeEntry), {}, { repoCode: repoCode, repoName: repoName, branch: repoBranch, filename: cfFilename, extra: cfcNoticeEntry.extra ? cfcNoticeEntry.extra : repoCode }));} // The following is needed coz we might be checking the linked TA and/or TW articles from TN2 TSV files
                        } catch (err) {_iterator2.e(err);} finally {_iterator2.f();}if (cfcResultObject.checkedFileCount && cfcResultObject.checkedFileCount > 0) {checkedFileCount += cfcResultObject.checkedFileCount;addSuccessMessage("Checked ".concat(cfcResultObject.checkedFileCount, " linked TA/TW articles"));}if (cfcResultObject.checkedFilesizes && cfcResultObject.checkedFilesizes > 0) totalCheckedSize += cfcResultObject.checkedFilesizes;if (cfcResultObject.checkedRepoNames && cfcResultObject.checkedRepoNames.length > 0) {_iterator3 = _createForOfIteratorHelper(cfcResultObject.checkedRepoNames);try {for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {checkedRepoName = _step3.value; // try { if (checkedRepoNames.indexOf(checkedRepoName) < 0) checkedRepoNames.push(checkedRepoName); }
                              // catch { checkedRepoNames = [checkedRepoName]; }
                              checkedRepoNames.add(checkedRepoName);}} catch (err) {_iterator3.e(err);} finally {_iterator3.f();}}if (cfcResultObject.checkedFilenameExtensions && cfcResultObject.checkedFilenameExtensions.length > 0) {_iterator4 = _createForOfIteratorHelper(cfcResultObject.checkedFilenameExtensions);try {for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {checkedFilenameExtension = _step4.value;checkedFilenameExtensions.add(checkedFilenameExtension);}} catch (err) {_iterator4.e(err);} finally {_iterator4.f();}}case 10:case "end":return _context.stop();}}}, _callee);}));return _ourCheckBPFileContents.apply(this, arguments);};ourCheckBPFileContents = function _ourCheckBPFileConten(_x13, _x14, _x15, _x16, _x17, _x18, _x19) {return _ourCheckBPFileContents.apply(this, arguments);};addNoticePartial = function _addNoticePartial(noticeObject) {// bookID is a three-character UPPERCASE USFM book identifier or 'OBS'.
              // functionLog(`checkBookPackage addNoticePartial: (priority=${noticeObject.priority}) ${noticeObject.bookID} ${noticeObject.C}:${noticeObject.V} ${noticeObject.message}${noticeObject.characterIndex > 0 ? ` (at character ${noticeObject.characterIndex})` : ""}${excerpt ? ` ${excerpt}` : ""}${location}`);
              //parameterAssert(noticeObject.priority !== undefined, "cBP addNoticePartial: 'priority' parameter should be defined");
              //parameterAssert(typeof noticeObject.priority === 'number', `cBP addNoticePartial: 'priority' parameter should be a number not a '${typeof noticeObject.priority}': ${noticeObject.priority}`);
              //parameterAssert(noticeObject.message !== undefined, "cBP addNoticePartial: 'message' parameter should be defined");
              //parameterAssert(typeof noticeObject.message === 'string', `cBP addNoticePartial: 'message' parameter should be a string not a '${typeof noticeObject.message}': ${noticeObject.message}`);
              // //parameterAssert(bookID !== undefined, "cBP addNoticePartial: 'bookID' parameter should be defined");
              if (noticeObject.bookID) {//parameterAssert(typeof noticeObject.bookID === 'string', `cBP addNoticePartial: 'bookID' parameter should be a string not a '${typeof noticeObject.bookID}': ${noticeObject.bookID}`);
                //parameterAssert(noticeObject.bookID.length === 3, `cBP addNoticePartial: 'bookID' parameter should be three characters long not ${noticeObject.bookID.length}`);
                //parameterAssert(bookID === 'OBS' || books.isValidBookID(noticeObject.bookID), `cBP addNoticePartial: '${noticeObject.bookID}' is not a valid USFM book identifier`);
              } // //parameterAssert(C !== undefined, "cBP addNoticePartial: 'C' parameter should be defined");
              if (noticeObject.C) {//parameterAssert(typeof noticeObject.C === 'string', `cBP addNoticePartial: 'C' parameter should be a string not a '${typeof noticeObject.C}': ${noticeObject.C}`);
              } // //parameterAssert(V !== undefined, "cBP addNoticePartial: 'V' parameter should be defined");
              if (noticeObject.V) {//parameterAssert(typeof noticeObject.V === 'string', `cBP addNoticePartial: 'V' parameter should be a string not a '${typeof noticeObject.V}': ${noticeObject.V}`);
              } // //parameterAssert(characterIndex !== undefined, "cBP addNoticePartial: 'characterIndex' parameter should be defined");
              if (noticeObject.characterIndex) {//parameterAssert(typeof noticeObject.characterIndex === 'number', `cBP addNoticePartial: 'characterIndex' parameter should be a number not a '${typeof noticeObject.characterIndex}': ${noticeObject.characterIndex}`);
              } // //parameterAssert(excerpt !== undefined, "cBP addNoticePartial: 'excerpt' parameter should be defined");
              if (noticeObject.excerpt) {//parameterAssert(typeof noticeObject.excerpt === 'string', `cBP addNoticePartial: 'excerpt' parameter should be a string not a '${typeof noticeObject.excerpt}': ${noticeObject.excerpt}`);
              } //parameterAssert(noticeObject.location !== undefined, "cBP addNoticePartial: 'location' parameter should be defined");
              //parameterAssert(typeof noticeObject.location === 'string', `cBP addNoticePartial: 'location' parameter should be a string not a '${typeof noticeObject.location}': ${noticeObject.location}`);
              //parameterAssert(noticeObject.extra !== undefined, "cBP addNoticePartial: 'extra' parameter should be defined");
              //parameterAssert(typeof noticeObject.extra === 'string', `cBP addNoticePartial: 'extra' parameter should be a string not a '${typeof noticeObject.extra}': ${noticeObject.extra}`);
              if (noticeObject.debugChain) noticeObject.debugChain = "checkBookPackage ".concat(noticeObject.debugChain);checkBookPackageResult.noticeList.push(_objectSpread(_objectSpread({}, noticeObject), {}, { bookID: bookID, username: username }));};addSuccessMessage = function _addSuccessMessage(successString) {// functionLog(`checkBookPackage success: ${successString}`);
              checkBookPackageResult.successList.push(successString);}; /*
            Note: You may want to run clearCaches() and/or preloadReposIfNecessary() before running this function???
             Note that bookID here can also be the 'OBS' pseudo bookID.
            */ // functionLog(`checkBookPackage(un='${username}', lC='${languageCode}', bk='${bookID}', (fn), ${JSON.stringify(checkingOptions)})…`)
            //parameterAssert(username !== undefined, "checkBookPackage: 'username' parameter should be defined");
            //parameterAssert(typeof username === 'string', `checkBookPackage: 'username' parameter should be a string not a '${typeof username}': ${username}`);
            //parameterAssert(languageCode !== undefined, "checkBookPackage: 'languageCode' parameter should be defined");
            //parameterAssert(typeof languageCode === 'string', `checkBookPackage: 'languageCode' parameter should be a string not a '${typeof languageCode}': ${languageCode}`);
            //parameterAssert(bookID !== undefined, "checkBookPackage: 'bookID' parameter should be defined");
            //parameterAssert(typeof bookID === 'string', `checkBookPackage: 'bookID' parameter should be a string not a '${typeof bookID}': ${bookID}`);
            //parameterAssert(bookID.length === 3, `checkBookPackage: 'bookID' parameter should be three characters long not ${bookID.length}`);
            //parameterAssert(bookID.toUpperCase() === bookID, `checkBookPackage: 'bookID' parameter should be UPPERCASE not '${bookID}'`);
            //parameterAssert(bookID === 'OBS' || books.isValidBookID(bookID), `checkBookPackage: '${bookID}' is not a valid USFM book identifier`);
            abortFlag = false;startTime = new Date();bookID = bookID.toUpperCase(); // normalise to USFM standard
            checkedFileCount = 0, checkedFilenames = [], checkedFilenameExtensions = new Set(), totalCheckedSize = 0, checkedRepoNames = new Set();checkBookPackageResult = { successList: [], noticeList: [] };dataSet = checkingOptions === null || checkingOptions === void 0 ? void 0 : checkingOptions.dataSet; // Can be 'DEFAULT', 'OLD' (Markdown, etc.), 'NEW' (TSV only), or 'BOTH'
            if (!dataSet) dataSet = 'DEFAULT';newCheckingOptions = checkingOptions ? _objectSpread({}, checkingOptions) : {}; // clone before modify
            getFile_ = newCheckingOptions.getFile ? newCheckingOptions.getFile : _core.cachedGetFile; // default to using caching of files
            newCheckingOptions.getFile = getFile_; // use same getFile_ when we call core functions
            if (!newCheckingOptions.originalLanguageRepoUsername) newCheckingOptions.originalLanguageRepoUsername = username;if (!newCheckingOptions.taRepoUsername) newCheckingOptions.taRepoUsername = username;if (!newCheckingOptions.twRepoUsername) newCheckingOptions.twRepoUsername = username; // No point in passing the branch through as a parameter
            //  coz if it’s not 'master', it’s unlikely to be common for all the repos
            originalBranch = 'master'; // If it's a big book, drop this location string to reduce memory use in case of thousands of errors
            generalLocation = bookID === 'OBS' ? " in ".concat(languageCode, " ").concat(bookID, " from ").concat(username, " ").concat(originalBranch, " branch") : books.chaptersInBook(bookID) > 10 ? '' : " in ".concat(languageCode, " ").concat(bookID, " book package from ").concat(username, " ").concat(originalBranch, " branch");if (!(bookID === 'OBS')) {_context4.next = 27;break;} // NOTE: No code below to handle OBS TN and TQ which are markdown repos
            if (dataSet === 'DEFAULT') repoCodeList = ['OBS', 'OBS-TWL', 'OBS-TN2', 'OBS-TQ2', 'OBS-SN2', 'OBS-SQ2'];else if (dataSet === 'OLD') repoCodeList = ['OBS', 'OBS-TN', 'OBS-TQ', 'OBS-SN', 'OBS-SQ'];else if (dataSet === 'NEW') repoCodeList = ['OBS', 'OBS-TWL', 'OBS-TN2', 'OBS-TQ2', 'OBS-SN2', 'OBS-SQ2'];else if (dataSet === 'BOTH') repoCodeList = ['OBS', 'OBS-TWL', 'OBS-TN', 'OBS-TN2', 'OBS-TQ', 'OBS-TQ2', 'OBS-SN', 'OBS-SN', 'OBS-SN2', 'OBS-SQ2'];_context4.next = 42;break;case 27:_context4.prev = 27;bookNumberAndName = books.usfmNumberName(bookID);whichTestament = books.testament(bookID); // returns 'old' or 'new'
            _context4.next = 40;break;case 32:_context4.prev = 32;_context4.t0 = _context4["catch"](27);if (!books.isValidBookID(bookID)) {_context4.next = 38;break;} // must be in FRT, BAK, etc.
            whichTestament = 'other';_context4.next = 40;break;case 38:addNoticePartial({ priority: 902, message: "Bad function call: should be given a valid book abbreviation", excerpt: bookID, location: " (not '".concat(bookID, "')").concat(generalLocation) });return _context4.abrupt("return", checkBookPackageResult);case 40: // debugLog(`checkBookPackage: bookNumberAndName='${bookNumberAndName}' (${whichTestament} testament)`);
            // So now we want to work through checking this one specified Bible book in various repos
            origLangRepoCode = whichTestament === 'old' ? 'UHB' : 'UGNT';if (dataSet === 'DEFAULT') repoCodeList = languageCode === 'en' ? [origLangRepoCode, 'TWL', 'LT', 'ST', 'TN', 'TQ', 'SN', 'SQ'] : [origLangRepoCode, 'LT', 'ST', 'TN', 'TQ'];else if (dataSet === 'OLD') repoCodeList = languageCode === 'en' ? [origLangRepoCode, 'TWL', 'LT', 'ST', 'TN', 'TQ'] : [origLangRepoCode, 'LT', 'ST', 'TN', 'TQ'];else if (dataSet === 'NEW') repoCodeList = languageCode === 'en' ? [origLangRepoCode, 'TWL', 'LT', 'ST', 'TN2', 'TQ2', 'SN', 'SQ'] : [origLangRepoCode, 'LT', 'ST', 'TN', 'TQ'];else if (dataSet === 'BOTH') repoCodeList = languageCode === 'en' ? [origLangRepoCode, 'TWL', 'LT', 'ST', 'TN2', 'TN', 'TQ2', 'TQ', 'SN', 'SQ'] : [origLangRepoCode, 'LT', 'ST', 'TN', 'TQ'];case 42: // Main loop for checkBookPackage()
            checkedManifestDetails = [];numCheckedRepos = 0;_iterator = _createForOfIteratorHelper(repoCodeList);_context4.prev = 45;_iterator.s();case 47:if ((_step = _iterator.n()).done) {_context4.next = 156;break;}repoCode = _step.value;if (!abortFlag) {_context4.next = 51;break;}return _context4.abrupt("break", 156);case 51:adjustedRepoCode = repoCode, adjustedBranch = originalBranch;if (adjustedRepoCode.endsWith('2')) {adjustedRepoCode = adjustedRepoCode.substring(0, adjustedRepoCode.length - 1); // Remove the '2' from the end
              adjustedBranch = 'newFormat';generalLocation = generalLocation.replace(originalBranch, adjustedBranch);} else // doesn't end with 2
              generalLocation = generalLocation.replace(adjustedBranch, originalBranch);repoName = (0, _core.formRepoName)(languageCode, adjustedRepoCode);repoLocation = " in ".concat(repoCode).concat(generalLocation);if (adjustedRepoCode.startsWith('OBS-')) adjustedRepoCode = adjustedRepoCode.substring(4); // Remove the 'OBS-' from the beginning
            // if (bookID === 'OBS' && dataSet === 'OLD' && repoCode !== 'OBS' && repoCode !== 'TWL' && repoName === `${languageCode}_${adjustedRepoCode.toLowerCase()}`)
            //   repoName = `${languageCode}_obs-${adjustedRepoCode.toLowerCase()}`;
            (0, _utilities.userLog)("checkBookPackage: check ".concat(languageCode, " ").concat(bookID, " in ").concat(repoCode, " (").concat(adjustedRepoCode, ") from ").concat(username, " ").concat(repoName, " ").concat(adjustedBranch, "\u2026")); // Update our "waiting" message
            setResultValue( /*#__PURE__*/_react.default.createElement("p", { style: { color: 'magenta' } }, "Checking ", /*#__PURE__*/_react.default.createElement("i", null, username), " ", languageCode, " ", /*#__PURE__*/_react.default.createElement("b", null, bookID), " book package in ", /*#__PURE__*/_react.default.createElement("b", null, repoCode), " (checked ", /*#__PURE__*/_react.default.createElement("b", null, numCheckedRepos), "/", repoCodeList.length, " repos)\u2026"));filename = void 0;if (!(repoCode === 'UHB' || repoCode === 'UGNT' || repoCode === 'LT' || repoCode === 'ST')) {_context4.next = 63;break;} // TODO: Might we need specific releases/tags for some of these (e.g., from the TN2 manifest)???
            // TODO: Do we need to hard-code where to find the UHB and UGNT???
            filename = "".concat(bookNumberAndName, ".usfm");_context4.next = 83;break;case 63:if (!(adjustedRepoCode === 'TWL' || repoCode.endsWith('TN2') || repoCode.endsWith('TQ2'))) {_context4.next = 67;break;}filename = "".concat(adjustedRepoCode.toLowerCase(), "_").concat(bookID, ".tsv");_context4.next = 83;break;case 67:if (!(adjustedRepoCode === 'SN' || adjustedRepoCode === 'SQ')) {_context4.next = 71;break;}filename = "".concat(adjustedRepoCode.toLowerCase(), "_").concat(bookID, ".tsv");_context4.next = 83;break;case 71:if (!(adjustedRepoCode === 'TN' && !repoCode.startsWith('OBS-'))) {_context4.next = 83;break;}_context4.prev = 72;_context4.next = 75;return (0, _core.cachedGetBookFilenameFromManifest)({ username: username, repository: repoName, branch: originalBranch, bookID: bookID.toLowerCase() });case 75:filename = _context4.sent;(0, _utilities.logicAssert)(filename.startsWith("".concat(languageCode, "_")), "Expected TN filename '".concat(filename, "' to start with the language code '").concat(languageCode, "_'"));_context4.next = 82;break;case 79:_context4.prev = 79;_context4.t1 = _context4["catch"](72); // console.error(`cachedGetBookFilenameFromManifest failed with: ${e}`);
            filename = "".concat(languageCode, "_tn_").concat(bookNumberAndName, ".tsv"); // Take a guess
          case 82:(0, _utilities.logicAssert)(filename.endsWith('.tsv'), "Expected TN filename '".concat(filename, "' to end with '.tsv'"));case 83:if (!(repoCode === 'OBS')) {_context4.next = 93;break;}_context4.next = 86;return (0, _checkRepo.checkRepo)(username, "".concat(languageCode, "_obs"), originalBranch, generalLocation, setResultValue, newCheckingOptions);case 86:crResultObject = _context4.sent; // Adds the notices to checkBookPackageResult
            // debugLog(`checkRepo('OBS') returned ${crResultObject.successList.length} success message(s) and ${crResultObject.noticeList.length} notice(s)`);
            // debugLog(`crResultObject keys: ${JSON.stringify(Object.keys(crResultObject))}`);
            // debugLog(`crResultObject checkedRepoNames: ${crResultObject.checkedRepoNames}`);
            checkBookPackageResult.successList = checkBookPackageResult.successList.concat(crResultObject.successList);checkBookPackageResult.noticeList = checkBookPackageResult.noticeList.concat(crResultObject.noticeList);if (crResultObject.checkedFileCount > 0) {checkedFilenames = checkedFilenames.concat(crResultObject.checkedFilenames);checkedFilenameExtensions = new Set([].concat((0, _toConsumableArray2.default)(checkedFilenameExtensions), (0, _toConsumableArray2.default)(crResultObject.checkedFilenameExtensions)));checkedFileCount += crResultObject.checkedFileCount;totalCheckedSize += crResultObject.totalCheckedSize;
              checkedRepoNames.add(repoName);
            }
            addSuccessMessage("Checked ".concat(languageCode, " OBS repo from ").concat(username));_context4.next = 133;break;case 93:if (!(
            repoCode === 'TQ' || repoCode === 'OBS-TN' || repoCode === 'OBS-TQ')) {_context4.next = 102;break;}_context4.next = 96;return (

              checkTQMarkdownBook(username, languageCode, repoCode, repoName, originalBranch, bookID, newCheckingOptions));case 96:tqResultObject = _context4.sent;
            checkBookPackageResult.successList = checkBookPackageResult.successList.concat(tqResultObject.successList);
            checkBookPackageResult.noticeList = checkBookPackageResult.noticeList.concat(tqResultObject.noticeList);
            if (tqResultObject.checkedFileCount > 0) {
              checkedFilenames = checkedFilenames.concat(tqResultObject.checkedFilenames);
              checkedFilenameExtensions = new Set([].concat((0, _toConsumableArray2.default)(checkedFilenameExtensions), (0, _toConsumableArray2.default)(tqResultObject.checkedFilenameExtensions)));
              checkedFileCount += tqResultObject.checkedFileCount;
              totalCheckedSize += tqResultObject.totalCheckedSize;
              checkedRepoNames.add(repoName);
            }_context4.next = 133;break;case 102:
            // For repos other than OBS and TQ, we only have one file to check
            (0, _utilities.logicAssert)((_filename = filename) === null || _filename === void 0 ? void 0 : _filename.length, "filename should be set by now for un=".concat(username, " rC=").concat(repoCode, " aRC=").concat(adjustedRepoCode, " rN=").concat(repoName, " aBr=").concat(adjustedBranch));
            repoFileContent = void 0;_context4.prev = 104;_context4.next = 107;return (


              getFile_({ username: username, repository: repoName, path: filename, branch: adjustedBranch }));case 107:repoFileContent = _context4.sent;
            // debugLog(`checkBookPackage fetched fileContent for ${username}, ${repoName}, ${adjustedBranch}, ${filename}, ${typeof repoFileContent}, ${repoFileContent.length}`);
            checkedFilenames.push(filename);
            totalCheckedSize += repoFileContent.length;
            checkedRepoNames.add(repoName);_context4.next = 127;break;case 113:_context4.prev = 113;_context4.t2 = _context4["catch"](104);

            // debugLog(`checkBookPackage(${username}, ${languageCode}, ${bookID}, (fn), ${JSON.stringify(checkingOptions)}) failed to load ${repoName}, ${filename}, ${adjustedBranch}, ${cBPgfError}`);
            // debugLog(`cBPgfError=${cBPgfError} or ${JSON.stringify(cBPgfError)} or2 ${cBPgfError === 'TypeError: repoFileContent is null'} or3 ${cBPgfError.message === 'TypeError: repoFileContent is null'} or4 ${cBPgfError.message === 'TypeError: repoFileContent is null'}`);
            details = "username=".concat(username);
            // Next line has special code to handle book-package-check.test.js tests [so we don't call repositoryExistsOnDoor43()]
            _context4.t3 = (_context4.t2 + '').startsWith('Tests could not find');if (_context4.t3) {_context4.next = 121;break;}_context4.next = 120;return (0, _core.repositoryExistsOnDoor43)({ username: username, repository: repoName });case 120:_context4.t3 = !_context4.sent;case 121:if (!_context4.t3) {_context4.next = 125;break;}
            checkBookPackageResult.noticeList.push({ priority: 997, message: "Repository doesn’t exist", details: details, username: username, repoCode: repoCode, repoName: repoName, location: repoLocation, extra: repoCode });_context4.next = 127;break;case 125:

            // eslint-disable-next-line eqeqeq
            if (_context4.t2 != 'TypeError: repoFileContent is null') details += " error=".concat(_context4.t2);
            addNoticePartial({ priority: repoCode === 'SN' || repoCode === 'SQ' ? 196 : 996, message: "Unable to load", details: details, repoCode: repoCode, repoName: repoName, filename: filename, location: repoLocation, extra: repoCode });case 127:if (!


            repoFileContent) {_context4.next = 133;break;}_context4.next = 130;return (


              ourCheckBPFileContents(repoCode, repoName, adjustedBranch, filename, repoFileContent, generalLocation, newCheckingOptions));case 130: // Adds the notices to checkBookPackageResult
            checkedFileCount += 1;
            checkedFilenameExtensions.add(filename.split('.').pop());
            addSuccessMessage("Checked ".concat(repoCode.toUpperCase(), " file: ").concat(filename));case 133:if (



            newCheckingOptions !== null && newCheckingOptions !== void 0 && newCheckingOptions.disableAllLinkFetchingFlag) {_context4.next = 153;break;}if (


            checkedManifestDetails.includes(repoName)) {_context4.next = 153;break;} // Don’t want to check more than once
            checkedManifestDetails.push(repoName); // Remember that we checked this one
            // debugLog(`Maybe checking MANIFEST etc. for ${repoName}`);
            if (!(
            newCheckingOptions !== null && newCheckingOptions !== void 0 && newCheckingOptions.checkManifestFlag)) {_context4.next = 141;break;}_context4.next = 139;return (

              ourCheckManifestFile(repoCode, repoName, adjustedBranch, generalLocation, newCheckingOptions));case 139:numCheckedCharacters = _context4.sent;
            if (numCheckedCharacters > 0) {
              checkedFileCount += 1;
              checkedFilenames.push('manifest.yaml');
              checkedFilenameExtensions.add('yaml');
              totalCheckedSize += numCheckedCharacters;
              addSuccessMessage("Checked ".concat(repoName, " manifest file"));
            }case 141:if (!(




            newCheckingOptions !== null && newCheckingOptions !== void 0 && newCheckingOptions.checkReadmeFlag)) {_context4.next = 147;break;}
            // debugLog(`checkBookPackage: checking README for ${repoName}`);
            _filename2 = 'README.md';_context4.next = 145;return (
              ourCheckMarkdownFile(repoCode, repoName, adjustedBranch, _filename2, generalLocation, newCheckingOptions));case 145:_numCheckedCharacters = _context4.sent;
            if (_numCheckedCharacters > 0) {
              checkedFileCount += 1;
              checkedFilenames.push(_filename2);
              checkedFilenameExtensions.add('md');
              totalCheckedSize += _numCheckedCharacters;
              addSuccessMessage("Checked ".concat(repoName, " README file"));
            }case 147:if (!(




            newCheckingOptions !== null && newCheckingOptions !== void 0 && newCheckingOptions.checkLicenseFlag)) {_context4.next = 153;break;}
            // debugLog(`Checking LICENSE for ${repoName}`);
            _filename3 = 'LICENSE.md';_context4.next = 151;return (
              ourCheckMarkdownFile(repoCode, repoName, adjustedBranch, _filename3, generalLocation, newCheckingOptions));case 151:_numCheckedCharacters2 = _context4.sent;
            if (_numCheckedCharacters2 > 0) {
              checkedFileCount += 1;
              checkedFilenames.push(_filename3);
              checkedFilenameExtensions.add('md');
              totalCheckedSize += _numCheckedCharacters2;
              addSuccessMessage("Checked ".concat(repoName, " LICENSE file"));
            }case 153:




            // end of linkFetching not disabled
            // else debugLog(`NOT fetching MANIFEST, etc. for ${repoName}`);

            numCheckedRepos += 1;
            // debugLog(`At end of loop having checked ${numCheckedRepos} repos`);
          case 154:_context4.next = 47;break;case 156:_context4.next = 161;break;case 158:_context4.prev = 158;_context4.t4 = _context4["catch"](45);_iterator.e(_context4.t4);case 161:_context4.prev = 161;_iterator.f();return _context4.finish(161);case 164: // end of repo loop


            // Add some extra fields to our checkFileResult object
            //  in case we need this information again later
            checkBookPackageResult.checkedFileCount = checkedFileCount;
            checkBookPackageResult.checkedFilenames = checkedFilenames;
            checkBookPackageResult.checkedFilenameExtensions = (0, _toConsumableArray2.default)(checkedFilenameExtensions); // convert Set to Array
            checkBookPackageResult.checkedFilesizes = totalCheckedSize;
            checkBookPackageResult.checkedRepoNames = (0, _toConsumableArray2.default)(checkedRepoNames); // convert Set to Array
            // checkBookPackageResult.checkedOptions = newCheckingOptions; // This is done at the caller level

            checkBookPackageResult.elapsedSeconds = (new Date() - startTime) / 1000; // seconds
            // debugLog("checkBookPackageResult:", JSON.stringify(checkBookPackageResult));
            // debugLog(`checkBookPackageResult(${bookID}): elapsedSeconds = ${checkBookPackageResult.elapsedSeconds}, notices count = ${checkBookPackageResult.noticeList.length}`);
            return _context4.abrupt("return", checkBookPackageResult);case 171:case "end":return _context4.stop();}}}, _callee4, null, [[27, 32], [45, 158, 161, 164], [72, 79], [104, 113]]);}));return _checkBookPackage.apply(this, arguments);}
;
// end of checkBookPackage()


/*
    checkTQMarkdownBook
*/
/**
 *
 * @param {string} username
 * @param {string} languageCode
 * @param {string} repoCode -- 'TQ' or 'OBS-TQ'
 * @param {string} repoName
 * @param {string} branch
 * @param {string} bookID -- 3-character USFM book ID or 'OBS'
 * @param {Object} checkingOptions
 * @return {Object} - containing successList and noticeList
 */function
checkTQMarkdownBook(_x6, _x7, _x8, _x9, _x10, _x11, _x12) {return _checkTQMarkdownBook.apply(this, arguments);}

































































































































































// end of checkTQMarkdownBook function
function _checkTQMarkdownBook() {_checkTQMarkdownBook = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee6(username, languageCode, repoCode, repoName, branch, bookID, checkingOptions) {var generalLocation, ctqResult, addSuccessMessage, addNoticePartial, ourCheckTQFileContents, _ourCheckTQFileContents, getFileListFromZip_, checkedFileCount, checkedFilenames, checkedFilenameExtensions, totalCheckedSize, pathList, details, _iterator7, _step7, thisPath, pathParts, C, V, _getFile_, tqFileContent, _details;return _regenerator.default.wrap(function _callee6$(_context6) {while (1) {switch (_context6.prev = _context6.next) {case 0:_ourCheckTQFileContents = function _ourCheckTQFileConten2() {_ourCheckTQFileContents = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee5(repoCode, bookID, C, V, cfFilename, fileContent, fileLocation, checkingOptions) {var cfResultObject, _iterator8, _step8, noticeEntry;return _regenerator.default.wrap(function _callee5$(_context5) {while (1) {switch (_context5.prev = _context5.next) {case 0:_context5.next = 2;return (0, _checkFileContents.checkFileContents)(username, languageCode, repoCode, branch, cfFilename, fileContent, fileLocation, checkingOptions);case 2:cfResultObject = _context5.sent; // debugLog("checkFileContents() returned", cfResultObject.successList.length, "success message(s) and", cfResultObject.noticeList.length, "notice(s)");
                        // for (const successEntry of cfResultObject.successList) userLog("  ourCheckTQFileContents:", successEntry);
                        // Process noticeList line by line,  appending the repoCode as an extra field as we go
                        _iterator8 = _createForOfIteratorHelper(cfResultObject.noticeList);try {for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {noticeEntry = _step8.value; // noticeEntry is an array of eight fields: 1=priority, 2=bookID, 3=C, 4=V, 5=msg, 6=characterIndex, 7=excerpt, 8=location
                            // //parameterAssert(Object.keys(noticeEntry).length === 5, `cTQ ourCheckTQFileContents notice length=${Object.keys(noticeEntry).length}`);
                            // We add the repoCode as an extra value
                            addNoticePartial(_objectSpread(_objectSpread({}, noticeEntry), {}, { bookID: bookID, C: C, V: V, extra: repoCode }));}} catch (err) {_iterator8.e(err);} finally {_iterator8.f();}case 5:case "end":return _context5.stop();}}}, _callee5);}));return _ourCheckTQFileContents.apply(this, arguments);};ourCheckTQFileContents = function _ourCheckTQFileConten(_x31, _x32, _x33, _x34, _x35, _x36, _x37, _x38) {return _ourCheckTQFileContents.apply(this, arguments);};addNoticePartial = function _addNoticePartial2(noticeObject) {// bookID is a three-character UPPERCASE USFM book identifier or 'OBS'.
              // functionLog(`checkTQMarkdownBook addNoticePartial: ${noticeObject.priority}:${noticeObject.message} ${noticeObject.bookID} ${noticeObject.C}:${noticeObject.V} ${noticeObject.filename}:${noticeObject.lineNumber} ${noticeObject.characterIndex > 0 ? ` (at character ${noticeObject.characterIndex})` : ""}${noticeObject.excerpt ? ` ${noticeObject.excerpt}` : ""}${noticeObject.location}`);
              //parameterAssert(noticeObject.priority !== undefined, "cTQ addNoticePartial: 'priority' parameter should be defined");
              //parameterAssert(typeof noticeObject.priority === 'number', `cTQ addNoticePartial: 'priority' parameter should be a number not a '${typeof noticeObject.priority}'`);
              //parameterAssert(noticeObject.message !== undefined, "cTQ addNoticePartial: 'message' parameter should be defined");
              //parameterAssert(typeof noticeObject.message === 'string', `cTQ addNoticePartial: 'message' parameter should be a string not a '${typeof noticeObject.message}'`);
              //parameterAssert(noticeObject.bookID !== undefined, "cTQ addNoticePartial: 'bookID' parameter should be defined");
              //parameterAssert(typeof noticeObject.bookID === 'string', `cTQ addNoticePartial: 'bookID' parameter should be a string not a '${typeof noticeObject.bookID}'`);
              //parameterAssert(noticeObject.bookID.length === 3, `cTQ addNoticePartial: 'bookID' parameter should be three characters long not ${noticeObject.bookID.length}`);
              //parameterAssert(noticeObject.bookID === 'OBS' || books.isValidBookID(noticeObject.bookID), `cTQ addNoticePartial: '${noticeObject.bookID}' is not a valid USFM book identifier`);
              // //parameterAssert(C !== undefined, "cTQ addNoticePartial: 'C' parameter should be defined");
              if (noticeObject.C) {//parameterAssert(typeof noticeObject.C === 'string', `cTQ addNoticePartial: 'C' parameter should be a string not a '${typeof noticeObject.C}'`);
              } // //parameterAssert(V !== undefined, "cTQ addNoticePartial: 'V' parameter should be defined");
              if (noticeObject.V) {//parameterAssert(typeof noticeObject.V === 'string', `cTQ addNoticePartial: 'V' parameter should be a string not a '${typeof noticeObject.V}'`);
              } // //parameterAssert(characterIndex !== undefined, "cTQ addNoticePartial: 'characterIndex' parameter should be defined");
              if (noticeObject.characterIndex) {//parameterAssert(typeof noticeObject.characterIndex === 'number', `cTQ addNoticePartial: 'characterIndex' parameter should be a number not a '${typeof noticeObject.characterIndex}'`);
              } // //parameterAssert(excerpt !== undefined, "cTQ addNoticePartial: 'excerpt' parameter should be defined");
              if (noticeObject.excerpt) {//parameterAssert(typeof noticeObject.excerpt === 'string', `cTQ addNoticePartial: 'excerpt' parameter should be a string not a '${typeof noticeObject.excerpt}'`);
              } //parameterAssert(noticeObject.location !== undefined, "cTQ addNoticePartial: 'location' parameter should be defined");
              //parameterAssert(typeof noticeObject.location === 'string', `cTQ addNoticePartial: 'location' parameter should be a string not a '${typeof noticeObject.location}'`);
              //parameterAssert(noticeObject.extra !== undefined, "cTQ addNoticePartial: 'extra' parameter should be defined");
              //parameterAssert(typeof noticeObject.extra === 'string', `cTQ addNoticePartial: 'extra' parameter should be a string not a '${typeof noticeObject.extra}'`);
              ctqResult.noticeList.push(_objectSpread(_objectSpread({}, noticeObject), {}, { username: username, repoCode: repoCode, repoName: repoName, bookID: bookID }));};addSuccessMessage = function _addSuccessMessage2(successString) {// functionLog(`checkBookPackage success: ${successString}`);
              ctqResult.successList.push(successString);}; // functionLog(`checkBookPackage checkTQMarkdownBook(${username}, ${languageCode}, ${repoCode} ${repoName}, ${branch}, ${bookID}, ${JSON.stringify(checkingOptions)})…`)
            //parameterAssert(username !== undefined, "checkTQMarkdownBook: 'username' parameter should be defined");
            //parameterAssert(typeof username === 'string', `checkTQMarkdownBook: 'username' parameter should be a string not a '${typeof username}': '${username}'`);
            //parameterAssert(languageCode !== undefined, "checkTQMarkdownBook: 'languageCode' parameter should be defined");
            //parameterAssert(typeof languageCode === 'string', `checkTQMarkdownBook: 'languageCode' parameter should be a string not a '${typeof languageCode}': '${languageCode}'`);
            //parameterAssert(repoCode !== undefined, "checkTQMarkdownBook: 'repoCode' parameter should be defined");
            //parameterAssert(typeof repoCode === 'string', `checkTQMarkdownBook: 'repoCode' parameter should be a string not a '${typeof repoCode}': '${repoCode}'`);
            //parameterAssert(repoCode === 'TQ' || repoCode === 'OBS-TQ', `checkTQMarkdownBook: 'repoCode' parameter should be 'TQ' or 'OBS-TQ' not '${repoCode}'`);
            //parameterAssert(repoName !== undefined, "checkTQMarkdownBook: 'repoName' parameter should be defined");
            //parameterAssert(typeof repoName === 'string', `checkTQMarkdownBook: 'repoName' parameter should be a string not a '${typeof repoName}': ${repoName}`);
            //parameterAssert(branch !== undefined, "checkTQMarkdownBook: 'branch' parameter should be defined");
            //parameterAssert(typeof branch === 'string', `checkTQMarkdownBook: 'branch' parameter should be a string not a '${typeof branch}': '${branch}'`);
            //parameterAssert(bookID !== undefined, "checkTQMarkdownBook: 'bookID' parameter should be defined");
            //parameterAssert(typeof bookID === 'string', `checkTQMarkdownBook: 'bookID' parameter should be a string not a '${typeof bookID}': ${bookID}`);
            //parameterAssert(bookID.length === 3, `checkTQMarkdownBook: 'bookID' parameter should be three characters long not ${bookID.length}`);
            //parameterAssert(bookID.toUpperCase() === bookID, `checkTQMarkdownBook: 'bookID' parameter should be UPPERCASE not '${bookID}'`);
            //parameterAssert(bookID === 'OBS' || books.isValidBookID(bookID), `checkTQMarkdownBook: '${bookID}' is not a valid USFM book identifier`);
            generalLocation = " in ".concat(username, " (").concat(branch, ")");ctqResult = { successList: [], noticeList: [] }; // end of ourCheckTQFileContents function
            // Main code for checkTQMarkdownBook
            // We need to find and check all the markdown folders/files for this book
            getFileListFromZip_ = checkingOptions && checkingOptions.getFileListFromZip ? checkingOptions.getFileListFromZip : _core.getFileListFromZip;checkedFileCount = 0, checkedFilenames = [], checkedFilenameExtensions = new Set(), totalCheckedSize = 0;_context6.next = 10;return getFileListFromZip_({ username: username, repository: repoName, branchOrRelease: branch, optionalPrefix: "".concat(bookID.toLowerCase(), "/") });case 10:pathList = _context6.sent;if (!(!Array.isArray(pathList) || !pathList.length)) {_context6.next = 22;break;} // console.error("checkTQrepo failed to load", username, repoName, branch);
            details = "username=".concat(username);_context6.next = 15;return (0, _core.repositoryExistsOnDoor43)({ username: username, repository: repoName });case 15:if (_context6.sent) {_context6.next = 19;break;}ctqResult.noticeList.push({ priority: 997, message: "Repository doesn’t exist", details: details, username: username, repoCode: repoCode, repoName: repoName, location: generalLocation, extra: repoCode });_context6.next = 20;break;case 19:addNoticePartial({ priority: 996, message: "Unable to load", details: details, bookID: bookID, location: generalLocation, extra: repoCode });case 20:_context6.next = 68;break;case 22: // debugLog(`  Got ${pathList.length} pathList entries`)
            _iterator7 = _createForOfIteratorHelper(pathList);_context6.prev = 23;_iterator7.s();case 25:if ((_step7 = _iterator7.n()).done) {_context6.next = 59;break;}thisPath = _step7.value; // debugLog("checkTQMarkdownBook: Try to load", username, repoName, thisPath, branch);
            //parameterAssert(thisPath.endsWith('.md'), `Expected ${thisPath} to end with .md`);
            // const filename = thisPath.split('/').pop();
            pathParts = thisPath.slice(0, -3).split('/');C = pathParts[pathParts.length - 2].replace(/^0+(?=\d)/, ''); // Remove leading zeroes
            V = pathParts[pathParts.length - 1].replace(/^0+(?=\d)/, ''); // Remove leading zeroes
            _getFile_ = checkingOptions && checkingOptions.getFile ? checkingOptions.getFile : _core.cachedGetFile;tqFileContent = void 0;_context6.prev = 32;_context6.next = 35;return _getFile_({ username: username, repository: repoName, path: thisPath, branch: branch });case 35:tqFileContent = _context6.sent; // debugLog("Fetched fileContent for", repoName, thisPath, typeof tqFileContent, tqFileContent.length);
            checkedFilenames.push(thisPath);totalCheckedSize += tqFileContent.length;_context6.next = 52;break;case 40:_context6.prev = 40;_context6.t0 = _context6["catch"](32);console.error("checkTQMarkdownBook failed to load", username, repoName, thisPath, branch, _context6.t0 + '');_details = "username=".concat(username);_context6.next = 46;return (0, _core.repositoryExistsOnDoor43)({ username: username, repository: repoName });case 46:if (_context6.sent) {_context6.next = 50;break;}ctqResult.noticeList.push({ priority: 997, message: "Repository doesn’t exist", details: _details, username: username, repoCode: repoCode, repoName: repoName, location: generalLocation, extra: repoCode });_context6.next = 52;break;case 50: // eslint-disable-next-line eqeqeq
            if (_context6.t0 != 'TypeError: repoFileContent is null') _details += " error=".concat(_context6.t0);addNoticePartial({ priority: 996, message: "Unable to load", details: _details, bookID: bookID, C: C, V: V, filename: thisPath, location: "".concat(generalLocation, " ").concat(thisPath), extra: repoCode });case 52:if (!tqFileContent) {_context6.next = 57;break;}_context6.next = 55;return ourCheckTQFileContents(repoCode, bookID, C, V, thisPath, tqFileContent, generalLocation, checkingOptions);case 55: // Adds the notices to checkBookPackageResult
            checkedFileCount += 1;checkedFilenameExtensions.add('md'); // addSuccessMessage(`Checked ${repoCode.toUpperCase()} file: ${thisPath}`);
          case 57:_context6.next = 25;break;case 59:_context6.next = 64;break;case 61:_context6.prev = 61;_context6.t1 = _context6["catch"](23);_iterator7.e(_context6.t1);case 64:_context6.prev = 64;_iterator7.f();return _context6.finish(64);case 67:addSuccessMessage("Checked ".concat(checkedFileCount.toLocaleString(), " ").concat(repoCode.toUpperCase(), " file").concat(checkedFileCount === 1 ? '' : 's'));case 68:ctqResult.checkedFileCount = checkedFileCount;ctqResult.checkedFilenames = checkedFilenames;ctqResult.checkedFilenameExtensions = (0, _toConsumableArray2.default)(checkedFilenameExtensions); // convert Set to Array
            ctqResult.checkedFilesizes = totalCheckedSize; // debugLog(`  checkTQMarkdownBook returning ${JSON.stringify(ctqResult)}`);
            return _context6.abrupt("return", ctqResult);case 73:case "end":return _context6.stop();}}}, _callee6, null, [[23, 61, 64, 67], [32, 40]]);}));return _checkTQMarkdownBook.apply(this, arguments);}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9kZW1vcy9ib29rLXBhY2thZ2UtY2hlY2svY2hlY2tCb29rUGFja2FnZS5qcyJdLCJuYW1lcyI6WyJTVEFOREFSRF9NQU5JRkVTVF9GSUxFTkFNRSIsImNoZWNrQm9va1BhY2thZ2UiLCJ1c2VybmFtZSIsImxhbmd1YWdlQ29kZSIsImJvb2tJRCIsInNldFJlc3VsdFZhbHVlIiwiY2hlY2tpbmdPcHRpb25zIiwiYWRkU3VjY2Vzc01lc3NhZ2UiLCJhZGROb3RpY2VQYXJ0aWFsIiwib3VyQ2hlY2tCUEZpbGVDb250ZW50cyIsIm91ckNoZWNrTWFuaWZlc3RGaWxlIiwib3VyQ2hlY2tNYXJrZG93bkZpbGUiLCJyZXBvQ29kZSIsInJlcG9OYW1lIiwicmVwb0JyYW5jaCIsImZpbGVuYW1lIiwibWFya2Rvd25Mb2NhdGlvbiIsImdldEZpbGVfIiwicmVwb3NpdG9yeSIsInBhdGgiLCJicmFuY2giLCJtYXJrZG93bkZpbGVDb250ZW50IiwiY29uc29sZSIsImVycm9yIiwiSlNPTiIsInN0cmluZ2lmeSIsIm9yaWdpbmFsQnJhbmNoIiwiZGV0YWlscyIsImNoZWNrQm9va1BhY2thZ2VSZXN1bHQiLCJub3RpY2VMaXN0IiwicHVzaCIsInByaW9yaXR5IiwibWVzc2FnZSIsImxvY2F0aW9uIiwiZXh0cmEiLCJzdWJzdHJpbmciLCJsZW5ndGgiLCJjbXRSZXN1bHRPYmplY3QiLCJjZmNOb3RpY2VFbnRyeSIsImZ1bGxZZWFyU3RyaW5nIiwiRGF0ZSIsImdldEZ1bGxZZWFyIiwiaW5kZXhPZiIsIm1hbmlmZXN0TG9jYXRpb24iLCJtYW5pZmVzdEZpbGVDb250ZW50IiwiY2ZGaWxlbmFtZSIsImZpbGVDb250ZW50IiwiZmlsZUxvY2F0aW9uIiwiYWRqdXN0ZWRMYW5ndWFnZUNvZGUiLCJjZmNSZXN1bHRPYmplY3QiLCJjaGVja2VkRmlsZUNvdW50IiwiY2hlY2tlZEZpbGVzaXplcyIsInRvdGFsQ2hlY2tlZFNpemUiLCJjaGVja2VkUmVwb05hbWVzIiwiY2hlY2tlZFJlcG9OYW1lIiwiYWRkIiwiY2hlY2tlZEZpbGVuYW1lRXh0ZW5zaW9ucyIsImNoZWNrZWRGaWxlbmFtZUV4dGVuc2lvbiIsIm5vdGljZU9iamVjdCIsIkMiLCJWIiwiY2hhcmFjdGVySW5kZXgiLCJleGNlcnB0IiwiZGVidWdDaGFpbiIsInN1Y2Nlc3NTdHJpbmciLCJzdWNjZXNzTGlzdCIsImFib3J0RmxhZyIsInN0YXJ0VGltZSIsInRvVXBwZXJDYXNlIiwiY2hlY2tlZEZpbGVuYW1lcyIsIlNldCIsImRhdGFTZXQiLCJuZXdDaGVja2luZ09wdGlvbnMiLCJnZXRGaWxlIiwiY2FjaGVkR2V0RmlsZSIsIm9yaWdpbmFsTGFuZ3VhZ2VSZXBvVXNlcm5hbWUiLCJ0YVJlcG9Vc2VybmFtZSIsInR3UmVwb1VzZXJuYW1lIiwiZ2VuZXJhbExvY2F0aW9uIiwiYm9va3MiLCJjaGFwdGVyc0luQm9vayIsInJlcG9Db2RlTGlzdCIsImJvb2tOdW1iZXJBbmROYW1lIiwidXNmbU51bWJlck5hbWUiLCJ3aGljaFRlc3RhbWVudCIsInRlc3RhbWVudCIsImlzVmFsaWRCb29rSUQiLCJvcmlnTGFuZ1JlcG9Db2RlIiwiY2hlY2tlZE1hbmlmZXN0RGV0YWlscyIsIm51bUNoZWNrZWRSZXBvcyIsImFkanVzdGVkUmVwb0NvZGUiLCJhZGp1c3RlZEJyYW5jaCIsImVuZHNXaXRoIiwicmVwbGFjZSIsInJlcG9Mb2NhdGlvbiIsInN0YXJ0c1dpdGgiLCJjb2xvciIsInRvTG93ZXJDYXNlIiwiY3JSZXN1bHRPYmplY3QiLCJjb25jYXQiLCJjaGVja1RRTWFya2Rvd25Cb29rIiwidHFSZXN1bHRPYmplY3QiLCJyZXBvRmlsZUNvbnRlbnQiLCJzcGxpdCIsInBvcCIsImRpc2FibGVBbGxMaW5rRmV0Y2hpbmdGbGFnIiwiaW5jbHVkZXMiLCJjaGVja01hbmlmZXN0RmxhZyIsIm51bUNoZWNrZWRDaGFyYWN0ZXJzIiwiY2hlY2tSZWFkbWVGbGFnIiwiY2hlY2tMaWNlbnNlRmxhZyIsImVsYXBzZWRTZWNvbmRzIiwib3VyQ2hlY2tUUUZpbGVDb250ZW50cyIsImNmUmVzdWx0T2JqZWN0Iiwibm90aWNlRW50cnkiLCJjdHFSZXN1bHQiLCJnZXRGaWxlTGlzdEZyb21aaXBfIiwiZ2V0RmlsZUxpc3RGcm9tWmlwIiwiYnJhbmNoT3JSZWxlYXNlIiwib3B0aW9uYWxQcmVmaXgiLCJwYXRoTGlzdCIsIkFycmF5IiwiaXNBcnJheSIsInRoaXNQYXRoIiwicGF0aFBhcnRzIiwic2xpY2UiLCJ0cUZpbGVDb250ZW50IiwidG9Mb2NhbGVTdHJpbmciXSwibWFwcGluZ3MiOiI4bkJBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxpRDs7O0FBR0E7O0FBRUEsSUFBTUEsMEJBQTBCLEdBQUcsZUFBbkM7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHO0FBQ3NCQyxnQixxTUFBZixrQkFBZ0NDLFFBQWhDLEVBQTBDQyxZQUExQyxFQUF3REMsTUFBeEQsRUFBZ0VDLGNBQWhFLEVBQWdGQyxlQUFoRjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQTJDSUMsSUFBQUEsaUJBM0NKOzs7Ozs7QUFpRElDLElBQUFBLGdCQWpESjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQW1GVUMsSUFBQUEsc0JBbkZWOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQThJVUMsSUFBQUEsb0JBOUlWOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUE2TVVDLElBQUFBLG9CQTdNViw2cEJBNk1MLGtCQUFvQ0MsUUFBcEMsRUFBOENDLFFBQTlDLEVBQXdEQyxVQUF4RCxFQUFvRUMsUUFBcEUsRUFBOEVDLGdCQUE5RSxFQUFnR1YsZUFBaEc7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQWtCZ0NXLDBCQUFBQSxRQUFRLENBQUMsRUFBRWYsUUFBUSxFQUFSQSxRQUFGLEVBQVlnQixVQUFVLEVBQUVMLFFBQXhCLEVBQWtDTSxJQUFJLEVBQUVKLFFBQXhDLEVBQWtESyxNQUFNLEVBQUVOLFVBQTFELEVBQUQsQ0FsQnhDLFNBa0JJTyxtQkFsQko7Ozs7QUFzQklDLHdCQUFBQSxPQUFPLENBQUNDLEtBQVIsaURBQXVEckIsUUFBdkQsZUFBb0VDLFlBQXBFLGVBQXFGQyxNQUFyRixxQkFBc0dvQixJQUFJLENBQUNDLFNBQUwsQ0FBZW5CLGVBQWYsQ0FBdEcsZ0NBQWtLSixRQUFsSyxFQUE0S1csUUFBNUssRUFBc0xFLFFBQXRMLEVBQWdNVyxjQUFoTSxFQUFnTixlQUFhLEVBQTdOO0FBQ0lDLHdCQUFBQSxPQXZCUixzQkF1QjhCekIsUUF2QjlCO0FBd0JnQiw4REFBeUIsRUFBRUEsUUFBUSxFQUFSQSxRQUFGLEVBQVlnQixVQUFVLEVBQUVMLFFBQXhCLEVBQXpCLENBeEJoQjtBQXlCTWUsd0JBQUFBLHNCQUFzQixDQUFDQyxVQUF2QixDQUFrQ0MsSUFBbEMsQ0FBdUMsRUFBRUMsUUFBUSxFQUFFLEdBQVosRUFBaUJDLE9BQU8sRUFBRSwwQkFBMUIsRUFBc0RMLE9BQU8sRUFBUEEsT0FBdEQsRUFBK0R6QixRQUFRLEVBQVJBLFFBQS9ELEVBQXlFVSxRQUFRLEVBQVJBLFFBQXpFLEVBQW1GQyxRQUFRLEVBQVJBLFFBQW5GLEVBQTZGb0IsUUFBUSxFQUFFakIsZ0JBQXZHLEVBQXlIa0IsS0FBSyxFQUFFdEIsUUFBaEksRUFBdkMsRUF6Qk47O0FBMkJNO0FBQ0EsNEJBQUksZ0JBQWMsb0NBQWxCLEVBQXdEZSxPQUFPLGtDQUFQO0FBQ3hEbkIsd0JBQUFBLGdCQUFnQixDQUFDLEVBQUV1QixRQUFRLEVBQUUsR0FBWixFQUFpQkMsT0FBTyxFQUFFLGdCQUExQixFQUE0Q0wsT0FBTyxxQkFBY3pCLFFBQWQsaUNBQW5ELEVBQWlHQSxRQUFRLEVBQVJBLFFBQWpHLEVBQTJHVyxRQUFRLEVBQVJBLFFBQTNHLEVBQXFIRSxRQUFRLEVBQVJBLFFBQXJILEVBQStIa0IsUUFBUSxFQUFFakIsZ0JBQXpJLEVBQTJKa0IsS0FBSyxFQUFFdEIsUUFBbEssRUFBRCxDQUFoQixDQTdCTjs7O0FBZ0NNUyx3QkFBQUEsbUJBaENOO0FBaUNrQyx1REFBa0JsQixZQUFsQixFQUFnQ1MsUUFBaEMsRUFBMENHLFFBQVEsQ0FBQ29CLFNBQVQsQ0FBbUIsQ0FBbkIsRUFBc0JwQixRQUFRLENBQUNxQixNQUFULEdBQWtCLENBQXhDLENBQTFDLEVBQXNGZixtQkFBdEYsRUFBMkdMLGdCQUEzRyxFQUE2SFYsZUFBN0gsQ0FqQ2xDLFVBaUNVK0IsZUFqQ1Y7QUFrQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQXhDSixnRUF5Q2lDQSxlQUFlLENBQUNSLFVBekNqRCxPQXlDSSx1REFBeUQsQ0FBOUNTLGNBQThDO0FBQ3ZEO0FBQ0E7QUFDQVYsNEJBQUFBLHNCQUFzQixDQUFDQyxVQUF2QixDQUFrQ0MsSUFBbEMsaUNBQTRDUSxjQUE1QyxTQUE0RHBDLFFBQVEsRUFBUkEsUUFBNUQsRUFBc0VVLFFBQVEsRUFBUkEsUUFBdEUsRUFBZ0ZDLFFBQVEsRUFBUkEsUUFBaEYsRUFBMEZFLFFBQVEsRUFBUkEsUUFBMUYsRUFBb0dtQixLQUFLLEVBQUV0QixRQUEzRztBQUNELDJCQTdDTDs7QUErQ0ksNEJBQUlHLFFBQVEsS0FBSyxZQUFqQixFQUErQjtBQUN2QndCLDBCQUFBQSxjQUR1QixhQUNGLElBQUlDLElBQUosRUFBRCxDQUFhQyxXQUFiLEVBREc7QUFFN0I7QUFDQSw4QkFBSXBCLG1CQUFtQixDQUFDcUIsT0FBcEIsQ0FBNEJILGNBQTVCLE1BQWdELENBQUMsQ0FBckQsRUFBd0Q7QUFDdEQ7QUFDQVgsNEJBQUFBLHNCQUFzQixDQUFDQyxVQUF2QixDQUFrQ0MsSUFBbEMsQ0FBdUMsRUFBRUMsUUFBUSxFQUFFLEdBQVosRUFBaUJDLE9BQU8sRUFBRSx5Q0FBMUIsRUFBcUVMLE9BQU8sZ0NBQXlCWSxjQUF6QixNQUE1RSxFQUF3SHJDLFFBQVEsRUFBUkEsUUFBeEgsRUFBa0lXLFFBQVEsRUFBUkEsUUFBbEksRUFBNElFLFFBQVEsRUFBUkEsUUFBNUksRUFBc0prQixRQUFRLEVBQUVqQixnQkFBaEssRUFBa0xrQixLQUFLLEVBQUV0QixRQUF6TCxFQUF2QztBQUNILHlCQXJETDs7QUF1RFdTLHdCQUFBQSxtQkFBbUIsQ0FBQ2UsTUF2RC9COztBQXlERTtBQUNBO0FBQ0FSLHdCQUFBQSxzQkFBc0IsQ0FBQ0MsVUFBdkIsQ0FBa0NDLElBQWxDLENBQXVDLEVBQUVDLFFBQVEsRUFBRSxHQUFaLEVBQWlCQyxPQUFPLEVBQUUseUJBQTFCLEVBQXFEbkIsUUFBUSxFQUFSQSxRQUFyRCxFQUErREUsUUFBUSxFQUFSQSxRQUEvRCxFQUF5RWtCLFFBQVEsRUFBRWpCLGdCQUFuRixFQUFxR2tCLEtBQUssRUFBRXRCLFFBQTVHLEVBQXZDLEVBM0RGO0FBNERTLHlCQTVEVCw2RUE3TUsseURBNk1VRCxvQkE3TVYseVJBOElMLGtCQUFvQ0MsUUFBcEMsRUFBOENDLFFBQTlDLEVBQXdEQyxVQUF4RCxFQUFvRTZCLGdCQUFwRSxFQUFzRnJDLGVBQXRGLGtRQWdCZ0NXLFFBQVEsQ0FBQyxFQUFFZixRQUFRLEVBQVJBLFFBQUYsRUFBWWdCLFVBQVUsRUFBRUwsUUFBeEIsRUFBa0NNLElBQUksRUFBRW5CLDBCQUF4QyxFQUFvRW9CLE1BQU0sRUFBRU4sVUFBNUUsRUFBRCxDQWhCeEMsUUFnQkk4QixtQkFoQkosMkdBb0JJdEIsT0FBTyxDQUFDQyxLQUFSLGlEQUF1RHJCLFFBQXZELGVBQW9FQyxZQUFwRSxlQUFxRkMsTUFBckYscUJBQXNHb0IsSUFBSSxDQUFDQyxTQUFMLENBQWVuQixlQUFmLENBQXRHLGdDQUFrS0osUUFBbEssRUFBNEtXLFFBQTVLLEVBQXNMQyxVQUF0TCxFQUFrTSxlQUFhLEVBQS9NLEVBQ0lhLE9BckJSLHNCQXFCOEJ6QixRQXJCOUIsNkJBc0JnQixvQ0FBeUIsRUFBRUEsUUFBUSxFQUFSQSxRQUFGLEVBQVlnQixVQUFVLEVBQUVMLFFBQXhCLEVBQXpCLENBdEJoQix5REF1Qk1lLHNCQUFzQixDQUFDQyxVQUF2QixDQUFrQ0MsSUFBbEMsQ0FBdUMsRUFBRUMsUUFBUSxFQUFFLEdBQVosRUFBaUJDLE9BQU8sRUFBRSwwQkFBMUIsRUFBc0RMLE9BQU8sRUFBUEEsT0FBdEQsRUFBK0R6QixRQUFRLEVBQVJBLFFBQS9ELEVBQXlFVSxRQUFRLEVBQVJBLFFBQXpFLEVBQW1GQyxRQUFRLEVBQVJBLFFBQW5GLEVBQTZGb0IsUUFBUSxFQUFFVSxnQkFBdkcsRUFBeUhULEtBQUssRUFBRXRCLFFBQWhJLEVBQXZDLEVBdkJOLG1DQXlCTTtBQUNBLDRCQUFJLGdCQUFjLG9DQUFsQixFQUF3RGUsT0FBTyxrQ0FBUCxDQUN4RG5CLGdCQUFnQixDQUFDLEVBQUV1QixRQUFRLEVBQUUsR0FBWixFQUFpQkMsT0FBTyxFQUFFLGdCQUExQixFQUE0Q0wsT0FBTyxxQkFBY3pCLFFBQWQsaUNBQW5ELEVBQWlHVyxRQUFRLEVBQVJBLFFBQWpHLEVBQTJHRSxRQUFRLEVBQUVmLDBCQUFySCxFQUFpSmlDLFFBQVEsRUFBRVUsZ0JBQTNKLEVBQTZLVCxLQUFLLEVBQUV0QixRQUFwTCxFQUFELENBQWhCLENBM0JOLGFBOEJNZ0MsbUJBOUJOLHlEQStCa0MsNkJBQWtCekMsWUFBbEIsRUFBZ0NTLFFBQWhDLEVBQTBDVixRQUExQyxFQUFvRFcsUUFBcEQsRUFBOERDLFVBQTlELEVBQTBFOEIsbUJBQTFFLEVBQStGRCxnQkFBL0YsRUFBaUhyQyxlQUFqSCxDQS9CbEMsU0ErQlUrQixlQS9CVixtQkFnQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBdENKLGdFQXVDaUNBLGVBQWUsQ0FBQ1IsVUF2Q2pELE9BdUNJLHVEQUF5RCxDQUE5Q1MsY0FBOEMsaUJBQ3ZEO0FBQ0E7QUFDQVYsNEJBQUFBLHNCQUFzQixDQUFDQyxVQUF2QixDQUFrQ0MsSUFBbEMsaUNBQTRDUSxjQUE1QyxTQUE0RHBDLFFBQVEsRUFBUkEsUUFBNUQsRUFBc0VVLFFBQVEsRUFBUkEsUUFBdEUsRUFBZ0ZDLFFBQVEsRUFBUkEsUUFBaEYsRUFBMEZFLFFBQVEsRUFBRWYsMEJBQXBHLEVBQWdJa0MsS0FBSyxZQUFLdEIsUUFBTCxjQUFySSxLQUNELENBM0NMLDhGQTRDV2dDLG1CQUFtQixDQUFDUixNQTVDL0IsV0E4Q0U7QUFDQTtBQUNBUix3QkFBQUEsc0JBQXNCLENBQUNDLFVBQXZCLENBQWtDQyxJQUFsQyxDQUF1QyxFQUFFQyxRQUFRLEVBQUUsR0FBWixFQUFpQkMsT0FBTyxFQUFFLHlCQUExQixFQUFxRG5CLFFBQVEsRUFBUkEsUUFBckQsRUFBK0RFLFFBQVEsRUFBRWYsMEJBQXpFLEVBQXFHaUMsUUFBUSxFQUFFVSxnQkFBL0csRUFBaUlULEtBQUssWUFBS3RCLFFBQUwsY0FBdEksRUFBdkMsRUFoREYsa0NBaURTLENBakRULDZFQTlJSyx5REE4SVVGLG9CQTlJVix1UkFtRkwsaUJBQXNDRSxRQUF0QyxFQUFnREMsUUFBaEQsRUFBMERDLFVBQTFELEVBQXNFK0IsVUFBdEUsRUFBa0ZDLFdBQWxGLEVBQStGQyxZQUEvRixFQUE2R3pDLGVBQTdHLDZSQUNFO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUkwQyx3QkFBQUEsb0JBbkJOLEdBbUI2QjdDLFlBbkI3QixFQW9CRTtBQUNBO0FBckJGLGlEQXNCZ0MsMENBQWtCRCxRQUFsQixFQUE0QjhDLG9CQUE1QixFQUFrRHBDLFFBQWxELEVBQTRERSxVQUE1RCxFQUF3RStCLFVBQXhFLEVBQW9GQyxXQUFwRixFQUFpR0MsWUFBakcsRUFBK0d6QyxlQUEvRyxDQXRCaEMsUUFzQlEyQyxlQXRCUixrQkF1QkU7QUFDQTtBQUNBO0FBRUE7QUEzQkYsZ0VBNEIrQkEsZUFBZSxDQUFDcEIsVUE1Qi9DLE9BNEJFLHdEQUFXUyxjQUFYLGlCQUF5RDtBQUN2RCxnQ0FBSUEsY0FBYyxDQUFDSixLQUFuQixFQUEwQjtBQUN4Qk4sOEJBQUFBLHNCQUFzQixDQUFDQyxVQUF2QixDQUFrQ0MsSUFBbEMsQ0FBdUNRLGNBQXZDLEVBREYsQ0FDMEQ7QUFEMUQsaUNBRUs7QUFDSDlCLDhCQUFBQSxnQkFBZ0IsaUNBQU04QixjQUFOLFNBQXNCMUIsUUFBUSxFQUFSQSxRQUF0QixFQUFnQ0MsUUFBUSxFQUFSQSxRQUFoQyxFQUEwQ08sTUFBTSxFQUFFTixVQUFsRCxFQUE4REMsUUFBUSxFQUFFOEIsVUFBeEUsRUFBb0ZYLEtBQUssRUFBRUksY0FBYyxDQUFDSixLQUFmLEdBQXVCSSxjQUFjLENBQUNKLEtBQXRDLEdBQThDdEIsUUFBekksSUFBaEIsQ0FKSixDQTVCRixDQWlDRTtBQWpDRixvRkFrQ0UsSUFBSXFDLGVBQWUsQ0FBQ0MsZ0JBQWhCLElBQW9DRCxlQUFlLENBQUNDLGdCQUFoQixHQUFtQyxDQUEzRSxFQUE4RSxDQUM1RUEsZ0JBQWdCLElBQUlELGVBQWUsQ0FBQ0MsZ0JBQXBDLENBQ0EzQyxpQkFBaUIsbUJBQVkwQyxlQUFlLENBQUNDLGdCQUE1Qiw0QkFBakIsQ0FDRCxDQUNELElBQUlELGVBQWUsQ0FBQ0UsZ0JBQWhCLElBQW9DRixlQUFlLENBQUNFLGdCQUFoQixHQUFtQyxDQUEzRSxFQUE4RUMsZ0JBQWdCLElBQUlILGVBQWUsQ0FBQ0UsZ0JBQXBDLENBQzlFLElBQUlGLGVBQWUsQ0FBQ0ksZ0JBQWhCLElBQW9DSixlQUFlLENBQUNJLGdCQUFoQixDQUFpQ2pCLE1BQWpDLEdBQTBDLENBQWxGLDJDQUNnQ2EsZUFBZSxDQUFDSSxnQkFEaEQsT0FDRSx3REFBV0MsZUFBWCxpQkFDRTtBQUNBO0FBQ0FELDhCQUFBQSxnQkFBZ0IsQ0FBQ0UsR0FBakIsQ0FBcUJELGVBQXJCLEVBSEYsQ0FERiw2REFLQSxJQUFJTCxlQUFlLENBQUNPLHlCQUFoQixJQUE2Q1AsZUFBZSxDQUFDTyx5QkFBaEIsQ0FBMENwQixNQUExQyxHQUFtRCxDQUFwRywyQ0FDeUNhLGVBQWUsQ0FBQ08seUJBRHpELE9BQ0Usd0RBQVdDLHdCQUFYLGdCQUNFRCx5QkFBeUIsQ0FBQ0QsR0FBMUIsQ0FBOEJFLHdCQUE5QixFQURGLENBREYsNkRBNUNGLHlEQW5GSywyREFtRlVoRCxzQkFuRlYscUlBaURJRCxnQkFqREosOEJBaURxQmtELFlBakRyQixFQWlEbUMsQ0FDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBSUEsWUFBWSxDQUFDdEQsTUFBakIsRUFBeUIsQ0FDdkI7QUFDQTtBQUNBO0FBQ0QsZUFacUMsQ0FhdEM7QUFDQSxrQkFBSXNELFlBQVksQ0FBQ0MsQ0FBakIsRUFBb0IsQ0FBRTtBQUNyQixlQWZxQyxDQWdCdEM7QUFDQSxrQkFBSUQsWUFBWSxDQUFDRSxDQUFqQixFQUFvQixDQUFFO0FBQ3JCLGVBbEJxQyxDQW1CdEM7QUFDQSxrQkFBSUYsWUFBWSxDQUFDRyxjQUFqQixFQUFpQyxDQUFFO0FBQ2xDLGVBckJxQyxDQXNCdEM7QUFDQSxrQkFBSUgsWUFBWSxDQUFDSSxPQUFqQixFQUEwQixDQUFFO0FBQzNCLGVBeEJxQyxDQXlCdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBSUosWUFBWSxDQUFDSyxVQUFqQixFQUE2QkwsWUFBWSxDQUFDSyxVQUFiLDhCQUE4Q0wsWUFBWSxDQUFDSyxVQUEzRCxFQUM3Qm5DLHNCQUFzQixDQUFDQyxVQUF2QixDQUFrQ0MsSUFBbEMsaUNBQTRDNEIsWUFBNUMsU0FBMER0RCxNQUFNLEVBQU5BLE1BQTFELEVBQWtFRixRQUFRLEVBQVJBLFFBQWxFLEtBQ0QsQ0FoRkksQ0EyQ0lLLGlCQTNDSiwrQkEyQ3NCeUQsYUEzQ3RCLEVBMkNxQyxDQUN4QztBQUNBcEMsY0FBQUEsc0JBQXNCLENBQUNxQyxXQUF2QixDQUFtQ25DLElBQW5DLENBQXdDa0MsYUFBeEMsRUFDRCxDQTlDSSxFQUNMO0FBQ0Y7QUFDQTtBQUNBLGNBSk8sQ0FNTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVJRSxZQUFBQSxTQWpCQyxHQWlCVyxLQWpCWCxDQWtCQ0MsU0FsQkQsR0FrQmEsSUFBSTNCLElBQUosRUFsQmIsQ0FtQkxwQyxNQUFNLEdBQUdBLE1BQU0sQ0FBQ2dFLFdBQVAsRUFBVCxDQW5CSyxDQW1CMEI7QUFFM0JsQixZQUFBQSxnQkFyQkMsR0FxQmtCLENBckJsQixFQXFCcUJtQixnQkFyQnJCLEdBcUJ3QyxFQXJCeEMsRUFxQjRDYix5QkFyQjVDLEdBcUJ3RSxJQUFJYyxHQUFKLEVBckJ4RSxFQXFCbUZsQixnQkFyQm5GLEdBcUJzRyxDQXJCdEcsRUFxQnlHQyxnQkFyQnpHLEdBcUI0SCxJQUFJaUIsR0FBSixFQXJCNUgsQ0FzQkQxQyxzQkF0QkMsR0FzQndCLEVBQUVxQyxXQUFXLEVBQUUsRUFBZixFQUFtQnBDLFVBQVUsRUFBRSxFQUEvQixFQXRCeEIsQ0F3QkQwQyxPQXhCQyxHQXdCU2pFLGVBeEJULGFBd0JTQSxlQXhCVCx1QkF3QlNBLGVBQWUsQ0FBRWlFLE9BeEIxQixFQXdCbUM7QUFDeEMsZ0JBQUksQ0FBQ0EsT0FBTCxFQUFjQSxPQUFPLEdBQUcsU0FBVixDQUVSQyxrQkEzQkQsR0EyQnNCbEUsZUFBZSxxQkFBUUEsZUFBUixJQUE0QixFQTNCakUsRUEyQnFFO0FBQ3BFVyxZQUFBQSxRQTVCRCxHQTRCWXVELGtCQUFrQixDQUFDQyxPQUFuQixHQUE2QkQsa0JBQWtCLENBQUNDLE9BQWhELEdBQTBEQyxtQkE1QnRFLEVBNEJxRjtBQUMxRkYsWUFBQUEsa0JBQWtCLENBQUNDLE9BQW5CLEdBQTZCeEQsUUFBN0IsQ0E3QkssQ0E2QmtDO0FBQ3ZDLGdCQUFJLENBQUN1RCxrQkFBa0IsQ0FBQ0csNEJBQXhCLEVBQXNESCxrQkFBa0IsQ0FBQ0csNEJBQW5CLEdBQWtEekUsUUFBbEQsQ0FDdEQsSUFBSSxDQUFDc0Usa0JBQWtCLENBQUNJLGNBQXhCLEVBQXdDSixrQkFBa0IsQ0FBQ0ksY0FBbkIsR0FBb0MxRSxRQUFwQyxDQUN4QyxJQUFJLENBQUNzRSxrQkFBa0IsQ0FBQ0ssY0FBeEIsRUFBd0NMLGtCQUFrQixDQUFDSyxjQUFuQixHQUFvQzNFLFFBQXBDLENBaENuQyxDQWtDTDtBQUNBO0FBQ0l3QixZQUFBQSxjQXBDQyxHQW9DZ0IsUUFwQ2hCLEVBc0NMO0FBQ0lvRCxZQUFBQSxlQXZDQyxHQXVDaUIxRSxNQUFNLEtBQUssS0FBWCxpQkFBMEJELFlBQTFCLGNBQTBDQyxNQUExQyxtQkFBeURGLFFBQXpELGNBQXFFd0IsY0FBckUsZUFDcEJxRCxLQUFLLENBQUNDLGNBQU4sQ0FBcUI1RSxNQUFyQixJQUErQixFQUEvQixHQUFvQyxFQUFwQyxpQkFBZ0RELFlBQWhELGNBQWdFQyxNQUFoRSxnQ0FBNEZGLFFBQTVGLGNBQXdHd0IsY0FBeEcsWUF4Q0csT0FvUkR0QixNQUFNLEtBQUssS0FwUlYsZ0NBcVJIO0FBQ0EsZ0JBQUltRSxPQUFPLEtBQUssU0FBaEIsRUFDRVUsWUFBWSxHQUFHLENBQUMsS0FBRCxFQUFRLFNBQVIsRUFBbUIsU0FBbkIsRUFBOEIsU0FBOUIsRUFBeUMsU0FBekMsRUFBb0QsU0FBcEQsQ0FBZixDQURGLEtBRUssSUFBSVYsT0FBTyxLQUFLLEtBQWhCLEVBQ0hVLFlBQVksR0FBRyxDQUFDLEtBQUQsRUFBUSxRQUFSLEVBQWtCLFFBQWxCLEVBQTRCLFFBQTVCLEVBQXNDLFFBQXRDLENBQWYsQ0FERyxLQUVBLElBQUlWLE9BQU8sS0FBSyxLQUFoQixFQUNIVSxZQUFZLEdBQUcsQ0FBQyxLQUFELEVBQVEsU0FBUixFQUFtQixTQUFuQixFQUE4QixTQUE5QixFQUF5QyxTQUF6QyxFQUFvRCxTQUFwRCxDQUFmLENBREcsS0FFQSxJQUFJVixPQUFPLEtBQUssTUFBaEIsRUFDSFUsWUFBWSxHQUFHLENBQUMsS0FBRCxFQUFRLFNBQVIsRUFBbUIsUUFBbkIsRUFBNkIsU0FBN0IsRUFBd0MsUUFBeEMsRUFBa0QsU0FBbEQsRUFBNkQsUUFBN0QsRUFBdUUsUUFBdkUsRUFBaUYsU0FBakYsRUFBNEYsU0FBNUYsQ0FBZixDQTdSQyxzREFpU0RDLGlCQUFpQixHQUFHSCxLQUFLLENBQUNJLGNBQU4sQ0FBcUIvRSxNQUFyQixDQUFwQixDQUNBZ0YsY0FBYyxHQUFHTCxLQUFLLENBQUNNLFNBQU4sQ0FBZ0JqRixNQUFoQixDQUFqQixDQWxTQyxDQWtTeUM7QUFsU3pDLDZHQW9TRzJFLEtBQUssQ0FBQ08sYUFBTixDQUFvQmxGLE1BQXBCLENBcFNILCtCQW9TZ0M7QUFDL0JnRixZQUFBQSxjQUFjLEdBQUcsT0FBakIsQ0FyU0Qsa0NBdVNDNUUsZ0JBQWdCLENBQUMsRUFBRXVCLFFBQVEsRUFBRSxHQUFaLEVBQWlCQyxPQUFPLEVBQUUsOERBQTFCLEVBQTBGOEIsT0FBTyxFQUFFMUQsTUFBbkcsRUFBMkc2QixRQUFRLG1CQUFZN0IsTUFBWixlQUF1QjBFLGVBQXZCLENBQW5ILEVBQUQsQ0FBaEIsQ0F2U0Qsa0NBdVN5TGxELHNCQXZTekwsV0EwU0g7QUFFQTtBQUNNMkQsWUFBQUEsZ0JBN1NILEdBNlNzQkgsY0FBYyxLQUFLLEtBQW5CLEdBQTJCLEtBQTNCLEdBQW1DLE1BN1N6RCxDQThTSCxJQUFJYixPQUFPLEtBQUssU0FBaEIsRUFDRVUsWUFBWSxHQUFHOUUsWUFBWSxLQUFLLElBQWpCLEdBQXdCLENBQUNvRixnQkFBRCxFQUFtQixLQUFuQixFQUEwQixJQUExQixFQUFnQyxJQUFoQyxFQUFzQyxJQUF0QyxFQUE0QyxJQUE1QyxFQUFrRCxJQUFsRCxFQUF3RCxJQUF4RCxDQUF4QixHQUF3RixDQUFDQSxnQkFBRCxFQUFtQixJQUFuQixFQUF5QixJQUF6QixFQUErQixJQUEvQixFQUFxQyxJQUFyQyxDQUF2RyxDQURGLEtBRUssSUFBSWhCLE9BQU8sS0FBSyxLQUFoQixFQUNIVSxZQUFZLEdBQUc5RSxZQUFZLEtBQUssSUFBakIsR0FBd0IsQ0FBQ29GLGdCQUFELEVBQW1CLEtBQW5CLEVBQTBCLElBQTFCLEVBQWdDLElBQWhDLEVBQXNDLElBQXRDLEVBQTRDLElBQTVDLENBQXhCLEdBQTRFLENBQUNBLGdCQUFELEVBQW1CLElBQW5CLEVBQXlCLElBQXpCLEVBQStCLElBQS9CLEVBQXFDLElBQXJDLENBQTNGLENBREcsS0FFQSxJQUFJaEIsT0FBTyxLQUFLLEtBQWhCLEVBQ0hVLFlBQVksR0FBRzlFLFlBQVksS0FBSyxJQUFqQixHQUF3QixDQUFDb0YsZ0JBQUQsRUFBbUIsS0FBbkIsRUFBMEIsSUFBMUIsRUFBZ0MsSUFBaEMsRUFBc0MsS0FBdEMsRUFBNkMsS0FBN0MsRUFBb0QsSUFBcEQsRUFBMEQsSUFBMUQsQ0FBeEIsR0FBMEYsQ0FBQ0EsZ0JBQUQsRUFBbUIsSUFBbkIsRUFBeUIsSUFBekIsRUFBK0IsSUFBL0IsRUFBcUMsSUFBckMsQ0FBekcsQ0FERyxLQUVBLElBQUloQixPQUFPLEtBQUssTUFBaEIsRUFDSFUsWUFBWSxHQUFHOUUsWUFBWSxLQUFLLElBQWpCLEdBQXdCLENBQUNvRixnQkFBRCxFQUFtQixLQUFuQixFQUEwQixJQUExQixFQUFnQyxJQUFoQyxFQUFzQyxLQUF0QyxFQUE2QyxJQUE3QyxFQUFtRCxLQUFuRCxFQUEwRCxJQUExRCxFQUFnRSxJQUFoRSxFQUFzRSxJQUF0RSxDQUF4QixHQUFzRyxDQUFDQSxnQkFBRCxFQUFtQixJQUFuQixFQUF5QixJQUF6QixFQUErQixJQUEvQixFQUFxQyxJQUFyQyxDQUFySCxDQXJUQyxTQXlUTDtBQUNNQyxZQUFBQSxzQkExVEQsR0EwVDBCLEVBMVQxQixDQTJUREMsZUEzVEMsR0EyVGlCLENBM1RqQix3Q0E0VGtCUixZQTVUbEIsMkdBNFRNckUsUUE1VE4sb0JBOFRDc0QsU0E5VEQsNEVBK1RDd0IsZ0JBL1RELEdBK1RvQjlFLFFBL1RwQixFQStUOEIrRSxjQS9UOUIsR0ErVCtDakUsY0EvVC9DLENBZ1VILElBQUlnRSxnQkFBZ0IsQ0FBQ0UsUUFBakIsQ0FBMEIsR0FBMUIsQ0FBSixFQUFvQyxDQUNsQ0YsZ0JBQWdCLEdBQUdBLGdCQUFnQixDQUFDdkQsU0FBakIsQ0FBMkIsQ0FBM0IsRUFBOEJ1RCxnQkFBZ0IsQ0FBQ3RELE1BQWpCLEdBQTBCLENBQXhELENBQW5CLENBRGtDLENBQzZDO0FBQy9FdUQsY0FBQUEsY0FBYyxHQUFHLFdBQWpCLENBQ0FiLGVBQWUsR0FBR0EsZUFBZSxDQUFDZSxPQUFoQixDQUF3Qm5FLGNBQXhCLEVBQXdDaUUsY0FBeEMsQ0FBbEIsQ0FDRCxDQUpELE1BSU87QUFDTGIsY0FBQUEsZUFBZSxHQUFHQSxlQUFlLENBQUNlLE9BQWhCLENBQXdCRixjQUF4QixFQUF3Q2pFLGNBQXhDLENBQWxCLENBQ0ViLFFBdFVELEdBc1VZLHdCQUFhVixZQUFiLEVBQTJCdUYsZ0JBQTNCLENBdFVaLENBdVVHSSxZQXZVSCxpQkF1VXlCbEYsUUF2VXpCLFNBdVVvQ2tFLGVBdlVwQyxFQXdVSCxJQUFJWSxnQkFBZ0IsQ0FBQ0ssVUFBakIsQ0FBNEIsTUFBNUIsQ0FBSixFQUNFTCxnQkFBZ0IsR0FBR0EsZ0JBQWdCLENBQUN2RCxTQUFqQixDQUEyQixDQUEzQixDQUFuQixDQXpVQyxDQXlVaUQ7QUFDcEQ7QUFDQTtBQUNBLHNFQUFtQ2hDLFlBQW5DLGNBQW1EQyxNQUFuRCxpQkFBZ0VRLFFBQWhFLGVBQTZFOEUsZ0JBQTdFLG9CQUF1R3hGLFFBQXZHLGNBQW1IVyxRQUFuSCxjQUErSDhFLGNBQS9ILGFBNVVHLENBOFVIO0FBQ0F0RixZQUFBQSxjQUFjLGVBQUMsb0NBQUcsS0FBSyxFQUFFLEVBQUUyRixLQUFLLEVBQUUsU0FBVCxFQUFWLDhCQUF5Qyx3Q0FBSTlGLFFBQUosQ0FBekMsT0FBNERDLFlBQTVELG9CQUEwRSx3Q0FBSUMsTUFBSixDQUExRSxvQ0FBMEcsd0NBQUlRLFFBQUosQ0FBMUcsNkJBQXFJLHdDQUFJNkUsZUFBSixDQUFySSxPQUErSlIsWUFBWSxDQUFDN0MsTUFBNUssa0JBQUQsQ0FBZCxDQUVJckIsUUFqVkQsZ0JBa1ZDSCxRQUFRLEtBQUssS0FBYixJQUFzQkEsUUFBUSxLQUFLLE1BQW5DLElBQTZDQSxRQUFRLEtBQUssSUFBMUQsSUFBa0VBLFFBQVEsS0FBSyxJQWxWaEYsZ0NBbVZEO0FBQ0E7QUFDQUcsWUFBQUEsUUFBUSxhQUFNbUUsaUJBQU4sVUFBUixDQXJWQyx3Q0FzVk1RLGdCQUFnQixLQUFLLEtBQXJCLElBQThCOUUsUUFBUSxDQUFDZ0YsUUFBVCxDQUFrQixLQUFsQixDQUE5QixJQUEwRGhGLFFBQVEsQ0FBQ2dGLFFBQVQsQ0FBa0IsS0FBbEIsQ0F0VmhFLCtCQXVWRDdFLFFBQVEsYUFBTTJFLGdCQUFnQixDQUFDTyxXQUFqQixFQUFOLGNBQXdDN0YsTUFBeEMsU0FBUixDQXZWQyx3Q0F3Vk1zRixnQkFBZ0IsS0FBSyxJQUFyQixJQUE2QkEsZ0JBQWdCLEtBQUssSUF4VnhELCtCQXlWRDNFLFFBQVEsYUFBTTJFLGdCQUFnQixDQUFDTyxXQUFqQixFQUFOLGNBQXdDN0YsTUFBeEMsU0FBUixDQXpWQyx3Q0EwVk1zRixnQkFBZ0IsS0FBSyxJQUFyQixJQUE2QixDQUFDOUUsUUFBUSxDQUFDbUYsVUFBVCxDQUFvQixNQUFwQixDQTFWcEMsOEVBNFZrQiw2Q0FBa0MsRUFBRTdGLFFBQVEsRUFBUkEsUUFBRixFQUFZZ0IsVUFBVSxFQUFFTCxRQUF4QixFQUFrQ08sTUFBTSxFQUFFTSxjQUExQyxFQUEwRHRCLE1BQU0sRUFBRUEsTUFBTSxDQUFDNkYsV0FBUCxFQUFsRSxFQUFsQyxDQTVWbEIsU0E0VkNsRixRQTVWRCxrQkE2VkMsNEJBQVlBLFFBQVEsQ0FBQ2dGLFVBQVQsV0FBdUI1RixZQUF2QixPQUFaLGtDQUE4RVksUUFBOUUsZ0RBQTRIWixZQUE1SCxTQTdWRCw2RkErVkM7QUFDQVksWUFBQUEsUUFBUSxhQUFNWixZQUFOLGlCQUF5QitFLGlCQUF6QixTQUFSLENBaFdELENBZ1cyRDtBQWhXM0Qsa0JBa1dELDRCQUFZbkUsUUFBUSxDQUFDNkUsUUFBVCxDQUFrQixNQUFsQixDQUFaLGtDQUFnRTdFLFFBQWhFLDJCQWxXQyxjQXFXQ0gsUUFBUSxLQUFLLEtBcldkLDBEQXVXNEIsMEJBQVVWLFFBQVYsWUFBdUJDLFlBQXZCLFdBQTJDdUIsY0FBM0MsRUFBMkRvRCxlQUEzRCxFQUE0RXpFLGNBQTVFLEVBQTRGbUUsa0JBQTVGLENBdlc1QixTQXVXSzBCLGNBdldMLG1CQXVXNkk7QUFDOUk7QUFDQTtBQUNBO0FBQ0F0RSxZQUFBQSxzQkFBc0IsQ0FBQ3FDLFdBQXZCLEdBQXFDckMsc0JBQXNCLENBQUNxQyxXQUF2QixDQUFtQ2tDLE1BQW5DLENBQTBDRCxjQUFjLENBQUNqQyxXQUF6RCxDQUFyQyxDQUNBckMsc0JBQXNCLENBQUNDLFVBQXZCLEdBQW9DRCxzQkFBc0IsQ0FBQ0MsVUFBdkIsQ0FBa0NzRSxNQUFsQyxDQUF5Q0QsY0FBYyxDQUFDckUsVUFBeEQsQ0FBcEMsQ0FDQSxJQUFJcUUsY0FBYyxDQUFDaEQsZ0JBQWYsR0FBa0MsQ0FBdEMsRUFBeUMsQ0FDdkNtQixnQkFBZ0IsR0FBR0EsZ0JBQWdCLENBQUM4QixNQUFqQixDQUF3QkQsY0FBYyxDQUFDN0IsZ0JBQXZDLENBQW5CLENBQ0FiLHlCQUF5QixHQUFHLElBQUljLEdBQUosNENBQVlkLHlCQUFaLG9DQUEwQzBDLGNBQWMsQ0FBQzFDLHlCQUF6RCxHQUE1QixDQUNBTixnQkFBZ0IsSUFBSWdELGNBQWMsQ0FBQ2hELGdCQUFuQyxDQUNBRSxnQkFBZ0IsSUFBSThDLGNBQWMsQ0FBQzlDLGdCQUFuQztBQUNBQyxjQUFBQSxnQkFBZ0IsQ0FBQ0UsR0FBakIsQ0FBcUIxQyxRQUFyQjtBQUNEO0FBQ0ROLFlBQUFBLGlCQUFpQixtQkFBWUosWUFBWiw0QkFBMENELFFBQTFDLEVBQWpCLENBcFhDO0FBcVhRVSxZQUFBQSxRQUFRLEtBQUssSUFBYixJQUFxQkEsUUFBUSxLQUFLLFFBQWxDLElBQTZDQSxRQUFRLEtBQUssUUFyWGxFOztBQXVYNEJ3RixjQUFBQSxtQkFBbUIsQ0FBQ2xHLFFBQUQsRUFBV0MsWUFBWCxFQUF5QlMsUUFBekIsRUFBbUNDLFFBQW5DLEVBQTZDYSxjQUE3QyxFQUE2RHRCLE1BQTdELEVBQXFFb0Usa0JBQXJFLENBdlgvQyxVQXVYSzZCLGNBdlhMO0FBd1hEekUsWUFBQUEsc0JBQXNCLENBQUNxQyxXQUF2QixHQUFxQ3JDLHNCQUFzQixDQUFDcUMsV0FBdkIsQ0FBbUNrQyxNQUFuQyxDQUEwQ0UsY0FBYyxDQUFDcEMsV0FBekQsQ0FBckM7QUFDQXJDLFlBQUFBLHNCQUFzQixDQUFDQyxVQUF2QixHQUFvQ0Qsc0JBQXNCLENBQUNDLFVBQXZCLENBQWtDc0UsTUFBbEMsQ0FBeUNFLGNBQWMsQ0FBQ3hFLFVBQXhELENBQXBDO0FBQ0EsZ0JBQUl3RSxjQUFjLENBQUNuRCxnQkFBZixHQUFrQyxDQUF0QyxFQUF5QztBQUN2Q21CLGNBQUFBLGdCQUFnQixHQUFHQSxnQkFBZ0IsQ0FBQzhCLE1BQWpCLENBQXdCRSxjQUFjLENBQUNoQyxnQkFBdkMsQ0FBbkI7QUFDQWIsY0FBQUEseUJBQXlCLEdBQUcsSUFBSWMsR0FBSiw0Q0FBWWQseUJBQVosb0NBQTBDNkMsY0FBYyxDQUFDN0MseUJBQXpELEdBQTVCO0FBQ0FOLGNBQUFBLGdCQUFnQixJQUFJbUQsY0FBYyxDQUFDbkQsZ0JBQW5DO0FBQ0FFLGNBQUFBLGdCQUFnQixJQUFJaUQsY0FBYyxDQUFDakQsZ0JBQW5DO0FBQ0FDLGNBQUFBLGdCQUFnQixDQUFDRSxHQUFqQixDQUFxQjFDLFFBQXJCO0FBQ0QsYUFoWUE7QUFpWU07QUFDUCxxREFBWUUsUUFBWiw4Q0FBWSxVQUFVcUIsTUFBdEIsaURBQXNFbEMsUUFBdEUsaUJBQXFGVSxRQUFyRixrQkFBcUc4RSxnQkFBckcsaUJBQTRIN0UsUUFBNUgsa0JBQTRJOEUsY0FBNUk7QUFDSVcsWUFBQUEsZUFuWUg7OztBQXNZeUJyRixjQUFBQSxRQUFRLENBQUMsRUFBRWYsUUFBUSxFQUFSQSxRQUFGLEVBQVlnQixVQUFVLEVBQUVMLFFBQXhCLEVBQWtDTSxJQUFJLEVBQUVKLFFBQXhDLEVBQWtESyxNQUFNLEVBQUV1RSxjQUExRCxFQUFELENBdFlqQyxXQXNZQ1csZUF0WUQ7QUF1WUM7QUFDQWpDLFlBQUFBLGdCQUFnQixDQUFDdkMsSUFBakIsQ0FBc0JmLFFBQXRCO0FBQ0FxQyxZQUFBQSxnQkFBZ0IsSUFBSWtELGVBQWUsQ0FBQ2xFLE1BQXBDO0FBQ0FpQixZQUFBQSxnQkFBZ0IsQ0FBQ0UsR0FBakIsQ0FBcUIxQyxRQUFyQixFQTFZRDs7QUE0WUM7QUFDQTtBQUNJYyxZQUFBQSxPQTlZTCxzQkE4WTJCekIsUUE5WTNCO0FBK1lDO0FBL1lELDJCQWdaSyxDQUFDLGVBQWEsRUFBZCxFQUFrQjZGLFVBQWxCLENBQTZCLHNCQUE3QixDQWhaTCw0RUFnWnFFLG9DQUF5QixFQUFFN0YsUUFBUSxFQUFSQSxRQUFGLEVBQVlnQixVQUFVLEVBQUVMLFFBQXhCLEVBQXpCLENBaFpyRTtBQWlaR2UsWUFBQUEsc0JBQXNCLENBQUNDLFVBQXZCLENBQWtDQyxJQUFsQyxDQUF1QyxFQUFFQyxRQUFRLEVBQUUsR0FBWixFQUFpQkMsT0FBTyxFQUFFLDBCQUExQixFQUFzREwsT0FBTyxFQUFQQSxPQUF0RCxFQUErRHpCLFFBQVEsRUFBUkEsUUFBL0QsRUFBeUVVLFFBQVEsRUFBUkEsUUFBekUsRUFBbUZDLFFBQVEsRUFBUkEsUUFBbkYsRUFBNkZvQixRQUFRLEVBQUU2RCxZQUF2RyxFQUFxSDVELEtBQUssRUFBRXRCLFFBQTVILEVBQXZDLEVBalpIOztBQW1aRztBQUNBLGdCQUFJLGdCQUFjLG9DQUFsQixFQUF3RGUsT0FBTyxrQ0FBUDtBQUN4RG5CLFlBQUFBLGdCQUFnQixDQUFDLEVBQUV1QixRQUFRLEVBQUVuQixRQUFRLEtBQUssSUFBYixJQUFxQkEsUUFBUSxLQUFLLElBQWxDLEdBQXlDLEdBQXpDLEdBQStDLEdBQTNELEVBQWdFb0IsT0FBTyxFQUFFLGdCQUF6RSxFQUEyRkwsT0FBTyxFQUFQQSxPQUEzRixFQUFvR2YsUUFBUSxFQUFSQSxRQUFwRyxFQUE4R0MsUUFBUSxFQUFSQSxRQUE5RyxFQUF3SEUsUUFBUSxFQUFSQSxRQUF4SCxFQUFrSWtCLFFBQVEsRUFBRTZELFlBQTVJLEVBQTBKNUQsS0FBSyxFQUFFdEIsUUFBakssRUFBRCxDQUFoQixDQXJaSDs7O0FBd1pHMEYsWUFBQUEsZUF4Wkg7OztBQTJaTzdGLGNBQUFBLHNCQUFzQixDQUFDRyxRQUFELEVBQVdDLFFBQVgsRUFBcUI4RSxjQUFyQixFQUFxQzVFLFFBQXJDLEVBQStDdUYsZUFBL0MsRUFBZ0V4QixlQUFoRSxFQUFpRk4sa0JBQWpGLENBM1o3QixZQTJabUk7QUFDbEl0QixZQUFBQSxnQkFBZ0IsSUFBSSxDQUFwQjtBQUNBTSxZQUFBQSx5QkFBeUIsQ0FBQ0QsR0FBMUIsQ0FBOEJ4QyxRQUFRLENBQUN3RixLQUFULENBQWUsR0FBZixFQUFvQkMsR0FBcEIsRUFBOUI7QUFDQWpHLFlBQUFBLGlCQUFpQixtQkFBWUssUUFBUSxDQUFDd0QsV0FBVCxFQUFaLG9CQUE0Q3JELFFBQTVDLEVBQWpCLENBOVpEOzs7O0FBa2FFeUQsWUFBQUEsa0JBbGFGLGFBa2FFQSxrQkFsYUYsZUFrYUVBLGtCQUFrQixDQUFFaUMsMEJBbGF0Qjs7O0FBcWFJakIsWUFBQUEsc0JBQXNCLENBQUNrQixRQUF2QixDQUFnQzdGLFFBQWhDLENBcmFKLGdDQXFhaUQ7QUFDaEQyRSxZQUFBQSxzQkFBc0IsQ0FBQzFELElBQXZCLENBQTRCakIsUUFBNUIsRUF0YUQsQ0FzYXdDO0FBQ3ZDO0FBdmFEO0FBeWFLMkQsWUFBQUEsa0JBemFMLGFBeWFLQSxrQkF6YUwsZUF5YUtBLGtCQUFrQixDQUFFbUMsaUJBemF6Qjs7QUEyYXNDakcsY0FBQUEsb0JBQW9CLENBQUNFLFFBQUQsRUFBV0MsUUFBWCxFQUFxQjhFLGNBQXJCLEVBQXFDYixlQUFyQyxFQUFzRE4sa0JBQXRELENBM2ExRCxXQTJhU29DLG9CQTNhVDtBQTRhRyxnQkFBSUEsb0JBQW9CLEdBQUcsQ0FBM0IsRUFBOEI7QUFDNUIxRCxjQUFBQSxnQkFBZ0IsSUFBSSxDQUFwQjtBQUNBbUIsY0FBQUEsZ0JBQWdCLENBQUN2QyxJQUFqQixDQUFzQixlQUF0QjtBQUNBMEIsY0FBQUEseUJBQXlCLENBQUNELEdBQTFCLENBQThCLE1BQTlCO0FBQ0FILGNBQUFBLGdCQUFnQixJQUFJd0Qsb0JBQXBCO0FBQ0FyRyxjQUFBQSxpQkFBaUIsbUJBQVlNLFFBQVosb0JBQWpCO0FBQ0QsYUFsYko7Ozs7O0FBdWJLMkQsWUFBQUEsa0JBdmJMLGFBdWJLQSxrQkF2YkwsZUF1YktBLGtCQUFrQixDQUFFcUMsZUF2YnpCO0FBd2JHO0FBQ005RixZQUFBQSxVQXpiVCxHQXlib0IsV0F6YnBCO0FBMGJzQ0osY0FBQUEsb0JBQW9CLENBQUNDLFFBQUQsRUFBV0MsUUFBWCxFQUFxQjhFLGNBQXJCLEVBQXFDNUUsVUFBckMsRUFBK0MrRCxlQUEvQyxFQUFnRU4sa0JBQWhFLENBMWIxRCxXQTBiU29DLHFCQTFiVDtBQTJiRyxnQkFBSUEscUJBQW9CLEdBQUcsQ0FBM0IsRUFBOEI7QUFDNUIxRCxjQUFBQSxnQkFBZ0IsSUFBSSxDQUFwQjtBQUNBbUIsY0FBQUEsZ0JBQWdCLENBQUN2QyxJQUFqQixDQUFzQmYsVUFBdEI7QUFDQXlDLGNBQUFBLHlCQUF5QixDQUFDRCxHQUExQixDQUE4QixJQUE5QjtBQUNBSCxjQUFBQSxnQkFBZ0IsSUFBSXdELHFCQUFwQjtBQUNBckcsY0FBQUEsaUJBQWlCLG1CQUFZTSxRQUFaLGtCQUFqQjtBQUNELGFBamNKOzs7OztBQXNjSzJELFlBQUFBLGtCQXRjTCxhQXNjS0Esa0JBdGNMLGVBc2NLQSxrQkFBa0IsQ0FBRXNDLGdCQXRjekI7QUF1Y0c7QUFDTS9GLFlBQUFBLFVBeGNULEdBd2NvQixZQXhjcEI7QUF5Y3NDSixjQUFBQSxvQkFBb0IsQ0FBQ0MsUUFBRCxFQUFXQyxRQUFYLEVBQXFCOEUsY0FBckIsRUFBcUM1RSxVQUFyQyxFQUErQytELGVBQS9DLEVBQWdFTixrQkFBaEUsQ0F6YzFELFdBeWNTb0Msc0JBemNUO0FBMGNHLGdCQUFJQSxzQkFBb0IsR0FBRyxDQUEzQixFQUE4QjtBQUM1QjFELGNBQUFBLGdCQUFnQixJQUFJLENBQXBCO0FBQ0FtQixjQUFBQSxnQkFBZ0IsQ0FBQ3ZDLElBQWpCLENBQXNCZixVQUF0QjtBQUNBeUMsY0FBQUEseUJBQXlCLENBQUNELEdBQTFCLENBQThCLElBQTlCO0FBQ0FILGNBQUFBLGdCQUFnQixJQUFJd0Qsc0JBQXBCO0FBQ0FyRyxjQUFBQSxpQkFBaUIsbUJBQVlNLFFBQVosbUJBQWpCO0FBQ0QsYUFoZEo7Ozs7O0FBcWREO0FBQ0Y7O0FBRUE0RSxZQUFBQSxlQUFlLElBQUksQ0FBbkI7QUFDQTtBQXpkRyxrUUEwZEg7OztBQUdGO0FBQ0E7QUFDQTdELFlBQUFBLHNCQUFzQixDQUFDc0IsZ0JBQXZCLEdBQTBDQSxnQkFBMUM7QUFDQXRCLFlBQUFBLHNCQUFzQixDQUFDeUMsZ0JBQXZCLEdBQTBDQSxnQkFBMUM7QUFDQXpDLFlBQUFBLHNCQUFzQixDQUFDNEIseUJBQXZCLG9DQUF1REEseUJBQXZELEVBamVLLENBaWU4RTtBQUNuRjVCLFlBQUFBLHNCQUFzQixDQUFDdUIsZ0JBQXZCLEdBQTBDQyxnQkFBMUM7QUFDQXhCLFlBQUFBLHNCQUFzQixDQUFDeUIsZ0JBQXZCLG9DQUE4Q0EsZ0JBQTlDLEVBbmVLLENBbWU0RDtBQUNqRTs7QUFFQXpCLFlBQUFBLHNCQUFzQixDQUFDbUYsY0FBdkIsR0FBd0MsQ0FBQyxJQUFJdkUsSUFBSixLQUFhMkIsU0FBZCxJQUEyQixJQUFuRSxDQXRlSyxDQXNlb0U7QUFDekU7QUFDQTtBQXhlSyw4Q0F5ZUV2QyxzQkF6ZUYsMkg7QUEwZU47QUFDRDs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHO0FBQ2V3RSxtQjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBa0tmO2dJQWxLQSxrQkFBbUNsRyxRQUFuQyxFQUE2Q0MsWUFBN0MsRUFBMkRTLFFBQTNELEVBQXFFQyxRQUFyRSxFQUErRU8sTUFBL0UsRUFBdUZoQixNQUF2RixFQUErRkUsZUFBL0YsbUNBdUJXQyxpQkF2QlgsRUE0QldDLGdCQTVCWCxFQXNFaUJ3RyxzQkF0RWpCLGlnQkFzRUUsa0JBQXNDcEcsUUFBdEMsRUFBZ0RSLE1BQWhELEVBQXdEdUQsQ0FBeEQsRUFBMkRDLENBQTNELEVBQThEZixVQUE5RCxFQUEwRUMsV0FBMUUsRUFBdUZDLFlBQXZGLEVBQXFHekMsZUFBckcsNk1BZStCLDBDQUFrQkosUUFBbEIsRUFBNEJDLFlBQTVCLEVBQTBDUyxRQUExQyxFQUFvRFEsTUFBcEQsRUFBNER5QixVQUE1RCxFQUF3RUMsV0FBeEUsRUFBcUZDLFlBQXJGLEVBQW1HekMsZUFBbkcsQ0FmL0IsUUFlUTJHLGNBZlIsbUJBZ0JFO0FBQ0E7QUFFQTtBQW5CRixnRUFvQjRCQSxjQUFjLENBQUNwRixVQXBCM0MsT0FvQkUsdURBQXFELENBQTFDcUYsV0FBMEMsaUJBQ25EO0FBQ0E7QUFDQTtBQUNBMUcsNEJBQUFBLGdCQUFnQixpQ0FBTTBHLFdBQU4sU0FBbUI5RyxNQUFNLEVBQU5BLE1BQW5CLEVBQTJCdUQsQ0FBQyxFQUFEQSxDQUEzQixFQUE4QkMsQ0FBQyxFQUFEQSxDQUE5QixFQUFpQzFCLEtBQUssRUFBRXRCLFFBQXhDLElBQWhCLENBQ0QsQ0F6Qkgsc0hBdEVGLDJEQXNFaUJvRyxzQkF0RWpCLDJJQTRCV3hHLGdCQTVCWCwrQkE0QjRCa0QsWUE1QjVCLEVBNEIwQyxDQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQUlBLFlBQVksQ0FBQ0MsQ0FBakIsRUFBb0IsQ0FBRTtBQUNyQixlQWJxQyxDQWN0QztBQUNBLGtCQUFJRCxZQUFZLENBQUNFLENBQWpCLEVBQW9CLENBQUU7QUFDckIsZUFoQnFDLENBaUJ0QztBQUNBLGtCQUFJRixZQUFZLENBQUNHLGNBQWpCLEVBQWlDLENBQUU7QUFDbEMsZUFuQnFDLENBb0J0QztBQUNBLGtCQUFJSCxZQUFZLENBQUNJLE9BQWpCLEVBQTBCLENBQUU7QUFDM0IsZUF0QnFDLENBdUJ0QztBQUNBO0FBQ0E7QUFDQTtBQUNBcUQsY0FBQUEsU0FBUyxDQUFDdEYsVUFBVixDQUFxQkMsSUFBckIsaUNBQStCNEIsWUFBL0IsU0FBNkN4RCxRQUFRLEVBQVJBLFFBQTdDLEVBQXVEVSxRQUFRLEVBQVJBLFFBQXZELEVBQWlFQyxRQUFRLEVBQVJBLFFBQWpFLEVBQTJFVCxNQUFNLEVBQU5BLE1BQTNFLEtBQ0QsQ0F4REgsQ0F1QldHLGlCQXZCWCxnQ0F1QjZCeUQsYUF2QjdCLEVBdUI0QyxDQUN4QztBQUNBbUQsY0FBQUEsU0FBUyxDQUFDbEQsV0FBVixDQUFzQm5DLElBQXRCLENBQTJCa0MsYUFBM0IsRUFDRCxDQTFCSCxFQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFTWMsWUFBQUEsZUFuQlIsaUJBbUJpQzVFLFFBbkJqQyxlQW1COENrQixNQW5COUMsT0FxQlErRixTQXJCUixHQXFCb0IsRUFBRWxELFdBQVcsRUFBRSxFQUFmLEVBQW1CcEMsVUFBVSxFQUFFLEVBQS9CLEVBckJwQixFQWlHRTtBQUdBO0FBQ0E7QUFDTXVGLFlBQUFBLG1CQXRHUixHQXNHOEI5RyxlQUFlLElBQUlBLGVBQWUsQ0FBQytHLGtCQUFuQyxHQUF3RC9HLGVBQWUsQ0FBQytHLGtCQUF4RSxHQUE2RkEsd0JBdEczSCxDQXVHTW5FLGdCQXZHTixHQXVHeUIsQ0F2R3pCLEVBdUc0Qm1CLGdCQXZHNUIsR0F1RytDLEVBdkcvQyxFQXVHbURiLHlCQXZHbkQsR0F1RytFLElBQUljLEdBQUosRUF2Ry9FLEVBdUcwRmxCLGdCQXZHMUYsR0F1RzZHLENBdkc3Ryw0QkF3R3lCZ0UsbUJBQW1CLENBQUMsRUFBRWxILFFBQVEsRUFBUkEsUUFBRixFQUFZZ0IsVUFBVSxFQUFFTCxRQUF4QixFQUFrQ3lHLGVBQWUsRUFBRWxHLE1BQW5ELEVBQTJEbUcsY0FBYyxZQUFLbkgsTUFBTSxDQUFDNkYsV0FBUCxFQUFMLE1BQXpFLEVBQUQsQ0F4RzVDLFNBd0dRdUIsUUF4R1Isd0JBeUdNLENBQUNDLEtBQUssQ0FBQ0MsT0FBTixDQUFjRixRQUFkLENBQUQsSUFBNEIsQ0FBQ0EsUUFBUSxDQUFDcEYsTUF6RzVDLGdDQTBHSTtBQUNNVCxZQUFBQSxPQTNHVixzQkEyR2dDekIsUUEzR2hDLDZCQTRHZ0Isb0NBQXlCLEVBQUVBLFFBQVEsRUFBUkEsUUFBRixFQUFZZ0IsVUFBVSxFQUFFTCxRQUF4QixFQUF6QixDQTVHaEIseURBNkdNc0csU0FBUyxDQUFDdEYsVUFBVixDQUFxQkMsSUFBckIsQ0FBMEIsRUFBRUMsUUFBUSxFQUFFLEdBQVosRUFBaUJDLE9BQU8sRUFBRSwwQkFBMUIsRUFBc0RMLE9BQU8sRUFBUEEsT0FBdEQsRUFBK0R6QixRQUFRLEVBQVJBLFFBQS9ELEVBQXlFVSxRQUFRLEVBQVJBLFFBQXpFLEVBQW1GQyxRQUFRLEVBQVJBLFFBQW5GLEVBQTZGb0IsUUFBUSxFQUFFNkMsZUFBdkcsRUFBd0g1QyxLQUFLLEVBQUV0QixRQUEvSCxFQUExQixFQTdHTixrQ0ErR01KLGdCQUFnQixDQUFDLEVBQUV1QixRQUFRLEVBQUUsR0FBWixFQUFpQkMsT0FBTyxFQUFFLGdCQUExQixFQUE0Q0wsT0FBTyxFQUFQQSxPQUE1QyxFQUFxRHZCLE1BQU0sRUFBTkEsTUFBckQsRUFBNkQ2QixRQUFRLEVBQUU2QyxlQUF2RSxFQUF3RjVDLEtBQUssRUFBRXRCLFFBQS9GLEVBQUQsQ0FBaEIsQ0EvR04sMkNBa0hJO0FBbEhKLG9EQW1IMkI0RyxRQW5IM0IsNkdBbUhlRyxRQW5IZixpQkFvSE07QUFFQTtBQUNBO0FBQ01DLFlBQUFBLFNBeEhaLEdBd0h3QkQsUUFBUSxDQUFDRSxLQUFULENBQWUsQ0FBZixFQUFrQixDQUFDLENBQW5CLEVBQXNCdEIsS0FBdEIsQ0FBNEIsR0FBNUIsQ0F4SHhCLENBeUhZNUMsQ0F6SFosR0F5SGdCaUUsU0FBUyxDQUFDQSxTQUFTLENBQUN4RixNQUFWLEdBQW1CLENBQXBCLENBQVQsQ0FBZ0N5RCxPQUFoQyxDQUF3QyxXQUF4QyxFQUFxRCxFQUFyRCxDQXpIaEIsRUF5SDBFO0FBQzlEakMsWUFBQUEsQ0ExSFosR0EwSGdCZ0UsU0FBUyxDQUFDQSxTQUFTLENBQUN4RixNQUFWLEdBQW1CLENBQXBCLENBQVQsQ0FBZ0N5RCxPQUFoQyxDQUF3QyxXQUF4QyxFQUFxRCxFQUFyRCxDQTFIaEIsRUEwSDBFO0FBRTlENUUsWUFBQUEsU0E1SFosR0E0SHdCWCxlQUFlLElBQUlBLGVBQWUsQ0FBQ21FLE9BQXBDLEdBQStDbkUsZUFBZSxDQUFDbUUsT0FBL0QsR0FBeUVDLG1CQTVIaEcsQ0E2SFVvRCxhQTdIVix5REErSDhCN0csU0FBUSxDQUFDLEVBQUVmLFFBQVEsRUFBUkEsUUFBRixFQUFZZ0IsVUFBVSxFQUFFTCxRQUF4QixFQUFrQ00sSUFBSSxFQUFFd0csUUFBeEMsRUFBa0R2RyxNQUFNLEVBQU5BLE1BQWxELEVBQUQsQ0EvSHRDLFNBK0hRMEcsYUEvSFIsbUJBZ0lRO0FBQ0F6RCxZQUFBQSxnQkFBZ0IsQ0FBQ3ZDLElBQWpCLENBQXNCNkYsUUFBdEIsRUFDQXZFLGdCQUFnQixJQUFJMEUsYUFBYSxDQUFDMUYsTUFBbEMsQ0FsSVIsNEZBb0lRZCxPQUFPLENBQUNDLEtBQVIsQ0FBYyxvQ0FBZCxFQUFvRHJCLFFBQXBELEVBQThEVyxRQUE5RCxFQUF3RThHLFFBQXhFLEVBQWtGdkcsTUFBbEYsRUFBMEYsZUFBVSxFQUFwRyxFQUNJTyxRQXJJWixzQkFxSWtDekIsUUFySWxDLDZCQXNJb0Isb0NBQXlCLEVBQUVBLFFBQVEsRUFBUkEsUUFBRixFQUFZZ0IsVUFBVSxFQUFFTCxRQUF4QixFQUF6QixDQXRJcEIseURBdUlVc0csU0FBUyxDQUFDdEYsVUFBVixDQUFxQkMsSUFBckIsQ0FBMEIsRUFBRUMsUUFBUSxFQUFFLEdBQVosRUFBaUJDLE9BQU8sRUFBRSwwQkFBMUIsRUFBc0RMLE9BQU8sRUFBUEEsUUFBdEQsRUFBK0R6QixRQUFRLEVBQVJBLFFBQS9ELEVBQXlFVSxRQUFRLEVBQVJBLFFBQXpFLEVBQW1GQyxRQUFRLEVBQVJBLFFBQW5GLEVBQTZGb0IsUUFBUSxFQUFFNkMsZUFBdkcsRUFBd0g1QyxLQUFLLEVBQUV0QixRQUEvSCxFQUExQixFQXZJVixtQ0F5SVU7QUFDQSxnQkFBSSxnQkFBVyxvQ0FBZixFQUFxRGUsUUFBTyxrQ0FBUCxDQUNyRG5CLGdCQUFnQixDQUFDLEVBQUV1QixRQUFRLEVBQUUsR0FBWixFQUFpQkMsT0FBTyxFQUFFLGdCQUExQixFQUE0Q0wsT0FBTyxFQUFQQSxRQUE1QyxFQUFxRHZCLE1BQU0sRUFBTkEsTUFBckQsRUFBNkR1RCxDQUFDLEVBQURBLENBQTdELEVBQWdFQyxDQUFDLEVBQURBLENBQWhFLEVBQW1FN0MsUUFBUSxFQUFFNEcsUUFBN0UsRUFBdUYxRixRQUFRLFlBQUs2QyxlQUFMLGNBQXdCNkMsUUFBeEIsQ0FBL0YsRUFBbUl6RixLQUFLLEVBQUV0QixRQUExSSxFQUFELENBQWhCLENBM0lWLGFBOElVa0gsYUE5SVYseURBa0pjZCxzQkFBc0IsQ0FBQ3BHLFFBQUQsRUFBV1IsTUFBWCxFQUFtQnVELENBQW5CLEVBQXNCQyxDQUF0QixFQUF5QitELFFBQXpCLEVBQW1DRyxhQUFuQyxFQUFrRGhELGVBQWxELEVBQW1FeEUsZUFBbkUsQ0FsSnBDLFVBa0p5SDtBQUNqSDRDLFlBQUFBLGdCQUFnQixJQUFJLENBQXBCLENBQ0FNLHlCQUF5QixDQUFDRCxHQUExQixDQUE4QixJQUE5QixFQXBKUixDQXFKUTtBQXJKUiwwUEF3SkloRCxpQkFBaUIsbUJBQVkyQyxnQkFBZ0IsQ0FBQzZFLGNBQWpCLEVBQVosY0FBaURuSCxRQUFRLENBQUN3RCxXQUFULEVBQWpELGtCQUErRWxCLGdCQUFnQixLQUFLLENBQXJCLEdBQXlCLEVBQXpCLEdBQThCLEdBQTdHLEVBQWpCLENBeEpKLFFBMkpFaUUsU0FBUyxDQUFDakUsZ0JBQVYsR0FBNkJBLGdCQUE3QixDQUNBaUUsU0FBUyxDQUFDOUMsZ0JBQVYsR0FBNkJBLGdCQUE3QixDQUNBOEMsU0FBUyxDQUFDM0QseUJBQVYsb0NBQTBDQSx5QkFBMUMsRUE3SkYsQ0E2SndFO0FBQ3RFMkQsWUFBQUEsU0FBUyxDQUFDaEUsZ0JBQVYsR0FBNkJDLGdCQUE3QixDQTlKRixDQStKRTtBQS9KRiw4Q0FnS1MrRCxTQWhLVCxpRyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnNcbmltcG9ydCB7IFJFUE9fQ09ERVNfTElTVCB9IGZyb20gJy4uLy4uL2NvcmUvZGVmYXVsdHMnO1xuaW1wb3J0ICogYXMgYm9va3MgZnJvbSAnLi4vLi4vY29yZS9ib29rcy9ib29rcyc7XG5pbXBvcnQgeyBmb3JtUmVwb05hbWUsIHJlcG9zaXRvcnlFeGlzdHNPbkRvb3I0MywgZ2V0RmlsZUxpc3RGcm9tWmlwLCBjYWNoZWRHZXRGaWxlLCBjYWNoZWRHZXRCb29rRmlsZW5hbWVGcm9tTWFuaWZlc3QsIGNoZWNrTWFuaWZlc3RUZXh0LCBjaGVja01hcmtkb3duVGV4dCB9IGZyb20gJy4uLy4uL2NvcmUnO1xuaW1wb3J0IHsgY2hlY2tGaWxlQ29udGVudHMgfSBmcm9tICcuLi9maWxlLWNoZWNrL2NoZWNrRmlsZUNvbnRlbnRzJztcbmltcG9ydCB7IGNoZWNrUmVwbyB9IGZyb20gJy4uL3JlcG8tY2hlY2svY2hlY2tSZXBvJztcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtdmFyc1xuaW1wb3J0IHsgdXNlckxvZywgZnVuY3Rpb25Mb2csIGRlYnVnTG9nLCBwYXJhbWV0ZXJBc3NlcnQsIGxvZ2ljQXNzZXJ0IH0gZnJvbSAnLi4vLi4vY29yZS91dGlsaXRpZXMnO1xuXG5cbi8vIGNvbnN0IEJQX1ZBTElEQVRPUl9WRVJTSU9OX1NUUklORyA9ICcwLjcuOCc7XG5cbmNvbnN0IFNUQU5EQVJEX01BTklGRVNUX0ZJTEVOQU1FID0gJ21hbmlmZXN0LnlhbWwnO1xuXG5cbi8qXG4gICAgY2hlY2tCb29rUGFja2FnZVxuKi9cbi8qKlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSB1c2VybmFtZSwgZS5nLiwgJ3VuZm9sZGluZ1dvcmQnXG4gKiBAcGFyYW0ge3N0cmluZ30gbGFuZ3VhZ2VDb2RlLCBlLmcuLCAnZW4nXG4gKiBAcGFyYW0ge3N0cmluZ30gYm9va0lEIC0tIDMtY2hhcmFjdGVyIFVTRk0gYm9vayBJRCBvciAnT0JTJ1xuICogQHBhcmFtIHtGdW5jdGlvbn0gc2V0UmVzdWx0VmFsdWUgZnVuY3Rpb25cbiAqIEBwYXJhbSB7T2JqZWN0fSBjaGVja2luZ09wdGlvbnMgLS0gY2FuIGNvbnRhaW46IGdldEZpbGUgKGZ1bmN0aW9uKSwgb3JpZ2luYWxMYW5ndWFnZVJlcG9Vc2VybmFtZSwgdGFSZXBvVXNlcm5hbWUsIGNoZWNrTWFuaWZlc3RGbGFnXG4gKiBAcmV0dXJuIHtPYmplY3R9IC0gY29udGFpbmluZyBzdWNjZXNzTGlzdCBhbmQgbm90aWNlTGlzdFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2hlY2tCb29rUGFja2FnZSh1c2VybmFtZSwgbGFuZ3VhZ2VDb2RlLCBib29rSUQsIHNldFJlc3VsdFZhbHVlLCBjaGVja2luZ09wdGlvbnMpIHtcbiAgLypcbiAgTm90ZTogWW91IG1heSB3YW50IHRvIHJ1biBjbGVhckNhY2hlcygpIGFuZC9vciBwcmVsb2FkUmVwb3NJZk5lY2Vzc2FyeSgpIGJlZm9yZSBydW5uaW5nIHRoaXMgZnVuY3Rpb24/Pz9cblxuICBOb3RlIHRoYXQgYm9va0lEIGhlcmUgY2FuIGFsc28gYmUgdGhlICdPQlMnIHBzZXVkbyBib29rSUQuXG4gICovXG4gIC8vIGZ1bmN0aW9uTG9nKGBjaGVja0Jvb2tQYWNrYWdlKHVuPScke3VzZXJuYW1lfScsIGxDPScke2xhbmd1YWdlQ29kZX0nLCBiaz0nJHtib29rSUR9JywgKGZuKSwgJHtKU09OLnN0cmluZ2lmeShjaGVja2luZ09wdGlvbnMpfSnigKZgKVxuICAvL3BhcmFtZXRlckFzc2VydCh1c2VybmFtZSAhPT0gdW5kZWZpbmVkLCBcImNoZWNrQm9va1BhY2thZ2U6ICd1c2VybmFtZScgcGFyYW1ldGVyIHNob3VsZCBiZSBkZWZpbmVkXCIpO1xuICAvL3BhcmFtZXRlckFzc2VydCh0eXBlb2YgdXNlcm5hbWUgPT09ICdzdHJpbmcnLCBgY2hlY2tCb29rUGFja2FnZTogJ3VzZXJuYW1lJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGEgc3RyaW5nIG5vdCBhICcke3R5cGVvZiB1c2VybmFtZX0nOiAke3VzZXJuYW1lfWApO1xuICAvL3BhcmFtZXRlckFzc2VydChsYW5ndWFnZUNvZGUgIT09IHVuZGVmaW5lZCwgXCJjaGVja0Jvb2tQYWNrYWdlOiAnbGFuZ3VhZ2VDb2RlJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGRlZmluZWRcIik7XG4gIC8vcGFyYW1ldGVyQXNzZXJ0KHR5cGVvZiBsYW5ndWFnZUNvZGUgPT09ICdzdHJpbmcnLCBgY2hlY2tCb29rUGFja2FnZTogJ2xhbmd1YWdlQ29kZScgcGFyYW1ldGVyIHNob3VsZCBiZSBhIHN0cmluZyBub3QgYSAnJHt0eXBlb2YgbGFuZ3VhZ2VDb2RlfSc6ICR7bGFuZ3VhZ2VDb2RlfWApO1xuICAvL3BhcmFtZXRlckFzc2VydChib29rSUQgIT09IHVuZGVmaW5lZCwgXCJjaGVja0Jvb2tQYWNrYWdlOiAnYm9va0lEJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGRlZmluZWRcIik7XG4gIC8vcGFyYW1ldGVyQXNzZXJ0KHR5cGVvZiBib29rSUQgPT09ICdzdHJpbmcnLCBgY2hlY2tCb29rUGFja2FnZTogJ2Jvb2tJRCcgcGFyYW1ldGVyIHNob3VsZCBiZSBhIHN0cmluZyBub3QgYSAnJHt0eXBlb2YgYm9va0lEfSc6ICR7Ym9va0lEfWApO1xuICAvL3BhcmFtZXRlckFzc2VydChib29rSUQubGVuZ3RoID09PSAzLCBgY2hlY2tCb29rUGFja2FnZTogJ2Jvb2tJRCcgcGFyYW1ldGVyIHNob3VsZCBiZSB0aHJlZSBjaGFyYWN0ZXJzIGxvbmcgbm90ICR7Ym9va0lELmxlbmd0aH1gKTtcbiAgLy9wYXJhbWV0ZXJBc3NlcnQoYm9va0lELnRvVXBwZXJDYXNlKCkgPT09IGJvb2tJRCwgYGNoZWNrQm9va1BhY2thZ2U6ICdib29rSUQnIHBhcmFtZXRlciBzaG91bGQgYmUgVVBQRVJDQVNFIG5vdCAnJHtib29rSUR9J2ApO1xuICAvL3BhcmFtZXRlckFzc2VydChib29rSUQgPT09ICdPQlMnIHx8IGJvb2tzLmlzVmFsaWRCb29rSUQoYm9va0lEKSwgYGNoZWNrQm9va1BhY2thZ2U6ICcke2Jvb2tJRH0nIGlzIG5vdCBhIHZhbGlkIFVTRk0gYm9vayBpZGVudGlmaWVyYCk7XG5cbiAgbGV0IGFib3J0RmxhZyA9IGZhbHNlO1xuICBjb25zdCBzdGFydFRpbWUgPSBuZXcgRGF0ZSgpO1xuICBib29rSUQgPSBib29rSUQudG9VcHBlckNhc2UoKTsgLy8gbm9ybWFsaXNlIHRvIFVTRk0gc3RhbmRhcmRcblxuICBsZXQgY2hlY2tlZEZpbGVDb3VudCA9IDAsIGNoZWNrZWRGaWxlbmFtZXMgPSBbXSwgY2hlY2tlZEZpbGVuYW1lRXh0ZW5zaW9ucyA9IG5ldyBTZXQoKSwgdG90YWxDaGVja2VkU2l6ZSA9IDAsIGNoZWNrZWRSZXBvTmFtZXMgPSBuZXcgU2V0KCk7XG4gIGxldCBjaGVja0Jvb2tQYWNrYWdlUmVzdWx0ID0geyBzdWNjZXNzTGlzdDogW10sIG5vdGljZUxpc3Q6IFtdIH07XG5cbiAgbGV0IGRhdGFTZXQgPSBjaGVja2luZ09wdGlvbnM/LmRhdGFTZXQ7IC8vIENhbiBiZSAnREVGQVVMVCcsICdPTEQnIChNYXJrZG93biwgZXRjLiksICdORVcnIChUU1Ygb25seSksIG9yICdCT1RIJ1xuICBpZiAoIWRhdGFTZXQpIGRhdGFTZXQgPSAnREVGQVVMVCc7XG5cbiAgY29uc3QgbmV3Q2hlY2tpbmdPcHRpb25zID0gY2hlY2tpbmdPcHRpb25zID8geyAuLi5jaGVja2luZ09wdGlvbnMgfSA6IHt9OyAvLyBjbG9uZSBiZWZvcmUgbW9kaWZ5XG4gIGNvbnN0IGdldEZpbGVfID0gbmV3Q2hlY2tpbmdPcHRpb25zLmdldEZpbGUgPyBuZXdDaGVja2luZ09wdGlvbnMuZ2V0RmlsZSA6IGNhY2hlZEdldEZpbGU7IC8vIGRlZmF1bHQgdG8gdXNpbmcgY2FjaGluZyBvZiBmaWxlc1xuICBuZXdDaGVja2luZ09wdGlvbnMuZ2V0RmlsZSA9IGdldEZpbGVfOyAvLyB1c2Ugc2FtZSBnZXRGaWxlXyB3aGVuIHdlIGNhbGwgY29yZSBmdW5jdGlvbnNcbiAgaWYgKCFuZXdDaGVja2luZ09wdGlvbnMub3JpZ2luYWxMYW5ndWFnZVJlcG9Vc2VybmFtZSkgbmV3Q2hlY2tpbmdPcHRpb25zLm9yaWdpbmFsTGFuZ3VhZ2VSZXBvVXNlcm5hbWUgPSB1c2VybmFtZTtcbiAgaWYgKCFuZXdDaGVja2luZ09wdGlvbnMudGFSZXBvVXNlcm5hbWUpIG5ld0NoZWNraW5nT3B0aW9ucy50YVJlcG9Vc2VybmFtZSA9IHVzZXJuYW1lO1xuICBpZiAoIW5ld0NoZWNraW5nT3B0aW9ucy50d1JlcG9Vc2VybmFtZSkgbmV3Q2hlY2tpbmdPcHRpb25zLnR3UmVwb1VzZXJuYW1lID0gdXNlcm5hbWU7XG5cbiAgLy8gTm8gcG9pbnQgaW4gcGFzc2luZyB0aGUgYnJhbmNoIHRocm91Z2ggYXMgYSBwYXJhbWV0ZXJcbiAgLy8gIGNveiBpZiBpdOKAmXMgbm90ICdtYXN0ZXInLCBpdOKAmXMgdW5saWtlbHkgdG8gYmUgY29tbW9uIGZvciBhbGwgdGhlIHJlcG9zXG4gIGxldCBvcmlnaW5hbEJyYW5jaCA9ICdtYXN0ZXInO1xuXG4gIC8vIElmIGl0J3MgYSBiaWcgYm9vaywgZHJvcCB0aGlzIGxvY2F0aW9uIHN0cmluZyB0byByZWR1Y2UgbWVtb3J5IHVzZSBpbiBjYXNlIG9mIHRob3VzYW5kcyBvZiBlcnJvcnNcbiAgbGV0IGdlbmVyYWxMb2NhdGlvbiA9IGJvb2tJRCA9PT0gJ09CUycgPyBgIGluICR7bGFuZ3VhZ2VDb2RlfSAke2Jvb2tJRH0gZnJvbSAke3VzZXJuYW1lfSAke29yaWdpbmFsQnJhbmNofSBicmFuY2hgIDpcbiAgICBib29rcy5jaGFwdGVyc0luQm9vayhib29rSUQpID4gMTAgPyAnJyA6IGAgaW4gJHtsYW5ndWFnZUNvZGV9ICR7Ym9va0lEfSBib29rIHBhY2thZ2UgZnJvbSAke3VzZXJuYW1lfSAke29yaWdpbmFsQnJhbmNofSBicmFuY2hgO1xuXG5cbiAgZnVuY3Rpb24gYWRkU3VjY2Vzc01lc3NhZ2Uoc3VjY2Vzc1N0cmluZykge1xuICAgIC8vIGZ1bmN0aW9uTG9nKGBjaGVja0Jvb2tQYWNrYWdlIHN1Y2Nlc3M6ICR7c3VjY2Vzc1N0cmluZ31gKTtcbiAgICBjaGVja0Jvb2tQYWNrYWdlUmVzdWx0LnN1Y2Nlc3NMaXN0LnB1c2goc3VjY2Vzc1N0cmluZyk7XG4gIH1cblxuXG4gIGZ1bmN0aW9uIGFkZE5vdGljZVBhcnRpYWwobm90aWNlT2JqZWN0KSB7XG4gICAgLy8gYm9va0lEIGlzIGEgdGhyZWUtY2hhcmFjdGVyIFVQUEVSQ0FTRSBVU0ZNIGJvb2sgaWRlbnRpZmllciBvciAnT0JTJy5cbiAgICAvLyBmdW5jdGlvbkxvZyhgY2hlY2tCb29rUGFja2FnZSBhZGROb3RpY2VQYXJ0aWFsOiAocHJpb3JpdHk9JHtub3RpY2VPYmplY3QucHJpb3JpdHl9KSAke25vdGljZU9iamVjdC5ib29rSUR9ICR7bm90aWNlT2JqZWN0LkN9OiR7bm90aWNlT2JqZWN0LlZ9ICR7bm90aWNlT2JqZWN0Lm1lc3NhZ2V9JHtub3RpY2VPYmplY3QuY2hhcmFjdGVySW5kZXggPiAwID8gYCAoYXQgY2hhcmFjdGVyICR7bm90aWNlT2JqZWN0LmNoYXJhY3RlckluZGV4fSlgIDogXCJcIn0ke2V4Y2VycHQgPyBgICR7ZXhjZXJwdH1gIDogXCJcIn0ke2xvY2F0aW9ufWApO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KG5vdGljZU9iamVjdC5wcmlvcml0eSAhPT0gdW5kZWZpbmVkLCBcImNCUCBhZGROb3RpY2VQYXJ0aWFsOiAncHJpb3JpdHknIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgICAvL3BhcmFtZXRlckFzc2VydCh0eXBlb2Ygbm90aWNlT2JqZWN0LnByaW9yaXR5ID09PSAnbnVtYmVyJywgYGNCUCBhZGROb3RpY2VQYXJ0aWFsOiAncHJpb3JpdHknIHBhcmFtZXRlciBzaG91bGQgYmUgYSBudW1iZXIgbm90IGEgJyR7dHlwZW9mIG5vdGljZU9iamVjdC5wcmlvcml0eX0nOiAke25vdGljZU9iamVjdC5wcmlvcml0eX1gKTtcbiAgICAvL3BhcmFtZXRlckFzc2VydChub3RpY2VPYmplY3QubWVzc2FnZSAhPT0gdW5kZWZpbmVkLCBcImNCUCBhZGROb3RpY2VQYXJ0aWFsOiAnbWVzc2FnZScgcGFyYW1ldGVyIHNob3VsZCBiZSBkZWZpbmVkXCIpO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KHR5cGVvZiBub3RpY2VPYmplY3QubWVzc2FnZSA9PT0gJ3N0cmluZycsIGBjQlAgYWRkTm90aWNlUGFydGlhbDogJ21lc3NhZ2UnIHBhcmFtZXRlciBzaG91bGQgYmUgYSBzdHJpbmcgbm90IGEgJyR7dHlwZW9mIG5vdGljZU9iamVjdC5tZXNzYWdlfSc6ICR7bm90aWNlT2JqZWN0Lm1lc3NhZ2V9YCk7XG4gICAgLy8gLy9wYXJhbWV0ZXJBc3NlcnQoYm9va0lEICE9PSB1bmRlZmluZWQsIFwiY0JQIGFkZE5vdGljZVBhcnRpYWw6ICdib29rSUQnIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgICBpZiAobm90aWNlT2JqZWN0LmJvb2tJRCkge1xuICAgICAgLy9wYXJhbWV0ZXJBc3NlcnQodHlwZW9mIG5vdGljZU9iamVjdC5ib29rSUQgPT09ICdzdHJpbmcnLCBgY0JQIGFkZE5vdGljZVBhcnRpYWw6ICdib29rSUQnIHBhcmFtZXRlciBzaG91bGQgYmUgYSBzdHJpbmcgbm90IGEgJyR7dHlwZW9mIG5vdGljZU9iamVjdC5ib29rSUR9JzogJHtub3RpY2VPYmplY3QuYm9va0lEfWApO1xuICAgICAgLy9wYXJhbWV0ZXJBc3NlcnQobm90aWNlT2JqZWN0LmJvb2tJRC5sZW5ndGggPT09IDMsIGBjQlAgYWRkTm90aWNlUGFydGlhbDogJ2Jvb2tJRCcgcGFyYW1ldGVyIHNob3VsZCBiZSB0aHJlZSBjaGFyYWN0ZXJzIGxvbmcgbm90ICR7bm90aWNlT2JqZWN0LmJvb2tJRC5sZW5ndGh9YCk7XG4gICAgICAvL3BhcmFtZXRlckFzc2VydChib29rSUQgPT09ICdPQlMnIHx8IGJvb2tzLmlzVmFsaWRCb29rSUQobm90aWNlT2JqZWN0LmJvb2tJRCksIGBjQlAgYWRkTm90aWNlUGFydGlhbDogJyR7bm90aWNlT2JqZWN0LmJvb2tJRH0nIGlzIG5vdCBhIHZhbGlkIFVTRk0gYm9vayBpZGVudGlmaWVyYCk7XG4gICAgfVxuICAgIC8vIC8vcGFyYW1ldGVyQXNzZXJ0KEMgIT09IHVuZGVmaW5lZCwgXCJjQlAgYWRkTm90aWNlUGFydGlhbDogJ0MnIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgICBpZiAobm90aWNlT2JqZWN0LkMpIHsgLy9wYXJhbWV0ZXJBc3NlcnQodHlwZW9mIG5vdGljZU9iamVjdC5DID09PSAnc3RyaW5nJywgYGNCUCBhZGROb3RpY2VQYXJ0aWFsOiAnQycgcGFyYW1ldGVyIHNob3VsZCBiZSBhIHN0cmluZyBub3QgYSAnJHt0eXBlb2Ygbm90aWNlT2JqZWN0LkN9JzogJHtub3RpY2VPYmplY3QuQ31gKTtcbiAgICB9XG4gICAgLy8gLy9wYXJhbWV0ZXJBc3NlcnQoViAhPT0gdW5kZWZpbmVkLCBcImNCUCBhZGROb3RpY2VQYXJ0aWFsOiAnVicgcGFyYW1ldGVyIHNob3VsZCBiZSBkZWZpbmVkXCIpO1xuICAgIGlmIChub3RpY2VPYmplY3QuVikgeyAvL3BhcmFtZXRlckFzc2VydCh0eXBlb2Ygbm90aWNlT2JqZWN0LlYgPT09ICdzdHJpbmcnLCBgY0JQIGFkZE5vdGljZVBhcnRpYWw6ICdWJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGEgc3RyaW5nIG5vdCBhICcke3R5cGVvZiBub3RpY2VPYmplY3QuVn0nOiAke25vdGljZU9iamVjdC5WfWApO1xuICAgIH1cbiAgICAvLyAvL3BhcmFtZXRlckFzc2VydChjaGFyYWN0ZXJJbmRleCAhPT0gdW5kZWZpbmVkLCBcImNCUCBhZGROb3RpY2VQYXJ0aWFsOiAnY2hhcmFjdGVySW5kZXgnIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgICBpZiAobm90aWNlT2JqZWN0LmNoYXJhY3RlckluZGV4KSB7IC8vcGFyYW1ldGVyQXNzZXJ0KHR5cGVvZiBub3RpY2VPYmplY3QuY2hhcmFjdGVySW5kZXggPT09ICdudW1iZXInLCBgY0JQIGFkZE5vdGljZVBhcnRpYWw6ICdjaGFyYWN0ZXJJbmRleCcgcGFyYW1ldGVyIHNob3VsZCBiZSBhIG51bWJlciBub3QgYSAnJHt0eXBlb2Ygbm90aWNlT2JqZWN0LmNoYXJhY3RlckluZGV4fSc6ICR7bm90aWNlT2JqZWN0LmNoYXJhY3RlckluZGV4fWApO1xuICAgIH1cbiAgICAvLyAvL3BhcmFtZXRlckFzc2VydChleGNlcnB0ICE9PSB1bmRlZmluZWQsIFwiY0JQIGFkZE5vdGljZVBhcnRpYWw6ICdleGNlcnB0JyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGRlZmluZWRcIik7XG4gICAgaWYgKG5vdGljZU9iamVjdC5leGNlcnB0KSB7IC8vcGFyYW1ldGVyQXNzZXJ0KHR5cGVvZiBub3RpY2VPYmplY3QuZXhjZXJwdCA9PT0gJ3N0cmluZycsIGBjQlAgYWRkTm90aWNlUGFydGlhbDogJ2V4Y2VycHQnIHBhcmFtZXRlciBzaG91bGQgYmUgYSBzdHJpbmcgbm90IGEgJyR7dHlwZW9mIG5vdGljZU9iamVjdC5leGNlcnB0fSc6ICR7bm90aWNlT2JqZWN0LmV4Y2VycHR9YCk7XG4gICAgfVxuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KG5vdGljZU9iamVjdC5sb2NhdGlvbiAhPT0gdW5kZWZpbmVkLCBcImNCUCBhZGROb3RpY2VQYXJ0aWFsOiAnbG9jYXRpb24nIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgICAvL3BhcmFtZXRlckFzc2VydCh0eXBlb2Ygbm90aWNlT2JqZWN0LmxvY2F0aW9uID09PSAnc3RyaW5nJywgYGNCUCBhZGROb3RpY2VQYXJ0aWFsOiAnbG9jYXRpb24nIHBhcmFtZXRlciBzaG91bGQgYmUgYSBzdHJpbmcgbm90IGEgJyR7dHlwZW9mIG5vdGljZU9iamVjdC5sb2NhdGlvbn0nOiAke25vdGljZU9iamVjdC5sb2NhdGlvbn1gKTtcbiAgICAvL3BhcmFtZXRlckFzc2VydChub3RpY2VPYmplY3QuZXh0cmEgIT09IHVuZGVmaW5lZCwgXCJjQlAgYWRkTm90aWNlUGFydGlhbDogJ2V4dHJhJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGRlZmluZWRcIik7XG4gICAgLy9wYXJhbWV0ZXJBc3NlcnQodHlwZW9mIG5vdGljZU9iamVjdC5leHRyYSA9PT0gJ3N0cmluZycsIGBjQlAgYWRkTm90aWNlUGFydGlhbDogJ2V4dHJhJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGEgc3RyaW5nIG5vdCBhICcke3R5cGVvZiBub3RpY2VPYmplY3QuZXh0cmF9JzogJHtub3RpY2VPYmplY3QuZXh0cmF9YCk7XG4gICAgaWYgKG5vdGljZU9iamVjdC5kZWJ1Z0NoYWluKSBub3RpY2VPYmplY3QuZGVidWdDaGFpbiA9IGBjaGVja0Jvb2tQYWNrYWdlICR7bm90aWNlT2JqZWN0LmRlYnVnQ2hhaW59YDtcbiAgICBjaGVja0Jvb2tQYWNrYWdlUmVzdWx0Lm5vdGljZUxpc3QucHVzaCh7IC4uLm5vdGljZU9iamVjdCwgYm9va0lELCB1c2VybmFtZSB9KTtcbiAgfVxuXG5cbiAgYXN5bmMgZnVuY3Rpb24gb3VyQ2hlY2tCUEZpbGVDb250ZW50cyhyZXBvQ29kZSwgcmVwb05hbWUsIHJlcG9CcmFuY2gsIGNmRmlsZW5hbWUsIGZpbGVDb250ZW50LCBmaWxlTG9jYXRpb24sIGNoZWNraW5nT3B0aW9ucykge1xuICAgIC8vIGZ1bmN0aW9uTG9nKGBjaGVja0Jvb2tQYWNrYWdlIG91ckNoZWNrQlBGaWxlQ29udGVudHMockM9JyR7cmVwb0NvZGV9Jywgck49JyR7cmVwb05hbWV9JywgckJyPScke3JlcG9CcmFuY2h9JywgZm49JyR7Y2ZGaWxlbmFtZX0nLCAke2ZpbGVDb250ZW50Lmxlbmd0aH0sICR7ZmlsZUxvY2F0aW9ufSwgJHtKU09OLnN0cmluZ2lmeShjaGVja2luZ09wdGlvbnMpfSnigKZgKTtcblxuICAgIC8vIFVwZGF0ZXMgdGhlIGdsb2JhbCBsaXN0IG9mIG5vdGljZXNcbiAgICAvL3BhcmFtZXRlckFzc2VydChyZXBvQ29kZSAhPT0gdW5kZWZpbmVkLCBcImNCUCBvdXJDaGVja0JQRmlsZUNvbnRlbnRzOiAncmVwb0NvZGUnIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgICAvL3BhcmFtZXRlckFzc2VydCh0eXBlb2YgcmVwb0NvZGUgPT09ICdzdHJpbmcnLCBgY0JQIG91ckNoZWNrQlBGaWxlQ29udGVudHM6ICdyZXBvQ29kZScgcGFyYW1ldGVyIHNob3VsZCBiZSBhIHN0cmluZyBub3QgYSAnJHt0eXBlb2YgcmVwb0NvZGV9J2ApO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KFJFUE9fQ09ERVNfTElTVC5pbmNsdWRlcyhyZXBvQ29kZSksIGBjQlAgb3VyQ2hlY2tCUEZpbGVDb250ZW50czogJ3JlcG9Db2RlJyBwYXJhbWV0ZXIgc2hvdWxkIG5vdCBiZSAnJHtyZXBvQ29kZX0nYCk7XG4gICAgLy9wYXJhbWV0ZXJBc3NlcnQocmVwb05hbWUgIT09IHVuZGVmaW5lZCwgXCJjQlAgb3VyQ2hlY2tCUEZpbGVDb250ZW50czogJ3JlcG9OYW1lJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGRlZmluZWRcIik7XG4gICAgLy9wYXJhbWV0ZXJBc3NlcnQodHlwZW9mIHJlcG9OYW1lID09PSAnc3RyaW5nJywgYGNCUCBvdXJDaGVja0JQRmlsZUNvbnRlbnRzOiAncmVwb05hbWUnIHBhcmFtZXRlciBzaG91bGQgYmUgYSBzdHJpbmcgbm90IGEgJyR7dHlwZW9mIHJlcG9OYW1lfSc6ICR7cmVwb05hbWV9YCk7XG4gICAgLy9wYXJhbWV0ZXJBc3NlcnQocmVwb0JyYW5jaCAhPT0gdW5kZWZpbmVkLCBcImNCUCBvdXJDaGVja0JQRmlsZUNvbnRlbnRzOiAncmVwb0JyYW5jaCcgcGFyYW1ldGVyIHNob3VsZCBiZSBkZWZpbmVkXCIpO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KHR5cGVvZiByZXBvQnJhbmNoID09PSAnc3RyaW5nJywgYGNCUCBvdXJDaGVja0JQRmlsZUNvbnRlbnRzOiAncmVwb0JyYW5jaCcgcGFyYW1ldGVyIHNob3VsZCBiZSBhIHN0cmluZyBub3QgYSAnJHt0eXBlb2YgcmVwb0JyYW5jaH0nOiAke3JlcG9CcmFuY2h9YCk7XG4gICAgLy9wYXJhbWV0ZXJBc3NlcnQoY2ZGaWxlbmFtZSAhPT0gdW5kZWZpbmVkLCBcImNCUCBvdXJDaGVja0JQRmlsZUNvbnRlbnRzOiAnY2ZGaWxlbmFtZScgcGFyYW1ldGVyIHNob3VsZCBiZSBkZWZpbmVkXCIpO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KHR5cGVvZiBjZkZpbGVuYW1lID09PSAnc3RyaW5nJywgYGNCUCBvdXJDaGVja0JQRmlsZUNvbnRlbnRzOiAnY2ZGaWxlbmFtZScgcGFyYW1ldGVyIHNob3VsZCBiZSBhIHN0cmluZyBub3QgYSAnJHt0eXBlb2YgY2ZGaWxlbmFtZX0nYCk7XG4gICAgLy9wYXJhbWV0ZXJBc3NlcnQoZmlsZUNvbnRlbnQgIT09IHVuZGVmaW5lZCwgXCJjQlAgb3VyQ2hlY2tCUEZpbGVDb250ZW50czogJ2ZpbGVDb250ZW50JyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGRlZmluZWRcIik7XG4gICAgLy9wYXJhbWV0ZXJBc3NlcnQodHlwZW9mIGZpbGVDb250ZW50ID09PSAnc3RyaW5nJywgYGNCUCBvdXJDaGVja0JQRmlsZUNvbnRlbnRzOiAnZmlsZUNvbnRlbnQnIHBhcmFtZXRlciBzaG91bGQgYmUgYSBzdHJpbmcgbm90IGEgJyR7dHlwZW9mIGZpbGVDb250ZW50fSdgKTtcbiAgICAvL3BhcmFtZXRlckFzc2VydChmaWxlTG9jYXRpb24gIT09IHVuZGVmaW5lZCwgXCJjQlAgb3VyQ2hlY2tCUEZpbGVDb250ZW50czogJ2ZpbGVMb2NhdGlvbicgcGFyYW1ldGVyIHNob3VsZCBiZSBkZWZpbmVkXCIpO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KHR5cGVvZiBmaWxlTG9jYXRpb24gPT09ICdzdHJpbmcnLCBgY0JQIG91ckNoZWNrQlBGaWxlQ29udGVudHM6ICdmaWxlTG9jYXRpb24nIHBhcmFtZXRlciBzaG91bGQgYmUgYSBzdHJpbmcgbm90IGEgJyR7dHlwZW9mIGZpbGVMb2NhdGlvbn0nYCk7XG4gICAgLy9wYXJhbWV0ZXJBc3NlcnQoY2hlY2tpbmdPcHRpb25zICE9PSB1bmRlZmluZWQsIFwiY0JQIG91ckNoZWNrQlBGaWxlQ29udGVudHM6ICdjaGVja2luZ09wdGlvbnMnIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcblxuICAgIGxldCBhZGp1c3RlZExhbmd1YWdlQ29kZSA9IGxhbmd1YWdlQ29kZTtcbiAgICAvLyBpZiAocmVwb0NvZGUgPT09ICdVSEInKSBhZGp1c3RlZExhbmd1YWdlQ29kZSA9ICdoYm8nOyAvLyBOTyAtLSB3ZSBuZWVkIHRoZSBsYW5ndWFnZUNvZGUgb2YgdGhlIEJQIGJlaW5nIGNoZWNrZWQgKHNvIHdlIGNhbiByZXNvbHZlIFRXIGxpbmtzIHdpdGggKiBmb3IgbGFuZ3VhZ2UpICEhIVxuICAgIC8vIGVsc2UgaWYgKHJlcG9Db2RlID09PSAnVUdOVCcpIGFkanVzdGVkTGFuZ3VhZ2VDb2RlID0gJ2VsLXgta29pbmUnO1xuICAgIGNvbnN0IGNmY1Jlc3VsdE9iamVjdCA9IGF3YWl0IGNoZWNrRmlsZUNvbnRlbnRzKHVzZXJuYW1lLCBhZGp1c3RlZExhbmd1YWdlQ29kZSwgcmVwb0NvZGUsIHJlcG9CcmFuY2gsIGNmRmlsZW5hbWUsIGZpbGVDb250ZW50LCBmaWxlTG9jYXRpb24sIGNoZWNraW5nT3B0aW9ucyk7XG4gICAgLy8gZGVidWdMb2coXCJjaGVja0ZpbGVDb250ZW50cygpIHJldHVybmVkXCIsIGNmUmVzdWx0T2JqZWN0LnN1Y2Nlc3NMaXN0Lmxlbmd0aCwgXCJzdWNjZXNzIG1lc3NhZ2UocykgYW5kXCIsIGNmUmVzdWx0T2JqZWN0Lm5vdGljZUxpc3QubGVuZ3RoLCBcIm5vdGljZShzKVwiKTtcbiAgICAvLyBmb3IgKGNvbnN0IHN1Y2Nlc3NFbnRyeSBvZiBjZlJlc3VsdE9iamVjdC5zdWNjZXNzTGlzdCkgdXNlckxvZyhcIiAgb3VyQ2hlY2tCUEZpbGVDb250ZW50czpcIiwgc3VjY2Vzc0VudHJ5KTtcbiAgICAvLyBkZWJ1Z0xvZyhcImNmY1Jlc3VsdE9iamVjdFwiLCBKU09OLnN0cmluZ2lmeShjZmNSZXN1bHRPYmplY3QpKTtcblxuICAgIC8vIFByb2Nlc3Mgbm90aWNlTGlzdCBsaW5lIGJ5IGxpbmUsICBhcHBlbmRpbmcgdGhlIHJlcG9Db2RlIGFzIGFuIGV4dHJhIGZpZWxkIGFzIHdlIGdvXG4gICAgZm9yIChjb25zdCBjZmNOb3RpY2VFbnRyeSBvZiBjZmNSZXN1bHRPYmplY3Qubm90aWNlTGlzdCkgLy8gbm90aWNlRW50cnkgaXMgYW4gb2JqZWN0XG4gICAgICBpZiAoY2ZjTm90aWNlRW50cnkuZXh0cmEpIC8vIGl0IG11c3QgYmUgYW4gaW5kaXJlY3QgY2hlY2sgb24gYSBUQSBvciBUVyBhcnRpY2xlIGZyb20gYSBUTjIgY2hlY2tcbiAgICAgICAgY2hlY2tCb29rUGFja2FnZVJlc3VsdC5ub3RpY2VMaXN0LnB1c2goY2ZjTm90aWNlRW50cnkpOyAvLyBKdXN0IGNvcHkgdGhlIGNvbXBsZXRlIG5vdGljZSBhcyBpc1xuICAgICAgZWxzZSAvLyBGb3Igb3VyIGRpcmVjdCBjaGVja3MsIHdlIGFkZCB0aGUgcmVwb0NvZGUgYXMgYW4gZXh0cmEgdmFsdWUgKHVubGVzcyBpdOKAmXMgYWxyZWFkeSB0aGVyZSBmcm9tIGEgVEEgb3IgVFcgY2hlY2spXG4gICAgICAgIGFkZE5vdGljZVBhcnRpYWwoeyAuLi5jZmNOb3RpY2VFbnRyeSwgcmVwb0NvZGUsIHJlcG9OYW1lLCBicmFuY2g6IHJlcG9CcmFuY2gsIGZpbGVuYW1lOiBjZkZpbGVuYW1lLCBleHRyYTogY2ZjTm90aWNlRW50cnkuZXh0cmEgPyBjZmNOb3RpY2VFbnRyeS5leHRyYSA6IHJlcG9Db2RlIH0pO1xuICAgIC8vIFRoZSBmb2xsb3dpbmcgaXMgbmVlZGVkIGNveiB3ZSBtaWdodCBiZSBjaGVja2luZyB0aGUgbGlua2VkIFRBIGFuZC9vciBUVyBhcnRpY2xlcyBmcm9tIFROMiBUU1YgZmlsZXNcbiAgICBpZiAoY2ZjUmVzdWx0T2JqZWN0LmNoZWNrZWRGaWxlQ291bnQgJiYgY2ZjUmVzdWx0T2JqZWN0LmNoZWNrZWRGaWxlQ291bnQgPiAwKSB7XG4gICAgICBjaGVja2VkRmlsZUNvdW50ICs9IGNmY1Jlc3VsdE9iamVjdC5jaGVja2VkRmlsZUNvdW50O1xuICAgICAgYWRkU3VjY2Vzc01lc3NhZ2UoYENoZWNrZWQgJHtjZmNSZXN1bHRPYmplY3QuY2hlY2tlZEZpbGVDb3VudH0gbGlua2VkIFRBL1RXIGFydGljbGVzYCk7XG4gICAgfVxuICAgIGlmIChjZmNSZXN1bHRPYmplY3QuY2hlY2tlZEZpbGVzaXplcyAmJiBjZmNSZXN1bHRPYmplY3QuY2hlY2tlZEZpbGVzaXplcyA+IDApIHRvdGFsQ2hlY2tlZFNpemUgKz0gY2ZjUmVzdWx0T2JqZWN0LmNoZWNrZWRGaWxlc2l6ZXM7XG4gICAgaWYgKGNmY1Jlc3VsdE9iamVjdC5jaGVja2VkUmVwb05hbWVzICYmIGNmY1Jlc3VsdE9iamVjdC5jaGVja2VkUmVwb05hbWVzLmxlbmd0aCA+IDApXG4gICAgICBmb3IgKGNvbnN0IGNoZWNrZWRSZXBvTmFtZSBvZiBjZmNSZXN1bHRPYmplY3QuY2hlY2tlZFJlcG9OYW1lcylcbiAgICAgICAgLy8gdHJ5IHsgaWYgKGNoZWNrZWRSZXBvTmFtZXMuaW5kZXhPZihjaGVja2VkUmVwb05hbWUpIDwgMCkgY2hlY2tlZFJlcG9OYW1lcy5wdXNoKGNoZWNrZWRSZXBvTmFtZSk7IH1cbiAgICAgICAgLy8gY2F0Y2ggeyBjaGVja2VkUmVwb05hbWVzID0gW2NoZWNrZWRSZXBvTmFtZV07IH1cbiAgICAgICAgY2hlY2tlZFJlcG9OYW1lcy5hZGQoY2hlY2tlZFJlcG9OYW1lKTtcbiAgICBpZiAoY2ZjUmVzdWx0T2JqZWN0LmNoZWNrZWRGaWxlbmFtZUV4dGVuc2lvbnMgJiYgY2ZjUmVzdWx0T2JqZWN0LmNoZWNrZWRGaWxlbmFtZUV4dGVuc2lvbnMubGVuZ3RoID4gMClcbiAgICAgIGZvciAoY29uc3QgY2hlY2tlZEZpbGVuYW1lRXh0ZW5zaW9uIG9mIGNmY1Jlc3VsdE9iamVjdC5jaGVja2VkRmlsZW5hbWVFeHRlbnNpb25zKVxuICAgICAgICBjaGVja2VkRmlsZW5hbWVFeHRlbnNpb25zLmFkZChjaGVja2VkRmlsZW5hbWVFeHRlbnNpb24pO1xuICB9XG4gIC8vIGVuZCBvZiBvdXJDaGVja0JQRmlsZUNvbnRlbnRzIGZ1bmN0aW9uXG5cblxuICAvKipcbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IHJlcG9Db2RlLCBlLmcuLCAnVEEnXG4gICAqIEBwYXJhbSB7c3RyaW5nfSByZXBvTmFtZSwgZS5nLiwgJ2VuX3RhJ1xuICAgKiBAcGFyYW0ge3N0cmluZ30gcmVwb0JyYW5jaCwgZS5nLiwgJ21hc3RlcidcbiAgICogQHBhcmFtIHtzdHJpbmd9IG1hbmlmZXN0TG9jYXRpb25cbiAgICogQHBhcmFtIHtPYmplY3R9IGNoZWNraW5nT3B0aW9uc1xuICAgKi9cbiAgYXN5bmMgZnVuY3Rpb24gb3VyQ2hlY2tNYW5pZmVzdEZpbGUocmVwb0NvZGUsIHJlcG9OYW1lLCByZXBvQnJhbmNoLCBtYW5pZmVzdExvY2F0aW9uLCBjaGVja2luZ09wdGlvbnMpIHtcbiAgICAvLyBVcGRhdGVzIHRoZSBnbG9iYWwgbGlzdCBvZiBub3RpY2VzXG4gICAgLy8gZnVuY3Rpb25Mb2coYGNoZWNrQm9va1BhY2thZ2Ugb3VyQ2hlY2tNYW5pZmVzdEZpbGUoJHtyZXBvQ29kZX0sICR7cmVwb05hbWV9LCAke3JlcG9CcmFuY2h9LCAke21hbmlmZXN0TG9jYXRpb259LCAke0pTT04uc3RyaW5naWZ5KGNoZWNraW5nT3B0aW9ucyl9KeKApmApO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KHJlcG9Db2RlICE9PSB1bmRlZmluZWQsIFwiY0JQIG91ckNoZWNrTWFuaWZlc3RGaWxlOiAncmVwb0NvZGUnIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgICAvL3BhcmFtZXRlckFzc2VydCh0eXBlb2YgcmVwb0NvZGUgPT09ICdzdHJpbmcnLCBgY0JQIG91ckNoZWNrTWFuaWZlc3RGaWxlOiAncmVwb0NvZGUnIHBhcmFtZXRlciBzaG91bGQgYmUgYSBzdHJpbmcgbm90IGEgJyR7dHlwZW9mIHJlcG9Db2RlfScgOiAke3JlcG9Db2RlfWApO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KFJFUE9fQ09ERVNfTElTVC5pbmNsdWRlcyhyZXBvQ29kZSksIGBjQlAgb3VyQ2hlY2tNYW5pZmVzdEZpbGU6ICdyZXBvQ29kZScgcGFyYW1ldGVyIHNob3VsZCBub3QgYmUgJyR7cmVwb0NvZGV9J2ApO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KHJlcG9OYW1lICE9PSB1bmRlZmluZWQsIFwiY0JQIG91ckNoZWNrTWFuaWZlc3RGaWxlOiAncmVwb05hbWUnIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgICAvL3BhcmFtZXRlckFzc2VydCh0eXBlb2YgcmVwb05hbWUgPT09ICdzdHJpbmcnLCBgY0JQIG91ckNoZWNrTWFuaWZlc3RGaWxlOiAncmVwb05hbWUnIHBhcmFtZXRlciBzaG91bGQgYmUgYSBzdHJpbmcgbm90IGEgJyR7dHlwZW9mIHJlcG9OYW1lfSc6ICR7cmVwb05hbWV9YCk7XG4gICAgLy9wYXJhbWV0ZXJBc3NlcnQocmVwb0JyYW5jaCAhPT0gdW5kZWZpbmVkLCBcImNCUCBvdXJDaGVja01hbmlmZXN0RmlsZTogJ3JlcG9CcmFuY2gnIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgICAvL3BhcmFtZXRlckFzc2VydCh0eXBlb2YgcmVwb0JyYW5jaCA9PT0gJ3N0cmluZycsIGBjQlAgb3VyQ2hlY2tNYW5pZmVzdEZpbGU6ICdyZXBvQnJhbmNoJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGEgc3RyaW5nIG5vdCBhICcke3R5cGVvZiByZXBvQnJhbmNofSc6ICR7cmVwb0JyYW5jaH1gKTtcbiAgICAvL3BhcmFtZXRlckFzc2VydChtYW5pZmVzdExvY2F0aW9uICE9PSB1bmRlZmluZWQsIFwiY0JQIG91ckNoZWNrTWFuaWZlc3RGaWxlOiAnbWFuaWZlc3RMb2NhdGlvbicgcGFyYW1ldGVyIHNob3VsZCBiZSBkZWZpbmVkXCIpO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KHR5cGVvZiBtYW5pZmVzdExvY2F0aW9uID09PSAnc3RyaW5nJywgYGNCUCBvdXJDaGVja01hbmlmZXN0RmlsZTogJ21hbmlmZXN0TG9jYXRpb24nIHBhcmFtZXRlciBzaG91bGQgYmUgYSBzdHJpbmcgbm90IGEgJyR7dHlwZW9mIG1hbmlmZXN0TG9jYXRpb259J2ApO1xuXG4gICAgbGV0IG1hbmlmZXN0RmlsZUNvbnRlbnQ7XG4gICAgdHJ5IHtcbiAgICAgIC8vIGRlYnVnTG9nKFwiY2hlY2tCb29rUGFja2FnZSBvdXJDaGVja01hbmlmZXN0RmlsZSBhYm91dCB0byBmZXRjaCBtYW5pZmVzdFwiLCB1c2VybmFtZSwgcmVwb05hbWUsIHJlcG9CcmFuY2gpO1xuICAgICAgbWFuaWZlc3RGaWxlQ29udGVudCA9IGF3YWl0IGdldEZpbGVfKHsgdXNlcm5hbWUsIHJlcG9zaXRvcnk6IHJlcG9OYW1lLCBwYXRoOiBTVEFOREFSRF9NQU5JRkVTVF9GSUxFTkFNRSwgYnJhbmNoOiByZXBvQnJhbmNoIH0pO1xuICAgICAgLy8gZGVidWdMb2coXCJjaGVja0Jvb2tQYWNrYWdlIG91ckNoZWNrTWFuaWZlc3RGaWxlIGZldGNoZWQgY29udGVudCBmb3IgbWFuaWZlc3RcIiwgdXNlcm5hbWUsIHJlcG9OYW1lLCByZXBvQnJhbmNoLCB0eXBlb2YgbWFuaWZlc3RGaWxlQ29udGVudCwgbWFuaWZlc3RGaWxlQ29udGVudC5sZW5ndGgpO1xuICAgICAgLy8gZGVidWdMb2cobWFuaWZlc3RGaWxlQ29udGVudCk7XG4gICAgfSBjYXRjaCAoY0JQZ2ZFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihgY2hlY2tCb29rUGFja2FnZSBvdXJDaGVja01hbmlmZXN0RmlsZSgke3VzZXJuYW1lfSwgJHtsYW5ndWFnZUNvZGV9LCAke2Jvb2tJRH0sIChmbiksICR7SlNPTi5zdHJpbmdpZnkoY2hlY2tpbmdPcHRpb25zKX0pIGZhaWxlZCB0byBsb2FkIG1hbmlmZXN0YCwgdXNlcm5hbWUsIHJlcG9OYW1lLCByZXBvQnJhbmNoLCBjQlBnZkVycm9yICsgJycpO1xuICAgICAgbGV0IGRldGFpbHMgPSBgdXNlcm5hbWU9JHt1c2VybmFtZX1gO1xuICAgICAgaWYgKCEgYXdhaXQgcmVwb3NpdG9yeUV4aXN0c09uRG9vcjQzKHsgdXNlcm5hbWUsIHJlcG9zaXRvcnk6IHJlcG9OYW1lIH0pKVxuICAgICAgICBjaGVja0Jvb2tQYWNrYWdlUmVzdWx0Lm5vdGljZUxpc3QucHVzaCh7IHByaW9yaXR5OiA5OTcsIG1lc3NhZ2U6IFwiUmVwb3NpdG9yeSBkb2VzbuKAmXQgZXhpc3RcIiwgZGV0YWlscywgdXNlcm5hbWUsIHJlcG9Db2RlLCByZXBvTmFtZSwgbG9jYXRpb246IG1hbmlmZXN0TG9jYXRpb24sIGV4dHJhOiByZXBvQ29kZSB9KTtcbiAgICAgIGVsc2Uge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZXFlcWVxXG4gICAgICAgIGlmIChjQlBnZkVycm9yICE9ICdUeXBlRXJyb3I6IHJlcG9GaWxlQ29udGVudCBpcyBudWxsJykgZGV0YWlscyArPSBgIGVycm9yPSR7Y0JQZ2ZFcnJvcn1gO1xuICAgICAgICBhZGROb3RpY2VQYXJ0aWFsKHsgcHJpb3JpdHk6IDk5NiwgbWVzc2FnZTogXCJVbmFibGUgdG8gbG9hZFwiLCBkZXRhaWxzOiBgdXNlcm5hbWU9JHt1c2VybmFtZX0gZXJyb3I9JHtjQlBnZkVycm9yfWAsIHJlcG9OYW1lLCBmaWxlbmFtZTogU1RBTkRBUkRfTUFOSUZFU1RfRklMRU5BTUUsIGxvY2F0aW9uOiBtYW5pZmVzdExvY2F0aW9uLCBleHRyYTogcmVwb0NvZGUgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChtYW5pZmVzdEZpbGVDb250ZW50KSB7XG4gICAgICBjb25zdCBjbXRSZXN1bHRPYmplY3QgPSBhd2FpdCBjaGVja01hbmlmZXN0VGV4dChsYW5ndWFnZUNvZGUsIHJlcG9Db2RlLCB1c2VybmFtZSwgcmVwb05hbWUsIHJlcG9CcmFuY2gsIG1hbmlmZXN0RmlsZUNvbnRlbnQsIG1hbmlmZXN0TG9jYXRpb24sIGNoZWNraW5nT3B0aW9ucyk7XG4gICAgICAvLyBkZWJ1Z0xvZyhgb3VyQ2hlY2tNYW5pZmVzdEZpbGUgY2hlY2tNYW5pZmVzdFRleHQoJHtyZXBvTmFtZX0pIHJldHVybmVkICR7Y210UmVzdWx0T2JqZWN0LnN1Y2Nlc3NMaXN0Lmxlbmd0aH0gc3VjY2VzcyBtZXNzYWdlKHMpIGFuZCAke2NtdFJlc3VsdE9iamVjdC5ub3RpY2VMaXN0Lmxlbmd0aH0gbm90aWNlKHMpYCk7XG4gICAgICAvLyBkZWJ1Z0xvZyhgb3VyQ2hlY2tNYW5pZmVzdEZpbGUgY2hlY2tNYW5pZmVzdFRleHQoJHtyZXBvTmFtZX0pIHJldHVybmVkICR7SlNPTi5zdHJpbmdpZnkoY210UmVzdWx0T2JqZWN0KX1gKTtcbiAgICAgIC8vIE5PVEU6IFdlIGlnbm9yZSB0aGUgcmV0dXJuZWQgc3VjY2VzcyBtZXNzYWdlcyBoZXJlXG4gICAgICAvLyBmb3IgKGNvbnN0IHN1Y2Nlc3NFbnRyeSBvZiBjZlJlc3VsdE9iamVjdC5zdWNjZXNzTGlzdCkgdXNlckxvZyhcIiAgb3VyQ2hlY2tCUEZpbGVDb250ZW50czpcIiwgc3VjY2Vzc0VudHJ5KTtcbiAgICAgIC8vIGRlYnVnTG9nKFwiY2ZjUmVzdWx0T2JqZWN0XCIsIEpTT04uc3RyaW5naWZ5KGNmY1Jlc3VsdE9iamVjdCkpO1xuXG4gICAgICAvLyBQcm9jZXNzIG5vdGljZUxpc3QgbGluZSBieSBsaW5lLCAgYXBwZW5kaW5nIHRoZSByZXBvQ29kZSBhcyBhbiBleHRyYSBmaWVsZCBhcyB3ZSBnb1xuICAgICAgZm9yIChjb25zdCBjZmNOb3RpY2VFbnRyeSBvZiBjbXRSZXN1bHRPYmplY3Qubm90aWNlTGlzdCkge1xuICAgICAgICAvLyBOT1RFOiBXZSBkb27igJl0IHVzZSBhZGROb3RpY2VQYXJ0aWFsLCBiZWNhdXNlIGl0IGFkZHMgYSBtaXNsZWFkaW5nIEJvb2tJRFxuICAgICAgICAvLyBhZGROb3RpY2VQYXJ0aWFsKHsgLi4uY2ZjTm90aWNlRW50cnksIGZpbGVuYW1lOiBTVEFOREFSRF9NQU5JRkVTVF9GSUxFTkFNRSwgZXh0cmE6IGAke3JlcG9Db2RlfSBNQU5JRkVTVGAgfSk7XG4gICAgICAgIGNoZWNrQm9va1BhY2thZ2VSZXN1bHQubm90aWNlTGlzdC5wdXNoKHsgLi4uY2ZjTm90aWNlRW50cnksIHVzZXJuYW1lLCByZXBvQ29kZSwgcmVwb05hbWUsIGZpbGVuYW1lOiBTVEFOREFSRF9NQU5JRkVTVF9GSUxFTkFNRSwgZXh0cmE6IGAke3JlcG9Db2RlfSBNQU5JRkVTVGAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbWFuaWZlc3RGaWxlQ29udGVudC5sZW5ndGg7XG4gICAgfVxuICAgIC8vIE5PVEU6IFdlIGRvbuKAmXQgdXNlIGFkZE5vdGljZVBhcnRpYWwsIGJlY2F1c2UgaXQgYWRkcyBhIG1pc2xlYWRpbmcgQm9va0lEXG4gICAgLy8gYWRkTm90aWNlUGFydGlhbCh7IHByaW9yaXR5OiA5NTYsIG1lc3NhZ2U6IFwiR290IGVtcHR5IG1hbmlmZXN0IGZpbGVcIiwgcmVwb05hbWUsIGZpbGVuYW1lOiBTVEFOREFSRF9NQU5JRkVTVF9GSUxFTkFNRSwgbG9jYXRpb246IG1hbmlmZXN0TG9jYXRpb24sIGV4dHJhOiBgJHtyZXBvQ29kZX0gTUFOSUZFU1RgIH0pO1xuICAgIGNoZWNrQm9va1BhY2thZ2VSZXN1bHQubm90aWNlTGlzdC5wdXNoKHsgcHJpb3JpdHk6IDk1NiwgbWVzc2FnZTogXCJHb3QgZW1wdHkgbWFuaWZlc3QgZmlsZVwiLCByZXBvTmFtZSwgZmlsZW5hbWU6IFNUQU5EQVJEX01BTklGRVNUX0ZJTEVOQU1FLCBsb2NhdGlvbjogbWFuaWZlc3RMb2NhdGlvbiwgZXh0cmE6IGAke3JlcG9Db2RlfSBNQU5JRkVTVGAgfSk7XG4gICAgcmV0dXJuIDA7XG4gIH1cbiAgLy8gZW5kIG9mIG91ckNoZWNrTWFuaWZlc3RGaWxlIGZ1bmN0aW9uXG5cblxuICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSByZXBvQ29kZSwgZS5nLiwgJ1RBJ1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSByZXBvTmFtZSwgZS5nLiwgJ2VuX3RhJ1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSByZXBvQnJhbmNoLCBlLmcuLCAnbWFzdGVyJ1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBmaWxlbmFtZSwgZS5nLiwgJ1JFQURNRS5tZCdcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbWFya2Rvd25Mb2NhdGlvblxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjaGVja2luZ09wdGlvbnNcbiAgICAgKi9cbiAgYXN5bmMgZnVuY3Rpb24gb3VyQ2hlY2tNYXJrZG93bkZpbGUocmVwb0NvZGUsIHJlcG9OYW1lLCByZXBvQnJhbmNoLCBmaWxlbmFtZSwgbWFya2Rvd25Mb2NhdGlvbiwgY2hlY2tpbmdPcHRpb25zKSB7XG4gICAgLy8gVXBkYXRlcyB0aGUgZ2xvYmFsIGxpc3Qgb2Ygbm90aWNlc1xuICAgIC8vIGZ1bmN0aW9uTG9nKGBjaGVja0Jvb2tQYWNrYWdlIG91ckNoZWNrTWFya2Rvd25GaWxlKCR7cmVwb0NvZGV9LCAke3JlcG9OYW1lfSwgJHtmaWxlbmFtZX0sICR7cmVwb0JyYW5jaH0sICR7bWFya2Rvd25Mb2NhdGlvbn0sICR7SlNPTi5zdHJpbmdpZnkoY2hlY2tpbmdPcHRpb25zKX0p4oCmYCk7XG4gICAgLy9wYXJhbWV0ZXJBc3NlcnQocmVwb0NvZGUgIT09IHVuZGVmaW5lZCwgXCJjQlAgb3VyQ2hlY2tNYXJrZG93bkZpbGU6ICdyZXBvQ29kZScgcGFyYW1ldGVyIHNob3VsZCBiZSBkZWZpbmVkXCIpO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KHR5cGVvZiByZXBvQ29kZSA9PT0gJ3N0cmluZycsIGBjQlAgb3VyQ2hlY2tNYXJrZG93bkZpbGU6ICdyZXBvQ29kZScgcGFyYW1ldGVyIHNob3VsZCBiZSBhIHN0cmluZyBub3QgYSAnJHt0eXBlb2YgcmVwb0NvZGV9J2ApO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KFJFUE9fQ09ERVNfTElTVC5pbmNsdWRlcyhyZXBvQ29kZSksIGBjQlAgb3VyQ2hlY2tNYXJrZG93bkZpbGU6ICdyZXBvQ29kZScgcGFyYW1ldGVyIHNob3VsZCBub3QgYmUgJyR7cmVwb0NvZGV9J2ApO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KHJlcG9OYW1lICE9PSB1bmRlZmluZWQsIFwiY0JQIG91ckNoZWNrTWFya2Rvd25GaWxlOiAncmVwb05hbWUnIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgICAvL3BhcmFtZXRlckFzc2VydCh0eXBlb2YgcmVwb05hbWUgPT09ICdzdHJpbmcnLCBgY0JQIG91ckNoZWNrTWFya2Rvd25GaWxlOiAncmVwb05hbWUnIHBhcmFtZXRlciBzaG91bGQgYmUgYSBzdHJpbmcgbm90IGEgJyR7dHlwZW9mIHJlcG9OYW1lfSdgKTtcbiAgICAvL3BhcmFtZXRlckFzc2VydChyZXBvQnJhbmNoICE9PSB1bmRlZmluZWQsIFwiY0JQIG91ckNoZWNrTWFya2Rvd25GaWxlOiAncmVwb0JyYW5jaCcgcGFyYW1ldGVyIHNob3VsZCBiZSBkZWZpbmVkXCIpO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KHR5cGVvZiByZXBvQnJhbmNoID09PSAnc3RyaW5nJywgYGNCUCBvdXJDaGVja01hcmtkb3duRmlsZTogJ3JlcG9CcmFuY2gnIHBhcmFtZXRlciBzaG91bGQgYmUgYSBzdHJpbmcgbm90IGEgJyR7dHlwZW9mIHJlcG9CcmFuY2h9J2ApO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KGZpbGVuYW1lICE9PSB1bmRlZmluZWQsIFwiY0JQIG91ckNoZWNrTWFya2Rvd25GaWxlOiAnZmlsZW5hbWUnIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgICAvL3BhcmFtZXRlckFzc2VydCh0eXBlb2YgZmlsZW5hbWUgPT09ICdzdHJpbmcnLCBgY0JQIG91ckNoZWNrTWFya2Rvd25GaWxlOiAnZmlsZW5hbWUnIHBhcmFtZXRlciBzaG91bGQgYmUgYSBzdHJpbmcgbm90IGEgJyR7dHlwZW9mIGZpbGVuYW1lfSc6ICR7ZmlsZW5hbWV9YCk7XG4gICAgLy9wYXJhbWV0ZXJBc3NlcnQobWFya2Rvd25Mb2NhdGlvbiAhPT0gdW5kZWZpbmVkLCBcImNCUCBvdXJDaGVja01hcmtkb3duRmlsZTogJ21hcmtkb3duTG9jYXRpb24nIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgICAvL3BhcmFtZXRlckFzc2VydCh0eXBlb2YgbWFya2Rvd25Mb2NhdGlvbiA9PT0gJ3N0cmluZycsIGBjQlAgb3VyQ2hlY2tNYXJrZG93bkZpbGU6ICdtYXJrZG93bkxvY2F0aW9uJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGEgc3RyaW5nIG5vdCBhICcke3R5cGVvZiBtYXJrZG93bkxvY2F0aW9ufSdgKTtcblxuICAgIGxldCBtYXJrZG93bkZpbGVDb250ZW50O1xuICAgIHRyeSB7XG4gICAgICAvLyBkZWJ1Z0xvZyhcImNoZWNrQm9va1BhY2thZ2Ugb3VyQ2hlY2tNYXJrZG93bkZpbGUgYWJvdXQgdG8gZmV0Y2ggbWFya2Rvd24gZmlsZVwiLCB1c2VybmFtZSwgcmVwb05hbWUsIHJlcG9CcmFuY2gsIGZpbGVuYW1lKTtcbiAgICAgIG1hcmtkb3duRmlsZUNvbnRlbnQgPSBhd2FpdCBnZXRGaWxlXyh7IHVzZXJuYW1lLCByZXBvc2l0b3J5OiByZXBvTmFtZSwgcGF0aDogZmlsZW5hbWUsIGJyYW5jaDogcmVwb0JyYW5jaCB9KTtcbiAgICAgIC8vIGRlYnVnTG9nKFwiY2hlY2tCb29rUGFja2FnZSBvdXJDaGVja01hcmtkb3duRmlsZSBmZXRjaGVkIG1hcmtkb3duIGNvbnRlbnRcIiwgdXNlcm5hbWUsIHJlcG9OYW1lLCByZXBvQnJhbmNoLCBmaWxlbmFtZSwgdHlwZW9mIG1hcmtkb3duRmlsZUNvbnRlbnQsIG1hcmtkb3duRmlsZUNvbnRlbnQubGVuZ3RoKTtcbiAgICAgIC8vIGRlYnVnTG9nKG1hcmtkb3duRmlsZUNvbnRlbnQpO1xuICAgIH0gY2F0Y2ggKGNCUGdmRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYGNoZWNrQm9va1BhY2thZ2Ugb3VyQ2hlY2tNYXJrZG93bkZpbGUoJHt1c2VybmFtZX0sICR7bGFuZ3VhZ2VDb2RlfSwgJHtib29rSUR9LCAoZm4pLCAke0pTT04uc3RyaW5naWZ5KGNoZWNraW5nT3B0aW9ucyl9KSBmYWlsZWQgdG8gbG9hZCBtYXJrZG93bmAsIHVzZXJuYW1lLCByZXBvTmFtZSwgZmlsZW5hbWUsIG9yaWdpbmFsQnJhbmNoLCBjQlBnZkVycm9yICsgJycpO1xuICAgICAgbGV0IGRldGFpbHMgPSBgdXNlcm5hbWU9JHt1c2VybmFtZX1gO1xuICAgICAgaWYgKCEgYXdhaXQgcmVwb3NpdG9yeUV4aXN0c09uRG9vcjQzKHsgdXNlcm5hbWUsIHJlcG9zaXRvcnk6IHJlcG9OYW1lIH0pKVxuICAgICAgICBjaGVja0Jvb2tQYWNrYWdlUmVzdWx0Lm5vdGljZUxpc3QucHVzaCh7IHByaW9yaXR5OiA5OTcsIG1lc3NhZ2U6IFwiUmVwb3NpdG9yeSBkb2VzbuKAmXQgZXhpc3RcIiwgZGV0YWlscywgdXNlcm5hbWUsIHJlcG9Db2RlLCByZXBvTmFtZSwgbG9jYXRpb246IG1hcmtkb3duTG9jYXRpb24sIGV4dHJhOiByZXBvQ29kZSB9KTtcbiAgICAgIGVsc2Uge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZXFlcWVxXG4gICAgICAgIGlmIChjQlBnZkVycm9yICE9ICdUeXBlRXJyb3I6IHJlcG9GaWxlQ29udGVudCBpcyBudWxsJykgZGV0YWlscyArPSBgIGVycm9yPSR7Y0JQZ2ZFcnJvcn1gO1xuICAgICAgICBhZGROb3RpY2VQYXJ0aWFsKHsgcHJpb3JpdHk6IDk5NiwgbWVzc2FnZTogXCJVbmFibGUgdG8gbG9hZFwiLCBkZXRhaWxzOiBgdXNlcm5hbWU9JHt1c2VybmFtZX0gZXJyb3I9JHtjQlBnZkVycm9yfWAsIHVzZXJuYW1lLCByZXBvTmFtZSwgZmlsZW5hbWUsIGxvY2F0aW9uOiBtYXJrZG93bkxvY2F0aW9uLCBleHRyYTogcmVwb0NvZGUgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChtYXJrZG93bkZpbGVDb250ZW50KSB7XG4gICAgICBjb25zdCBjbXRSZXN1bHRPYmplY3QgPSBhd2FpdCBjaGVja01hcmtkb3duVGV4dChsYW5ndWFnZUNvZGUsIHJlcG9Db2RlLCBmaWxlbmFtZS5zdWJzdHJpbmcoMCwgZmlsZW5hbWUubGVuZ3RoIC0gMyksIG1hcmtkb3duRmlsZUNvbnRlbnQsIG1hcmtkb3duTG9jYXRpb24sIGNoZWNraW5nT3B0aW9ucyk7XG4gICAgICAvLyBkZWJ1Z0xvZyhgb3VyQ2hlY2tNYXJrZG93bkZpbGUgY2hlY2tNYXJrZG93blRleHQoJHtyZXBvTmFtZX0pIHJldHVybmVkICR7Y210UmVzdWx0T2JqZWN0LnN1Y2Nlc3NMaXN0Lmxlbmd0aH0gc3VjY2VzcyBtZXNzYWdlKHMpIGFuZCAke2NtdFJlc3VsdE9iamVjdC5ub3RpY2VMaXN0Lmxlbmd0aH0gbm90aWNlKHMpYCk7XG4gICAgICAvLyBkZWJ1Z0xvZyhgb3VyQ2hlY2tNYXJrZG93bkZpbGUgY2hlY2tNYXJrZG93blRleHQoJHtyZXBvTmFtZX0pIHJldHVybmVkICR7SlNPTi5zdHJpbmdpZnkoY210UmVzdWx0T2JqZWN0KX1gKTtcbiAgICAgIC8vIE5PVEU6IFdlIGlnbm9yZSB0aGUgcmV0dXJuZWQgc3VjY2VzcyBtZXNzYWdlcyBoZXJlXG4gICAgICAvLyBmb3IgKGNvbnN0IHN1Y2Nlc3NFbnRyeSBvZiBjZlJlc3VsdE9iamVjdC5zdWNjZXNzTGlzdCkgdXNlckxvZyhcIiAgb3VyQ2hlY2tCUEZpbGVDb250ZW50czpcIiwgc3VjY2Vzc0VudHJ5KTtcbiAgICAgIC8vIGRlYnVnTG9nKFwiY2ZjUmVzdWx0T2JqZWN0XCIsIEpTT04uc3RyaW5naWZ5KGNmY1Jlc3VsdE9iamVjdCkpO1xuXG4gICAgICAvLyBQcm9jZXNzIG5vdGljZUxpc3QgbGluZSBieSBsaW5lLCAgYXBwZW5kaW5nIHRoZSByZXBvQ29kZSBhcyBhbiBleHRyYSBmaWVsZCBhcyB3ZSBnb1xuICAgICAgZm9yIChjb25zdCBjZmNOb3RpY2VFbnRyeSBvZiBjbXRSZXN1bHRPYmplY3Qubm90aWNlTGlzdCkge1xuICAgICAgICAvLyBOT1RFOiBXZSBkb27igJl0IHVzZSBhZGROb3RpY2VQYXJ0aWFsLCBiZWNhdXNlIGl0IGFkZHMgYSBtaXNsZWFkaW5nIEJvb2tJRFxuICAgICAgICAvLyBhZGROb3RpY2VQYXJ0aWFsKHsgLi4uY2ZjTm90aWNlRW50cnksIGZpbGVuYW1lLCBleHRyYTogYCR7cmVwb0NvZGV9IG1hcmtkb3duYCB9KTtcbiAgICAgICAgY2hlY2tCb29rUGFja2FnZVJlc3VsdC5ub3RpY2VMaXN0LnB1c2goeyAuLi5jZmNOb3RpY2VFbnRyeSwgdXNlcm5hbWUsIHJlcG9Db2RlLCByZXBvTmFtZSwgZmlsZW5hbWUsIGV4dHJhOiByZXBvQ29kZSB9KTtcbiAgICAgIH1cblxuICAgICAgaWYgKGZpbGVuYW1lID09PSAnTElDRU5TRS5tZCcpIHtcbiAgICAgICAgY29uc3QgZnVsbFllYXJTdHJpbmcgPSBgJHsobmV3IERhdGUoKSkuZ2V0RnVsbFllYXIoKX1gO1xuICAgICAgICAvLyBkZWJ1Z0xvZyhgWWVhciAke2Z1bGxZZWFyU3RyaW5nfSBpcyAke3R5cGVvZiBmdWxsWWVhclN0cmluZ31gKTtcbiAgICAgICAgaWYgKG1hcmtkb3duRmlsZUNvbnRlbnQuaW5kZXhPZihmdWxsWWVhclN0cmluZykgPT09IC0xKSAvLyBDYW4ndCBmaW5kIHRoaXMgeWVhciBzdHJpbmcgaW4gZmlsZVxuICAgICAgICAgIC8vIE5PVEU6IFdlIGRvbuKAmXQgdXNlIGFkZE5vdGljZVBhcnRpYWwsIGJlY2F1c2UgaXQgYWRkcyBhIG1pc2xlYWRpbmcgQm9va0lEXG4gICAgICAgICAgY2hlY2tCb29rUGFja2FnZVJlc3VsdC5ub3RpY2VMaXN0LnB1c2goeyBwcmlvcml0eTogMjU2LCBtZXNzYWdlOiBcIlBvc3NpYmx5IG1pc3NpbmcgY3VycmVudCBjb3B5cmlnaHQgeWVhclwiLCBkZXRhaWxzOiBgcG9zc2libHkgZXhwZWN0aW5nICcke2Z1bGxZZWFyU3RyaW5nfSdgLCB1c2VybmFtZSwgcmVwb05hbWUsIGZpbGVuYW1lLCBsb2NhdGlvbjogbWFya2Rvd25Mb2NhdGlvbiwgZXh0cmE6IHJlcG9Db2RlIH0pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbWFya2Rvd25GaWxlQ29udGVudC5sZW5ndGg7XG4gICAgfVxuICAgIC8vIE5PVEU6IFdlIGRvbuKAmXQgdXNlIGFkZE5vdGljZVBhcnRpYWwsIGJlY2F1c2UgaXQgYWRkcyBhIG1pc2xlYWRpbmcgQm9va0lEXG4gICAgLy8gYWRkTm90aWNlUGFydGlhbCh7IHByaW9yaXR5OiA5NTYsIG1lc3NhZ2U6IFwiR290IGVtcHR5IG1hcmtkb3duIGZpbGVcIiwgcmVwb05hbWUsIGZpbGVuYW1lLCBsb2NhdGlvbjogbWFya2Rvd25Mb2NhdGlvbiwgZXh0cmE6IGAke3JlcG9Db2RlfSBtYXJrZG93bmAgfSk7XG4gICAgY2hlY2tCb29rUGFja2FnZVJlc3VsdC5ub3RpY2VMaXN0LnB1c2goeyBwcmlvcml0eTogOTU2LCBtZXNzYWdlOiBcIkdvdCBlbXB0eSBtYXJrZG93biBmaWxlXCIsIHJlcG9OYW1lLCBmaWxlbmFtZSwgbG9jYXRpb246IG1hcmtkb3duTG9jYXRpb24sIGV4dHJhOiByZXBvQ29kZSB9KTtcbiAgICByZXR1cm4gMDtcbiAgfVxuICAvLyBlbmQgb2Ygb3VyQ2hlY2tNYXJrZG93bkZpbGUgZnVuY3Rpb25cblxuXG4gIC8vIE1haW4gY29kZSBmb3IgY2hlY2tCb29rUGFja2FnZSgpXG4gIC8vIE5PVEU6IFROIGFuZCBUUSBhcmUgdXNlZCBoZXJlIGZvciB0aGUgb2xkIHJlc291cmNlIGZvcm1hdHMsIGUuZy4sIDktY29sdW1uIFRTViBUTjIgYW5kIG1hcmtkb3duIFRRMlxuICAvLyAgICAgICAgVGhlIFROMiwgVFEyLCBTTiwgYW5kIGlmIChsaW5rQm9va0NvZGUubGVuZ3RoKSByZXBvQ29kZXMgcmVmZXIgdG8gdGhlIG5ldyA3LWNvbHVtbiBub3RlcyBUU1YgZm9ybWF0LlxuICAvLyBkZWJ1Z0xvZyhcImNoZWNrQm9va1BhY2thZ2UoKSBtYWluIGNvZGXigKZcIik7XG4gIGxldCByZXBvQ29kZUxpc3Q7XG4gIGxldCBib29rTnVtYmVyQW5kTmFtZSwgd2hpY2hUZXN0YW1lbnQ7XG4gIGlmIChib29rSUQgPT09ICdPQlMnKSB7XG4gICAgLy8gTk9URTogTm8gY29kZSBiZWxvdyB0byBoYW5kbGUgT0JTIFROIGFuZCBUUSB3aGljaCBhcmUgbWFya2Rvd24gcmVwb3NcbiAgICBpZiAoZGF0YVNldCA9PT0gJ0RFRkFVTFQnKVxuICAgICAgcmVwb0NvZGVMaXN0ID0gWydPQlMnLCAnT0JTLVRXTCcsICdPQlMtVE4yJywgJ09CUy1UUTInLCAnT0JTLVNOMicsICdPQlMtU1EyJ107XG4gICAgZWxzZSBpZiAoZGF0YVNldCA9PT0gJ09MRCcpXG4gICAgICByZXBvQ29kZUxpc3QgPSBbJ09CUycsICdPQlMtVE4nLCAnT0JTLVRRJywgJ09CUy1TTicsICdPQlMtU1EnXTtcbiAgICBlbHNlIGlmIChkYXRhU2V0ID09PSAnTkVXJylcbiAgICAgIHJlcG9Db2RlTGlzdCA9IFsnT0JTJywgJ09CUy1UV0wnLCAnT0JTLVROMicsICdPQlMtVFEyJywgJ09CUy1TTjInLCAnT0JTLVNRMiddO1xuICAgIGVsc2UgaWYgKGRhdGFTZXQgPT09ICdCT1RIJylcbiAgICAgIHJlcG9Db2RlTGlzdCA9IFsnT0JTJywgJ09CUy1UV0wnLCAnT0JTLVROJywgJ09CUy1UTjInLCAnT0JTLVRRJywgJ09CUy1UUTInLCAnT0JTLVNOJywgJ09CUy1TTicsICdPQlMtU04yJywgJ09CUy1TUTInXTtcbiAgfSBlbHNlIHsgLy8gbm90IE9CU1xuICAgIC8vIFdlIGFsc28gbmVlZCB0byBrbm93IHRoZSBudW1iZXIgZm9yIFVTRk0gYm9va3NcbiAgICB0cnkge1xuICAgICAgYm9va051bWJlckFuZE5hbWUgPSBib29rcy51c2ZtTnVtYmVyTmFtZShib29rSUQpO1xuICAgICAgd2hpY2hUZXN0YW1lbnQgPSBib29rcy50ZXN0YW1lbnQoYm9va0lEKTsgLy8gcmV0dXJucyAnb2xkJyBvciAnbmV3J1xuICAgIH0gY2F0Y2ggKGJOTmVycm9yKSB7XG4gICAgICBpZiAoYm9va3MuaXNWYWxpZEJvb2tJRChib29rSUQpKSAvLyBtdXN0IGJlIGluIEZSVCwgQkFLLCBldGMuXG4gICAgICAgIHdoaWNoVGVzdGFtZW50ID0gJ290aGVyJ1xuICAgICAgZWxzZSB7XG4gICAgICAgIGFkZE5vdGljZVBhcnRpYWwoeyBwcmlvcml0eTogOTAyLCBtZXNzYWdlOiBcIkJhZCBmdW5jdGlvbiBjYWxsOiBzaG91bGQgYmUgZ2l2ZW4gYSB2YWxpZCBib29rIGFiYnJldmlhdGlvblwiLCBleGNlcnB0OiBib29rSUQsIGxvY2F0aW9uOiBgIChub3QgJyR7Ym9va0lEfScpJHtnZW5lcmFsTG9jYXRpb259YCB9KTsgcmV0dXJuIGNoZWNrQm9va1BhY2thZ2VSZXN1bHQ7XG4gICAgICB9XG4gICAgfVxuICAgIC8vIGRlYnVnTG9nKGBjaGVja0Jvb2tQYWNrYWdlOiBib29rTnVtYmVyQW5kTmFtZT0nJHtib29rTnVtYmVyQW5kTmFtZX0nICgke3doaWNoVGVzdGFtZW50fSB0ZXN0YW1lbnQpYCk7XG5cbiAgICAvLyBTbyBub3cgd2Ugd2FudCB0byB3b3JrIHRocm91Z2ggY2hlY2tpbmcgdGhpcyBvbmUgc3BlY2lmaWVkIEJpYmxlIGJvb2sgaW4gdmFyaW91cyByZXBvc1xuICAgIGNvbnN0IG9yaWdMYW5nUmVwb0NvZGUgPSB3aGljaFRlc3RhbWVudCA9PT0gJ29sZCcgPyAnVUhCJyA6ICdVR05UJztcbiAgICBpZiAoZGF0YVNldCA9PT0gJ0RFRkFVTFQnKVxuICAgICAgcmVwb0NvZGVMaXN0ID0gbGFuZ3VhZ2VDb2RlID09PSAnZW4nID8gW29yaWdMYW5nUmVwb0NvZGUsICdUV0wnLCAnTFQnLCAnU1QnLCAnVE4nLCAnVFEnLCAnU04nLCAnU1EnXSA6IFtvcmlnTGFuZ1JlcG9Db2RlLCAnTFQnLCAnU1QnLCAnVE4nLCAnVFEnXTtcbiAgICBlbHNlIGlmIChkYXRhU2V0ID09PSAnT0xEJylcbiAgICAgIHJlcG9Db2RlTGlzdCA9IGxhbmd1YWdlQ29kZSA9PT0gJ2VuJyA/IFtvcmlnTGFuZ1JlcG9Db2RlLCAnVFdMJywgJ0xUJywgJ1NUJywgJ1ROJywgJ1RRJ10gOiBbb3JpZ0xhbmdSZXBvQ29kZSwgJ0xUJywgJ1NUJywgJ1ROJywgJ1RRJ107XG4gICAgZWxzZSBpZiAoZGF0YVNldCA9PT0gJ05FVycpXG4gICAgICByZXBvQ29kZUxpc3QgPSBsYW5ndWFnZUNvZGUgPT09ICdlbicgPyBbb3JpZ0xhbmdSZXBvQ29kZSwgJ1RXTCcsICdMVCcsICdTVCcsICdUTjInLCAnVFEyJywgJ1NOJywgJ1NRJ10gOiBbb3JpZ0xhbmdSZXBvQ29kZSwgJ0xUJywgJ1NUJywgJ1ROJywgJ1RRJ107XG4gICAgZWxzZSBpZiAoZGF0YVNldCA9PT0gJ0JPVEgnKVxuICAgICAgcmVwb0NvZGVMaXN0ID0gbGFuZ3VhZ2VDb2RlID09PSAnZW4nID8gW29yaWdMYW5nUmVwb0NvZGUsICdUV0wnLCAnTFQnLCAnU1QnLCAnVE4yJywgJ1ROJywgJ1RRMicsICdUUScsICdTTicsICdTUSddIDogW29yaWdMYW5nUmVwb0NvZGUsICdMVCcsICdTVCcsICdUTicsICdUUSddO1xuICB9XG5cblxuICAvLyBNYWluIGxvb3AgZm9yIGNoZWNrQm9va1BhY2thZ2UoKVxuICBjb25zdCBjaGVja2VkTWFuaWZlc3REZXRhaWxzID0gW107XG4gIGxldCBudW1DaGVja2VkUmVwb3MgPSAwO1xuICBmb3IgKGNvbnN0IHJlcG9Db2RlIG9mIHJlcG9Db2RlTGlzdCkge1xuICAgIC8vIGRlYnVnTG9nKGBjaGVja0Jvb2tQYWNrYWdlIGZvciAke2Jvb2tJRH0gZ290IHJlcG9Db2RlPSR7cmVwb0NvZGV9IGFib3J0RmxhZz0ke2Fib3J0RmxhZ30gZnJvbSAke3JlcG9Db2RlTGlzdH1gKTtcbiAgICBpZiAoYWJvcnRGbGFnKSBicmVhaztcbiAgICBsZXQgYWRqdXN0ZWRSZXBvQ29kZSA9IHJlcG9Db2RlLCBhZGp1c3RlZEJyYW5jaCA9IG9yaWdpbmFsQnJhbmNoO1xuICAgIGlmIChhZGp1c3RlZFJlcG9Db2RlLmVuZHNXaXRoKCcyJykpIHtcbiAgICAgIGFkanVzdGVkUmVwb0NvZGUgPSBhZGp1c3RlZFJlcG9Db2RlLnN1YnN0cmluZygwLCBhZGp1c3RlZFJlcG9Db2RlLmxlbmd0aCAtIDEpOyAvLyBSZW1vdmUgdGhlICcyJyBmcm9tIHRoZSBlbmRcbiAgICAgIGFkanVzdGVkQnJhbmNoID0gJ25ld0Zvcm1hdCc7XG4gICAgICBnZW5lcmFsTG9jYXRpb24gPSBnZW5lcmFsTG9jYXRpb24ucmVwbGFjZShvcmlnaW5hbEJyYW5jaCwgYWRqdXN0ZWRCcmFuY2gpO1xuICAgIH0gZWxzZSAvLyBkb2Vzbid0IGVuZCB3aXRoIDJcbiAgICAgIGdlbmVyYWxMb2NhdGlvbiA9IGdlbmVyYWxMb2NhdGlvbi5yZXBsYWNlKGFkanVzdGVkQnJhbmNoLCBvcmlnaW5hbEJyYW5jaCk7XG4gICAgbGV0IHJlcG9OYW1lID0gZm9ybVJlcG9OYW1lKGxhbmd1YWdlQ29kZSwgYWRqdXN0ZWRSZXBvQ29kZSk7XG4gICAgY29uc3QgcmVwb0xvY2F0aW9uID0gYCBpbiAke3JlcG9Db2RlfSR7Z2VuZXJhbExvY2F0aW9ufWA7XG4gICAgaWYgKGFkanVzdGVkUmVwb0NvZGUuc3RhcnRzV2l0aCgnT0JTLScpKVxuICAgICAgYWRqdXN0ZWRSZXBvQ29kZSA9IGFkanVzdGVkUmVwb0NvZGUuc3Vic3RyaW5nKDQpOyAvLyBSZW1vdmUgdGhlICdPQlMtJyBmcm9tIHRoZSBiZWdpbm5pbmdcbiAgICAvLyBpZiAoYm9va0lEID09PSAnT0JTJyAmJiBkYXRhU2V0ID09PSAnT0xEJyAmJiByZXBvQ29kZSAhPT0gJ09CUycgJiYgcmVwb0NvZGUgIT09ICdUV0wnICYmIHJlcG9OYW1lID09PSBgJHtsYW5ndWFnZUNvZGV9XyR7YWRqdXN0ZWRSZXBvQ29kZS50b0xvd2VyQ2FzZSgpfWApXG4gICAgLy8gICByZXBvTmFtZSA9IGAke2xhbmd1YWdlQ29kZX1fb2JzLSR7YWRqdXN0ZWRSZXBvQ29kZS50b0xvd2VyQ2FzZSgpfWA7XG4gICAgdXNlckxvZyhgY2hlY2tCb29rUGFja2FnZTogY2hlY2sgJHtsYW5ndWFnZUNvZGV9ICR7Ym9va0lEfSBpbiAke3JlcG9Db2RlfSAoJHthZGp1c3RlZFJlcG9Db2RlfSkgZnJvbSAke3VzZXJuYW1lfSAke3JlcG9OYW1lfSAke2FkanVzdGVkQnJhbmNofeKApmApO1xuXG4gICAgLy8gVXBkYXRlIG91ciBcIndhaXRpbmdcIiBtZXNzYWdlXG4gICAgc2V0UmVzdWx0VmFsdWUoPHAgc3R5bGU9e3sgY29sb3I6ICdtYWdlbnRhJyB9fT5DaGVja2luZyA8aT57dXNlcm5hbWV9PC9pPiB7bGFuZ3VhZ2VDb2RlfSA8Yj57Ym9va0lEfTwvYj4gYm9vayBwYWNrYWdlIGluIDxiPntyZXBvQ29kZX08L2I+IChjaGVja2VkIDxiPntudW1DaGVja2VkUmVwb3N9PC9iPi97cmVwb0NvZGVMaXN0Lmxlbmd0aH0gcmVwb3Mp4oCmPC9wPik7XG5cbiAgICBsZXQgZmlsZW5hbWU7XG4gICAgaWYgKHJlcG9Db2RlID09PSAnVUhCJyB8fCByZXBvQ29kZSA9PT0gJ1VHTlQnIHx8IHJlcG9Db2RlID09PSAnTFQnIHx8IHJlcG9Db2RlID09PSAnU1QnKVxuICAgICAgLy8gVE9ETzogTWlnaHQgd2UgbmVlZCBzcGVjaWZpYyByZWxlYXNlcy90YWdzIGZvciBzb21lIG9mIHRoZXNlIChlLmcuLCBmcm9tIHRoZSBUTjIgbWFuaWZlc3QpPz8/XG4gICAgICAvLyBUT0RPOiBEbyB3ZSBuZWVkIHRvIGhhcmQtY29kZSB3aGVyZSB0byBmaW5kIHRoZSBVSEIgYW5kIFVHTlQ/Pz9cbiAgICAgIGZpbGVuYW1lID0gYCR7Ym9va051bWJlckFuZE5hbWV9LnVzZm1gO1xuICAgIGVsc2UgaWYgKGFkanVzdGVkUmVwb0NvZGUgPT09ICdUV0wnIHx8IHJlcG9Db2RlLmVuZHNXaXRoKCdUTjInKSB8fCByZXBvQ29kZS5lbmRzV2l0aCgnVFEyJykpXG4gICAgICBmaWxlbmFtZSA9IGAke2FkanVzdGVkUmVwb0NvZGUudG9Mb3dlckNhc2UoKX1fJHtib29rSUR9LnRzdmBcbiAgICBlbHNlIGlmIChhZGp1c3RlZFJlcG9Db2RlID09PSAnU04nIHx8IGFkanVzdGVkUmVwb0NvZGUgPT09ICdTUScpXG4gICAgICBmaWxlbmFtZSA9IGAke2FkanVzdGVkUmVwb0NvZGUudG9Mb3dlckNhc2UoKX1fJHtib29rSUR9LnRzdmBcbiAgICBlbHNlIGlmIChhZGp1c3RlZFJlcG9Db2RlID09PSAnVE4nICYmICFyZXBvQ29kZS5zdGFydHNXaXRoKCdPQlMtJykpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGZpbGVuYW1lID0gYXdhaXQgY2FjaGVkR2V0Qm9va0ZpbGVuYW1lRnJvbU1hbmlmZXN0KHsgdXNlcm5hbWUsIHJlcG9zaXRvcnk6IHJlcG9OYW1lLCBicmFuY2g6IG9yaWdpbmFsQnJhbmNoLCBib29rSUQ6IGJvb2tJRC50b0xvd2VyQ2FzZSgpIH0pO1xuICAgICAgICBsb2dpY0Fzc2VydChmaWxlbmFtZS5zdGFydHNXaXRoKGAke2xhbmd1YWdlQ29kZX1fYCksIGBFeHBlY3RlZCBUTiBmaWxlbmFtZSAnJHtmaWxlbmFtZX0nIHRvIHN0YXJ0IHdpdGggdGhlIGxhbmd1YWdlIGNvZGUgJyR7bGFuZ3VhZ2VDb2RlfV8nYCk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIC8vIGNvbnNvbGUuZXJyb3IoYGNhY2hlZEdldEJvb2tGaWxlbmFtZUZyb21NYW5pZmVzdCBmYWlsZWQgd2l0aDogJHtlfWApO1xuICAgICAgICBmaWxlbmFtZSA9IGAke2xhbmd1YWdlQ29kZX1fdG5fJHtib29rTnVtYmVyQW5kTmFtZX0udHN2YDsgLy8gVGFrZSBhIGd1ZXNzXG4gICAgICB9XG4gICAgICBsb2dpY0Fzc2VydChmaWxlbmFtZS5lbmRzV2l0aCgnLnRzdicpLCBgRXhwZWN0ZWQgVE4gZmlsZW5hbWUgJyR7ZmlsZW5hbWV9JyB0byBlbmQgd2l0aCAnLnRzdidgKTtcbiAgICB9XG5cbiAgICBpZiAocmVwb0NvZGUgPT09ICdPQlMnKSB7XG4gICAgICAvLyBkZWJ1Z0xvZyhcIkNhbGxpbmcgT0JTIGNoZWNrUmVwbygp4oCmXCIpO1xuICAgICAgY29uc3QgY3JSZXN1bHRPYmplY3QgPSBhd2FpdCBjaGVja1JlcG8odXNlcm5hbWUsIGAke2xhbmd1YWdlQ29kZX1fb2JzYCwgb3JpZ2luYWxCcmFuY2gsIGdlbmVyYWxMb2NhdGlvbiwgc2V0UmVzdWx0VmFsdWUsIG5ld0NoZWNraW5nT3B0aW9ucyk7IC8vIEFkZHMgdGhlIG5vdGljZXMgdG8gY2hlY2tCb29rUGFja2FnZVJlc3VsdFxuICAgICAgLy8gZGVidWdMb2coYGNoZWNrUmVwbygnT0JTJykgcmV0dXJuZWQgJHtjclJlc3VsdE9iamVjdC5zdWNjZXNzTGlzdC5sZW5ndGh9IHN1Y2Nlc3MgbWVzc2FnZShzKSBhbmQgJHtjclJlc3VsdE9iamVjdC5ub3RpY2VMaXN0Lmxlbmd0aH0gbm90aWNlKHMpYCk7XG4gICAgICAvLyBkZWJ1Z0xvZyhgY3JSZXN1bHRPYmplY3Qga2V5czogJHtKU09OLnN0cmluZ2lmeShPYmplY3Qua2V5cyhjclJlc3VsdE9iamVjdCkpfWApO1xuICAgICAgLy8gZGVidWdMb2coYGNyUmVzdWx0T2JqZWN0IGNoZWNrZWRSZXBvTmFtZXM6ICR7Y3JSZXN1bHRPYmplY3QuY2hlY2tlZFJlcG9OYW1lc31gKTtcbiAgICAgIGNoZWNrQm9va1BhY2thZ2VSZXN1bHQuc3VjY2Vzc0xpc3QgPSBjaGVja0Jvb2tQYWNrYWdlUmVzdWx0LnN1Y2Nlc3NMaXN0LmNvbmNhdChjclJlc3VsdE9iamVjdC5zdWNjZXNzTGlzdCk7XG4gICAgICBjaGVja0Jvb2tQYWNrYWdlUmVzdWx0Lm5vdGljZUxpc3QgPSBjaGVja0Jvb2tQYWNrYWdlUmVzdWx0Lm5vdGljZUxpc3QuY29uY2F0KGNyUmVzdWx0T2JqZWN0Lm5vdGljZUxpc3QpO1xuICAgICAgaWYgKGNyUmVzdWx0T2JqZWN0LmNoZWNrZWRGaWxlQ291bnQgPiAwKSB7XG4gICAgICAgIGNoZWNrZWRGaWxlbmFtZXMgPSBjaGVja2VkRmlsZW5hbWVzLmNvbmNhdChjclJlc3VsdE9iamVjdC5jaGVja2VkRmlsZW5hbWVzKTtcbiAgICAgICAgY2hlY2tlZEZpbGVuYW1lRXh0ZW5zaW9ucyA9IG5ldyBTZXQoWy4uLmNoZWNrZWRGaWxlbmFtZUV4dGVuc2lvbnMsIC4uLmNyUmVzdWx0T2JqZWN0LmNoZWNrZWRGaWxlbmFtZUV4dGVuc2lvbnNdKTtcbiAgICAgICAgY2hlY2tlZEZpbGVDb3VudCArPSBjclJlc3VsdE9iamVjdC5jaGVja2VkRmlsZUNvdW50O1xuICAgICAgICB0b3RhbENoZWNrZWRTaXplICs9IGNyUmVzdWx0T2JqZWN0LnRvdGFsQ2hlY2tlZFNpemU7XG4gICAgICAgIGNoZWNrZWRSZXBvTmFtZXMuYWRkKHJlcG9OYW1lKTtcbiAgICAgIH1cbiAgICAgIGFkZFN1Y2Nlc3NNZXNzYWdlKGBDaGVja2VkICR7bGFuZ3VhZ2VDb2RlfSBPQlMgcmVwbyBmcm9tICR7dXNlcm5hbWV9YCk7XG4gICAgfSBlbHNlIGlmIChyZXBvQ29kZSA9PT0gJ1RRJyB8fCByZXBvQ29kZSA9PT0gJ09CUy1UTid8fCByZXBvQ29kZSA9PT0gJ09CUy1UUScpIHsgLy8gVGhlc2UgYXJlIHN0aWxsIG1hcmtkb3duIGZvciBub3dcbiAgICAgIC8vIFRoaXMgaXMgdGhlIG9sZCBtYXJrZG93biByZXNvdXJjZSB3aXRoIGh1bmRyZWRzL3Rob3VzYW5kcyBvZiBmaWxlc1xuICAgICAgY29uc3QgdHFSZXN1bHRPYmplY3QgPSBhd2FpdCBjaGVja1RRTWFya2Rvd25Cb29rKHVzZXJuYW1lLCBsYW5ndWFnZUNvZGUsIHJlcG9Db2RlLCByZXBvTmFtZSwgb3JpZ2luYWxCcmFuY2gsIGJvb2tJRCwgbmV3Q2hlY2tpbmdPcHRpb25zKTtcbiAgICAgIGNoZWNrQm9va1BhY2thZ2VSZXN1bHQuc3VjY2Vzc0xpc3QgPSBjaGVja0Jvb2tQYWNrYWdlUmVzdWx0LnN1Y2Nlc3NMaXN0LmNvbmNhdCh0cVJlc3VsdE9iamVjdC5zdWNjZXNzTGlzdCk7XG4gICAgICBjaGVja0Jvb2tQYWNrYWdlUmVzdWx0Lm5vdGljZUxpc3QgPSBjaGVja0Jvb2tQYWNrYWdlUmVzdWx0Lm5vdGljZUxpc3QuY29uY2F0KHRxUmVzdWx0T2JqZWN0Lm5vdGljZUxpc3QpO1xuICAgICAgaWYgKHRxUmVzdWx0T2JqZWN0LmNoZWNrZWRGaWxlQ291bnQgPiAwKSB7XG4gICAgICAgIGNoZWNrZWRGaWxlbmFtZXMgPSBjaGVja2VkRmlsZW5hbWVzLmNvbmNhdCh0cVJlc3VsdE9iamVjdC5jaGVja2VkRmlsZW5hbWVzKTtcbiAgICAgICAgY2hlY2tlZEZpbGVuYW1lRXh0ZW5zaW9ucyA9IG5ldyBTZXQoWy4uLmNoZWNrZWRGaWxlbmFtZUV4dGVuc2lvbnMsIC4uLnRxUmVzdWx0T2JqZWN0LmNoZWNrZWRGaWxlbmFtZUV4dGVuc2lvbnNdKTtcbiAgICAgICAgY2hlY2tlZEZpbGVDb3VudCArPSB0cVJlc3VsdE9iamVjdC5jaGVja2VkRmlsZUNvdW50O1xuICAgICAgICB0b3RhbENoZWNrZWRTaXplICs9IHRxUmVzdWx0T2JqZWN0LnRvdGFsQ2hlY2tlZFNpemU7XG4gICAgICAgIGNoZWNrZWRSZXBvTmFtZXMuYWRkKHJlcG9OYW1lKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgeyAvLyBGb3IgcmVwb3Mgb3RoZXIgdGhhbiBPQlMgYW5kIFRRLCB3ZSBvbmx5IGhhdmUgb25lIGZpbGUgdG8gY2hlY2tcbiAgICAgIGxvZ2ljQXNzZXJ0KGZpbGVuYW1lPy5sZW5ndGgsIGBmaWxlbmFtZSBzaG91bGQgYmUgc2V0IGJ5IG5vdyBmb3IgdW49JHt1c2VybmFtZX0gckM9JHtyZXBvQ29kZX0gYVJDPSR7YWRqdXN0ZWRSZXBvQ29kZX0gck49JHtyZXBvTmFtZX0gYUJyPSR7YWRqdXN0ZWRCcmFuY2h9YCk7XG4gICAgICBsZXQgcmVwb0ZpbGVDb250ZW50O1xuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gZGVidWdMb2coYGNoZWNrQm9va1BhY2thZ2UgYWJvdXQgdG8gZmV0Y2ggZmlsZUNvbnRlbnQgZm9yICR7dXNlcm5hbWV9LCAke3JlcG9OYW1lfSwgJHthZGp1c3RlZEJyYW5jaH0sICR7ZmlsZW5hbWV9YCk7XG4gICAgICAgIHJlcG9GaWxlQ29udGVudCA9IGF3YWl0IGdldEZpbGVfKHsgdXNlcm5hbWUsIHJlcG9zaXRvcnk6IHJlcG9OYW1lLCBwYXRoOiBmaWxlbmFtZSwgYnJhbmNoOiBhZGp1c3RlZEJyYW5jaCB9KTtcbiAgICAgICAgLy8gZGVidWdMb2coYGNoZWNrQm9va1BhY2thZ2UgZmV0Y2hlZCBmaWxlQ29udGVudCBmb3IgJHt1c2VybmFtZX0sICR7cmVwb05hbWV9LCAke2FkanVzdGVkQnJhbmNofSwgJHtmaWxlbmFtZX0sICR7dHlwZW9mIHJlcG9GaWxlQ29udGVudH0sICR7cmVwb0ZpbGVDb250ZW50Lmxlbmd0aH1gKTtcbiAgICAgICAgY2hlY2tlZEZpbGVuYW1lcy5wdXNoKGZpbGVuYW1lKTtcbiAgICAgICAgdG90YWxDaGVja2VkU2l6ZSArPSByZXBvRmlsZUNvbnRlbnQubGVuZ3RoO1xuICAgICAgICBjaGVja2VkUmVwb05hbWVzLmFkZChyZXBvTmFtZSk7XG4gICAgICB9IGNhdGNoIChjQlBnZkVycm9yKSB7XG4gICAgICAgIC8vIGRlYnVnTG9nKGBjaGVja0Jvb2tQYWNrYWdlKCR7dXNlcm5hbWV9LCAke2xhbmd1YWdlQ29kZX0sICR7Ym9va0lEfSwgKGZuKSwgJHtKU09OLnN0cmluZ2lmeShjaGVja2luZ09wdGlvbnMpfSkgZmFpbGVkIHRvIGxvYWQgJHtyZXBvTmFtZX0sICR7ZmlsZW5hbWV9LCAke2FkanVzdGVkQnJhbmNofSwgJHtjQlBnZkVycm9yfWApO1xuICAgICAgICAvLyBkZWJ1Z0xvZyhgY0JQZ2ZFcnJvcj0ke2NCUGdmRXJyb3J9IG9yICR7SlNPTi5zdHJpbmdpZnkoY0JQZ2ZFcnJvcil9IG9yMiAke2NCUGdmRXJyb3IgPT09ICdUeXBlRXJyb3I6IHJlcG9GaWxlQ29udGVudCBpcyBudWxsJ30gb3IzICR7Y0JQZ2ZFcnJvci5tZXNzYWdlID09PSAnVHlwZUVycm9yOiByZXBvRmlsZUNvbnRlbnQgaXMgbnVsbCd9IG9yNCAke2NCUGdmRXJyb3IubWVzc2FnZSA9PT0gJ1R5cGVFcnJvcjogcmVwb0ZpbGVDb250ZW50IGlzIG51bGwnfWApO1xuICAgICAgICBsZXQgZGV0YWlscyA9IGB1c2VybmFtZT0ke3VzZXJuYW1lfWA7XG4gICAgICAgIC8vIE5leHQgbGluZSBoYXMgc3BlY2lhbCBjb2RlIHRvIGhhbmRsZSBib29rLXBhY2thZ2UtY2hlY2sudGVzdC5qcyB0ZXN0cyBbc28gd2UgZG9uJ3QgY2FsbCByZXBvc2l0b3J5RXhpc3RzT25Eb29yNDMoKV1cbiAgICAgICAgaWYgKChjQlBnZkVycm9yICsgJycpLnN0YXJ0c1dpdGgoJ1Rlc3RzIGNvdWxkIG5vdCBmaW5kJykgfHwgISBhd2FpdCByZXBvc2l0b3J5RXhpc3RzT25Eb29yNDMoeyB1c2VybmFtZSwgcmVwb3NpdG9yeTogcmVwb05hbWUgfSkpXG4gICAgICAgICAgY2hlY2tCb29rUGFja2FnZVJlc3VsdC5ub3RpY2VMaXN0LnB1c2goeyBwcmlvcml0eTogOTk3LCBtZXNzYWdlOiBcIlJlcG9zaXRvcnkgZG9lc27igJl0IGV4aXN0XCIsIGRldGFpbHMsIHVzZXJuYW1lLCByZXBvQ29kZSwgcmVwb05hbWUsIGxvY2F0aW9uOiByZXBvTG9jYXRpb24sIGV4dHJhOiByZXBvQ29kZSB9KTtcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGVxZXFlcVxuICAgICAgICAgIGlmIChjQlBnZkVycm9yICE9ICdUeXBlRXJyb3I6IHJlcG9GaWxlQ29udGVudCBpcyBudWxsJykgZGV0YWlscyArPSBgIGVycm9yPSR7Y0JQZ2ZFcnJvcn1gO1xuICAgICAgICAgIGFkZE5vdGljZVBhcnRpYWwoeyBwcmlvcml0eTogcmVwb0NvZGUgPT09ICdTTicgfHwgcmVwb0NvZGUgPT09ICdTUScgPyAxOTYgOiA5OTYsIG1lc3NhZ2U6IFwiVW5hYmxlIHRvIGxvYWRcIiwgZGV0YWlscywgcmVwb0NvZGUsIHJlcG9OYW1lLCBmaWxlbmFtZSwgbG9jYXRpb246IHJlcG9Mb2NhdGlvbiwgZXh0cmE6IHJlcG9Db2RlIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAocmVwb0ZpbGVDb250ZW50KSB7XG4gICAgICAgIC8vIFdlIHVzZSB0aGUgZ2VuZXJhbExvY2F0aW9uIGhlcmUgKGRvZXMgbm90IGluY2x1ZGUgcmVwbyBuYW1lKVxuICAgICAgICAvLyAgc28gdGhhdCB3ZSBjYW4gYWRqdXN0IHRoZSByZXR1cm5lZCBzdHJpbmdzIG91cnNlbHZlc1xuICAgICAgICBhd2FpdCBvdXJDaGVja0JQRmlsZUNvbnRlbnRzKHJlcG9Db2RlLCByZXBvTmFtZSwgYWRqdXN0ZWRCcmFuY2gsIGZpbGVuYW1lLCByZXBvRmlsZUNvbnRlbnQsIGdlbmVyYWxMb2NhdGlvbiwgbmV3Q2hlY2tpbmdPcHRpb25zKTsgLy8gQWRkcyB0aGUgbm90aWNlcyB0byBjaGVja0Jvb2tQYWNrYWdlUmVzdWx0XG4gICAgICAgIGNoZWNrZWRGaWxlQ291bnQgKz0gMTtcbiAgICAgICAgY2hlY2tlZEZpbGVuYW1lRXh0ZW5zaW9ucy5hZGQoZmlsZW5hbWUuc3BsaXQoJy4nKS5wb3AoKSk7XG4gICAgICAgIGFkZFN1Y2Nlc3NNZXNzYWdlKGBDaGVja2VkICR7cmVwb0NvZGUudG9VcHBlckNhc2UoKX0gZmlsZTogJHtmaWxlbmFtZX1gKTtcbiAgICAgIH1cbiAgICB9IC8vIGVuZCBvZiByZXBvIHRoYXQncyBub3QgT0JTIG9yIFRRXG5cbiAgICBpZiAoIW5ld0NoZWNraW5nT3B0aW9ucz8uZGlzYWJsZUFsbExpbmtGZXRjaGluZ0ZsYWcpIHtcbiAgICAgIC8vIFdlIGFsc28gY2hlY2sgdGhlIG1hbmlmZXN0IGZpbGUgZm9yIGVhY2ggcmVwbyBpZiByZXF1ZXN0ZWRcbiAgICAgIC8vICBiZWNhdXNlIGEgZmF1bHR5IG1hbmlmZXN0IG1pZ2h0IGFsc28gc3RvcCBhIEJQIGZyb20gd29ya2luZyBjb3JyZWN0bHkgaW4gdmFyaW91cyBwcm9ncmFtc1xuICAgICAgaWYgKCFjaGVja2VkTWFuaWZlc3REZXRhaWxzLmluY2x1ZGVzKHJlcG9OYW1lKSkgeyAvLyBEb27igJl0IHdhbnQgdG8gY2hlY2sgbW9yZSB0aGFuIG9uY2VcbiAgICAgICAgY2hlY2tlZE1hbmlmZXN0RGV0YWlscy5wdXNoKHJlcG9OYW1lKTsgLy8gUmVtZW1iZXIgdGhhdCB3ZSBjaGVja2VkIHRoaXMgb25lXG4gICAgICAgIC8vIGRlYnVnTG9nKGBNYXliZSBjaGVja2luZyBNQU5JRkVTVCBldGMuIGZvciAke3JlcG9OYW1lfWApO1xuXG4gICAgICAgIGlmIChuZXdDaGVja2luZ09wdGlvbnM/LmNoZWNrTWFuaWZlc3RGbGFnKSB7XG4gICAgICAgICAgLy8gZGVidWdMb2coYGNoZWNrQm9va1BhY2thZ2U6IGNoZWNraW5nIE1BTklGRVNUIGZvciAke3JlcG9OYW1lfWApO1xuICAgICAgICAgIGNvbnN0IG51bUNoZWNrZWRDaGFyYWN0ZXJzID0gYXdhaXQgb3VyQ2hlY2tNYW5pZmVzdEZpbGUocmVwb0NvZGUsIHJlcG9OYW1lLCBhZGp1c3RlZEJyYW5jaCwgZ2VuZXJhbExvY2F0aW9uLCBuZXdDaGVja2luZ09wdGlvbnMpO1xuICAgICAgICAgIGlmIChudW1DaGVja2VkQ2hhcmFjdGVycyA+IDApIHtcbiAgICAgICAgICAgIGNoZWNrZWRGaWxlQ291bnQgKz0gMTtcbiAgICAgICAgICAgIGNoZWNrZWRGaWxlbmFtZXMucHVzaCgnbWFuaWZlc3QueWFtbCcpO1xuICAgICAgICAgICAgY2hlY2tlZEZpbGVuYW1lRXh0ZW5zaW9ucy5hZGQoJ3lhbWwnKTtcbiAgICAgICAgICAgIHRvdGFsQ2hlY2tlZFNpemUgKz0gbnVtQ2hlY2tlZENoYXJhY3RlcnM7XG4gICAgICAgICAgICBhZGRTdWNjZXNzTWVzc2FnZShgQ2hlY2tlZCAke3JlcG9OYW1lfSBtYW5pZmVzdCBmaWxlYCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIGVsc2UgZGVidWdMb2coYE5PVCBjaGVja2luZyBNQU5JRkVTVCBmb3IgJHtyZXBvTmFtZX1gKTtcblxuICAgICAgICAvLyBXZSBjYW4gYWxzbyBjaGVjayB0aGUgUkVBRE1FIGZpbGUgZm9yIGVhY2ggcmVwbyBpZiByZXF1ZXN0ZWRcbiAgICAgICAgaWYgKG5ld0NoZWNraW5nT3B0aW9ucz8uY2hlY2tSZWFkbWVGbGFnKSB7XG4gICAgICAgICAgLy8gZGVidWdMb2coYGNoZWNrQm9va1BhY2thZ2U6IGNoZWNraW5nIFJFQURNRSBmb3IgJHtyZXBvTmFtZX1gKTtcbiAgICAgICAgICBjb25zdCBmaWxlbmFtZSA9ICdSRUFETUUubWQnO1xuICAgICAgICAgIGNvbnN0IG51bUNoZWNrZWRDaGFyYWN0ZXJzID0gYXdhaXQgb3VyQ2hlY2tNYXJrZG93bkZpbGUocmVwb0NvZGUsIHJlcG9OYW1lLCBhZGp1c3RlZEJyYW5jaCwgZmlsZW5hbWUsIGdlbmVyYWxMb2NhdGlvbiwgbmV3Q2hlY2tpbmdPcHRpb25zKTtcbiAgICAgICAgICBpZiAobnVtQ2hlY2tlZENoYXJhY3RlcnMgPiAwKSB7XG4gICAgICAgICAgICBjaGVja2VkRmlsZUNvdW50ICs9IDE7XG4gICAgICAgICAgICBjaGVja2VkRmlsZW5hbWVzLnB1c2goZmlsZW5hbWUpO1xuICAgICAgICAgICAgY2hlY2tlZEZpbGVuYW1lRXh0ZW5zaW9ucy5hZGQoJ21kJyk7XG4gICAgICAgICAgICB0b3RhbENoZWNrZWRTaXplICs9IG51bUNoZWNrZWRDaGFyYWN0ZXJzO1xuICAgICAgICAgICAgYWRkU3VjY2Vzc01lc3NhZ2UoYENoZWNrZWQgJHtyZXBvTmFtZX0gUkVBRE1FIGZpbGVgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gZWxzZSBkZWJ1Z0xvZyhgTk9UIGNoZWNraW5nIFJFQURNRSBmb3IgJHtyZXBvTmFtZX1gKTtcblxuICAgICAgICAvLyBXZSBjYW4gYWxzbyBjaGVjayB0aGUgTElDRU5TRSBmaWxlIGZvciBlYWNoIHJlcG8gaWYgcmVxdWVzdGVkXG4gICAgICAgIGlmIChuZXdDaGVja2luZ09wdGlvbnM/LmNoZWNrTGljZW5zZUZsYWcpIHtcbiAgICAgICAgICAvLyBkZWJ1Z0xvZyhgQ2hlY2tpbmcgTElDRU5TRSBmb3IgJHtyZXBvTmFtZX1gKTtcbiAgICAgICAgICBjb25zdCBmaWxlbmFtZSA9ICdMSUNFTlNFLm1kJztcbiAgICAgICAgICBjb25zdCBudW1DaGVja2VkQ2hhcmFjdGVycyA9IGF3YWl0IG91ckNoZWNrTWFya2Rvd25GaWxlKHJlcG9Db2RlLCByZXBvTmFtZSwgYWRqdXN0ZWRCcmFuY2gsIGZpbGVuYW1lLCBnZW5lcmFsTG9jYXRpb24sIG5ld0NoZWNraW5nT3B0aW9ucyk7XG4gICAgICAgICAgaWYgKG51bUNoZWNrZWRDaGFyYWN0ZXJzID4gMCkge1xuICAgICAgICAgICAgY2hlY2tlZEZpbGVDb3VudCArPSAxO1xuICAgICAgICAgICAgY2hlY2tlZEZpbGVuYW1lcy5wdXNoKGZpbGVuYW1lKTtcbiAgICAgICAgICAgIGNoZWNrZWRGaWxlbmFtZUV4dGVuc2lvbnMuYWRkKCdtZCcpO1xuICAgICAgICAgICAgdG90YWxDaGVja2VkU2l6ZSArPSBudW1DaGVja2VkQ2hhcmFjdGVycztcbiAgICAgICAgICAgIGFkZFN1Y2Nlc3NNZXNzYWdlKGBDaGVja2VkICR7cmVwb05hbWV9IExJQ0VOU0UgZmlsZWApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBlbHNlIGRlYnVnTG9nKGBOT1QgY2hlY2tpbmcgTElDRU5TRSBmb3IgJHtyZXBvTmFtZX1gKTtcbiAgICAgIH1cbiAgICAgIC8vIGVsc2UgZGVidWdMb2coYEFMUkVBRFkgY2hlY2tlZCBNQU5JRkVTVCwgZXRjLiBmb3IgJHtyZXBvTmFtZX1gKTtcbiAgICB9IC8vIGVuZCBvZiBsaW5rRmV0Y2hpbmcgbm90IGRpc2FibGVkXG4gICAgLy8gZWxzZSBkZWJ1Z0xvZyhgTk9UIGZldGNoaW5nIE1BTklGRVNULCBldGMuIGZvciAke3JlcG9OYW1lfWApO1xuXG4gICAgbnVtQ2hlY2tlZFJlcG9zICs9IDE7XG4gICAgLy8gZGVidWdMb2coYEF0IGVuZCBvZiBsb29wIGhhdmluZyBjaGVja2VkICR7bnVtQ2hlY2tlZFJlcG9zfSByZXBvc2ApO1xuICB9IC8vIGVuZCBvZiByZXBvIGxvb3BcblxuXG4gIC8vIEFkZCBzb21lIGV4dHJhIGZpZWxkcyB0byBvdXIgY2hlY2tGaWxlUmVzdWx0IG9iamVjdFxuICAvLyAgaW4gY2FzZSB3ZSBuZWVkIHRoaXMgaW5mb3JtYXRpb24gYWdhaW4gbGF0ZXJcbiAgY2hlY2tCb29rUGFja2FnZVJlc3VsdC5jaGVja2VkRmlsZUNvdW50ID0gY2hlY2tlZEZpbGVDb3VudDtcbiAgY2hlY2tCb29rUGFja2FnZVJlc3VsdC5jaGVja2VkRmlsZW5hbWVzID0gY2hlY2tlZEZpbGVuYW1lcztcbiAgY2hlY2tCb29rUGFja2FnZVJlc3VsdC5jaGVja2VkRmlsZW5hbWVFeHRlbnNpb25zID0gWy4uLmNoZWNrZWRGaWxlbmFtZUV4dGVuc2lvbnNdOyAvLyBjb252ZXJ0IFNldCB0byBBcnJheVxuICBjaGVja0Jvb2tQYWNrYWdlUmVzdWx0LmNoZWNrZWRGaWxlc2l6ZXMgPSB0b3RhbENoZWNrZWRTaXplO1xuICBjaGVja0Jvb2tQYWNrYWdlUmVzdWx0LmNoZWNrZWRSZXBvTmFtZXMgPSBbLi4uY2hlY2tlZFJlcG9OYW1lc107IC8vIGNvbnZlcnQgU2V0IHRvIEFycmF5XG4gIC8vIGNoZWNrQm9va1BhY2thZ2VSZXN1bHQuY2hlY2tlZE9wdGlvbnMgPSBuZXdDaGVja2luZ09wdGlvbnM7IC8vIFRoaXMgaXMgZG9uZSBhdCB0aGUgY2FsbGVyIGxldmVsXG5cbiAgY2hlY2tCb29rUGFja2FnZVJlc3VsdC5lbGFwc2VkU2Vjb25kcyA9IChuZXcgRGF0ZSgpIC0gc3RhcnRUaW1lKSAvIDEwMDA7IC8vIHNlY29uZHNcbiAgLy8gZGVidWdMb2coXCJjaGVja0Jvb2tQYWNrYWdlUmVzdWx0OlwiLCBKU09OLnN0cmluZ2lmeShjaGVja0Jvb2tQYWNrYWdlUmVzdWx0KSk7XG4gIC8vIGRlYnVnTG9nKGBjaGVja0Jvb2tQYWNrYWdlUmVzdWx0KCR7Ym9va0lEfSk6IGVsYXBzZWRTZWNvbmRzID0gJHtjaGVja0Jvb2tQYWNrYWdlUmVzdWx0LmVsYXBzZWRTZWNvbmRzfSwgbm90aWNlcyBjb3VudCA9ICR7Y2hlY2tCb29rUGFja2FnZVJlc3VsdC5ub3RpY2VMaXN0Lmxlbmd0aH1gKTtcbiAgcmV0dXJuIGNoZWNrQm9va1BhY2thZ2VSZXN1bHQ7XG59O1xuLy8gZW5kIG9mIGNoZWNrQm9va1BhY2thZ2UoKVxuXG5cbi8qXG4gICAgY2hlY2tUUU1hcmtkb3duQm9va1xuKi9cbi8qKlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSB1c2VybmFtZVxuICogQHBhcmFtIHtzdHJpbmd9IGxhbmd1YWdlQ29kZVxuICogQHBhcmFtIHtzdHJpbmd9IHJlcG9Db2RlIC0tICdUUScgb3IgJ09CUy1UUSdcbiAqIEBwYXJhbSB7c3RyaW5nfSByZXBvTmFtZVxuICogQHBhcmFtIHtzdHJpbmd9IGJyYW5jaFxuICogQHBhcmFtIHtzdHJpbmd9IGJvb2tJRCAtLSAzLWNoYXJhY3RlciBVU0ZNIGJvb2sgSUQgb3IgJ09CUydcbiAqIEBwYXJhbSB7T2JqZWN0fSBjaGVja2luZ09wdGlvbnNcbiAqIEByZXR1cm4ge09iamVjdH0gLSBjb250YWluaW5nIHN1Y2Nlc3NMaXN0IGFuZCBub3RpY2VMaXN0XG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGNoZWNrVFFNYXJrZG93bkJvb2sodXNlcm5hbWUsIGxhbmd1YWdlQ29kZSwgcmVwb0NvZGUsIHJlcG9OYW1lLCBicmFuY2gsIGJvb2tJRCwgY2hlY2tpbmdPcHRpb25zKSB7XG4gIC8vIGZ1bmN0aW9uTG9nKGBjaGVja0Jvb2tQYWNrYWdlIGNoZWNrVFFNYXJrZG93bkJvb2soJHt1c2VybmFtZX0sICR7bGFuZ3VhZ2VDb2RlfSwgJHtyZXBvQ29kZX0gJHtyZXBvTmFtZX0sICR7YnJhbmNofSwgJHtib29rSUR9LCAke0pTT04uc3RyaW5naWZ5KGNoZWNraW5nT3B0aW9ucyl9KeKApmApXG4gIC8vcGFyYW1ldGVyQXNzZXJ0KHVzZXJuYW1lICE9PSB1bmRlZmluZWQsIFwiY2hlY2tUUU1hcmtkb3duQm9vazogJ3VzZXJuYW1lJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGRlZmluZWRcIik7XG4gIC8vcGFyYW1ldGVyQXNzZXJ0KHR5cGVvZiB1c2VybmFtZSA9PT0gJ3N0cmluZycsIGBjaGVja1RRTWFya2Rvd25Cb29rOiAndXNlcm5hbWUnIHBhcmFtZXRlciBzaG91bGQgYmUgYSBzdHJpbmcgbm90IGEgJyR7dHlwZW9mIHVzZXJuYW1lfSc6ICcke3VzZXJuYW1lfSdgKTtcbiAgLy9wYXJhbWV0ZXJBc3NlcnQobGFuZ3VhZ2VDb2RlICE9PSB1bmRlZmluZWQsIFwiY2hlY2tUUU1hcmtkb3duQm9vazogJ2xhbmd1YWdlQ29kZScgcGFyYW1ldGVyIHNob3VsZCBiZSBkZWZpbmVkXCIpO1xuICAvL3BhcmFtZXRlckFzc2VydCh0eXBlb2YgbGFuZ3VhZ2VDb2RlID09PSAnc3RyaW5nJywgYGNoZWNrVFFNYXJrZG93bkJvb2s6ICdsYW5ndWFnZUNvZGUnIHBhcmFtZXRlciBzaG91bGQgYmUgYSBzdHJpbmcgbm90IGEgJyR7dHlwZW9mIGxhbmd1YWdlQ29kZX0nOiAnJHtsYW5ndWFnZUNvZGV9J2ApO1xuICAvL3BhcmFtZXRlckFzc2VydChyZXBvQ29kZSAhPT0gdW5kZWZpbmVkLCBcImNoZWNrVFFNYXJrZG93bkJvb2s6ICdyZXBvQ29kZScgcGFyYW1ldGVyIHNob3VsZCBiZSBkZWZpbmVkXCIpO1xuICAvL3BhcmFtZXRlckFzc2VydCh0eXBlb2YgcmVwb0NvZGUgPT09ICdzdHJpbmcnLCBgY2hlY2tUUU1hcmtkb3duQm9vazogJ3JlcG9Db2RlJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGEgc3RyaW5nIG5vdCBhICcke3R5cGVvZiByZXBvQ29kZX0nOiAnJHtyZXBvQ29kZX0nYCk7XG4gIC8vcGFyYW1ldGVyQXNzZXJ0KHJlcG9Db2RlID09PSAnVFEnIHx8IHJlcG9Db2RlID09PSAnT0JTLVRRJywgYGNoZWNrVFFNYXJrZG93bkJvb2s6ICdyZXBvQ29kZScgcGFyYW1ldGVyIHNob3VsZCBiZSAnVFEnIG9yICdPQlMtVFEnIG5vdCAnJHtyZXBvQ29kZX0nYCk7XG4gIC8vcGFyYW1ldGVyQXNzZXJ0KHJlcG9OYW1lICE9PSB1bmRlZmluZWQsIFwiY2hlY2tUUU1hcmtkb3duQm9vazogJ3JlcG9OYW1lJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGRlZmluZWRcIik7XG4gIC8vcGFyYW1ldGVyQXNzZXJ0KHR5cGVvZiByZXBvTmFtZSA9PT0gJ3N0cmluZycsIGBjaGVja1RRTWFya2Rvd25Cb29rOiAncmVwb05hbWUnIHBhcmFtZXRlciBzaG91bGQgYmUgYSBzdHJpbmcgbm90IGEgJyR7dHlwZW9mIHJlcG9OYW1lfSc6ICR7cmVwb05hbWV9YCk7XG4gIC8vcGFyYW1ldGVyQXNzZXJ0KGJyYW5jaCAhPT0gdW5kZWZpbmVkLCBcImNoZWNrVFFNYXJrZG93bkJvb2s6ICdicmFuY2gnIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgLy9wYXJhbWV0ZXJBc3NlcnQodHlwZW9mIGJyYW5jaCA9PT0gJ3N0cmluZycsIGBjaGVja1RRTWFya2Rvd25Cb29rOiAnYnJhbmNoJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGEgc3RyaW5nIG5vdCBhICcke3R5cGVvZiBicmFuY2h9JzogJyR7YnJhbmNofSdgKTtcbiAgLy9wYXJhbWV0ZXJBc3NlcnQoYm9va0lEICE9PSB1bmRlZmluZWQsIFwiY2hlY2tUUU1hcmtkb3duQm9vazogJ2Jvb2tJRCcgcGFyYW1ldGVyIHNob3VsZCBiZSBkZWZpbmVkXCIpO1xuICAvL3BhcmFtZXRlckFzc2VydCh0eXBlb2YgYm9va0lEID09PSAnc3RyaW5nJywgYGNoZWNrVFFNYXJrZG93bkJvb2s6ICdib29rSUQnIHBhcmFtZXRlciBzaG91bGQgYmUgYSBzdHJpbmcgbm90IGEgJyR7dHlwZW9mIGJvb2tJRH0nOiAke2Jvb2tJRH1gKTtcbiAgLy9wYXJhbWV0ZXJBc3NlcnQoYm9va0lELmxlbmd0aCA9PT0gMywgYGNoZWNrVFFNYXJrZG93bkJvb2s6ICdib29rSUQnIHBhcmFtZXRlciBzaG91bGQgYmUgdGhyZWUgY2hhcmFjdGVycyBsb25nIG5vdCAke2Jvb2tJRC5sZW5ndGh9YCk7XG4gIC8vcGFyYW1ldGVyQXNzZXJ0KGJvb2tJRC50b1VwcGVyQ2FzZSgpID09PSBib29rSUQsIGBjaGVja1RRTWFya2Rvd25Cb29rOiAnYm9va0lEJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIFVQUEVSQ0FTRSBub3QgJyR7Ym9va0lEfSdgKTtcbiAgLy9wYXJhbWV0ZXJBc3NlcnQoYm9va0lEID09PSAnT0JTJyB8fCBib29rcy5pc1ZhbGlkQm9va0lEKGJvb2tJRCksIGBjaGVja1RRTWFya2Rvd25Cb29rOiAnJHtib29rSUR9JyBpcyBub3QgYSB2YWxpZCBVU0ZNIGJvb2sgaWRlbnRpZmllcmApO1xuXG4gIGNvbnN0IGdlbmVyYWxMb2NhdGlvbiA9IGAgaW4gJHt1c2VybmFtZX0gKCR7YnJhbmNofSlgO1xuXG4gIGNvbnN0IGN0cVJlc3VsdCA9IHsgc3VjY2Vzc0xpc3Q6IFtdLCBub3RpY2VMaXN0OiBbXSB9O1xuXG4gIGZ1bmN0aW9uIGFkZFN1Y2Nlc3NNZXNzYWdlKHN1Y2Nlc3NTdHJpbmcpIHtcbiAgICAvLyBmdW5jdGlvbkxvZyhgY2hlY2tCb29rUGFja2FnZSBzdWNjZXNzOiAke3N1Y2Nlc3NTdHJpbmd9YCk7XG4gICAgY3RxUmVzdWx0LnN1Y2Nlc3NMaXN0LnB1c2goc3VjY2Vzc1N0cmluZyk7XG4gIH1cblxuICBmdW5jdGlvbiBhZGROb3RpY2VQYXJ0aWFsKG5vdGljZU9iamVjdCkge1xuICAgIC8vIGJvb2tJRCBpcyBhIHRocmVlLWNoYXJhY3RlciBVUFBFUkNBU0UgVVNGTSBib29rIGlkZW50aWZpZXIgb3IgJ09CUycuXG4gICAgLy8gZnVuY3Rpb25Mb2coYGNoZWNrVFFNYXJrZG93bkJvb2sgYWRkTm90aWNlUGFydGlhbDogJHtub3RpY2VPYmplY3QucHJpb3JpdHl9OiR7bm90aWNlT2JqZWN0Lm1lc3NhZ2V9ICR7bm90aWNlT2JqZWN0LmJvb2tJRH0gJHtub3RpY2VPYmplY3QuQ306JHtub3RpY2VPYmplY3QuVn0gJHtub3RpY2VPYmplY3QuZmlsZW5hbWV9OiR7bm90aWNlT2JqZWN0LmxpbmVOdW1iZXJ9ICR7bm90aWNlT2JqZWN0LmNoYXJhY3RlckluZGV4ID4gMCA/IGAgKGF0IGNoYXJhY3RlciAke25vdGljZU9iamVjdC5jaGFyYWN0ZXJJbmRleH0pYCA6IFwiXCJ9JHtub3RpY2VPYmplY3QuZXhjZXJwdCA/IGAgJHtub3RpY2VPYmplY3QuZXhjZXJwdH1gIDogXCJcIn0ke25vdGljZU9iamVjdC5sb2NhdGlvbn1gKTtcbiAgICAvL3BhcmFtZXRlckFzc2VydChub3RpY2VPYmplY3QucHJpb3JpdHkgIT09IHVuZGVmaW5lZCwgXCJjVFEgYWRkTm90aWNlUGFydGlhbDogJ3ByaW9yaXR5JyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGRlZmluZWRcIik7XG4gICAgLy9wYXJhbWV0ZXJBc3NlcnQodHlwZW9mIG5vdGljZU9iamVjdC5wcmlvcml0eSA9PT0gJ251bWJlcicsIGBjVFEgYWRkTm90aWNlUGFydGlhbDogJ3ByaW9yaXR5JyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGEgbnVtYmVyIG5vdCBhICcke3R5cGVvZiBub3RpY2VPYmplY3QucHJpb3JpdHl9J2ApO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KG5vdGljZU9iamVjdC5tZXNzYWdlICE9PSB1bmRlZmluZWQsIFwiY1RRIGFkZE5vdGljZVBhcnRpYWw6ICdtZXNzYWdlJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGRlZmluZWRcIik7XG4gICAgLy9wYXJhbWV0ZXJBc3NlcnQodHlwZW9mIG5vdGljZU9iamVjdC5tZXNzYWdlID09PSAnc3RyaW5nJywgYGNUUSBhZGROb3RpY2VQYXJ0aWFsOiAnbWVzc2FnZScgcGFyYW1ldGVyIHNob3VsZCBiZSBhIHN0cmluZyBub3QgYSAnJHt0eXBlb2Ygbm90aWNlT2JqZWN0Lm1lc3NhZ2V9J2ApO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KG5vdGljZU9iamVjdC5ib29rSUQgIT09IHVuZGVmaW5lZCwgXCJjVFEgYWRkTm90aWNlUGFydGlhbDogJ2Jvb2tJRCcgcGFyYW1ldGVyIHNob3VsZCBiZSBkZWZpbmVkXCIpO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KHR5cGVvZiBub3RpY2VPYmplY3QuYm9va0lEID09PSAnc3RyaW5nJywgYGNUUSBhZGROb3RpY2VQYXJ0aWFsOiAnYm9va0lEJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGEgc3RyaW5nIG5vdCBhICcke3R5cGVvZiBub3RpY2VPYmplY3QuYm9va0lEfSdgKTtcbiAgICAvL3BhcmFtZXRlckFzc2VydChub3RpY2VPYmplY3QuYm9va0lELmxlbmd0aCA9PT0gMywgYGNUUSBhZGROb3RpY2VQYXJ0aWFsOiAnYm9va0lEJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIHRocmVlIGNoYXJhY3RlcnMgbG9uZyBub3QgJHtub3RpY2VPYmplY3QuYm9va0lELmxlbmd0aH1gKTtcbiAgICAvL3BhcmFtZXRlckFzc2VydChub3RpY2VPYmplY3QuYm9va0lEID09PSAnT0JTJyB8fCBib29rcy5pc1ZhbGlkQm9va0lEKG5vdGljZU9iamVjdC5ib29rSUQpLCBgY1RRIGFkZE5vdGljZVBhcnRpYWw6ICcke25vdGljZU9iamVjdC5ib29rSUR9JyBpcyBub3QgYSB2YWxpZCBVU0ZNIGJvb2sgaWRlbnRpZmllcmApO1xuICAgIC8vIC8vcGFyYW1ldGVyQXNzZXJ0KEMgIT09IHVuZGVmaW5lZCwgXCJjVFEgYWRkTm90aWNlUGFydGlhbDogJ0MnIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgICBpZiAobm90aWNlT2JqZWN0LkMpIHsgLy9wYXJhbWV0ZXJBc3NlcnQodHlwZW9mIG5vdGljZU9iamVjdC5DID09PSAnc3RyaW5nJywgYGNUUSBhZGROb3RpY2VQYXJ0aWFsOiAnQycgcGFyYW1ldGVyIHNob3VsZCBiZSBhIHN0cmluZyBub3QgYSAnJHt0eXBlb2Ygbm90aWNlT2JqZWN0LkN9J2ApO1xuICAgIH1cbiAgICAvLyAvL3BhcmFtZXRlckFzc2VydChWICE9PSB1bmRlZmluZWQsIFwiY1RRIGFkZE5vdGljZVBhcnRpYWw6ICdWJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGRlZmluZWRcIik7XG4gICAgaWYgKG5vdGljZU9iamVjdC5WKSB7IC8vcGFyYW1ldGVyQXNzZXJ0KHR5cGVvZiBub3RpY2VPYmplY3QuViA9PT0gJ3N0cmluZycsIGBjVFEgYWRkTm90aWNlUGFydGlhbDogJ1YnIHBhcmFtZXRlciBzaG91bGQgYmUgYSBzdHJpbmcgbm90IGEgJyR7dHlwZW9mIG5vdGljZU9iamVjdC5WfSdgKTtcbiAgICB9XG4gICAgLy8gLy9wYXJhbWV0ZXJBc3NlcnQoY2hhcmFjdGVySW5kZXggIT09IHVuZGVmaW5lZCwgXCJjVFEgYWRkTm90aWNlUGFydGlhbDogJ2NoYXJhY3RlckluZGV4JyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGRlZmluZWRcIik7XG4gICAgaWYgKG5vdGljZU9iamVjdC5jaGFyYWN0ZXJJbmRleCkgeyAvL3BhcmFtZXRlckFzc2VydCh0eXBlb2Ygbm90aWNlT2JqZWN0LmNoYXJhY3RlckluZGV4ID09PSAnbnVtYmVyJywgYGNUUSBhZGROb3RpY2VQYXJ0aWFsOiAnY2hhcmFjdGVySW5kZXgnIHBhcmFtZXRlciBzaG91bGQgYmUgYSBudW1iZXIgbm90IGEgJyR7dHlwZW9mIG5vdGljZU9iamVjdC5jaGFyYWN0ZXJJbmRleH0nYCk7XG4gICAgfVxuICAgIC8vIC8vcGFyYW1ldGVyQXNzZXJ0KGV4Y2VycHQgIT09IHVuZGVmaW5lZCwgXCJjVFEgYWRkTm90aWNlUGFydGlhbDogJ2V4Y2VycHQnIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgICBpZiAobm90aWNlT2JqZWN0LmV4Y2VycHQpIHsgLy9wYXJhbWV0ZXJBc3NlcnQodHlwZW9mIG5vdGljZU9iamVjdC5leGNlcnB0ID09PSAnc3RyaW5nJywgYGNUUSBhZGROb3RpY2VQYXJ0aWFsOiAnZXhjZXJwdCcgcGFyYW1ldGVyIHNob3VsZCBiZSBhIHN0cmluZyBub3QgYSAnJHt0eXBlb2Ygbm90aWNlT2JqZWN0LmV4Y2VycHR9J2ApO1xuICAgIH1cbiAgICAvL3BhcmFtZXRlckFzc2VydChub3RpY2VPYmplY3QubG9jYXRpb24gIT09IHVuZGVmaW5lZCwgXCJjVFEgYWRkTm90aWNlUGFydGlhbDogJ2xvY2F0aW9uJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGRlZmluZWRcIik7XG4gICAgLy9wYXJhbWV0ZXJBc3NlcnQodHlwZW9mIG5vdGljZU9iamVjdC5sb2NhdGlvbiA9PT0gJ3N0cmluZycsIGBjVFEgYWRkTm90aWNlUGFydGlhbDogJ2xvY2F0aW9uJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGEgc3RyaW5nIG5vdCBhICcke3R5cGVvZiBub3RpY2VPYmplY3QubG9jYXRpb259J2ApO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KG5vdGljZU9iamVjdC5leHRyYSAhPT0gdW5kZWZpbmVkLCBcImNUUSBhZGROb3RpY2VQYXJ0aWFsOiAnZXh0cmEnIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgICAvL3BhcmFtZXRlckFzc2VydCh0eXBlb2Ygbm90aWNlT2JqZWN0LmV4dHJhID09PSAnc3RyaW5nJywgYGNUUSBhZGROb3RpY2VQYXJ0aWFsOiAnZXh0cmEnIHBhcmFtZXRlciBzaG91bGQgYmUgYSBzdHJpbmcgbm90IGEgJyR7dHlwZW9mIG5vdGljZU9iamVjdC5leHRyYX0nYCk7XG4gICAgY3RxUmVzdWx0Lm5vdGljZUxpc3QucHVzaCh7IC4uLm5vdGljZU9iamVjdCwgdXNlcm5hbWUsIHJlcG9Db2RlLCByZXBvTmFtZSwgYm9va0lEIH0pO1xuICB9XG5cblxuICAvKipcbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IHJlcG9Db2RlXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBib29rSURcbiAgICogQHBhcmFtIHtzdHJpbmd9IENcbiAgICogQHBhcmFtIHtzdHJpbmd9IFZcbiAgICogQHBhcmFtIHtzdHJpbmd9IGNmRmlsZW5hbWVcbiAgICogQHBhcmFtIHtzdHJpbmd9IGZpbGVDb250ZW50XG4gICAqIEBwYXJhbSB7c3RyaW5nfSBmaWxlTG9jYXRpb25cbiAgICogQHBhcmFtIHtPYmplY3R9IGNoZWNraW5nT3B0aW9uc1xuICAgKi9cbiAgYXN5bmMgZnVuY3Rpb24gb3VyQ2hlY2tUUUZpbGVDb250ZW50cyhyZXBvQ29kZSwgYm9va0lELCBDLCBWLCBjZkZpbGVuYW1lLCBmaWxlQ29udGVudCwgZmlsZUxvY2F0aW9uLCBjaGVja2luZ09wdGlvbnMpIHtcbiAgICAvLyBmdW5jdGlvbkxvZyhgY2hlY2tCb29rUGFja2FnZSBvdXJDaGVja1RRRmlsZUNvbnRlbnRzKCR7cmVwb0NvZGV9LCAke2Jvb2tJRH0gJHtDfToke1Z9ICR7Y2ZGaWxlbmFtZX3igKYp4oCmYCk7XG5cbiAgICAvLyBVcGRhdGVzIHRoZSBnbG9iYWwgbGlzdCBvZiBub3RpY2VzXG4gICAgLy9wYXJhbWV0ZXJBc3NlcnQocmVwb0NvZGUgIT09IHVuZGVmaW5lZCwgXCJjVFEgb3VyQ2hlY2tUUUZpbGVDb250ZW50czogJ3JlcG9Db2RlJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGRlZmluZWRcIik7XG4gICAgLy9wYXJhbWV0ZXJBc3NlcnQodHlwZW9mIHJlcG9Db2RlID09PSAnc3RyaW5nJywgYGNUUSBvdXJDaGVja1RRRmlsZUNvbnRlbnRzOiAncmVwb0NvZGUnIHBhcmFtZXRlciBzaG91bGQgYmUgYSBzdHJpbmcgbm90IGEgJyR7dHlwZW9mIHJlcG9Db2RlfSdgKTtcbiAgICAvL3BhcmFtZXRlckFzc2VydChSRVBPX0NPREVTX0xJU1QuaW5jbHVkZXMocmVwb0NvZGUpLCBgY1RRIG91ckNoZWNrVFFGaWxlQ29udGVudHM6ICdyZXBvQ29kZScgcGFyYW1ldGVyIHNob3VsZCBub3QgYmUgJyR7cmVwb0NvZGV9J2ApO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KGNmRmlsZW5hbWUgIT09IHVuZGVmaW5lZCwgXCJjVFEgb3VyQ2hlY2tUUUZpbGVDb250ZW50czogJ2NmRmlsZW5hbWUnIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgICAvL3BhcmFtZXRlckFzc2VydCh0eXBlb2YgY2ZGaWxlbmFtZSA9PT0gJ3N0cmluZycsIGBjVFEgb3VyQ2hlY2tUUUZpbGVDb250ZW50czogJ2NmRmlsZW5hbWUnIHBhcmFtZXRlciBzaG91bGQgYmUgYSBzdHJpbmcgbm90IGEgJyR7dHlwZW9mIGNmRmlsZW5hbWV9J2ApO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KGZpbGVDb250ZW50ICE9PSB1bmRlZmluZWQsIFwiY1RRIG91ckNoZWNrVFFGaWxlQ29udGVudHM6ICdmaWxlQ29udGVudCcgcGFyYW1ldGVyIHNob3VsZCBiZSBkZWZpbmVkXCIpO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KHR5cGVvZiBmaWxlQ29udGVudCA9PT0gJ3N0cmluZycsIGBjVFEgb3VyQ2hlY2tUUUZpbGVDb250ZW50czogJ2ZpbGVDb250ZW50JyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGEgc3RyaW5nIG5vdCBhICcke3R5cGVvZiBmaWxlQ29udGVudH0nYCk7XG4gICAgLy9wYXJhbWV0ZXJBc3NlcnQoZmlsZUxvY2F0aW9uICE9PSB1bmRlZmluZWQsIFwiY1RRIG91ckNoZWNrVFFGaWxlQ29udGVudHM6ICdmaWxlTG9jYXRpb24nIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgICAvL3BhcmFtZXRlckFzc2VydCh0eXBlb2YgZmlsZUxvY2F0aW9uID09PSAnc3RyaW5nJywgYGNUUSBvdXJDaGVja1RRRmlsZUNvbnRlbnRzOiAnZmlsZUxvY2F0aW9uJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGEgc3RyaW5nIG5vdCBhICcke3R5cGVvZiBmaWxlTG9jYXRpb259J2ApO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KGNoZWNraW5nT3B0aW9ucyAhPT0gdW5kZWZpbmVkLCBcImNUUSBvdXJDaGVja1RRRmlsZUNvbnRlbnRzOiAnY2hlY2tpbmdPcHRpb25zJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGRlZmluZWRcIik7XG5cbiAgICBjb25zdCBjZlJlc3VsdE9iamVjdCA9IGF3YWl0IGNoZWNrRmlsZUNvbnRlbnRzKHVzZXJuYW1lLCBsYW5ndWFnZUNvZGUsIHJlcG9Db2RlLCBicmFuY2gsIGNmRmlsZW5hbWUsIGZpbGVDb250ZW50LCBmaWxlTG9jYXRpb24sIGNoZWNraW5nT3B0aW9ucyk7XG4gICAgLy8gZGVidWdMb2coXCJjaGVja0ZpbGVDb250ZW50cygpIHJldHVybmVkXCIsIGNmUmVzdWx0T2JqZWN0LnN1Y2Nlc3NMaXN0Lmxlbmd0aCwgXCJzdWNjZXNzIG1lc3NhZ2UocykgYW5kXCIsIGNmUmVzdWx0T2JqZWN0Lm5vdGljZUxpc3QubGVuZ3RoLCBcIm5vdGljZShzKVwiKTtcbiAgICAvLyBmb3IgKGNvbnN0IHN1Y2Nlc3NFbnRyeSBvZiBjZlJlc3VsdE9iamVjdC5zdWNjZXNzTGlzdCkgdXNlckxvZyhcIiAgb3VyQ2hlY2tUUUZpbGVDb250ZW50czpcIiwgc3VjY2Vzc0VudHJ5KTtcblxuICAgIC8vIFByb2Nlc3Mgbm90aWNlTGlzdCBsaW5lIGJ5IGxpbmUsICBhcHBlbmRpbmcgdGhlIHJlcG9Db2RlIGFzIGFuIGV4dHJhIGZpZWxkIGFzIHdlIGdvXG4gICAgZm9yIChjb25zdCBub3RpY2VFbnRyeSBvZiBjZlJlc3VsdE9iamVjdC5ub3RpY2VMaXN0KSB7XG4gICAgICAvLyBub3RpY2VFbnRyeSBpcyBhbiBhcnJheSBvZiBlaWdodCBmaWVsZHM6IDE9cHJpb3JpdHksIDI9Ym9va0lELCAzPUMsIDQ9ViwgNT1tc2csIDY9Y2hhcmFjdGVySW5kZXgsIDc9ZXhjZXJwdCwgOD1sb2NhdGlvblxuICAgICAgLy8gLy9wYXJhbWV0ZXJBc3NlcnQoT2JqZWN0LmtleXMobm90aWNlRW50cnkpLmxlbmd0aCA9PT0gNSwgYGNUUSBvdXJDaGVja1RRRmlsZUNvbnRlbnRzIG5vdGljZSBsZW5ndGg9JHtPYmplY3Qua2V5cyhub3RpY2VFbnRyeSkubGVuZ3RofWApO1xuICAgICAgLy8gV2UgYWRkIHRoZSByZXBvQ29kZSBhcyBhbiBleHRyYSB2YWx1ZVxuICAgICAgYWRkTm90aWNlUGFydGlhbCh7IC4uLm5vdGljZUVudHJ5LCBib29rSUQsIEMsIFYsIGV4dHJhOiByZXBvQ29kZSB9KTtcbiAgICB9XG4gIH1cbiAgLy8gZW5kIG9mIG91ckNoZWNrVFFGaWxlQ29udGVudHMgZnVuY3Rpb25cblxuXG4gIC8vIE1haW4gY29kZSBmb3IgY2hlY2tUUU1hcmtkb3duQm9va1xuICAvLyBXZSBuZWVkIHRvIGZpbmQgYW5kIGNoZWNrIGFsbCB0aGUgbWFya2Rvd24gZm9sZGVycy9maWxlcyBmb3IgdGhpcyBib29rXG4gIGNvbnN0IGdldEZpbGVMaXN0RnJvbVppcF8gPSBjaGVja2luZ09wdGlvbnMgJiYgY2hlY2tpbmdPcHRpb25zLmdldEZpbGVMaXN0RnJvbVppcCA/IGNoZWNraW5nT3B0aW9ucy5nZXRGaWxlTGlzdEZyb21aaXAgOiBnZXRGaWxlTGlzdEZyb21aaXA7XG4gIGxldCBjaGVja2VkRmlsZUNvdW50ID0gMCwgY2hlY2tlZEZpbGVuYW1lcyA9IFtdLCBjaGVja2VkRmlsZW5hbWVFeHRlbnNpb25zID0gbmV3IFNldCgpLCB0b3RhbENoZWNrZWRTaXplID0gMDtcbiAgY29uc3QgcGF0aExpc3QgPSBhd2FpdCBnZXRGaWxlTGlzdEZyb21aaXBfKHsgdXNlcm5hbWUsIHJlcG9zaXRvcnk6IHJlcG9OYW1lLCBicmFuY2hPclJlbGVhc2U6IGJyYW5jaCwgb3B0aW9uYWxQcmVmaXg6IGAke2Jvb2tJRC50b0xvd2VyQ2FzZSgpfS9gIH0pO1xuICBpZiAoIUFycmF5LmlzQXJyYXkocGF0aExpc3QpIHx8ICFwYXRoTGlzdC5sZW5ndGgpIHtcbiAgICAvLyBjb25zb2xlLmVycm9yKFwiY2hlY2tUUXJlcG8gZmFpbGVkIHRvIGxvYWRcIiwgdXNlcm5hbWUsIHJlcG9OYW1lLCBicmFuY2gpO1xuICAgIGNvbnN0IGRldGFpbHMgPSBgdXNlcm5hbWU9JHt1c2VybmFtZX1gO1xuICAgIGlmICghIGF3YWl0IHJlcG9zaXRvcnlFeGlzdHNPbkRvb3I0Myh7IHVzZXJuYW1lLCByZXBvc2l0b3J5OiByZXBvTmFtZSB9KSlcbiAgICAgIGN0cVJlc3VsdC5ub3RpY2VMaXN0LnB1c2goeyBwcmlvcml0eTogOTk3LCBtZXNzYWdlOiBcIlJlcG9zaXRvcnkgZG9lc27igJl0IGV4aXN0XCIsIGRldGFpbHMsIHVzZXJuYW1lLCByZXBvQ29kZSwgcmVwb05hbWUsIGxvY2F0aW9uOiBnZW5lcmFsTG9jYXRpb24sIGV4dHJhOiByZXBvQ29kZSB9KTtcbiAgICBlbHNlXG4gICAgICBhZGROb3RpY2VQYXJ0aWFsKHsgcHJpb3JpdHk6IDk5NiwgbWVzc2FnZTogXCJVbmFibGUgdG8gbG9hZFwiLCBkZXRhaWxzLCBib29rSUQsIGxvY2F0aW9uOiBnZW5lcmFsTG9jYXRpb24sIGV4dHJhOiByZXBvQ29kZSB9KTtcbiAgfSBlbHNlIHtcblxuICAgIC8vIGRlYnVnTG9nKGAgIEdvdCAke3BhdGhMaXN0Lmxlbmd0aH0gcGF0aExpc3QgZW50cmllc2ApXG4gICAgZm9yIChjb25zdCB0aGlzUGF0aCBvZiBwYXRoTGlzdCkge1xuICAgICAgLy8gZGVidWdMb2coXCJjaGVja1RRTWFya2Rvd25Cb29rOiBUcnkgdG8gbG9hZFwiLCB1c2VybmFtZSwgcmVwb05hbWUsIHRoaXNQYXRoLCBicmFuY2gpO1xuXG4gICAgICAvL3BhcmFtZXRlckFzc2VydCh0aGlzUGF0aC5lbmRzV2l0aCgnLm1kJyksIGBFeHBlY3RlZCAke3RoaXNQYXRofSB0byBlbmQgd2l0aCAubWRgKTtcbiAgICAgIC8vIGNvbnN0IGZpbGVuYW1lID0gdGhpc1BhdGguc3BsaXQoJy8nKS5wb3AoKTtcbiAgICAgIGNvbnN0IHBhdGhQYXJ0cyA9IHRoaXNQYXRoLnNsaWNlKDAsIC0zKS5zcGxpdCgnLycpO1xuICAgICAgY29uc3QgQyA9IHBhdGhQYXJ0c1twYXRoUGFydHMubGVuZ3RoIC0gMl0ucmVwbGFjZSgvXjArKD89XFxkKS8sICcnKTsgLy8gUmVtb3ZlIGxlYWRpbmcgemVyb2VzXG4gICAgICBjb25zdCBWID0gcGF0aFBhcnRzW3BhdGhQYXJ0cy5sZW5ndGggLSAxXS5yZXBsYWNlKC9eMCsoPz1cXGQpLywgJycpOyAvLyBSZW1vdmUgbGVhZGluZyB6ZXJvZXNcblxuICAgICAgY29uc3QgZ2V0RmlsZV8gPSAoY2hlY2tpbmdPcHRpb25zICYmIGNoZWNraW5nT3B0aW9ucy5nZXRGaWxlKSA/IGNoZWNraW5nT3B0aW9ucy5nZXRGaWxlIDogY2FjaGVkR2V0RmlsZTtcbiAgICAgIGxldCB0cUZpbGVDb250ZW50O1xuICAgICAgdHJ5IHtcbiAgICAgICAgdHFGaWxlQ29udGVudCA9IGF3YWl0IGdldEZpbGVfKHsgdXNlcm5hbWUsIHJlcG9zaXRvcnk6IHJlcG9OYW1lLCBwYXRoOiB0aGlzUGF0aCwgYnJhbmNoIH0pO1xuICAgICAgICAvLyBkZWJ1Z0xvZyhcIkZldGNoZWQgZmlsZUNvbnRlbnQgZm9yXCIsIHJlcG9OYW1lLCB0aGlzUGF0aCwgdHlwZW9mIHRxRmlsZUNvbnRlbnQsIHRxRmlsZUNvbnRlbnQubGVuZ3RoKTtcbiAgICAgICAgY2hlY2tlZEZpbGVuYW1lcy5wdXNoKHRoaXNQYXRoKTtcbiAgICAgICAgdG90YWxDaGVja2VkU2l6ZSArPSB0cUZpbGVDb250ZW50Lmxlbmd0aDtcbiAgICAgIH0gY2F0Y2ggKHRRZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcImNoZWNrVFFNYXJrZG93bkJvb2sgZmFpbGVkIHRvIGxvYWRcIiwgdXNlcm5hbWUsIHJlcG9OYW1lLCB0aGlzUGF0aCwgYnJhbmNoLCB0UWVycm9yICsgJycpO1xuICAgICAgICBsZXQgZGV0YWlscyA9IGB1c2VybmFtZT0ke3VzZXJuYW1lfWA7XG4gICAgICAgIGlmICghIGF3YWl0IHJlcG9zaXRvcnlFeGlzdHNPbkRvb3I0Myh7IHVzZXJuYW1lLCByZXBvc2l0b3J5OiByZXBvTmFtZSB9KSlcbiAgICAgICAgICBjdHFSZXN1bHQubm90aWNlTGlzdC5wdXNoKHsgcHJpb3JpdHk6IDk5NywgbWVzc2FnZTogXCJSZXBvc2l0b3J5IGRvZXNu4oCZdCBleGlzdFwiLCBkZXRhaWxzLCB1c2VybmFtZSwgcmVwb0NvZGUsIHJlcG9OYW1lLCBsb2NhdGlvbjogZ2VuZXJhbExvY2F0aW9uLCBleHRyYTogcmVwb0NvZGUgfSk7XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBlcWVxZXFcbiAgICAgICAgICBpZiAodFFlcnJvciAhPSAnVHlwZUVycm9yOiByZXBvRmlsZUNvbnRlbnQgaXMgbnVsbCcpIGRldGFpbHMgKz0gYCBlcnJvcj0ke3RRZXJyb3J9YDtcbiAgICAgICAgICBhZGROb3RpY2VQYXJ0aWFsKHsgcHJpb3JpdHk6IDk5NiwgbWVzc2FnZTogXCJVbmFibGUgdG8gbG9hZFwiLCBkZXRhaWxzLCBib29rSUQsIEMsIFYsIGZpbGVuYW1lOiB0aGlzUGF0aCwgbG9jYXRpb246IGAke2dlbmVyYWxMb2NhdGlvbn0gJHt0aGlzUGF0aH1gLCBleHRyYTogcmVwb0NvZGUgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICh0cUZpbGVDb250ZW50KSB7XG4gICAgICAgIC8vIFdlIHVzZSB0aGUgZ2VuZXJhbExvY2F0aW9uIGhlcmUgKGRvZXMgbm90IGluY2x1ZGUgcmVwbyBuYW1lKVxuICAgICAgICAvLyAgc28gdGhhdCB3ZSBjYW4gYWRqdXN0IHRoZSByZXR1cm5lZCBzdHJpbmdzIG91cnNlbHZlc1xuICAgICAgICAvLyBOT1RFOiBXZSBwYXNzIHRoaXNQYXRoIGhlcmUgY296IHRoZSBhY3R1YWwgZmlsZW5hbWUgYnkgaXRzZWxmIGlzIHVzZWxlc3MgKHNvIG1hbnkgJzAxLm1kJylcbiAgICAgICAgYXdhaXQgb3VyQ2hlY2tUUUZpbGVDb250ZW50cyhyZXBvQ29kZSwgYm9va0lELCBDLCBWLCB0aGlzUGF0aCwgdHFGaWxlQ29udGVudCwgZ2VuZXJhbExvY2F0aW9uLCBjaGVja2luZ09wdGlvbnMpOyAvLyBBZGRzIHRoZSBub3RpY2VzIHRvIGNoZWNrQm9va1BhY2thZ2VSZXN1bHRcbiAgICAgICAgY2hlY2tlZEZpbGVDb3VudCArPSAxO1xuICAgICAgICBjaGVja2VkRmlsZW5hbWVFeHRlbnNpb25zLmFkZCgnbWQnKTtcbiAgICAgICAgLy8gYWRkU3VjY2Vzc01lc3NhZ2UoYENoZWNrZWQgJHtyZXBvQ29kZS50b1VwcGVyQ2FzZSgpfSBmaWxlOiAke3RoaXNQYXRofWApO1xuICAgICAgfVxuICAgIH1cbiAgICBhZGRTdWNjZXNzTWVzc2FnZShgQ2hlY2tlZCAke2NoZWNrZWRGaWxlQ291bnQudG9Mb2NhbGVTdHJpbmcoKX0gJHtyZXBvQ29kZS50b1VwcGVyQ2FzZSgpfSBmaWxlJHtjaGVja2VkRmlsZUNvdW50ID09PSAxID8gJycgOiAncyd9YCk7XG4gIH1cblxuICBjdHFSZXN1bHQuY2hlY2tlZEZpbGVDb3VudCA9IGNoZWNrZWRGaWxlQ291bnQ7XG4gIGN0cVJlc3VsdC5jaGVja2VkRmlsZW5hbWVzID0gY2hlY2tlZEZpbGVuYW1lcztcbiAgY3RxUmVzdWx0LmNoZWNrZWRGaWxlbmFtZUV4dGVuc2lvbnMgPSBbLi4uY2hlY2tlZEZpbGVuYW1lRXh0ZW5zaW9uc107IC8vIGNvbnZlcnQgU2V0IHRvIEFycmF5XG4gIGN0cVJlc3VsdC5jaGVja2VkRmlsZXNpemVzID0gdG90YWxDaGVja2VkU2l6ZTtcbiAgLy8gZGVidWdMb2coYCAgY2hlY2tUUU1hcmtkb3duQm9vayByZXR1cm5pbmcgJHtKU09OLnN0cmluZ2lmeShjdHFSZXN1bHQpfWApO1xuICByZXR1cm4gY3RxUmVzdWx0O1xufVxuLy8gZW5kIG9mIGNoZWNrVFFNYXJrZG93bkJvb2sgZnVuY3Rpb25cbiJdfQ==