"use strict";var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");var _typeof = require("@babel/runtime/helpers/typeof");Object.defineProperty(exports, "__esModule", { value: true });exports.default = void 0;var _regenerator = _interopRequireDefault(require("@babel/runtime/regenerator"));var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _react = _interopRequireWildcard(require("react"));

var books = _interopRequireWildcard(require("../../core/books/books"));
var _core = require("../../core");
var _noticeProcessingFunctions = require("../notice-processing-functions");
var _RenderProcessedResults = require("../RenderProcessedResults");
var _checkBookPackage = require("./checkBookPackage");

var _utilities = require("../../core/utilities");function _getRequireWildcardCache(nodeInterop) {if (typeof WeakMap !== "function") return null;var cacheBabelInterop = new WeakMap();var cacheNodeInterop = new WeakMap();return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) {return nodeInterop ? cacheNodeInterop : cacheBabelInterop;})(nodeInterop);}function _interopRequireWildcard(obj, nodeInterop) {if (!nodeInterop && obj && obj.__esModule) {return obj;}if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") {return { default: obj };}var cache = _getRequireWildcardCache(nodeInterop);if (cache && cache.has(obj)) {return cache.get(obj);}var newObj = {};var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;for (var key in obj) {if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;if (desc && (desc.get || desc.set)) {Object.defineProperty(newObj, key, desc);} else {newObj[key] = obj[key];}}}newObj.default = obj;if (cache) {cache.set(obj, newObj);}return newObj;}function _createForOfIteratorHelper(o, allowArrayLike) {var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"];if (!it) {if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") {if (it) o = it;var i = 0;var F = function F() {};return { s: F, n: function n() {if (i >= o.length) return { done: true };return { done: false, value: o[i++] };}, e: function e(_e) {throw _e;}, f: F };}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var normalCompletion = true,didErr = false,err;return { s: function s() {it = it.call(o);}, n: function n() {var step = it.next();normalCompletion = step.done;return step;}, e: function e(_e2) {didErr = true;err = _e2;}, f: function f() {try {if (!normalCompletion && it.return != null) it.return();} finally {if (didErr) throw err;}} };}function _unsupportedIterableToArray(o, minLen) {if (!o) return;if (typeof o === "string") return _arrayLikeToArray(o, minLen);var n = Object.prototype.toString.call(o).slice(8, -1);if (n === "Object" && o.constructor) n = o.constructor.name;if (n === "Map" || n === "Set") return Array.from(o);if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);}function _arrayLikeToArray(arr, len) {if (len == null || len > arr.length) len = arr.length;for (var i = 0, arr2 = new Array(len); i < len; i++) {arr2[i] = arr[i];}return arr2;}


// const BP_VALIDATOR_VERSION_STRING = '0.5.5';


function BookPackageCheck( /*username, languageCode, bookID,*/props) {
  // Check a single Bible book across many repositories
  var _useState = (0, _react.useState)("Waiting-CheckBookPackage"),_useState2 = (0, _slicedToArray2.default)(_useState, 2),result = _useState2[0],setResultValue = _useState2[1];

  // debugLog(`I'm here in BookPackageCheck v${BP_VALIDATOR_VERSION_STRING}`);
  // consoleLogObject("props", props);
  // consoleLogObject("props.classes", props.classes);

  var username = props.username;
  // debugLog(`username='${username}'`);
  var languageCode = props.languageCode;
  // debugLog(`languageCode='${languageCode}'`);
  var bookID = props.bookID;
  // debugLog(`bookID='${bookID}'`);
  var dataSet = props.dataSet;
  // debugLog(`dataSet='${dataSet}'`);
  var branch = props.branch;
  // debugLog(`branch='${branch}'`);

  var checkingOptions = { // Uncomment any of these to test them
    dataSet: dataSet, // Can be 'OLD' (Markdown, etc.), 'NEW' (TSV only), or 'BOTH', or 'DEFAULT'
    // excerptLength: 25, // default is 20 characters
    checkManifestFlag: true,
    checkReadmeFlag: true,
    checkLicenseFlag: true,
    suppressNoticeDisablingFlag: true // Leave this one as true (otherwise demo checks are less efficient)
  };
  // Or this allows the parameters to be specified as a BookPackageCheck property
  if (props.excerptLength) checkingOptions.excerptLength = (0, _core.ourParseInt)(props.excerptLength);
  if (props.cutoffPriorityLevel) checkingOptions.cutoffPriorityLevel = (0, _core.ourParseInt)(props.cutoffPriorityLevel);
  if (props.disableAllLinkFetchingFlag) checkingOptions.disableAllLinkFetchingFlag = props.disableAllLinkFetchingFlag.toLowerCase() === 'true';
  if (props.disableLinkedTAArticlesCheckFlag) checkingOptions.disableLinkedTAArticlesCheckFlag = props.disableLinkedTAArticlesCheckFlag.toLowerCase() === 'true';
  if (props.disableLinkedTWArticlesCheckFlag) checkingOptions.disableLinkedTWArticlesCheckFlag = props.disableLinkedTWArticlesCheckFlag.toLowerCase() === 'true';
  // functionLog(`checkingOptions.disableLinkedTAArticlesCheckFlag ${checkingOptions.disableLinkedTAArticlesCheckFlag} from '${props.disableLinkedTAArticlesCheckFlag}'`);
  // functionLog(`checkingOptions.disableLinkedTWArticlesCheckFlag ${checkingOptions.disableLinkedTWArticlesCheckFlag} from '${props.disableLinkedTWArticlesCheckFlag}'`);

  (0, _react.useEffect)(function () {
    // const newProps = { bookID, branch, checkingOptions, languageCode, cutoffPriorityLevel: props.cutoffPriorityLevel, displayType: props.displayType, errorPriorityLevel: props.errorPriorityLevel, maximumSimilarMessages: props.maximumSimilarMessages, sortBy: props.sortBy, username};
    // debugLog("BookPackageCheck.useEffect() called with ", JSON.stringify(newProps));

    // Use an IIFE (Immediately Invoked Function Expression)
    //  e.g., see https://medium.com/javascript-in-plain-english/https-medium-com-javascript-in-plain-english-stop-feeling-iffy-about-using-an-iife-7b0292aba174
    (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee() {var repoPreloadList, whichTestament, origLangRepo, successFlag, rawCBPResults, processOptions, _iterator, _step, stringBit, intBit, displayType,






































































































      renderSummary, processedResults, _processedResults, _processedResults2;return _regenerator.default.wrap(function _callee$(_context) {while (1) {switch (_context.prev = _context.next) {case 0:renderSummary = function _renderSummary(processedResults) {
                return /*#__PURE__*/_react.default.createElement("div", null, /*#__PURE__*/
                _react.default.createElement("p", null, "Checked ", /*#__PURE__*/_react.default.createElement("b", null, username, " ", languageCode, " ", bookID), " (from ", /*#__PURE__*/_react.default.createElement("i", null, branch === undefined ? 'DEFAULT' : branch), " branches)"), /*#__PURE__*/
                _react.default.createElement(_RenderProcessedResults.RenderCheckedFilesList, { username: username, results: processedResults }), /*#__PURE__*/
                _react.default.createElement(_RenderProcessedResults.RenderTotals, { rawNoticeListLength: rawCBPResults.noticeList.length, results: processedResults }));


              };if (!(!props.wait || props.wait !== 'N')) {_context.next = 4;break;}setResultValue( /*#__PURE__*/_react.default.createElement("p", null, /*#__PURE__*/_react.default.createElement("span", { style: { color: 'blue' } }, "Waiting for user\u2026"), " (Adjust settings below as necessary and then set ", /*#__PURE__*/_react.default.createElement("b", null, "wait='N'"), " to start)"));return _context.abrupt("return");case 4:if (!(bookID !== 'OBS' && !books.isValidBookID(bookID))) {_context.next = 8;break;}(0, _utilities.userLog)("Invalid '".concat(bookID, "' bookID given!"));setResultValue( /*#__PURE__*/_react.default.createElement("p", { style: { color: 'red' } }, "Please enter a valid USFM book identifier or 'OBS'. ('", /*#__PURE__*/_react.default.createElement("b", null, bookID), "' is not valid.)"));return _context.abrupt("return");case 8:if (!(props.reloadAllFilesFirst && props.reloadAllFilesFirst.slice(0).toUpperCase() === 'Y')) {_context.next = 15;break;}(0, _utilities.userLog)("Clearing cache before running book package check…");setResultValue( /*#__PURE__*/_react.default.createElement("p", { style: { color: 'orange' } }, "Clearing cache before running book package check\u2026"));_context.next = 13;return (0, _core.clearCaches)();case 13:_context.next = 17;break;case 15:_context.next = 17;return (0, _core.clearCheckedArticleCache)();case 17:if (bookID === 'OBS') {repoPreloadList = ['OBS', 'OBS-TWL', 'OBS-TN2', 'OBS-TQ2', 'OBS-SN2', 'OBS-SQ2']; // for DEFAULT
                if (dataSet === 'OLD') repoPreloadList = ['OBS', 'OBS-TWL', 'OBS-TN', 'OBS-TQ', 'OBS-SN', 'OBS-SQ'];else if (dataSet === 'NEW') repoPreloadList = ['OBS', 'OBS-TWL', 'OBS-TN2', 'OBS-TQ2', 'OBS-SN', 'OBS-SQ'];else if (dataSet === 'BOTH') repoPreloadList = ['OBS', 'OBS-TWL', 'OBS-TN', 'OBS-TN2', 'OBS-TQ', 'OBS-TQ2', 'OBS-SN', 'OBS-SN', 'OBS-SN2', 'OBS-SQ2'];} else {// not OBS
                repoPreloadList = ['TWL', 'LT', 'ST', 'TN', 'TQ', 'SN', 'SQ']; // for DEFAULT
                if (dataSet === 'OLD') repoPreloadList = ['TWL', 'LT', 'ST', 'TN', 'TQ'];else if (dataSet === 'NEW') repoPreloadList = ['TWL', 'LT', 'ST', 'TN2', 'TQ2', 'SN', 'SQ'];else if (dataSet === 'BOTH') repoPreloadList = ['TWL', 'LT', 'ST', 'TN', 'TN2', 'TQ', 'TQ2', 'SN', 'SQ'];whichTestament = books.testament(bookID); // returns 'old' or 'new'
                (0, _utilities.logicAssert)(whichTestament === 'old' || whichTestament === 'new', "BookPackageCheck() couldn't find testament for '".concat(bookID, "'"));origLangRepo = whichTestament === 'old' ? 'UHB' : 'UGNT';repoPreloadList.unshift(origLangRepo);}if (!checkingOptions.disableAllLinkFetchingFlag) {// Both Bible books and OBS refer to TW and TA
                repoPreloadList.push('TW');repoPreloadList.push('TA');} // debugLog(`BookPackageCheck got repoPreloadList=${repoPreloadList} for dataSet=${dataSet}`)
              // if (bookID !== 'OBS') { // Preload the reference repos
              setResultValue( /*#__PURE__*/_react.default.createElement("p", { style: { color: 'magenta' } }, "Preloading ", repoPreloadList.length, " repos for ", /*#__PURE__*/_react.default.createElement("i", null, username), " ", languageCode, " ready for ", /*#__PURE__*/_react.default.createElement("b", null, bookID), " book package check\u2026"));_context.next = 22;return (0, _core.preloadReposIfNecessary)(username, languageCode, [bookID], branch, repoPreloadList);case 22:successFlag = _context.sent;if (!successFlag) console.error("BookPackageCheck error: Failed to pre-load all repos"); // }
              // Display our "waiting" message
              setResultValue( /*#__PURE__*/_react.default.createElement("p", { style: { color: 'magenta' } }, "Checking ", /*#__PURE__*/_react.default.createElement("i", null, username), " ", languageCode, " ", /*#__PURE__*/_react.default.createElement("b", null, bookID), " book package\u2026"));_context.next = 27;return (0, _checkBookPackage.checkBookPackage)(username, languageCode, bookID, setResultValue, checkingOptions);case 27:rawCBPResults = _context.sent; // Add some extra fields to our rawCBPResults object in case we need this information again later
              rawCBPResults.checkType = 'BookPackage';rawCBPResults.username = username;rawCBPResults.languageCode = languageCode;rawCBPResults.bookID = bookID;rawCBPResults.checkedOptions = checkingOptions; // debugLog("Here with CBP rawCBPResults", typeof rawCBPResults);
              // Now do our final handling of the result -- we have some options available
              processOptions = {// Uncomment any of these to test them
                // 'maximumSimilarMessages': 4, // default is 3 -- 0 means don’t suppress
                // 'errorPriorityLevel': 800, // default is 700
                // 'cutoffPriorityLevel': 100, // default is 0
                // 'sortBy': 'ByRepo', // default is 'ByPriority', also have 'AsFound'
                // 'ignorePriorityNumberList': [123, 202], // default is []
              }; // Or this allows the parameters to be specified as a BookPackageCheck property
              if (props.maximumSimilarMessages) processOptions.maximumSimilarMessages = (0, _core.ourParseInt)(props.maximumSimilarMessages);if (props.errorPriorityLevel) processOptions.errorPriorityLevel = (0, _core.ourParseInt)(props.errorPriorityLevel); // if (props.cutoffPriorityLevel) processOptions.cutoffPriorityLevel = ourParseInt(props.cutoffPriorityLevel);
              if (props.sortBy) processOptions.sortBy = props.sortBy;if (props.ignorePriorityNumberList) {// We need to convert from string to Array
                //parameterAssert(props.ignorePriorityNumberList[0] === '[' && props.ignorePriorityNumberList[props.ignorePriorityNumberList.length - 1] === ']', `Format of props.ignorePriorityNumberList '${props.ignorePriorityNumberList}' is wrong should be enclosed in []`)
                processOptions.ignorePriorityNumberList = [];_iterator = _createForOfIteratorHelper(props.ignorePriorityNumberList.substring(1, props.ignorePriorityNumberList.length - 1).split(','));try {for (_iterator.s(); !(_step = _iterator.n()).done;) {stringBit = _step.value;intBit = (0, _core.ourParseInt)(stringBit.trim()); // trim allows comma,space to also be used as separator
                    processOptions.ignorePriorityNumberList.push(intBit);} // debugLog(`Now have processOptions.ignorePriorityNumberList=${JSON.stringify(processOptions.ignorePriorityNumberList)}`);
                } catch (err) {_iterator.e(err);} finally {_iterator.f();}}if (props.showDisabledNoticesFlag) processOptions.showDisabledNoticesFlag = props.showDisabledNoticesFlag.toLowerCase() === 'true';displayType = 'ErrorsWarnings'; // default
              if (props.displayType) displayType = props.displayType;if (displayType === 'ErrorsWarnings') {processedResults = (0, _noticeProcessingFunctions.processNoticesToErrorsWarnings)(rawCBPResults, processOptions); //             userLog(`BookPackageCheck got back processedResults with ${processedResults.successList.length.toLocaleString()} success message(s), ${processedResults.errorList.length.toLocaleString()} error(s) and ${processedResults.warningList.length.toLocaleString()} warning(s)
                //   numIgnoredNotices=${processedResults.numIgnoredNotices.toLocaleString()} numHiddenErrors=${processedResults.numHiddenErrors.toLocaleString()} numHiddenWarnings=${processedResults.numHiddenWarnings.toLocaleString()}`);
                // debugLog("Here now in rendering bit!");
                if (processedResults.errorList.length || processedResults.warningList.length) setResultValue( /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, renderSummary(processedResults), /*#__PURE__*/_react.default.createElement(_RenderProcessedResults.RenderSuccessesErrorsWarnings, { results: processedResults })));else // no errors or warnings
                  setResultValue( /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, renderSummary(processedResults), /*#__PURE__*/_react.default.createElement(_RenderProcessedResults.RenderSuccessesErrorsWarnings, { results: processedResults })));} else if (displayType === 'SevereMediumLow') {_processedResults = (0, _noticeProcessingFunctions.processNoticesToSevereMediumLow)(rawCBPResults, processOptions); //             userLog(`BookPackageCheck got back processedResults with ${processedResults.successList.length.toLocaleString()} success message(s), ${processedResults.errorList.length.toLocaleString()} error(s) and ${processedResults.warningList.length.toLocaleString()} warning(s)
                //   numIgnoredNotices=${processedResults.numIgnoredNotices.toLocaleString()} numHiddenErrors=${processedResults.numHiddenErrors.toLocaleString()} numHiddenWarnings=${processedResults.numHiddenWarnings.toLocaleString()}`);
                if (_processedResults.severeList.length || _processedResults.mediumList.length || _processedResults.lowList.length) setResultValue( /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, renderSummary(_processedResults), /*#__PURE__*/_react.default.createElement(_RenderProcessedResults.RenderSuccessesSevereMediumLow, { results: _processedResults })));else // no severe, medium, or low notices
                  setResultValue( /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, renderSummary(_processedResults), /*#__PURE__*/_react.default.createElement(_RenderProcessedResults.RenderSuccessesSevereMediumLow, { results: _processedResults })));

              } else if (displayType === 'SingleList') {
                _processedResults2 = (0, _noticeProcessingFunctions.processNoticesToSingleList)(rawCBPResults, processOptions);
                // debugLog(`BookPackageCheck got back processedResults with ${processedResults.successList.length.toLocaleString()} success message(s) and ${processedResults.warningList.length.toLocaleString()} notice(s)
                //   numIgnoredNotices=${processedResults.numIgnoredNotices.toLocaleString()} numHiddenWarnings=${processedResults.numHiddenWarnings.toLocaleString()}`);

                if (_processedResults2.warningList.length)
                setResultValue( /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null,
                renderSummary(_processedResults2), /*#__PURE__*/
                _react.default.createElement(_RenderProcessedResults.RenderSuccessesNoticesGradient, { results: _processedResults2 })));else

                  // no warnings
                  setResultValue( /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null,
                  renderSummary(_processedResults2), /*#__PURE__*/
                  _react.default.createElement(_RenderProcessedResults.RenderSuccessesNoticesGradient, { results: _processedResults2 })));

              } else setResultValue( /*#__PURE__*/_react.default.createElement("b", { style: { color: 'red' } }, "Invalid displayType='", displayType, "'"));

              // debugLog("Finished rendering bit.");
            case 42:case "end":return _context.stop();}}}, _callee);}))(); // end of async part in unnamedFunction
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [bookID, branch, JSON.stringify(checkingOptions), languageCode, JSON.stringify(props), username]); // end of useEffect part

  // {/* <div className={classes.root}> */}
  return /*#__PURE__*/(
    _react.default.createElement("div", { className: "Fred" },
    result));


}

// BookPackageCheck.propTypes = {
//   /** @ignore */
//   username: PropTypes.object.isRequired,
//   /** @ignore */
//   languageCode: PropTypes.object.isRequired,
//   bookID: PropTypes.object.isRequired,
//   props: PropTypes.object,
// };

// const styles = theme => ({
//   root: {
//   },
// });
var _default =
BookPackageCheck;exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9kZW1vcy9ib29rLXBhY2thZ2UtY2hlY2svQm9va1BhY2thZ2VDaGVjay5qcyJdLCJuYW1lcyI6WyJCb29rUGFja2FnZUNoZWNrIiwicHJvcHMiLCJyZXN1bHQiLCJzZXRSZXN1bHRWYWx1ZSIsInVzZXJuYW1lIiwibGFuZ3VhZ2VDb2RlIiwiYm9va0lEIiwiZGF0YVNldCIsImJyYW5jaCIsImNoZWNraW5nT3B0aW9ucyIsImNoZWNrTWFuaWZlc3RGbGFnIiwiY2hlY2tSZWFkbWVGbGFnIiwiY2hlY2tMaWNlbnNlRmxhZyIsInN1cHByZXNzTm90aWNlRGlzYWJsaW5nRmxhZyIsImV4Y2VycHRMZW5ndGgiLCJjdXRvZmZQcmlvcml0eUxldmVsIiwiZGlzYWJsZUFsbExpbmtGZXRjaGluZ0ZsYWciLCJ0b0xvd2VyQ2FzZSIsImRpc2FibGVMaW5rZWRUQUFydGljbGVzQ2hlY2tGbGFnIiwiZGlzYWJsZUxpbmtlZFRXQXJ0aWNsZXNDaGVja0ZsYWciLCJyZW5kZXJTdW1tYXJ5IiwicHJvY2Vzc2VkUmVzdWx0cyIsInVuZGVmaW5lZCIsInJhd0NCUFJlc3VsdHMiLCJub3RpY2VMaXN0IiwibGVuZ3RoIiwid2FpdCIsImNvbG9yIiwiYm9va3MiLCJpc1ZhbGlkQm9va0lEIiwicmVsb2FkQWxsRmlsZXNGaXJzdCIsInNsaWNlIiwidG9VcHBlckNhc2UiLCJyZXBvUHJlbG9hZExpc3QiLCJ3aGljaFRlc3RhbWVudCIsInRlc3RhbWVudCIsIm9yaWdMYW5nUmVwbyIsInVuc2hpZnQiLCJwdXNoIiwic3VjY2Vzc0ZsYWciLCJjb25zb2xlIiwiZXJyb3IiLCJjaGVja1R5cGUiLCJjaGVja2VkT3B0aW9ucyIsInByb2Nlc3NPcHRpb25zIiwibWF4aW11bVNpbWlsYXJNZXNzYWdlcyIsImVycm9yUHJpb3JpdHlMZXZlbCIsInNvcnRCeSIsImlnbm9yZVByaW9yaXR5TnVtYmVyTGlzdCIsInN1YnN0cmluZyIsInNwbGl0Iiwic3RyaW5nQml0IiwiaW50Qml0IiwidHJpbSIsInNob3dEaXNhYmxlZE5vdGljZXNGbGFnIiwiZGlzcGxheVR5cGUiLCJlcnJvckxpc3QiLCJ3YXJuaW5nTGlzdCIsInNldmVyZUxpc3QiLCJtZWRpdW1MaXN0IiwibG93TGlzdCIsIkpTT04iLCJzdHJpbmdpZnkiXSwibWFwcGluZ3MiOiJtZ0JBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxpRDs7O0FBR0E7OztBQUdBLFNBQVNBLGdCQUFULEVBQTBCLG1DQUFvQ0MsS0FBOUQsRUFBcUU7QUFDakU7QUFDQSxrQkFBaUMscUJBQVMsMEJBQVQsQ0FBakMseURBQU9DLE1BQVAsaUJBQWVDLGNBQWY7O0FBRUE7QUFDQTtBQUNBOztBQUVBLE1BQUlDLFFBQVEsR0FBR0gsS0FBSyxDQUFDRyxRQUFyQjtBQUNBO0FBQ0EsTUFBSUMsWUFBWSxHQUFHSixLQUFLLENBQUNJLFlBQXpCO0FBQ0E7QUFDQSxNQUFJQyxNQUFNLEdBQUdMLEtBQUssQ0FBQ0ssTUFBbkI7QUFDQTtBQUNBLE1BQUlDLE9BQU8sR0FBR04sS0FBSyxDQUFDTSxPQUFwQjtBQUNBO0FBQ0EsTUFBSUMsTUFBTSxHQUFHUCxLQUFLLENBQUNPLE1BQW5CO0FBQ0E7O0FBRUEsTUFBTUMsZUFBZSxHQUFHLEVBQUU7QUFDdEJGLElBQUFBLE9BQU8sRUFBRUEsT0FEVyxFQUNGO0FBQ2xCO0FBQ0FHLElBQUFBLGlCQUFpQixFQUFFLElBSEM7QUFJcEJDLElBQUFBLGVBQWUsRUFBRSxJQUpHO0FBS3BCQyxJQUFBQSxnQkFBZ0IsRUFBRSxJQUxFO0FBTXBCQyxJQUFBQSwyQkFBMkIsRUFBRSxJQU5ULENBTWU7QUFOZixHQUF4QjtBQVFBO0FBQ0EsTUFBSVosS0FBSyxDQUFDYSxhQUFWLEVBQXlCTCxlQUFlLENBQUNLLGFBQWhCLEdBQWdDLHVCQUFZYixLQUFLLENBQUNhLGFBQWxCLENBQWhDO0FBQ3pCLE1BQUliLEtBQUssQ0FBQ2MsbUJBQVYsRUFBK0JOLGVBQWUsQ0FBQ00sbUJBQWhCLEdBQXNDLHVCQUFZZCxLQUFL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RUFBQyxNQUFmO0FBQ0tGLElBQUFBLE1BREwsQ0FESjs7O0FBS0g7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFZUYsZ0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUsIHVzZUVmZmVjdCB9IGZyb20gJ3JlYWN0Jztcbi8vIGltcG9ydCB7IHdpdGhTdHlsZXMgfSBmcm9tICdAbWF0ZXJpYWwtdWkvY29yZS9zdHlsZXMnO1xuaW1wb3J0ICogYXMgYm9va3MgZnJvbSAnLi4vLi4vY29yZS9ib29rcy9ib29rcyc7XG5pbXBvcnQgeyBjbGVhckNhY2hlcywgY2xlYXJDaGVja2VkQXJ0aWNsZUNhY2hlLCBvdXJQYXJzZUludCwgcHJlbG9hZFJlcG9zSWZOZWNlc3NhcnkgfSBmcm9tICcuLi8uLi9jb3JlJztcbmltcG9ydCB7IHByb2Nlc3NOb3RpY2VzVG9FcnJvcnNXYXJuaW5ncywgcHJvY2Vzc05vdGljZXNUb1NldmVyZU1lZGl1bUxvdywgcHJvY2Vzc05vdGljZXNUb1NpbmdsZUxpc3QgfSBmcm9tICcuLi9ub3RpY2UtcHJvY2Vzc2luZy1mdW5jdGlvbnMnO1xuaW1wb3J0IHsgUmVuZGVyQ2hlY2tlZEZpbGVzTGlzdCwgUmVuZGVyU3VjY2Vzc2VzRXJyb3JzV2FybmluZ3MsIFJlbmRlclN1Y2Nlc3Nlc1NldmVyZU1lZGl1bUxvdywgUmVuZGVyU3VjY2Vzc2VzTm90aWNlc0dyYWRpZW50LCBSZW5kZXJUb3RhbHMgfSBmcm9tICcuLi9SZW5kZXJQcm9jZXNzZWRSZXN1bHRzJztcbmltcG9ydCB7IGNoZWNrQm9va1BhY2thZ2UgfSBmcm9tICcuL2NoZWNrQm9va1BhY2thZ2UnO1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVudXNlZC12YXJzXG5pbXBvcnQgeyB1c2VyTG9nLCBkZWJ1Z0xvZywgcGFyYW1ldGVyQXNzZXJ0LCBsb2dpY0Fzc2VydCB9IGZyb20gJy4uLy4uL2NvcmUvdXRpbGl0aWVzJztcblxuXG4vLyBjb25zdCBCUF9WQUxJREFUT1JfVkVSU0lPTl9TVFJJTkcgPSAnMC41LjUnO1xuXG5cbmZ1bmN0aW9uIEJvb2tQYWNrYWdlQ2hlY2soLyp1c2VybmFtZSwgbGFuZ3VhZ2VDb2RlLCBib29rSUQsKi8gcHJvcHMpIHtcbiAgICAvLyBDaGVjayBhIHNpbmdsZSBCaWJsZSBib29rIGFjcm9zcyBtYW55IHJlcG9zaXRvcmllc1xuICAgIGNvbnN0IFtyZXN1bHQsIHNldFJlc3VsdFZhbHVlXSA9IHVzZVN0YXRlKFwiV2FpdGluZy1DaGVja0Jvb2tQYWNrYWdlXCIpO1xuXG4gICAgLy8gZGVidWdMb2coYEknbSBoZXJlIGluIEJvb2tQYWNrYWdlQ2hlY2sgdiR7QlBfVkFMSURBVE9SX1ZFUlNJT05fU1RSSU5HfWApO1xuICAgIC8vIGNvbnNvbGVMb2dPYmplY3QoXCJwcm9wc1wiLCBwcm9wcyk7XG4gICAgLy8gY29uc29sZUxvZ09iamVjdChcInByb3BzLmNsYXNzZXNcIiwgcHJvcHMuY2xhc3Nlcyk7XG5cbiAgICBsZXQgdXNlcm5hbWUgPSBwcm9wcy51c2VybmFtZTtcbiAgICAvLyBkZWJ1Z0xvZyhgdXNlcm5hbWU9JyR7dXNlcm5hbWV9J2ApO1xuICAgIGxldCBsYW5ndWFnZUNvZGUgPSBwcm9wcy5sYW5ndWFnZUNvZGU7XG4gICAgLy8gZGVidWdMb2coYGxhbmd1YWdlQ29kZT0nJHtsYW5ndWFnZUNvZGV9J2ApO1xuICAgIGxldCBib29rSUQgPSBwcm9wcy5ib29rSUQ7XG4gICAgLy8gZGVidWdMb2coYGJvb2tJRD0nJHtib29rSUR9J2ApO1xuICAgIGxldCBkYXRhU2V0ID0gcHJvcHMuZGF0YVNldDtcbiAgICAvLyBkZWJ1Z0xvZyhgZGF0YVNldD0nJHtkYXRhU2V0fSdgKTtcbiAgICBsZXQgYnJhbmNoID0gcHJvcHMuYnJhbmNoO1xuICAgIC8vIGRlYnVnTG9nKGBicmFuY2g9JyR7YnJhbmNofSdgKTtcblxuICAgIGNvbnN0IGNoZWNraW5nT3B0aW9ucyA9IHsgLy8gVW5jb21tZW50IGFueSBvZiB0aGVzZSB0byB0ZXN0IHRoZW1cbiAgICAgICAgZGF0YVNldDogZGF0YVNldCwgLy8gQ2FuIGJlICdPTEQnIChNYXJrZG93biwgZXRjLiksICdORVcnIChUU1Ygb25seSksIG9yICdCT1RIJywgb3IgJ0RFRkFVTFQnXG4gICAgICAgIC8vIGV4Y2VycHRMZW5ndGg6IDI1LCAvLyBkZWZhdWx0IGlzIDIwIGNoYXJhY3RlcnNcbiAgICAgICAgY2hlY2tNYW5pZmVzdEZsYWc6IHRydWUsXG4gICAgICAgIGNoZWNrUmVhZG1lRmxhZzogdHJ1ZSxcbiAgICAgICAgY2hlY2tMaWNlbnNlRmxhZzogdHJ1ZSxcbiAgICAgICAgc3VwcHJlc3NOb3RpY2VEaXNhYmxpbmdGbGFnOiB0cnVlLCAvLyBMZWF2ZSB0aGlzIG9uZSBhcyB0cnVlIChvdGhlcndpc2UgZGVtbyBjaGVja3MgYXJlIGxlc3MgZWZmaWNpZW50KVxuICAgIH07XG4gICAgLy8gT3IgdGhpcyBhbGxvd3MgdGhlIHBhcmFtZXRlcnMgdG8gYmUgc3BlY2lmaWVkIGFzIGEgQm9va1BhY2thZ2VDaGVjayBwcm9wZXJ0eVxuICAgIGlmIChwcm9wcy5leGNlcnB0TGVuZ3RoKSBjaGVja2luZ09wdGlvbnMuZXhjZXJwdExlbmd0aCA9IG91clBhcnNlSW50KHByb3BzLmV4Y2VycHRMZW5ndGgpO1xuICAgIGlmIChwcm9wcy5jdXRvZmZQcmlvcml0eUxldmVsKSBjaGVja2luZ09wdGlvbnMuY3V0b2ZmUHJpb3JpdHlMZXZlbCA9IG91clBhcnNlSW50KHByb3BzLmN1dG9mZlByaW9yaXR5TGV2ZWwpO1xuICAgIGlmIChwcm9wcy5kaXNhYmxlQWxsTGlua0ZldGNoaW5nRmxhZykgY2hlY2tpbmdPcHRpb25zLmRpc2FibGVBbGxMaW5rRmV0Y2hpbmdGbGFnID0gcHJvcHMuZGlzYWJsZUFsbExpbmtGZXRjaGluZ0ZsYWcudG9Mb3dlckNhc2UoKSA9PT0gJ3RydWUnO1xuICAgIGlmIChwcm9wcy5kaXNhYmxlTGlua2VkVEFBcnRpY2xlc0NoZWNrRmxhZykgY2hlY2tpbmdPcHRpb25zLmRpc2FibGVMaW5rZWRUQUFydGljbGVzQ2hlY2tGbGFnID0gcHJvcHMuZGlzYWJsZUxpbmtlZFRBQXJ0aWNsZXNDaGVja0ZsYWcudG9Mb3dlckNhc2UoKSA9PT0gJ3RydWUnO1xuICAgIGlmIChwcm9wcy5kaXNhYmxlTGlua2VkVFdBcnRpY2xlc0NoZWNrRmxhZykgY2hlY2tpbmdPcHRpb25zLmRpc2FibGVMaW5rZWRUV0FydGljbGVzQ2hlY2tGbGFnID0gcHJvcHMuZGlzYWJsZUxpbmtlZFRXQXJ0aWNsZXNDaGVja0ZsYWcudG9Mb3dlckNhc2UoKSA9PT0gJ3RydWUnO1xuICAgIC8vIGZ1bmN0aW9uTG9nKGBjaGVja2luZ09wdGlvbnMuZGlzYWJsZUxpbmtlZFRBQXJ0aWNsZXNDaGVja0ZsYWcgJHtjaGVja2luZ09wdGlvbnMuZGlzYWJsZUxpbmtlZFRBQXJ0aWNsZXNDaGVja0ZsYWd9IGZyb20gJyR7cHJvcHMuZGlzYWJsZUxpbmtlZFRBQXJ0aWNsZXNDaGVja0ZsYWd9J2ApO1xuICAgIC8vIGZ1bmN0aW9uTG9nKGBjaGVja2luZ09wdGlvbnMuZGlzYWJsZUxpbmtlZFRXQXJ0aWNsZXNDaGVja0ZsYWcgJHtjaGVja2luZ09wdGlvbnMuZGlzYWJsZUxpbmtlZFRXQXJ0aWNsZXNDaGVja0ZsYWd9IGZyb20gJyR7cHJvcHMuZGlzYWJsZUxpbmtlZFRXQXJ0aWNsZXNDaGVja0ZsYWd9J2ApO1xuXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgLy8gY29uc3QgbmV3UHJvcHMgPSB7IGJvb2tJRCwgYnJhbmNoLCBjaGVja2luZ09wdGlvbnMsIGxhbmd1YWdlQ29kZSwgY3V0b2ZmUHJpb3JpdHlMZXZlbDogcHJvcHMuY3V0b2ZmUHJpb3JpdHlMZXZlbCwgZGlzcGxheVR5cGU6IHByb3BzLmRpc3BsYXlUeXBlLCBlcnJvclByaW9yaXR5TGV2ZWw6IHByb3BzLmVycm9yUHJpb3JpdHlMZXZlbCwgbWF4aW11bVNpbWlsYXJNZXNzYWdlczogcHJvcHMubWF4aW11bVNpbWlsYXJNZXNzYWdlcywgc29ydEJ5OiBwcm9wcy5zb3J0QnksIHVzZXJuYW1lfTtcbiAgICAgICAgLy8gZGVidWdMb2coXCJCb29rUGFja2FnZUNoZWNrLnVzZUVmZmVjdCgpIGNhbGxlZCB3aXRoIFwiLCBKU09OLnN0cmluZ2lmeShuZXdQcm9wcykpO1xuXG4gICAgICAgIC8vIFVzZSBhbiBJSUZFIChJbW1lZGlhdGVseSBJbnZva2VkIEZ1bmN0aW9uIEV4cHJlc3Npb24pXG4gICAgICAgIC8vICBlLmcuLCBzZWUgaHR0cHM6Ly9tZWRpdW0uY29tL2phdmFzY3JpcHQtaW4tcGxhaW4tZW5nbGlzaC9odHRwcy1tZWRpdW0tY29tLWphdmFzY3JpcHQtaW4tcGxhaW4tZW5nbGlzaC1zdG9wLWZlZWxpbmctaWZmeS1hYm91dC11c2luZy1hbi1paWZlLTdiMDI5MmFiYTE3NFxuICAgICAgICAoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgLy8gZGVidWdMb2coXCJTdGFydGVkIEJvb2tQYWNrYWdlQ2hlY2sudW5uYW1lZEZ1bmN0aW9uKClcIik7XG5cbiAgICAgICAgICAgIC8vIE5PVEUgZnJvbSBSSkg6IEkgY2Fu4oCZdCBmaW5kIHRoZSBjb3JyZWN0IFJlYWN0IHBsYWNlIGZvciB0aGlzIC8gd2F5IHRvIGRvIHRoaXNcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICAgc28gaXQgc2hvd3MgYSB3YXJuaW5nIGZvciB0aGUgdXNlciwgYW5kIGRvZXNu4oCZdCBjb250aW51ZSB0byB0cnkgdG8gcHJvY2Vzc1xuICAgICAgICAgICAgaWYgKCFwcm9wcy53YWl0IHx8IHByb3BzLndhaXQgIT09ICdOJykge1xuICAgICAgICAgICAgICAgIHNldFJlc3VsdFZhbHVlKDxwPjxzcGFuIHN0eWxlPXt7IGNvbG9yOiAnYmx1ZScgfX0+V2FpdGluZyBmb3IgdXNlcuKApjwvc3Bhbj4gKEFkanVzdCBzZXR0aW5ncyBiZWxvdyBhcyBuZWNlc3NhcnkgYW5kIHRoZW4gc2V0IDxiPndhaXQ9J04nPC9iPiB0byBzdGFydCk8L3A+KTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIE5PVEUgZnJvbSBSSkg6IEkgY2Fu4oCZdCBmaW5kIHRoZSBjb3JyZWN0IFJlYWN0IHBsYWNlIGZvciB0aGlzIC8gd2F5IHRvIGRvIHRoaXNcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICAgc28gaXQgc2hvd3MgYSB3YXJuaW5nIGZvciB0aGUgdXNlciwgYW5kIGRvZXNu4oCZdCBjb250aW51ZSB0byB0cnkgdG8gcHJvY2Vzc1xuICAgICAgICAgICAgaWYgKGJvb2tJRCAhPT0gJ09CUycgJiYgIWJvb2tzLmlzVmFsaWRCb29rSUQoYm9va0lEKSkge1xuICAgICAgICAgICAgICAgIHVzZXJMb2coYEludmFsaWQgJyR7Ym9va0lEfScgYm9va0lEIGdpdmVuIWApXG4gICAgICAgICAgICAgICAgc2V0UmVzdWx0VmFsdWUoPHAgc3R5bGU9e3sgY29sb3I6ICdyZWQnIH19PlBsZWFzZSBlbnRlciBhIHZhbGlkIFVTRk0gYm9vayBpZGVudGlmaWVyIG9yICdPQlMnLiAoJzxiPntib29rSUR9PC9iPicgaXMgbm90IHZhbGlkLik8L3A+KTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChwcm9wcy5yZWxvYWRBbGxGaWxlc0ZpcnN0ICYmIHByb3BzLnJlbG9hZEFsbEZpbGVzRmlyc3Quc2xpY2UoMCkudG9VcHBlckNhc2UoKSA9PT0gJ1knKSB7XG4gICAgICAgICAgICAgICAgdXNlckxvZyhcIkNsZWFyaW5nIGNhY2hlIGJlZm9yZSBydW5uaW5nIGJvb2sgcGFja2FnZSBjaGVja+KAplwiKTtcbiAgICAgICAgICAgICAgICBzZXRSZXN1bHRWYWx1ZSg8cCBzdHlsZT17eyBjb2xvcjogJ29yYW5nZScgfX0+Q2xlYXJpbmcgY2FjaGUgYmVmb3JlIHJ1bm5pbmcgYm9vayBwYWNrYWdlIGNoZWNr4oCmPC9wPik7XG4gICAgICAgICAgICAgICAgYXdhaXQgY2xlYXJDYWNoZXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgYXdhaXQgY2xlYXJDaGVja2VkQXJ0aWNsZUNhY2hlKCk7IC8vIG90aGVyd2lzZSB3ZSB3b3VsZG4ndCBzZWUgYW55IG9mIHRoZSB3YXJuaW5ncyBhZ2FpbiBmcm9tIGNoZWNraW5nIHRoZXNlXG5cbiAgICAgICAgICAgIC8vIExvYWQgd2hvbGUgcmVwbyB6aXAgZmlsZXMgd2hpY2ggaXMgbWF5YmUgZmFzdGVyIHRoYW4gbG9hZGluZyBzZXZlcmFsIGluZGl2aWR1YWwgZmlsZXNcbiAgICAgICAgICAgIC8vICBlc3BlY2lhbGx5IGlmIHdlIGFyZSBnb2luZyB0byBhbHNvIGNoZWNrIHRoZSBtYW5pZmVzdHMsIGxpY2Vuc2UsIGFuZCBSZWFkTWUgZmlsZXMgYXMgd2VsbCBhcyB0aGUgYm9vayBmaWxlLlxuICAgICAgICAgICAgLy8gUmVtZW1iZXIgdGhhdCB0aGUgbWFuaWZlc3QgY2hlY2sgYWN0dWFsbHkgY2hlY2tzIHRoZSBleGlzdGVuY2Ugb2YgYWxsIHRoZSBwcm9qZWN0cywgaS5lLiwgYWxsIGZpbGVzIGluIHRoZSByZXBvXG4gICAgICAgICAgICBsZXQgcmVwb1ByZWxvYWRMaXN0O1xuICAgICAgICAgICAgaWYgKGJvb2tJRCA9PT0gJ09CUycpIHtcbiAgICAgICAgICAgICAgICByZXBvUHJlbG9hZExpc3QgPSBbJ09CUycsICdPQlMtVFdMJywgJ09CUy1UTjInLCAnT0JTLVRRMicsICdPQlMtU04yJywgJ09CUy1TUTInXTsgLy8gZm9yIERFRkFVTFRcbiAgICAgICAgICAgICAgICBpZiAoZGF0YVNldCA9PT0gJ09MRCcpXG4gICAgICAgICAgICAgICAgICAgIHJlcG9QcmVsb2FkTGlzdCA9IFsnT0JTJywgJ09CUy1UV0wnLCAnT0JTLVROJywgJ09CUy1UUScsICdPQlMtU04nLCAnT0JTLVNRJ107XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoZGF0YVNldCA9PT0gJ05FVycpXG4gICAgICAgICAgICAgICAgICAgIHJlcG9QcmVsb2FkTGlzdCA9IFsnT0JTJywgJ09CUy1UV0wnLCAnT0JTLVROMicsICdPQlMtVFEyJywgJ09CUy1TTicsICdPQlMtU1EnXTtcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChkYXRhU2V0ID09PSAnQk9USCcpXG4gICAgICAgICAgICAgICAgICAgIHJlcG9QcmVsb2FkTGlzdCA9IFsnT0JTJywgJ09CUy1UV0wnLCAnT0JTLVROJywgJ09CUy1UTjInLCAnT0JTLVRRJywgJ09CUy1UUTInLCAnT0JTLVNOJywgJ09CUy1TTicsICdPQlMtU04yJywgJ09CUy1TUTInXTtcbiAgICAgICAgICAgIH0gZWxzZSB7IC8vIG5vdCBPQlNcbiAgICAgICAgICAgICAgICByZXBvUHJlbG9hZExpc3QgPSBbJ1RXTCcsICdMVCcsICdTVCcsICdUTicsICdUUScsICdTTicsICdTUSddOyAvLyBmb3IgREVGQVVMVFxuICAgICAgICAgICAgICAgIGlmIChkYXRhU2V0ID09PSAnT0xEJylcbiAgICAgICAgICAgICAgICAgICAgcmVwb1ByZWxvYWRMaXN0ID0gWydUV0wnLCAnTFQnLCAnU1QnLCAnVE4nLCAnVFEnXTtcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChkYXRhU2V0ID09PSAnTkVXJylcbiAgICAgICAgICAgICAgICAgICAgcmVwb1ByZWxvYWRMaXN0ID0gWydUV0wnLCAnTFQnLCAnU1QnLCAnVE4yJywgJ1RRMicsICdTTicsICdTUSddO1xuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGRhdGFTZXQgPT09ICdCT1RIJylcbiAgICAgICAgICAgICAgICAgICAgcmVwb1ByZWxvYWRMaXN0ID0gWydUV0wnLCAnTFQnLCAnU1QnLCAnVE4nLCAnVE4yJywgJ1RRJywgJ1RRMicsICdTTicsICdTUSddO1xuICAgICAgICAgICAgICAgIGNvbnN0IHdoaWNoVGVzdGFtZW50ID0gYm9va3MudGVzdGFtZW50KGJvb2tJRCk7IC8vIHJldHVybnMgJ29sZCcgb3IgJ25ldydcbiAgICAgICAgICAgICAgICBsb2dpY0Fzc2VydCh3aGljaFRlc3RhbWVudCA9PT0gJ29sZCcgfHwgd2hpY2hUZXN0YW1lbnQgPT09ICduZXcnLCBgQm9va1BhY2thZ2VDaGVjaygpIGNvdWxkbid0IGZpbmQgdGVzdGFtZW50IGZvciAnJHtib29rSUR9J2ApO1xuICAgICAgICAgICAgICAgIGNvbnN0IG9yaWdMYW5nUmVwbyA9IHdoaWNoVGVzdGFtZW50ID09PSAnb2xkJyA/ICdVSEInIDogJ1VHTlQnO1xuICAgICAgICAgICAgICAgIHJlcG9QcmVsb2FkTGlzdC51bnNoaWZ0KG9yaWdMYW5nUmVwbyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWNoZWNraW5nT3B0aW9ucy5kaXNhYmxlQWxsTGlua0ZldGNoaW5nRmxhZykgeyAvLyBCb3RoIEJpYmxlIGJvb2tzIGFuZCBPQlMgcmVmZXIgdG8gVFcgYW5kIFRBXG4gICAgICAgICAgICAgICAgcmVwb1ByZWxvYWRMaXN0LnB1c2goJ1RXJyk7XG4gICAgICAgICAgICAgICAgcmVwb1ByZWxvYWRMaXN0LnB1c2goJ1RBJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBkZWJ1Z0xvZyhgQm9va1BhY2thZ2VDaGVjayBnb3QgcmVwb1ByZWxvYWRMaXN0PSR7cmVwb1ByZWxvYWRMaXN0fSBmb3IgZGF0YVNldD0ke2RhdGFTZXR9YClcblxuICAgICAgICAgICAgLy8gaWYgKGJvb2tJRCAhPT0gJ09CUycpIHsgLy8gUHJlbG9hZCB0aGUgcmVmZXJlbmNlIHJlcG9zXG4gICAgICAgICAgICBzZXRSZXN1bHRWYWx1ZSg8cCBzdHlsZT17eyBjb2xvcjogJ21hZ2VudGEnIH19PlByZWxvYWRpbmcge3JlcG9QcmVsb2FkTGlzdC5sZW5ndGh9IHJlcG9zIGZvciA8aT57dXNlcm5hbWV9PC9pPiB7bGFuZ3VhZ2VDb2RlfSByZWFkeSBmb3IgPGI+e2Jvb2tJRH08L2I+IGJvb2sgcGFja2FnZSBjaGVja+KApjwvcD4pO1xuICAgICAgICAgICAgY29uc3Qgc3VjY2Vzc0ZsYWcgPSBhd2FpdCBwcmVsb2FkUmVwb3NJZk5lY2Vzc2FyeSh1c2VybmFtZSwgbGFuZ3VhZ2VDb2RlLCBbYm9va0lEXSwgYnJhbmNoLCByZXBvUHJlbG9hZExpc3QpO1xuICAgICAgICAgICAgaWYgKCFzdWNjZXNzRmxhZylcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBCb29rUGFja2FnZUNoZWNrIGVycm9yOiBGYWlsZWQgdG8gcHJlLWxvYWQgYWxsIHJlcG9zYClcbiAgICAgICAgICAgIC8vIH1cblxuICAgICAgICAgICAgLy8gRGlzcGxheSBvdXIgXCJ3YWl0aW5nXCIgbWVzc2FnZVxuICAgICAgICAgICAgc2V0UmVzdWx0VmFsdWUoPHAgc3R5bGU9e3sgY29sb3I6ICdtYWdlbnRhJyB9fT5DaGVja2luZyA8aT57dXNlcm5hbWV9PC9pPiB7bGFuZ3VhZ2VDb2RlfSA8Yj57Ym9va0lEfTwvYj4gYm9vayBwYWNrYWdl4oCmPC9wPik7XG5cbiAgICAgICAgICAgIGNvbnN0IHJhd0NCUFJlc3VsdHMgPSBhd2FpdCBjaGVja0Jvb2tQYWNrYWdlKHVzZXJuYW1lLCBsYW5ndWFnZUNvZGUsIGJvb2tJRCwgc2V0UmVzdWx0VmFsdWUsIGNoZWNraW5nT3B0aW9ucyk7XG5cbiAgICAgICAgICAgIC8vIEFkZCBzb21lIGV4dHJhIGZpZWxkcyB0byBvdXIgcmF3Q0JQUmVzdWx0cyBvYmplY3QgaW4gY2FzZSB3ZSBuZWVkIHRoaXMgaW5mb3JtYXRpb24gYWdhaW4gbGF0ZXJcbiAgICAgICAgICAgIHJhd0NCUFJlc3VsdHMuY2hlY2tUeXBlID0gJ0Jvb2tQYWNrYWdlJztcbiAgICAgICAgICAgIHJhd0NCUFJlc3VsdHMudXNlcm5hbWUgPSB1c2VybmFtZTtcbiAgICAgICAgICAgIHJhd0NCUFJlc3VsdHMubGFuZ3VhZ2VDb2RlID0gbGFuZ3VhZ2VDb2RlO1xuICAgICAgICAgICAgcmF3Q0JQUmVzdWx0cy5ib29rSUQgPSBib29rSUQ7XG4gICAgICAgICAgICByYXdDQlBSZXN1bHRzLmNoZWNrZWRPcHRpb25zID0gY2hlY2tpbmdPcHRpb25zO1xuXG4gICAgICAgICAgICAvLyBkZWJ1Z0xvZyhcIkhlcmUgd2l0aCBDQlAgcmF3Q0JQUmVzdWx0c1wiLCB0eXBlb2YgcmF3Q0JQUmVzdWx0cyk7XG4gICAgICAgICAgICAvLyBOb3cgZG8gb3VyIGZpbmFsIGhhbmRsaW5nIG9mIHRoZSByZXN1bHQgLS0gd2UgaGF2ZSBzb21lIG9wdGlvbnMgYXZhaWxhYmxlXG4gICAgICAgICAgICBsZXQgcHJvY2Vzc09wdGlvbnMgPSB7IC8vIFVuY29tbWVudCBhbnkgb2YgdGhlc2UgdG8gdGVzdCB0aGVtXG4gICAgICAgICAgICAgICAgLy8gJ21heGltdW1TaW1pbGFyTWVzc2FnZXMnOiA0LCAvLyBkZWZhdWx0IGlzIDMgLS0gMCBtZWFucyBkb27igJl0IHN1cHByZXNzXG4gICAgICAgICAgICAgICAgLy8gJ2Vycm9yUHJpb3JpdHlMZXZlbCc6IDgwMCwgLy8gZGVmYXVsdCBpcyA3MDBcbiAgICAgICAgICAgICAgICAvLyAnY3V0b2ZmUHJpb3JpdHlMZXZlbCc6IDEwMCwgLy8gZGVmYXVsdCBpcyAwXG4gICAgICAgICAgICAgICAgLy8gJ3NvcnRCeSc6ICdCeVJlcG8nLCAvLyBkZWZhdWx0IGlzICdCeVByaW9yaXR5JywgYWxzbyBoYXZlICdBc0ZvdW5kJ1xuICAgICAgICAgICAgICAgIC8vICdpZ25vcmVQcmlvcml0eU51bWJlckxpc3QnOiBbMTIzLCAyMDJdLCAvLyBkZWZhdWx0IGlzIFtdXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLy8gT3IgdGhpcyBhbGxvd3MgdGhlIHBhcmFtZXRlcnMgdG8gYmUgc3BlY2lmaWVkIGFzIGEgQm9va1BhY2thZ2VDaGVjayBwcm9wZXJ0eVxuICAgICAgICAgICAgaWYgKHByb3BzLm1heGltdW1TaW1pbGFyTWVzc2FnZXMpIHByb2Nlc3NPcHRpb25zLm1heGltdW1TaW1pbGFyTWVzc2FnZXMgPSBvdXJQYXJzZUludChwcm9wcy5tYXhpbXVtU2ltaWxhck1lc3NhZ2VzKTtcbiAgICAgICAgICAgIGlmIChwcm9wcy5lcnJvclByaW9yaXR5TGV2ZWwpIHByb2Nlc3NPcHRpb25zLmVycm9yUHJpb3JpdHlMZXZlbCA9IG91clBhcnNlSW50KHByb3BzLmVycm9yUHJpb3JpdHlMZXZlbCk7XG4gICAgICAgICAgICAvLyBpZiAocHJvcHMuY3V0b2ZmUHJpb3JpdHlMZXZlbCkgcHJvY2Vzc09wdGlvbnMuY3V0b2ZmUHJpb3JpdHlMZXZlbCA9IG91clBhcnNlSW50KHByb3BzLmN1dG9mZlByaW9yaXR5TGV2ZWwpO1xuICAgICAgICAgICAgaWYgKHByb3BzLnNvcnRCeSkgcHJvY2Vzc09wdGlvbnMuc29ydEJ5ID0gcHJvcHMuc29ydEJ5O1xuICAgICAgICAgICAgaWYgKHByb3BzLmlnbm9yZVByaW9yaXR5TnVtYmVyTGlzdCkgeyAvLyBXZSBuZWVkIHRvIGNvbnZlcnQgZnJvbSBzdHJpbmcgdG8gQXJyYXlcbiAgICAgICAgICAgICAgICAvL3BhcmFtZXRlckFzc2VydChwcm9wcy5pZ25vcmVQcmlvcml0eU51bWJlckxpc3RbMF0gPT09ICdbJyAmJiBwcm9wcy5pZ25vcmVQcmlvcml0eU51bWJlckxpc3RbcHJvcHMuaWdub3JlUHJpb3JpdHlOdW1iZXJMaXN0Lmxlbmd0aCAtIDFdID09PSAnXScsIGBGb3JtYXQgb2YgcHJvcHMuaWdub3JlUHJpb3JpdHlOdW1iZXJMaXN0ICcke3Byb3BzLmlnbm9yZVByaW9yaXR5TnVtYmVyTGlzdH0nIGlzIHdyb25nIHNob3VsZCBiZSBlbmNsb3NlZCBpbiBbXWApXG4gICAgICAgICAgICAgICAgcHJvY2Vzc09wdGlvbnMuaWdub3JlUHJpb3JpdHlOdW1iZXJMaXN0ID0gW107XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBzdHJpbmdCaXQgb2YgcHJvcHMuaWdub3JlUHJpb3JpdHlOdW1iZXJMaXN0LnN1YnN0cmluZygxLCBwcm9wcy5pZ25vcmVQcmlvcml0eU51bWJlckxpc3QubGVuZ3RoIC0gMSkuc3BsaXQoJywnKSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpbnRCaXQgPSBvdXJQYXJzZUludChzdHJpbmdCaXQudHJpbSgpKTsgLy8gdHJpbSBhbGxvd3MgY29tbWEsc3BhY2UgdG8gYWxzbyBiZSB1c2VkIGFzIHNlcGFyYXRvclxuICAgICAgICAgICAgICAgICAgICBwcm9jZXNzT3B0aW9ucy5pZ25vcmVQcmlvcml0eU51bWJlckxpc3QucHVzaChpbnRCaXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBkZWJ1Z0xvZyhgTm93IGhhdmUgcHJvY2Vzc09wdGlvbnMuaWdub3JlUHJpb3JpdHlOdW1iZXJMaXN0PSR7SlNPTi5zdHJpbmdpZnkocHJvY2Vzc09wdGlvbnMuaWdub3JlUHJpb3JpdHlOdW1iZXJMaXN0KX1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwcm9wcy5zaG93RGlzYWJsZWROb3RpY2VzRmxhZykgcHJvY2Vzc09wdGlvbnMuc2hvd0Rpc2FibGVkTm90aWNlc0ZsYWcgPSBwcm9wcy5zaG93RGlzYWJsZWROb3RpY2VzRmxhZy50b0xvd2VyQ2FzZSgpID09PSAndHJ1ZSc7XG5cbiAgICAgICAgICAgIGxldCBkaXNwbGF5VHlwZSA9ICdFcnJvcnNXYXJuaW5ncyc7IC8vIGRlZmF1bHRcbiAgICAgICAgICAgIGlmIChwcm9wcy5kaXNwbGF5VHlwZSkgZGlzcGxheVR5cGUgPSBwcm9wcy5kaXNwbGF5VHlwZTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gcmVuZGVyU3VtbWFyeShwcm9jZXNzZWRSZXN1bHRzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICg8ZGl2PlxuICAgICAgICAgICAgICAgICAgICA8cD5DaGVja2VkIDxiPnt1c2VybmFtZX0ge2xhbmd1YWdlQ29kZX0ge2Jvb2tJRH08L2I+IChmcm9tIDxpPnticmFuY2ggPT09IHVuZGVmaW5lZCA/ICdERUZBVUxUJyA6IGJyYW5jaH08L2k+IGJyYW5jaGVzKTwvcD5cbiAgICAgICAgICAgICAgICAgICAgPFJlbmRlckNoZWNrZWRGaWxlc0xpc3QgdXNlcm5hbWU9e3VzZXJuYW1lfSByZXN1bHRzPXtwcm9jZXNzZWRSZXN1bHRzfSAvPlxuICAgICAgICAgICAgICAgICAgICA8UmVuZGVyVG90YWxzIHJhd05vdGljZUxpc3RMZW5ndGg9e3Jhd0NCUFJlc3VsdHMubm90aWNlTGlzdC5sZW5ndGh9IHJlc3VsdHM9e3Byb2Nlc3NlZFJlc3VsdHN9IC8+XG4gICAgICAgICAgICAgICAgICAgIHsvKiA8UmVuZGVyUmF3UmVzdWx0cyByZXN1bHRzPXtyYXdDQlBSZXN1bHRzfSAvPiAqL31cbiAgICAgICAgICAgICAgICA8L2Rpdj4pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZGlzcGxheVR5cGUgPT09ICdFcnJvcnNXYXJuaW5ncycpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9jZXNzZWRSZXN1bHRzID0gcHJvY2Vzc05vdGljZXNUb0Vycm9yc1dhcm5pbmdzKHJhd0NCUFJlc3VsdHMsIHByb2Nlc3NPcHRpb25zKTtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB1c2VyTG9nKGBCb29rUGFja2FnZUNoZWNrIGdvdCBiYWNrIHByb2Nlc3NlZFJlc3VsdHMgd2l0aCAke3Byb2Nlc3NlZFJlc3VsdHMuc3VjY2Vzc0xpc3QubGVuZ3RoLnRvTG9jYWxlU3RyaW5nKCl9IHN1Y2Nlc3MgbWVzc2FnZShzKSwgJHtwcm9jZXNzZWRSZXN1bHRzLmVycm9yTGlzdC5sZW5ndGgudG9Mb2NhbGVTdHJpbmcoKX0gZXJyb3IocykgYW5kICR7cHJvY2Vzc2VkUmVzdWx0cy53YXJuaW5nTGlzdC5sZW5ndGgudG9Mb2NhbGVTdHJpbmcoKX0gd2FybmluZyhzKVxuICAgICAgICAgICAgICAgIC8vICAgbnVtSWdub3JlZE5vdGljZXM9JHtwcm9jZXNzZWRSZXN1bHRzLm51bUlnbm9yZWROb3RpY2VzLnRvTG9jYWxlU3RyaW5nKCl9IG51bUhpZGRlbkVycm9ycz0ke3Byb2Nlc3NlZFJlc3VsdHMubnVtSGlkZGVuRXJyb3JzLnRvTG9jYWxlU3RyaW5nKCl9IG51bUhpZGRlbldhcm5pbmdzPSR7cHJvY2Vzc2VkUmVzdWx0cy5udW1IaWRkZW5XYXJuaW5ncy50b0xvY2FsZVN0cmluZygpfWApO1xuXG4gICAgICAgICAgICAgICAgLy8gZGVidWdMb2coXCJIZXJlIG5vdyBpbiByZW5kZXJpbmcgYml0IVwiKTtcblxuICAgICAgICAgICAgICAgIGlmIChwcm9jZXNzZWRSZXN1bHRzLmVycm9yTGlzdC5sZW5ndGggfHwgcHJvY2Vzc2VkUmVzdWx0cy53YXJuaW5nTGlzdC5sZW5ndGgpXG4gICAgICAgICAgICAgICAgICAgIHNldFJlc3VsdFZhbHVlKDw+XG4gICAgICAgICAgICAgICAgICAgICAgICB7cmVuZGVyU3VtbWFyeShwcm9jZXNzZWRSZXN1bHRzKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIDxSZW5kZXJTdWNjZXNzZXNFcnJvcnNXYXJuaW5ncyByZXN1bHRzPXtwcm9jZXNzZWRSZXN1bHRzfSAvPlxuICAgICAgICAgICAgICAgICAgICA8Lz4pO1xuICAgICAgICAgICAgICAgIGVsc2UgLy8gbm8gZXJyb3JzIG9yIHdhcm5pbmdzXG4gICAgICAgICAgICAgICAgICAgIHNldFJlc3VsdFZhbHVlKDw+XG4gICAgICAgICAgICAgICAgICAgICAgICB7cmVuZGVyU3VtbWFyeShwcm9jZXNzZWRSZXN1bHRzKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIDxSZW5kZXJTdWNjZXNzZXNFcnJvcnNXYXJuaW5ncyByZXN1bHRzPXtwcm9jZXNzZWRSZXN1bHRzfSAvPlxuICAgICAgICAgICAgICAgICAgICA8Lz4pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChkaXNwbGF5VHlwZSA9PT0gJ1NldmVyZU1lZGl1bUxvdycpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9jZXNzZWRSZXN1bHRzID0gcHJvY2Vzc05vdGljZXNUb1NldmVyZU1lZGl1bUxvdyhyYXdDQlBSZXN1bHRzLCBwcm9jZXNzT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgdXNlckxvZyhgQm9va1BhY2thZ2VDaGVjayBnb3QgYmFjayBwcm9jZXNzZWRSZXN1bHRzIHdpdGggJHtwcm9jZXNzZWRSZXN1bHRzLnN1Y2Nlc3NMaXN0Lmxlbmd0aC50b0xvY2FsZVN0cmluZygpfSBzdWNjZXNzIG1lc3NhZ2UocyksICR7cHJvY2Vzc2VkUmVzdWx0cy5lcnJvckxpc3QubGVuZ3RoLnRvTG9jYWxlU3RyaW5nKCl9IGVycm9yKHMpIGFuZCAke3Byb2Nlc3NlZFJlc3VsdHMud2FybmluZ0xpc3QubGVuZ3RoLnRvTG9jYWxlU3RyaW5nKCl9IHdhcm5pbmcocylcbiAgICAgICAgICAgICAgICAvLyAgIG51bUlnbm9yZWROb3RpY2VzPSR7cHJvY2Vzc2VkUmVzdWx0cy5udW1JZ25vcmVkTm90aWNlcy50b0xvY2FsZVN0cmluZygpfSBudW1IaWRkZW5FcnJvcnM9JHtwcm9jZXNzZWRSZXN1bHRzLm51bUhpZGRlbkVycm9ycy50b0xvY2FsZVN0cmluZygpfSBudW1IaWRkZW5XYXJuaW5ncz0ke3Byb2Nlc3NlZFJlc3VsdHMubnVtSGlkZGVuV2FybmluZ3MudG9Mb2NhbGVTdHJpbmcoKX1gKTtcblxuICAgICAgICAgICAgICAgIGlmIChwcm9jZXNzZWRSZXN1bHRzLnNldmVyZUxpc3QubGVuZ3RoIHx8IHByb2Nlc3NlZFJlc3VsdHMubWVkaXVtTGlzdC5sZW5ndGggfHwgcHJvY2Vzc2VkUmVzdWx0cy5sb3dMaXN0Lmxlbmd0aClcbiAgICAgICAgICAgICAgICAgICAgc2V0UmVzdWx0VmFsdWUoPD5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtyZW5kZXJTdW1tYXJ5KHByb2Nlc3NlZFJlc3VsdHMpfVxuICAgICAgICAgICAgICAgICAgICAgICAgPFJlbmRlclN1Y2Nlc3Nlc1NldmVyZU1lZGl1bUxvdyByZXN1bHRzPXtwcm9jZXNzZWRSZXN1bHRzfSAvPlxuICAgICAgICAgICAgICAgICAgICA8Lz4pO1xuICAgICAgICAgICAgICAgIGVsc2UgLy8gbm8gc2V2ZXJlLCBtZWRpdW0sIG9yIGxvdyBub3RpY2VzXG4gICAgICAgICAgICAgICAgICAgIHNldFJlc3VsdFZhbHVlKDw+XG4gICAgICAgICAgICAgICAgICAgICAgICB7cmVuZGVyU3VtbWFyeShwcm9jZXNzZWRSZXN1bHRzKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIDxSZW5kZXJTdWNjZXNzZXNTZXZlcmVNZWRpdW1Mb3cgcmVzdWx0cz17cHJvY2Vzc2VkUmVzdWx0c30gLz5cbiAgICAgICAgICAgICAgICAgICAgPC8+KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGlzcGxheVR5cGUgPT09ICdTaW5nbGVMaXN0Jykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHByb2Nlc3NlZFJlc3VsdHMgPSBwcm9jZXNzTm90aWNlc1RvU2luZ2xlTGlzdChyYXdDQlBSZXN1bHRzLCBwcm9jZXNzT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgLy8gZGVidWdMb2coYEJvb2tQYWNrYWdlQ2hlY2sgZ290IGJhY2sgcHJvY2Vzc2VkUmVzdWx0cyB3aXRoICR7cHJvY2Vzc2VkUmVzdWx0cy5zdWNjZXNzTGlzdC5sZW5ndGgudG9Mb2NhbGVTdHJpbmcoKX0gc3VjY2VzcyBtZXNzYWdlKHMpIGFuZCAke3Byb2Nlc3NlZFJlc3VsdHMud2FybmluZ0xpc3QubGVuZ3RoLnRvTG9jYWxlU3RyaW5nKCl9IG5vdGljZShzKVxuICAgICAgICAgICAgICAgIC8vICAgbnVtSWdub3JlZE5vdGljZXM9JHtwcm9jZXNzZWRSZXN1bHRzLm51bUlnbm9yZWROb3RpY2VzLnRvTG9jYWxlU3RyaW5nKCl9IG51bUhpZGRlbldhcm5pbmdzPSR7cHJvY2Vzc2VkUmVzdWx0cy5udW1IaWRkZW5XYXJuaW5ncy50b0xvY2FsZVN0cmluZygpfWApO1xuXG4gICAgICAgICAgICAgICAgaWYgKHByb2Nlc3NlZFJlc3VsdHMud2FybmluZ0xpc3QubGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgICBzZXRSZXN1bHRWYWx1ZSg8PlxuICAgICAgICAgICAgICAgICAgICAgICAge3JlbmRlclN1bW1hcnkocHJvY2Vzc2VkUmVzdWx0cyl9XG4gICAgICAgICAgICAgICAgICAgICAgICA8UmVuZGVyU3VjY2Vzc2VzTm90aWNlc0dyYWRpZW50IHJlc3VsdHM9e3Byb2Nlc3NlZFJlc3VsdHN9IC8+XG4gICAgICAgICAgICAgICAgICAgIDwvPik7XG4gICAgICAgICAgICAgICAgZWxzZSAvLyBubyB3YXJuaW5nc1xuICAgICAgICAgICAgICAgICAgICBzZXRSZXN1bHRWYWx1ZSg8PlxuICAgICAgICAgICAgICAgICAgICAgICAge3JlbmRlclN1bW1hcnkocHJvY2Vzc2VkUmVzdWx0cyl9XG4gICAgICAgICAgICAgICAgICAgICAgICA8UmVuZGVyU3VjY2Vzc2VzTm90aWNlc0dyYWRpZW50IHJlc3VsdHM9e3Byb2Nlc3NlZFJlc3VsdHN9IC8+XG4gICAgICAgICAgICAgICAgICAgIDwvPik7XG4gICAgICAgICAgICB9IGVsc2Ugc2V0UmVzdWx0VmFsdWUoPGIgc3R5bGU9e3sgY29sb3I6ICdyZWQnIH19PkludmFsaWQgZGlzcGxheVR5cGU9J3tkaXNwbGF5VHlwZX0nPC9iPilcblxuICAgICAgICAgICAgLy8gZGVidWdMb2coXCJGaW5pc2hlZCByZW5kZXJpbmcgYml0LlwiKTtcbiAgICAgICAgfSkoKTsgLy8gZW5kIG9mIGFzeW5jIHBhcnQgaW4gdW5uYW1lZEZ1bmN0aW9uXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9leGhhdXN0aXZlLWRlcHNcbiAgICB9LCBbYm9va0lELCBicmFuY2gsIEpTT04uc3RyaW5naWZ5KGNoZWNraW5nT3B0aW9ucyksIGxhbmd1YWdlQ29kZSwgSlNPTi5zdHJpbmdpZnkocHJvcHMpLCB1c2VybmFtZV0pOyAvLyBlbmQgb2YgdXNlRWZmZWN0IHBhcnRcblxuICAgIC8vIHsvKiA8ZGl2IGNsYXNzTmFtZT17Y2xhc3Nlcy5yb290fT4gKi99XG4gICAgcmV0dXJuIChcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJGcmVkXCI+XG4gICAgICAgICAgICB7cmVzdWx0fVxuICAgICAgICA8L2Rpdj5cbiAgICApO1xufVxuXG4vLyBCb29rUGFja2FnZUNoZWNrLnByb3BUeXBlcyA9IHtcbi8vICAgLyoqIEBpZ25vcmUgKi9cbi8vICAgdXNlcm5hbWU6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbi8vICAgLyoqIEBpZ25vcmUgKi9cbi8vICAgbGFuZ3VhZ2VDb2RlOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4vLyAgIGJvb2tJRDogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuLy8gICBwcm9wczogUHJvcFR5cGVzLm9iamVjdCxcbi8vIH07XG5cbi8vIGNvbnN0IHN0eWxlcyA9IHRoZW1lID0+ICh7XG4vLyAgIHJvb3Q6IHtcbi8vICAgfSxcbi8vIH0pO1xuXG5leHBvcnQgZGVmYXVsdCBCb29rUGFja2FnZUNoZWNrO1xuIl19