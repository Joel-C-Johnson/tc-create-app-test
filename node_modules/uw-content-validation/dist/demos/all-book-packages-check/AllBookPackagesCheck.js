"use strict";var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");var _typeof = require("@babel/runtime/helpers/typeof");Object.defineProperty(exports, "__esModule", { value: true });exports.default = void 0;var _regenerator = _interopRequireDefault(require("@babel/runtime/regenerator"));var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _react = _interopRequireWildcard(require("react"));

var books = _interopRequireWildcard(require("../../core/books/books"));
var _core = require("../../core");
var _checkBookPackages = require("../book-packages-check/checkBookPackages");
var _noticeProcessingFunctions = require("../notice-processing-functions");
var _RenderProcessedResults = require("../RenderProcessedResults");

var _utilities = require("../../core/utilities");function _getRequireWildcardCache(nodeInterop) {if (typeof WeakMap !== "function") return null;var cacheBabelInterop = new WeakMap();var cacheNodeInterop = new WeakMap();return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) {return nodeInterop ? cacheNodeInterop : cacheBabelInterop;})(nodeInterop);}function _interopRequireWildcard(obj, nodeInterop) {if (!nodeInterop && obj && obj.__esModule) {return obj;}if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") {return { default: obj };}var cache = _getRequireWildcardCache(nodeInterop);if (cache && cache.has(obj)) {return cache.get(obj);}var newObj = {};var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;for (var key in obj) {if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;if (desc && (desc.get || desc.set)) {Object.defineProperty(newObj, key, desc);} else {newObj[key] = obj[key];}}}newObj.default = obj;if (cache) {cache.set(obj, newObj);}return newObj;}function _createForOfIteratorHelper(o, allowArrayLike) {var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"];if (!it) {if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") {if (it) o = it;var i = 0;var F = function F() {};return { s: F, n: function n() {if (i >= o.length) return { done: true };return { done: false, value: o[i++] };}, e: function e(_e) {throw _e;}, f: F };}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var normalCompletion = true,didErr = false,err;return { s: function s() {it = it.call(o);}, n: function n() {var step = it.next();normalCompletion = step.done;return step;}, e: function e(_e2) {didErr = true;err = _e2;}, f: function f() {try {if (!normalCompletion && it.return != null) it.return();} finally {if (didErr) throw err;}} };}function _unsupportedIterableToArray(o, minLen) {if (!o) return;if (typeof o === "string") return _arrayLikeToArray(o, minLen);var n = Object.prototype.toString.call(o).slice(8, -1);if (n === "Object" && o.constructor) n = o.constructor.name;if (n === "Map" || n === "Set") return Array.from(o);if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);}function _arrayLikeToArray(arr, len) {if (len == null || len > arr.length) len = arr.length;for (var i = 0, arr2 = new Array(len); i < len; i++) {arr2[i] = arr[i];}return arr2;}


// const ALL_BPS_VALIDATOR_VERSION_STRING = '0.3.8';

var OLD_TESTAMENT_BOOK_CODES = 'GEN,EXO,LEV,NUM,DEU,JOS,JDG,RUT,1SA,2SA,1KI,2KI,1CH,2CH,EZR,NEH,EST,JOB,PSA,PRO,ECC,SNG,ISA,JER,LAM,EZK,DAN,HOS,JOL,AMO,OBA,JON,MIC,NAM,HAB,ZEP,HAG,ZEC,MAL';
var NEW_TESTAMENT_BOOK_CODES = 'MAT,MRK,LUK,JHN,ACT,ROM,1CO,2CO,GAL,EPH,PHP,COL,1TH,2TH,1TI,2TI,TIT,PHM,HEB,JAS,1PE,2PE,1JN,2JN,3JN,JUD,REV';


function AllBookPackagesCheck( /*username, languageCode, bookIDs,*/props) {
  // Check a single Bible book across many repositories
  var _useState = (0, _react.useState)("Waiting-CheckAllBookPackages"),_useState2 = (0, _slicedToArray2.default)(_useState, 2),result = _useState2[0],setResultValue = _useState2[1];

  // debugLog(`I'm here in AllBookPackagesCheckBookPackagesCheck v${ALL_BPS_VALIDATOR_VERSION_STRING}`);
  // consoleLogObject("props", props);
  // consoleLogObject("props.classes", props.classes);

  var username = props.username;
  // debugLog(`username='${username}'`);
  var languageCode = props.languageCode;
  // debugLog(`languageCode='${languageCode}'`);
  var testament = props.testament;
  // debugLog(`testament='${testament}'`);
  var includeOBS = props.includeOBS;
  // debugLog(`includeOBS='${includeOBS}'`);
  var dataSet = props.dataSet;
  // debugLog(`dataSet='${dataSet}'`);
  var branch = props.branch;
  // debugLog(`branch='${branch}'`);

  // Enter a string containing UPPERCASE USFM book identifiers separated only by commas
  //  and can also include OBS (for Open Bible Stories)
  var bookIDsString = '';
  var haveOT = false,haveNT = false;
  if (testament.toUpperCase() === 'OT' || testament.toUpperCase() === 'OLD') {
    bookIDsString = OLD_TESTAMENT_BOOK_CODES;
    haveOT = true;
  } else if (testament.toUpperCase() === 'NT' || testament.toUpperCase() === 'NEW') {
    bookIDsString = NEW_TESTAMENT_BOOK_CODES;
    haveNT = true;
  } else if (testament.toUpperCase() === 'ALL' || testament.toUpperCase() === 'BOTH') {
    bookIDsString = "".concat(OLD_TESTAMENT_BOOK_CODES, ",").concat(NEW_TESTAMENT_BOOK_CODES);
    haveOT = true;haveNT = true;
  } else
  setResultValue( /*#__PURE__*/_react.default.createElement("p", { style: { color: 'red' } }, "No testament selected"));
  if (includeOBS.toUpperCase() === 'Y' || includeOBS.toUpperCase() === 'YES')
  bookIDsString += ',OBS';

  var bookIDList = [];
  var bookIDInvalid;var _iterator = _createForOfIteratorHelper(
  bookIDsString.split(',')),_step;try {for (_iterator.s(); !(_step = _iterator.n()).done;) {var bookID = _step.value;
      bookID = bookID.trim();
      if (!books.isValidBookID(bookID) && bookID !== 'OBS') {
        bookIDInvalid = bookID;
      }
      bookIDList.push(bookID);
    }
    // TODO: I don't understand why this command gets executed multiple times!!!
  } catch (err) {_iterator.e(err);} finally {_iterator.f();}(0, _utilities.userLog)("AllBookPackagesCheck bookIDList (".concat(bookIDList.length, ") = ").concat(bookIDList.join(', ')));

  var checkingOptions = { // Uncomment any of these to test them
    // excerptLength: 25,
    suppressNoticeDisablingFlag: true // Leave this one as true (otherwise demo checks are less efficient)
  };
  // Or this allows the parameters to be specified as a BookPackagesCheck property
  if (props.excerptLength) checkingOptions.excerptLength = (0, _core.ourParseInt)(props.excerptLength);
  if (props.cutoffPriorityLevel) checkingOptions.cutoffPriorityLevel = (0, _core.ourParseInt)(props.cutoffPriorityLevel);

  (0, _react.useEffect)(function () {
    // debugLog("BookPackagesCheck.useEffect() called with ", JSON.stringify(props));

    // Use an IIFE (Immediately Invoked Function Expression)
    //  e.g., see https://medium.com/javascript-in-plain-english/https-medium-com-javascript-in-plain-english-stop-feeling-iffy-about-using-an-iife-7b0292aba174
    (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee() {var repoPreloadList, obsRepoPreloadList, successFlag, rawABPsResults, processOptions, displayType,



















































































      renderSummary, processedResults, _processedResults, _processedResults2;return _regenerator.default.wrap(function _callee$(_context) {while (1) {switch (_context.prev = _context.next) {case 0:renderSummary = function _renderSummary(processedResults) {
                return /*#__PURE__*/_react.default.createElement("div", null, /*#__PURE__*/
                _react.default.createElement("p", null, "Checked ", /*#__PURE__*/_react.default.createElement("b", null, username, " ", languageCode, " ", bookIDList.join(', ')), " (from ", /*#__PURE__*/_react.default.createElement("i", null, branch === undefined ? 'DEFAULT' : branch), " branches)"), /*#__PURE__*/
                _react.default.createElement(_RenderProcessedResults.RenderCheckedFilesList, { username: username, results: processedResults }), /*#__PURE__*/
                _react.default.createElement(_RenderProcessedResults.RenderTotals, { rawNoticeListLength: rawABPsResults.noticeList.length, results: processedResults }));


              };if (!(!props.wait || props.wait !== 'N')) {_context.next = 4;break;}setResultValue( /*#__PURE__*/_react.default.createElement("p", null, /*#__PURE__*/_react.default.createElement("span", { style: { color: 'blue' } }, "Waiting for user\u2026"), " (Adjust settings below as necessary and then set ", /*#__PURE__*/_react.default.createElement("b", null, "wait='N'"), " to start)"));return _context.abrupt("return");case 4:if (!(props.reloadAllFilesFirst && props.reloadAllFilesFirst.slice(0).toUpperCase() === 'Y')) {_context.next = 11;break;}(0, _utilities.userLog)("Clearing cache before running all book packages checkâ€¦");setResultValue( /*#__PURE__*/_react.default.createElement("p", { style: { color: 'orange' } }, "Clearing cache before running all book packages check\u2026"));_context.next = 9;return (0, _core.clearCaches)();case 9:_context.next = 13;break;case 11:_context.next = 13;return (0, _core.clearCheckedArticleCache)();case 13: // otherwise we wouldn't see any of the warnings again from checking these
              // Load whole repos, especially if we are going to check files in manifests
              repoPreloadList = ['TWL', 'LT', 'ST', 'TN', 'TA', 'TW', 'TQ']; // for DEFAULT
              if (dataSet === 'OLD') repoPreloadList = ['TWL', 'LT', 'ST', 'TN', 'TA', 'TW', 'TQ'];else if (dataSet === 'NEW') repoPreloadList = ['TWL', 'LT', 'ST', 'TN2', 'TA', 'TW', 'TQ2'];else if (dataSet === 'BOTH') repoPreloadList = ['TWL', 'LT', 'ST', 'TN', 'TN2', 'TA', 'TW', 'TQ', 'TQ2'];if (haveNT) repoPreloadList.unshift('UGNT');if (haveOT) repoPreloadList.unshift('UHB');if (!checkingOptions.disableAllLinkFetchingFlag) {repoPreloadList.push('TW');repoPreloadList.push('TA');}if (bookIDList.includes('OBS')) {obsRepoPreloadList = ['OBS', 'OBS-TWL', 'OBS-TN2', 'OBS-TQ2', 'OBS-SN2', 'OBS-SQ2']; // for DEFAULT
                if (dataSet === 'OLD') obsRepoPreloadList = ['OBS', 'OBS-TWL', 'OBS-TN', 'OBS-TQ', 'OBS-SN', 'OBS-SQ'];else if (dataSet === 'NEW') obsRepoPreloadList = ['OBS', 'OBS-TWL', 'OBS-TN2', 'OBS-TQ2', 'OBS-SN', 'OBS-SQ'];else if (dataSet === 'BOTH') obsRepoPreloadList = ['OBS', 'OBS-TWL', 'OBS-TN', 'OBS-TN2', 'OBS-TQ', 'OBS-TQ2', 'OBS-SN', 'OBS-SN', 'OBS-SN2', 'OBS-SQ2'];repoPreloadList.push.apply(repoPreloadList, obsRepoPreloadList);}setResultValue( /*#__PURE__*/_react.default.createElement("p", { style: { color: 'magenta' } }, "Preloading ", repoPreloadList.length, " repos for ", /*#__PURE__*/_react.default.createElement("i", null, username), " ", languageCode, " ready for all book packages check\u2026"));_context.next = 22;return (0, _core.preloadReposIfNecessary)(username, languageCode, bookIDList, branch, repoPreloadList);case 22:successFlag = _context.sent;if (!successFlag) (0, _utilities.userLog)("AllBookPackagesCheck error: Failed to pre-load all repos"); // Display our "waiting" message
              setResultValue( /*#__PURE__*/_react.default.createElement("p", { style: { color: 'magenta' } }, "Checking ", /*#__PURE__*/_react.default.createElement("i", null, username), " ", languageCode, " ", /*#__PURE__*/_react.default.createElement("b", null, bookIDList.join(', ')), " book packages\u2026"));rawABPsResults = {};if (!bookIDList.length) {_context.next = 30;break;}_context.next = 29;return (0, _checkBookPackages.checkBookPackages)(username, languageCode, bookIDList, setResultValue, checkingOptions);case 29:rawABPsResults = _context.sent;case 30: // Add some extra fields to our rawCBPsResults object in case we need this information again later
              rawABPsResults.checkType = 'AllBookPackages';rawABPsResults.username = username;rawABPsResults.languageCode = languageCode;rawABPsResults.bookIDs = bookIDsString;rawABPsResults.bookIDList = bookIDList;rawABPsResults.checkedOptions = checkingOptions; // debugLog("Here with CBPs rawCBPsResults", typeof rawCBPsResults);
              // Now do our final handling of the result -- we have some options available
              processOptions = {// Uncomment any of these to test them
                // 'maximumSimilarMessages': 4, // default is 3 -- 0 means donâ€™t suppress
                // 'errorPriorityLevel': 800, // default is 700
                // 'cutoffPriorityLevel': 100, // default is 0
                // 'sortBy': 'ByRepo', // default is 'ByPriority', also have 'AsFound'
                // 'ignorePriorityNumberList': [123, 202], // default is []
              }; // Or this allows the parameters to be specified as a BookPackagesCheck property
              if (props.maximumSimilarMessages) processOptions.maximumSimilarMessages = (0, _core.ourParseInt)(props.maximumSimilarMessages);if (props.errorPriorityLevel) processOptions.errorPriorityLevel = (0, _core.ourParseInt)(props.errorPriorityLevel); // if (props.cutoffPriorityLevel) processOptions.cutoffPriorityLevel = ourParseInt(props.cutoffPriorityLevel);
              if (props.sortBy) processOptions.sortBy = props.sortBy; // if (props.ignorePriorityNumberList) processOptions.ignorePriorityNumberList = props.ignorePriorityNumberList;
              displayType = 'ErrorsWarnings'; // default
              if (props.displayType) displayType = props.displayType;if (displayType === 'ErrorsWarnings') {processedResults = (0, _noticeProcessingFunctions.processNoticesToErrorsWarnings)(rawABPsResults, processOptions); //       userLog(`AllBookPackagesCheck got back processedResults with ${processedResults.successList.length.toLocaleString()} success message(s), ${processedResults.errorList.length.toLocaleString()} error(s) and ${processedResults.warningList.length.toLocaleString()} warning(s)
                // numIgnoredNotices=${processedResults.numIgnoredNotices.toLocaleString()} numHiddenErrors=${processedResults.numHiddenErrors.toLocaleString()} numHiddenWarnings=${processedResults.numHiddenWarnings.toLocaleString()}`);
                // debugLog("Here now in rendering bit!");
                if (processedResults.errorList.length || processedResults.warningList.length) setResultValue( /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, renderSummary(processedResults), /*#__PURE__*/_react.default.createElement(_RenderProcessedResults.RenderSuccessesErrorsWarnings, { results: processedResults })));else // no errors or warnings
                  setResultValue( /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, renderSummary(processedResults), /*#__PURE__*/_react.default.createElement(_RenderProcessedResults.RenderSuccessesErrorsWarnings, { results: processedResults })));} else if (displayType === 'SevereMediumLow') {_processedResults = (0, _noticeProcessingFunctions.processNoticesToSevereMediumLow)(rawABPsResults, processOptions); //                 userLog(`AllBookPackagesCheck got processed results with ${processedResults.successList.length.toLocaleString()} success message(s), ${processedResults.errorList.length.toLocaleString()} error(s) and ${processedResults.warningList.length.toLocaleString()} warning(s)
                //   numIgnoredNotices=${processedResults.numIgnoredNotices.toLocaleString()} numHiddenErrors=${processedResults.numHiddenErrors.toLocaleString()} numHiddenWarnings=${processedResults.numHiddenWarnings.toLocaleString()}`);
                if (_processedResults.severeList.length || _processedResults.mediumList.length || _processedResults.lowList.length)
                setResultValue( /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null,
                renderSummary(_processedResults), /*#__PURE__*/
                _react.default.createElement(_RenderProcessedResults.RenderSuccessesSevereMediumLow, { results: _processedResults })));else

                  // no severe, medium, or low notices
                  setResultValue( /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null,
                  renderSummary(_processedResults), /*#__PURE__*/
                  _react.default.createElement(_RenderProcessedResults.RenderSuccessesSevereMediumLow, { results: _processedResults })));

              } else if (displayType === 'SingleList') {
                _processedResults2 = (0, _noticeProcessingFunctions.processNoticesToSingleList)(rawABPsResults, processOptions);
                //       userLog(`AllBookPackagesCheck got processed results with ${processedResults.successList.length.toLocaleString()} success message(s) and ${processedResults.warningList.length.toLocaleString()} notice(s)
                // numIgnoredNotices=${processedResults.numIgnoredNotices.toLocaleString()} numHiddenWarnings=${processedResults.numHiddenWarnings.toLocaleString()}`);

                if (_processedResults2.warningList.length)
                setResultValue( /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null,
                renderSummary(_processedResults2), /*#__PURE__*/
                _react.default.createElement(_RenderProcessedResults.RenderSuccessesNoticesGradient, { results: _processedResults2 })));else

                  // no warnings
                  setResultValue( /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null,
                  renderSummary(_processedResults2), /*#__PURE__*/
                  _react.default.createElement(_RenderProcessedResults.RenderSuccessesNoticesGradient, { results: _processedResults2 })));

              } else setResultValue( /*#__PURE__*/_react.default.createElement("b", { style: { color: 'red' } }, "Invalid displayType='", displayType, "'"));

              // debugLog("Finished rendering bit.");
            case 43:case "end":return _context.stop();}}}, _callee);}))(); // end of async part in unnamedFunction
    // Doesnâ€™t work if we add this to next line: bookIDList,bookIDs,username,branch,checkingOptions,languageCode,props
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [JSON.stringify(bookIDList), bookIDsString, branch, JSON.stringify(checkingOptions), languageCode, JSON.stringify(props), username]); // end of useEffect part

  if (bookIDInvalid) {
    return /*#__PURE__*/_react.default.createElement("p", null, "Please enter only valid USFM book identifiers separated by commas. ('", bookIDInvalid, "' is not valid.)");
  }

  // {/* <div className={classes.root}> */}
  return /*#__PURE__*/(
    _react.default.createElement("div", { className: "whatGoesHere" },
    result));


}

// BookPackagesCheck.propTypes = {
//   /** @ignore */
//   username: PropTypes.object.isRequired,
//   /** @ignore */
//   languageCode: PropTypes.object.isRequired,
//   bookIDs: PropTypes.object.isRequired,
//   props: PropTypes.object,
// };

// const styles = theme => ({
//   root: {
//   },
// });
var _default =
AllBookPackagesCheck;exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9kZW1vcy9hbGwtYm9vay1wYWNrYWdlcy1jaGVjay9BbGxCb29rUGFja2FnZXNDaGVjay5qcyJdLCJuYW1lcyI6WyJPTERfVEVTVEFNRU5UX0JPT0tfQ09ERVMiLCJORVdfVEVTVEFNRU5UX0JPT0tfQ09ERVMiLCJBbGxCb29rUGFja2FnZXNDaGVjayIsInByb3BzIiwicmVzdWx0Iiwic2V0UmVzdWx0VmFsdWUiLCJ1c2VybmFtZSIsImxhbmd1YWdlQ29kZSIsInRlc3RhbWVudCIsImluY2x1ZGVPQlMiLCJkYXRhU2V0IiwiYnJhbmNoIiwiYm9va0lEc1N0cmluZyIsImhhdmVPVCIsImhhdmVOVCIsInRvVXBwZXJDYXNlIiwiY29sb3IiLCJib29rSURMaXN0IiwiYm9va0lESW52YWxpZCIsInNwbGl0IiwiYm9va0lEIiwidHJpbSIsImJvb2tzIiwiaXNWYWxpZEJvb2tJRCIsInB1c2giLCJsZW5ndGgiLCJqb2luIiwiY2hlY2tpbmdPcHRpb25zIiwic3VwcHJlc3NOb3RpY2VEaXNhYmxpbmdGbGFnIiwiZXhjZXJwdExlbmd0aCIsImN1dG9mZlByaW9yaXR5TGV2ZWwiLCJyZW5kZXJTdW1tYXJ5IiwicHJvY2Vzc2VkUmVzdWx0cyIsInVuZGVmaW5lZCIsInJhd0FCUHNSZXN1bHRzIiwibm90aWNlTGlzdCIsIndhaXQiLCJyZWxvYWRBbGxGaWxlc0ZpcnN0Iiwic2xpY2UiLCJyZXBvUHJlbG9hZExpc3QiLCJ1bnNoaWZ0IiwiZGlzYWJsZUFsbExpbmtGZXRjaGluZ0ZsYWciLCJpbmNsdWRlcyIsIm9ic1JlcG9QcmVsb2FkTGlzdCIsImFwcGx5Iiwic3VjY2Vzc0ZsYWciLCJjaGVja1R5cGUiLCJib29rSURzIiwiY2hlY2tlZE9wdGlvbnMiLCJwcm9jZXNzT3B0aW9ucyIsIm1heGltdW1TaW1pbGFyTWVzc2FnZXMiLCJlcnJvclByaW9yaXR5TGV2ZWwiLCJzb3J0QnkiLCJkaXNwbGF5VHlwZSIsImVycm9yTGlzdCIsIndhcm5pbmdMaXN0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ZixDQUFwRCxFQUFxRnBCLFlBQXJGLEVBQW1Hb0QsSUFBSSxDQUFDQyxTQUFMLENBQWV6RCxLQUFmLENBQW5HLEVBQTBIRyxRQUExSCxDQXZKSCxFQTNEd0UsQ0FrTmlFOztBQUV6SSxNQUFJWSxhQUFKLEVBQW1CO0FBQ2pCLHdCQUFRLGlIQUF5RUEsYUFBekUscUJBQVI7QUFDRDs7QUFFRDtBQUNBO0FBQ0UsMENBQUssU0FBUyxFQUFDLGNBQWY7QUFDR2QsSUFBQUEsTUFESCxDQURGOzs7QUFLRDs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVlRixvQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSwgdXNlRWZmZWN0IH0gZnJvbSAncmVhY3QnO1xuLy8gaW1wb3J0IHsgd2l0aFN0eWxlcyB9IGZyb20gJ0BtYXRlcmlhbC11aS9jb3JlL3N0eWxlcyc7XG5pbXBvcnQgKiBhcyBib29rcyBmcm9tICcuLi8uLi9jb3JlL2Jvb2tzL2Jvb2tzJztcbmltcG9ydCB7IGNsZWFyQ2FjaGVzLCBjbGVhckNoZWNrZWRBcnRpY2xlQ2FjaGUsIG91clBhcnNlSW50LCBwcmVsb2FkUmVwb3NJZk5lY2Vzc2FyeSB9IGZyb20gJy4uLy4uL2NvcmUnO1xuaW1wb3J0IHsgY2hlY2tCb29rUGFja2FnZXMgfSBmcm9tICcuLi9ib29rLXBhY2thZ2VzLWNoZWNrL2NoZWNrQm9va1BhY2thZ2VzJztcbmltcG9ydCB7IHByb2Nlc3NOb3RpY2VzVG9FcnJvcnNXYXJuaW5ncywgcHJvY2Vzc05vdGljZXNUb1NldmVyZU1lZGl1bUxvdywgcHJvY2Vzc05vdGljZXNUb1NpbmdsZUxpc3QgfSBmcm9tICcuLi9ub3RpY2UtcHJvY2Vzc2luZy1mdW5jdGlvbnMnO1xuaW1wb3J0IHsgUmVuZGVyQ2hlY2tlZEZpbGVzTGlzdCwgUmVuZGVyU3VjY2Vzc2VzRXJyb3JzV2FybmluZ3MsIFJlbmRlclN1Y2Nlc3Nlc1NldmVyZU1lZGl1bUxvdywgUmVuZGVyU3VjY2Vzc2VzTm90aWNlc0dyYWRpZW50LCBSZW5kZXJUb3RhbHMgfSBmcm9tICcuLi9SZW5kZXJQcm9jZXNzZWRSZXN1bHRzJztcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtdmFyc1xuaW1wb3J0IHsgbG9naWNBc3NlcnQsIHVzZXJMb2csIGRlYnVnTG9nIH0gZnJvbSAnLi4vLi4vY29yZS91dGlsaXRpZXMnO1xuXG5cbi8vIGNvbnN0IEFMTF9CUFNfVkFMSURBVE9SX1ZFUlNJT05fU1RSSU5HID0gJzAuMy44JztcblxuY29uc3QgT0xEX1RFU1RBTUVOVF9CT09LX0NPREVTID0gJ0dFTixFWE8sTEVWLE5VTSxERVUsSk9TLEpERyxSVVQsMVNBLDJTQSwxS0ksMktJLDFDSCwyQ0gsRVpSLE5FSCxFU1QsSk9CLFBTQSxQUk8sRUNDLFNORyxJU0EsSkVSLExBTSxFWkssREFOLEhPUyxKT0wsQU1PLE9CQSxKT04sTUlDLE5BTSxIQUIsWkVQLEhBRyxaRUMsTUFMJztcbmNvbnN0IE5FV19URVNUQU1FTlRfQk9PS19DT0RFUyA9ICdNQVQsTVJLLExVSyxKSE4sQUNULFJPTSwxQ08sMkNPLEdBTCxFUEgsUEhQLENPTCwxVEgsMlRILDFUSSwyVEksVElULFBITSxIRUIsSkFTLDFQRSwyUEUsMUpOLDJKTiwzSk4sSlVELFJFVic7XG5cblxuZnVuY3Rpb24gQWxsQm9va1BhY2thZ2VzQ2hlY2soLyp1c2VybmFtZSwgbGFuZ3VhZ2VDb2RlLCBib29rSURzLCovIHByb3BzKSB7XG4gIC8vIENoZWNrIGEgc2luZ2xlIEJpYmxlIGJvb2sgYWNyb3NzIG1hbnkgcmVwb3NpdG9yaWVzXG4gIGNvbnN0IFtyZXN1bHQsIHNldFJlc3VsdFZhbHVlXSA9IHVzZVN0YXRlKFwiV2FpdGluZy1DaGVja0FsbEJvb2tQYWNrYWdlc1wiKTtcblxuICAvLyBkZWJ1Z0xvZyhgSSdtIGhlcmUgaW4gQWxsQm9va1BhY2thZ2VzQ2hlY2tCb29rUGFja2FnZXNDaGVjayB2JHtBTExfQlBTX1ZBTElEQVRPUl9WRVJTSU9OX1NUUklOR31gKTtcbiAgLy8gY29uc29sZUxvZ09iamVjdChcInByb3BzXCIsIHByb3BzKTtcbiAgLy8gY29uc29sZUxvZ09iamVjdChcInByb3BzLmNsYXNzZXNcIiwgcHJvcHMuY2xhc3Nlcyk7XG5cbiAgbGV0IHVzZXJuYW1lID0gcHJvcHMudXNlcm5hbWU7XG4gIC8vIGRlYnVnTG9nKGB1c2VybmFtZT0nJHt1c2VybmFtZX0nYCk7XG4gIGxldCBsYW5ndWFnZUNvZGUgPSBwcm9wcy5sYW5ndWFnZUNvZGU7XG4gIC8vIGRlYnVnTG9nKGBsYW5ndWFnZUNvZGU9JyR7bGFuZ3VhZ2VDb2RlfSdgKTtcbiAgbGV0IHRlc3RhbWVudCA9IHByb3BzLnRlc3RhbWVudDtcbiAgLy8gZGVidWdMb2coYHRlc3RhbWVudD0nJHt0ZXN0YW1lbnR9J2ApO1xuICBsZXQgaW5jbHVkZU9CUyA9IHByb3BzLmluY2x1ZGVPQlM7XG4gIC8vIGRlYnVnTG9nKGBpbmNsdWRlT0JTPScke2luY2x1ZGVPQlN9J2ApO1xuICBsZXQgZGF0YVNldCA9IHByb3BzLmRhdGFTZXQ7XG4gIC8vIGRlYnVnTG9nKGBkYXRhU2V0PScke2RhdGFTZXR9J2ApO1xuICBsZXQgYnJhbmNoID0gcHJvcHMuYnJhbmNoO1xuICAvLyBkZWJ1Z0xvZyhgYnJhbmNoPScke2JyYW5jaH0nYCk7XG5cbiAgLy8gRW50ZXIgYSBzdHJpbmcgY29udGFpbmluZyBVUFBFUkNBU0UgVVNGTSBib29rIGlkZW50aWZpZXJzIHNlcGFyYXRlZCBvbmx5IGJ5IGNvbW1hc1xuICAvLyAgYW5kIGNhbiBhbHNvIGluY2x1ZGUgT0JTIChmb3IgT3BlbiBCaWJsZSBTdG9yaWVzKVxuICBsZXQgYm9va0lEc1N0cmluZyA9ICcnO1xuICBsZXQgaGF2ZU9UID0gZmFsc2UsIGhhdmVOVCA9IGZhbHNlO1xuICBpZiAodGVzdGFtZW50LnRvVXBwZXJDYXNlKCkgPT09ICdPVCcgfHwgdGVzdGFtZW50LnRvVXBwZXJDYXNlKCkgPT09ICdPTEQnKSB7XG4gICAgYm9va0lEc1N0cmluZyA9IE9MRF9URVNUQU1FTlRfQk9PS19DT0RFUztcbiAgICBoYXZlT1QgPSB0cnVlO1xuICB9ICBlbHNlIGlmICh0ZXN0YW1lbnQudG9VcHBlckNhc2UoKSA9PT0gJ05UJyB8fCB0ZXN0YW1lbnQudG9VcHBlckNhc2UoKSA9PT0gJ05FVycpIHtcbiAgICBib29rSURzU3RyaW5nID0gTkVXX1RFU1RBTUVOVF9CT09LX0NPREVTO1xuICAgIGhhdmVOVCA9IHRydWU7XG4gIH0gZWxzZSBpZiAodGVzdGFtZW50LnRvVXBwZXJDYXNlKCkgPT09ICdBTEwnIHx8IHRlc3RhbWVudC50b1VwcGVyQ2FzZSgpID09PSAnQk9USCcpIHtcbiAgICBib29rSURzU3RyaW5nID0gYCR7T0xEX1RFU1RBTUVOVF9CT09LX0NPREVTfSwke05FV19URVNUQU1FTlRfQk9PS19DT0RFU31gO1xuICAgIGhhdmVPVCA9IHRydWU7IGhhdmVOVCA9IHRydWU7XG4gIH1lbHNlXG4gICAgc2V0UmVzdWx0VmFsdWUoPHAgc3R5bGU9e3sgY29sb3I6ICdyZWQnIH19Pk5vIHRlc3RhbWVudCBzZWxlY3RlZDwvcD4pO1xuICBpZiAoaW5jbHVkZU9CUy50b1VwcGVyQ2FzZSgpID09PSAnWScgfHwgaW5jbHVkZU9CUy50b1VwcGVyQ2FzZSgpID09PSAnWUVTJylcbiAgICBib29rSURzU3RyaW5nICs9ICcsT0JTJztcblxuICBsZXQgYm9va0lETGlzdCA9IFtdO1xuICBsZXQgYm9va0lESW52YWxpZDtcbiAgZm9yIChsZXQgYm9va0lEIG9mIGJvb2tJRHNTdHJpbmcuc3BsaXQoJywnKSkge1xuICAgIGJvb2tJRCA9IGJvb2tJRC50cmltKCk7XG4gICAgaWYgKCFib29rcy5pc1ZhbGlkQm9va0lEKGJvb2tJRCkgJiYgYm9va0lEICE9PSAnT0JTJykge1xuICAgICAgYm9va0lESW52YWxpZCA9IGJvb2tJRDtcbiAgICB9XG4gICAgYm9va0lETGlzdC5wdXNoKGJvb2tJRCk7XG4gIH1cbiAgLy8gVE9ETzogSSBkb24ndCB1bmRlcnN0YW5kIHdoeSB0aGlzIGNvbW1hbmQgZ2V0cyBleGVjdXRlZCBtdWx0aXBsZSB0aW1lcyEhIVxuICB1c2VyTG9nKGBBbGxCb29rUGFja2FnZXNDaGVjayBib29rSURMaXN0ICgke2Jvb2tJRExpc3QubGVuZ3RofSkgPSAke2Jvb2tJRExpc3Quam9pbignLCAnKX1gKTtcblxuICBjb25zdCBjaGVja2luZ09wdGlvbnMgPSB7IC8vIFVuY29tbWVudCBhbnkgb2YgdGhlc2UgdG8gdGVzdCB0aGVtXG4gICAgLy8gZXhjZXJwdExlbmd0aDogMjUsXG4gICAgc3VwcHJlc3NOb3RpY2VEaXNhYmxpbmdGbGFnOiB0cnVlLCAvLyBMZWF2ZSB0aGlzIG9uZSBhcyB0cnVlIChvdGhlcndpc2UgZGVtbyBjaGVja3MgYXJlIGxlc3MgZWZmaWNpZW50KVxuICB9O1xuICAvLyBPciB0aGlzIGFsbG93cyB0aGUgcGFyYW1ldGVycyB0byBiZSBzcGVjaWZpZWQgYXMgYSBCb29rUGFja2FnZXNDaGVjayBwcm9wZXJ0eVxuICBpZiAocHJvcHMuZXhjZXJwdExlbmd0aCkgY2hlY2tpbmdPcHRpb25zLmV4Y2VycHRMZW5ndGggPSBvdXJQYXJzZUludChwcm9wcy5leGNlcnB0TGVuZ3RoKTtcbiAgaWYgKHByb3BzLmN1dG9mZlByaW9yaXR5TGV2ZWwpIGNoZWNraW5nT3B0aW9ucy5jdXRvZmZQcmlvcml0eUxldmVsID0gb3VyUGFyc2VJbnQocHJvcHMuY3V0b2ZmUHJpb3JpdHlMZXZlbCk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAvLyBkZWJ1Z0xvZyhcIkJvb2tQYWNrYWdlc0NoZWNrLnVzZUVmZmVjdCgpIGNhbGxlZCB3aXRoIFwiLCBKU09OLnN0cmluZ2lmeShwcm9wcykpO1xuXG4gICAgLy8gVXNlIGFuIElJRkUgKEltbWVkaWF0ZWx5IEludm9rZWQgRnVuY3Rpb24gRXhwcmVzc2lvbilcbiAgICAvLyAgZS5nLiwgc2VlIGh0dHBzOi8vbWVkaXVtLmNvbS9qYXZhc2NyaXB0LWluLXBsYWluLWVuZ2xpc2gvaHR0cHMtbWVkaXVtLWNvbS1qYXZhc2NyaXB0LWluLXBsYWluLWVuZ2xpc2gtc3RvcC1mZWVsaW5nLWlmZnktYWJvdXQtdXNpbmctYW4taWlmZS03YjAyOTJhYmExNzRcbiAgICAoYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gZGVidWdMb2coXCJTdGFydGVkIEJvb2tQYWNrYWdlc0NoZWNrLnVubmFtZWRGdW5jdGlvbigpXCIpO1xuXG4gICAgICAvLyBOT1RFIGZyb20gUkpIOiBJIGNhbuKAmXQgZmluZCB0aGUgY29ycmVjdCBSZWFjdCBwbGFjZSBmb3IgdGhpcyAvIHdheSB0byBkbyB0aGlzXG4gICAgICAvLyAgICAgICAgICAgICAgICAgIHNvIGl0IHNob3dzIGEgd2FybmluZyBmb3IgdGhlIHVzZXIsIGFuZCBkb2VzbuKAmXQgY29udGludWUgdG8gdHJ5IHRvIHByb2Nlc3NcbiAgICAgIGlmICghcHJvcHMud2FpdCB8fCBwcm9wcy53YWl0ICE9PSAnTicpIHtcbiAgICAgICAgc2V0UmVzdWx0VmFsdWUoPHA+PHNwYW4gc3R5bGU9e3sgY29sb3I6ICdibHVlJyB9fT5XYWl0aW5nIGZvciB1c2Vy4oCmPC9zcGFuPiAoQWRqdXN0IHNldHRpbmdzIGJlbG93IGFzIG5lY2Vzc2FyeSBhbmQgdGhlbiBzZXQgPGI+d2FpdD0nTic8L2I+IHRvIHN0YXJ0KTwvcD4pO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmIChwcm9wcy5yZWxvYWRBbGxGaWxlc0ZpcnN0ICYmIHByb3BzLnJlbG9hZEFsbEZpbGVzRmlyc3Quc2xpY2UoMCkudG9VcHBlckNhc2UoKSA9PT0gJ1knKSB7XG4gICAgICAgIHVzZXJMb2coXCJDbGVhcmluZyBjYWNoZSBiZWZvcmUgcnVubmluZyBhbGwgYm9vayBwYWNrYWdlcyBjaGVja+KAplwiKTtcbiAgICAgICAgc2V0UmVzdWx0VmFsdWUoPHAgc3R5bGU9e3sgY29sb3I6ICdvcmFuZ2UnIH19PkNsZWFyaW5nIGNhY2hlIGJlZm9yZSBydW5uaW5nIGFsbCBib29rIHBhY2thZ2VzIGNoZWNr4oCmPC9wPik7XG4gICAgICAgIGF3YWl0IGNsZWFyQ2FjaGVzKCk7XG4gICAgICB9XG4gICAgICBlbHNlIGF3YWl0IGNsZWFyQ2hlY2tlZEFydGljbGVDYWNoZSgpOyAvLyBvdGhlcndpc2Ugd2Ugd291bGRuJ3Qgc2VlIGFueSBvZiB0aGUgd2FybmluZ3MgYWdhaW4gZnJvbSBjaGVja2luZyB0aGVzZVxuXG4gICAgICAvLyBMb2FkIHdob2xlIHJlcG9zLCBlc3BlY2lhbGx5IGlmIHdlIGFyZSBnb2luZyB0byBjaGVjayBmaWxlcyBpbiBtYW5pZmVzdHNcbiAgICAgIGxldCByZXBvUHJlbG9hZExpc3QgPSBbJ1RXTCcsICdMVCcsICdTVCcsICdUTicsICdUQScsICdUVycsICdUUSddOyAvLyBmb3IgREVGQVVMVFxuICAgICAgaWYgKGRhdGFTZXQgPT09ICdPTEQnKVxuICAgICAgICByZXBvUHJlbG9hZExpc3QgPSBbJ1RXTCcsICdMVCcsICdTVCcsICdUTicsICdUQScsICdUVycsICdUUSddO1xuICAgICAgZWxzZSBpZiAoZGF0YVNldCA9PT0gJ05FVycpXG4gICAgICAgIHJlcG9QcmVsb2FkTGlzdCA9IFsnVFdMJywgJ0xUJywgJ1NUJywgJ1ROMicsICdUQScsICdUVycsICdUUTInXTtcbiAgICAgIGVsc2UgaWYgKGRhdGFTZXQgPT09ICdCT1RIJylcbiAgICAgICAgcmVwb1ByZWxvYWRMaXN0ID0gWydUV0wnLCAnTFQnLCAnU1QnLCAnVE4nLCAnVE4yJywgJ1RBJywgJ1RXJywgJ1RRJywgJ1RRMiddO1xuICAgICAgaWYgKGhhdmVOVCkgcmVwb1ByZWxvYWRMaXN0LnVuc2hpZnQoJ1VHTlQnKTtcbiAgICAgIGlmIChoYXZlT1QpIHJlcG9QcmVsb2FkTGlzdC51bnNoaWZ0KCdVSEInKTtcbiAgICAgIGlmICghY2hlY2tpbmdPcHRpb25zLmRpc2FibGVBbGxMaW5rRmV0Y2hpbmdGbGFnKSB7XG4gICAgICAgIHJlcG9QcmVsb2FkTGlzdC5wdXNoKCdUVycpO1xuICAgICAgICByZXBvUHJlbG9hZExpc3QucHVzaCgnVEEnKTtcbiAgICAgIH1cbiAgICAgIGlmIChib29rSURMaXN0LmluY2x1ZGVzKCdPQlMnKSkge1xuICAgICAgICBsZXQgb2JzUmVwb1ByZWxvYWRMaXN0ID0gWydPQlMnLCAnT0JTLVRXTCcsICdPQlMtVE4yJywgJ09CUy1UUTInLCAnT0JTLVNOMicsICdPQlMtU1EyJ107IC8vIGZvciBERUZBVUxUXG4gICAgICAgIGlmIChkYXRhU2V0ID09PSAnT0xEJylcbiAgICAgICAgICBvYnNSZXBvUHJlbG9hZExpc3QgPSBbJ09CUycsICdPQlMtVFdMJywgJ09CUy1UTicsICdPQlMtVFEnLCAnT0JTLVNOJywgJ09CUy1TUSddO1xuICAgICAgICBlbHNlIGlmIChkYXRhU2V0ID09PSAnTkVXJylcbiAgICAgICAgICBvYnNSZXBvUHJlbG9hZExpc3QgPSBbJ09CUycsICdPQlMtVFdMJywgJ09CUy1UTjInLCAnT0JTLVRRMicsICdPQlMtU04nLCAnT0JTLVNRJ107XG4gICAgICAgIGVsc2UgaWYgKGRhdGFTZXQgPT09ICdCT1RIJylcbiAgICAgICAgICBvYnNSZXBvUHJlbG9hZExpc3QgPSBbJ09CUycsICdPQlMtVFdMJywgJ09CUy1UTicsICdPQlMtVE4yJywgJ09CUy1UUScsICdPQlMtVFEyJywgJ09CUy1TTicsICdPQlMtU04nLCAnT0JTLVNOMicsICdPQlMtU1EyJ107XG4gICAgICAgIHJlcG9QcmVsb2FkTGlzdC5wdXNoLmFwcGx5KHJlcG9QcmVsb2FkTGlzdCwgb2JzUmVwb1ByZWxvYWRMaXN0KTtcbiAgICAgIH1cblxuICAgICAgc2V0UmVzdWx0VmFsdWUoPHAgc3R5bGU9e3sgY29sb3I6ICdtYWdlbnRhJyB9fT5QcmVsb2FkaW5nIHtyZXBvUHJlbG9hZExpc3QubGVuZ3RofSByZXBvcyBmb3IgPGk+e3VzZXJuYW1lfTwvaT4ge2xhbmd1YWdlQ29kZX0gcmVhZHkgZm9yIGFsbCBib29rIHBhY2thZ2VzIGNoZWNr4oCmPC9wPik7XG4gICAgICBjb25zdCBzdWNjZXNzRmxhZyA9IGF3YWl0IHByZWxvYWRSZXBvc0lmTmVjZXNzYXJ5KHVzZXJuYW1lLCBsYW5ndWFnZUNvZGUsIGJvb2tJRExpc3QsIGJyYW5jaCwgcmVwb1ByZWxvYWRMaXN0KTtcbiAgICAgIGlmICghc3VjY2Vzc0ZsYWcpXG4gICAgICAgIHVzZXJMb2coYEFsbEJvb2tQYWNrYWdlc0NoZWNrIGVycm9yOiBGYWlsZWQgdG8gcHJlLWxvYWQgYWxsIHJlcG9zYClcblxuICAgICAgLy8gRGlzcGxheSBvdXIgXCJ3YWl0aW5nXCIgbWVzc2FnZVxuICAgICAgc2V0UmVzdWx0VmFsdWUoPHAgc3R5bGU9e3sgY29sb3I6ICdtYWdlbnRhJyB9fT5DaGVja2luZyA8aT57dXNlcm5hbWV9PC9pPiB7bGFuZ3VhZ2VDb2RlfSA8Yj57Ym9va0lETGlzdC5qb2luKCcsICcpfTwvYj4gYm9vayBwYWNrYWdlc+KApjwvcD4pO1xuXG4gICAgICBsZXQgcmF3QUJQc1Jlc3VsdHMgPSB7fTtcbiAgICAgIGlmIChib29rSURMaXN0Lmxlbmd0aCkge1xuICAgICAgICByYXdBQlBzUmVzdWx0cyA9IGF3YWl0IGNoZWNrQm9va1BhY2thZ2VzKHVzZXJuYW1lLCBsYW5ndWFnZUNvZGUsIGJvb2tJRExpc3QsIHNldFJlc3VsdFZhbHVlLCBjaGVja2luZ09wdGlvbnMpO1xuICAgICAgICAvLyBkZWJ1Z0xvZyhgcmF3Q0JQc1Jlc3VsdHMga2V5czogJHtPYmplY3Qua2V5cyhyYXdBQlBzUmVzdWx0cyl9YCk7XG4gICAgICAgIC8vIGxvZ2ljQXNzZXJ0KCdjaGVja2VkRmlsZUNvdW50JyBpbiByYXdBQlBzUmVzdWx0cywgYEV4cGVjdGVkIHJhd0NCUHNSZXN1bHRzIHRvIGNvbnRhaW4gJ2NoZWNrZWRGaWxlQ291bnQnOiAke09iamVjdC5rZXlzKHJhd0FCUHNSZXN1bHRzKX1gKTtcbiAgICAgIH1cblxuICAgICAgLy8gQWRkIHNvbWUgZXh0cmEgZmllbGRzIHRvIG91ciByYXdDQlBzUmVzdWx0cyBvYmplY3QgaW4gY2FzZSB3ZSBuZWVkIHRoaXMgaW5mb3JtYXRpb24gYWdhaW4gbGF0ZXJcbiAgICAgIHJhd0FCUHNSZXN1bHRzLmNoZWNrVHlwZSA9ICdBbGxCb29rUGFja2FnZXMnO1xuICAgICAgcmF3QUJQc1Jlc3VsdHMudXNlcm5hbWUgPSB1c2VybmFtZTtcbiAgICAgIHJhd0FCUHNSZXN1bHRzLmxhbmd1YWdlQ29kZSA9IGxhbmd1YWdlQ29kZTtcbiAgICAgIHJhd0FCUHNSZXN1bHRzLmJvb2tJRHMgPSBib29rSURzU3RyaW5nO1xuICAgICAgcmF3QUJQc1Jlc3VsdHMuYm9va0lETGlzdCA9IGJvb2tJRExpc3Q7XG4gICAgICByYXdBQlBzUmVzdWx0cy5jaGVja2VkT3B0aW9ucyA9IGNoZWNraW5nT3B0aW9ucztcblxuICAgICAgLy8gZGVidWdMb2coXCJIZXJlIHdpdGggQ0JQcyByYXdDQlBzUmVzdWx0c1wiLCB0eXBlb2YgcmF3Q0JQc1Jlc3VsdHMpO1xuICAgICAgLy8gTm93IGRvIG91ciBmaW5hbCBoYW5kbGluZyBvZiB0aGUgcmVzdWx0IC0tIHdlIGhhdmUgc29tZSBvcHRpb25zIGF2YWlsYWJsZVxuICAgICAgbGV0IHByb2Nlc3NPcHRpb25zID0geyAvLyBVbmNvbW1lbnQgYW55IG9mIHRoZXNlIHRvIHRlc3QgdGhlbVxuICAgICAgICAvLyAnbWF4aW11bVNpbWlsYXJNZXNzYWdlcyc6IDQsIC8vIGRlZmF1bHQgaXMgMyAtLSAwIG1lYW5zIGRvbuKAmXQgc3VwcHJlc3NcbiAgICAgICAgLy8gJ2Vycm9yUHJpb3JpdHlMZXZlbCc6IDgwMCwgLy8gZGVmYXVsdCBpcyA3MDBcbiAgICAgICAgLy8gJ2N1dG9mZlByaW9yaXR5TGV2ZWwnOiAxMDAsIC8vIGRlZmF1bHQgaXMgMFxuICAgICAgICAvLyAnc29ydEJ5JzogJ0J5UmVwbycsIC8vIGRlZmF1bHQgaXMgJ0J5UHJpb3JpdHknLCBhbHNvIGhhdmUgJ0FzRm91bmQnXG4gICAgICAgIC8vICdpZ25vcmVQcmlvcml0eU51bWJlckxpc3QnOiBbMTIzLCAyMDJdLCAvLyBkZWZhdWx0IGlzIFtdXG4gICAgICB9O1xuICAgICAgLy8gT3IgdGhpcyBhbGxvd3MgdGhlIHBhcmFtZXRlcnMgdG8gYmUgc3BlY2lmaWVkIGFzIGEgQm9va1BhY2thZ2VzQ2hlY2sgcHJvcGVydHlcbiAgICAgIGlmIChwcm9wcy5tYXhpbXVtU2ltaWxhck1lc3NhZ2VzKSBwcm9jZXNzT3B0aW9ucy5tYXhpbXVtU2ltaWxhck1lc3NhZ2VzID0gb3VyUGFyc2VJbnQocHJvcHMubWF4aW11bVNpbWlsYXJNZXNzYWdlcyk7XG4gICAgICBpZiAocHJvcHMuZXJyb3JQcmlvcml0eUxldmVsKSBwcm9jZXNzT3B0aW9ucy5lcnJvclByaW9yaXR5TGV2ZWwgPSBvdXJQYXJzZUludChwcm9wcy5lcnJvclByaW9yaXR5TGV2ZWwpO1xuICAgICAgLy8gaWYgKHByb3BzLmN1dG9mZlByaW9yaXR5TGV2ZWwpIHByb2Nlc3NPcHRpb25zLmN1dG9mZlByaW9yaXR5TGV2ZWwgPSBvdXJQYXJzZUludChwcm9wcy5jdXRvZmZQcmlvcml0eUxldmVsKTtcbiAgICAgIGlmIChwcm9wcy5zb3J0QnkpIHByb2Nlc3NPcHRpb25zLnNvcnRCeSA9IHByb3BzLnNvcnRCeTtcbiAgICAgIC8vIGlmIChwcm9wcy5pZ25vcmVQcmlvcml0eU51bWJlckxpc3QpIHByb2Nlc3NPcHRpb25zLmlnbm9yZVByaW9yaXR5TnVtYmVyTGlzdCA9IHByb3BzLmlnbm9yZVByaW9yaXR5TnVtYmVyTGlzdDtcblxuICAgICAgbGV0IGRpc3BsYXlUeXBlID0gJ0Vycm9yc1dhcm5pbmdzJzsgLy8gZGVmYXVsdFxuICAgICAgaWYgKHByb3BzLmRpc3BsYXlUeXBlKSBkaXNwbGF5VHlwZSA9IHByb3BzLmRpc3BsYXlUeXBlO1xuXG4gICAgICBmdW5jdGlvbiByZW5kZXJTdW1tYXJ5KHByb2Nlc3NlZFJlc3VsdHMpIHtcbiAgICAgICAgcmV0dXJuICg8ZGl2PlxuICAgICAgICAgIDxwPkNoZWNrZWQgPGI+e3VzZXJuYW1lfSB7bGFuZ3VhZ2VDb2RlfSB7Ym9va0lETGlzdC5qb2luKCcsICcpfTwvYj4gKGZyb20gPGk+e2JyYW5jaCA9PT0gdW5kZWZpbmVkID8gJ0RFRkFVTFQnIDogYnJhbmNofTwvaT4gYnJhbmNoZXMpPC9wPlxuICAgICAgICAgIDxSZW5kZXJDaGVja2VkRmlsZXNMaXN0IHVzZXJuYW1lPXt1c2VybmFtZX0gcmVzdWx0cz17cHJvY2Vzc2VkUmVzdWx0c30gLz5cbiAgICAgICAgICA8UmVuZGVyVG90YWxzIHJhd05vdGljZUxpc3RMZW5ndGg9e3Jhd0FCUHNSZXN1bHRzLm5vdGljZUxpc3QubGVuZ3RofSByZXN1bHRzPXtwcm9jZXNzZWRSZXN1bHRzfSAvPlxuICAgICAgICAgIHsvKiA8UmVuZGVyUmF3UmVzdWx0cyByZXN1bHRzPXtyYXdDQlBzUmVzdWx0c30gLz4gKi99XG4gICAgICAgIDwvZGl2Pik7XG4gICAgICB9XG5cbiAgICAgIGlmIChkaXNwbGF5VHlwZSA9PT0gJ0Vycm9yc1dhcm5pbmdzJykge1xuICAgICAgICBjb25zdCBwcm9jZXNzZWRSZXN1bHRzID0gcHJvY2Vzc05vdGljZXNUb0Vycm9yc1dhcm5pbmdzKHJhd0FCUHNSZXN1bHRzLCBwcm9jZXNzT3B0aW9ucyk7XG4gICAgICAgIC8vICAgICAgIHVzZXJMb2coYEFsbEJvb2tQYWNrYWdlc0NoZWNrIGdvdCBiYWNrIHByb2Nlc3NlZFJlc3VsdHMgd2l0aCAke3Byb2Nlc3NlZFJlc3VsdHMuc3VjY2Vzc0xpc3QubGVuZ3RoLnRvTG9jYWxlU3RyaW5nKCl9IHN1Y2Nlc3MgbWVzc2FnZShzKSwgJHtwcm9jZXNzZWRSZXN1bHRzLmVycm9yTGlzdC5sZW5ndGgudG9Mb2NhbGVTdHJpbmcoKX0gZXJyb3IocykgYW5kICR7cHJvY2Vzc2VkUmVzdWx0cy53YXJuaW5nTGlzdC5sZW5ndGgudG9Mb2NhbGVTdHJpbmcoKX0gd2FybmluZyhzKVxuICAgICAgICAvLyBudW1JZ25vcmVkTm90aWNlcz0ke3Byb2Nlc3NlZFJlc3VsdHMubnVtSWdub3JlZE5vdGljZXMudG9Mb2NhbGVTdHJpbmcoKX0gbnVtSGlkZGVuRXJyb3JzPSR7cHJvY2Vzc2VkUmVzdWx0cy5udW1IaWRkZW5FcnJvcnMudG9Mb2NhbGVTdHJpbmcoKX0gbnVtSGlkZGVuV2FybmluZ3M9JHtwcm9jZXNzZWRSZXN1bHRzLm51bUhpZGRlbldhcm5pbmdzLnRvTG9jYWxlU3RyaW5nKCl9YCk7XG5cbiAgICAgICAgLy8gZGVidWdMb2coXCJIZXJlIG5vdyBpbiByZW5kZXJpbmcgYml0IVwiKTtcblxuICAgICAgICBpZiAocHJvY2Vzc2VkUmVzdWx0cy5lcnJvckxpc3QubGVuZ3RoIHx8IHByb2Nlc3NlZFJlc3VsdHMud2FybmluZ0xpc3QubGVuZ3RoKVxuICAgICAgICAgIHNldFJlc3VsdFZhbHVlKDw+XG4gICAgICAgICAgICB7cmVuZGVyU3VtbWFyeShwcm9jZXNzZWRSZXN1bHRzKX1cbiAgICAgICAgICAgIDxSZW5kZXJTdWNjZXNzZXNFcnJvcnNXYXJuaW5ncyByZXN1bHRzPXtwcm9jZXNzZWRSZXN1bHRzfSAvPlxuICAgICAgICAgIDwvPik7XG4gICAgICAgIGVsc2UgLy8gbm8gZXJyb3JzIG9yIHdhcm5pbmdzXG4gICAgICAgICAgc2V0UmVzdWx0VmFsdWUoPD5cbiAgICAgICAgICAgIHtyZW5kZXJTdW1tYXJ5KHByb2Nlc3NlZFJlc3VsdHMpfVxuICAgICAgICAgICAgPFJlbmRlclN1Y2Nlc3Nlc0Vycm9yc1dhcm5pbmdzIHJlc3VsdHM9e3Byb2Nlc3NlZFJlc3VsdHN9IC8+XG4gICAgICAgICAgPC8+KTtcbiAgICAgIH0gZWxzZSBpZiAoZGlzcGxheVR5cGUgPT09ICdTZXZlcmVNZWRpdW1Mb3cnKSB7XG4gICAgICAgIGNvbnN0IHByb2Nlc3NlZFJlc3VsdHMgPSBwcm9jZXNzTm90aWNlc1RvU2V2ZXJlTWVkaXVtTG93KHJhd0FCUHNSZXN1bHRzLCBwcm9jZXNzT3B0aW9ucyk7XG4gICAgICAgIC8vICAgICAgICAgICAgICAgICB1c2VyTG9nKGBBbGxCb29rUGFja2FnZXNDaGVjayBnb3QgcHJvY2Vzc2VkIHJlc3VsdHMgd2l0aCAke3Byb2Nlc3NlZFJlc3VsdHMuc3VjY2Vzc0xpc3QubGVuZ3RoLnRvTG9jYWxlU3RyaW5nKCl9IHN1Y2Nlc3MgbWVzc2FnZShzKSwgJHtwcm9jZXNzZWRSZXN1bHRzLmVycm9yTGlzdC5sZW5ndGgudG9Mb2NhbGVTdHJpbmcoKX0gZXJyb3IocykgYW5kICR7cHJvY2Vzc2VkUmVzdWx0cy53YXJuaW5nTGlzdC5sZW5ndGgudG9Mb2NhbGVTdHJpbmcoKX0gd2FybmluZyhzKVxuICAgICAgICAvLyAgIG51bUlnbm9yZWROb3RpY2VzPSR7cHJvY2Vzc2VkUmVzdWx0cy5udW1JZ25vcmVkTm90aWNlcy50b0xvY2FsZVN0cmluZygpfSBudW1IaWRkZW5FcnJvcnM9JHtwcm9jZXNzZWRSZXN1bHRzLm51bUhpZGRlbkVycm9ycy50b0xvY2FsZVN0cmluZygpfSBudW1IaWRkZW5XYXJuaW5ncz0ke3Byb2Nlc3NlZFJlc3VsdHMubnVtSGlkZGVuV2FybmluZ3MudG9Mb2NhbGVTdHJpbmcoKX1gKTtcblxuICAgICAgICBpZiAocHJvY2Vzc2VkUmVzdWx0cy5zZXZlcmVMaXN0Lmxlbmd0aCB8fCBwcm9jZXNzZWRSZXN1bHRzLm1lZGl1bUxpc3QubGVuZ3RoIHx8IHByb2Nlc3NlZFJlc3VsdHMubG93TGlzdC5sZW5ndGgpXG4gICAgICAgICAgc2V0UmVzdWx0VmFsdWUoPD5cbiAgICAgICAgICAgIHtyZW5kZXJTdW1tYXJ5KHByb2Nlc3NlZFJlc3VsdHMpfVxuICAgICAgICAgICAgPFJlbmRlclN1Y2Nlc3Nlc1NldmVyZU1lZGl1bUxvdyByZXN1bHRzPXtwcm9jZXNzZWRSZXN1bHRzfSAvPlxuICAgICAgICAgIDwvPik7XG4gICAgICAgIGVsc2UgLy8gbm8gc2V2ZXJlLCBtZWRpdW0sIG9yIGxvdyBub3RpY2VzXG4gICAgICAgICAgc2V0UmVzdWx0VmFsdWUoPD5cbiAgICAgICAgICAgIHtyZW5kZXJTdW1tYXJ5KHByb2Nlc3NlZFJlc3VsdHMpfVxuICAgICAgICAgICAgPFJlbmRlclN1Y2Nlc3Nlc1NldmVyZU1lZGl1bUxvdyByZXN1bHRzPXtwcm9jZXNzZWRSZXN1bHRzfSAvPlxuICAgICAgICAgIDwvPik7XG4gICAgICB9IGVsc2UgaWYgKGRpc3BsYXlUeXBlID09PSAnU2luZ2xlTGlzdCcpIHtcbiAgICAgICAgY29uc3QgcHJvY2Vzc2VkUmVzdWx0cyA9IHByb2Nlc3NOb3RpY2VzVG9TaW5nbGVMaXN0KHJhd0FCUHNSZXN1bHRzLCBwcm9jZXNzT3B0aW9ucyk7XG4gICAgICAgIC8vICAgICAgIHVzZXJMb2coYEFsbEJvb2tQYWNrYWdlc0NoZWNrIGdvdCBwcm9jZXNzZWQgcmVzdWx0cyB3aXRoICR7cHJvY2Vzc2VkUmVzdWx0cy5zdWNjZXNzTGlzdC5sZW5ndGgudG9Mb2NhbGVTdHJpbmcoKX0gc3VjY2VzcyBtZXNzYWdlKHMpIGFuZCAke3Byb2Nlc3NlZFJlc3VsdHMud2FybmluZ0xpc3QubGVuZ3RoLnRvTG9jYWxlU3RyaW5nKCl9IG5vdGljZShzKVxuICAgICAgICAvLyBudW1JZ25vcmVkTm90aWNlcz0ke3Byb2Nlc3NlZFJlc3VsdHMubnVtSWdub3JlZE5vdGljZXMudG9Mb2NhbGVTdHJpbmcoKX0gbnVtSGlkZGVuV2FybmluZ3M9JHtwcm9jZXNzZWRSZXN1bHRzLm51bUhpZGRlbldhcm5pbmdzLnRvTG9jYWxlU3RyaW5nKCl9YCk7XG5cbiAgICAgICAgaWYgKHByb2Nlc3NlZFJlc3VsdHMud2FybmluZ0xpc3QubGVuZ3RoKVxuICAgICAgICAgIHNldFJlc3VsdFZhbHVlKDw+XG4gICAgICAgICAgICB7cmVuZGVyU3VtbWFyeShwcm9jZXNzZWRSZXN1bHRzKX1cbiAgICAgICAgICAgIDxSZW5kZXJTdWNjZXNzZXNOb3RpY2VzR3JhZGllbnQgcmVzdWx0cz17cHJvY2Vzc2VkUmVzdWx0c30gLz5cbiAgICAgICAgICA8Lz4pO1xuICAgICAgICBlbHNlIC8vIG5vIHdhcm5pbmdzXG4gICAgICAgICAgc2V0UmVzdWx0VmFsdWUoPD5cbiAgICAgICAgICAgIHtyZW5kZXJTdW1tYXJ5KHByb2Nlc3NlZFJlc3VsdHMpfVxuICAgICAgICAgICAgPFJlbmRlclN1Y2Nlc3Nlc05vdGljZXNHcmFkaWVudCByZXN1bHRzPXtwcm9jZXNzZWRSZXN1bHRzfSAvPlxuICAgICAgICAgIDwvPik7XG4gICAgICB9IGVsc2Ugc2V0UmVzdWx0VmFsdWUoPGIgc3R5bGU9e3sgY29sb3I6ICdyZWQnIH19PkludmFsaWQgZGlzcGxheVR5cGU9J3tkaXNwbGF5VHlwZX0nPC9iPilcblxuICAgICAgLy8gZGVidWdMb2coXCJGaW5pc2hlZCByZW5kZXJpbmcgYml0LlwiKTtcbiAgICB9KSgpOyAvLyBlbmQgb2YgYXN5bmMgcGFydCBpbiB1bm5hbWVkRnVuY3Rpb25cbiAgICAvLyBEb2VzbuKAmXQgd29yayBpZiB3ZSBhZGQgdGhpcyB0byBuZXh0IGxpbmU6IGJvb2tJRExpc3QsYm9va0lEcyx1c2VybmFtZSxicmFuY2gsY2hlY2tpbmdPcHRpb25zLGxhbmd1YWdlQ29kZSxwcm9wc1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9leGhhdXN0aXZlLWRlcHNcbiAgfSwgW0pTT04uc3RyaW5naWZ5KGJvb2tJRExpc3QpLCBib29rSURzU3RyaW5nLCBicmFuY2gsIEpTT04uc3RyaW5naWZ5KGNoZWNraW5nT3B0aW9ucyksIGxhbmd1YWdlQ29kZSwgSlNPTi5zdHJpbmdpZnkocHJvcHMpLCB1c2VybmFtZV0pOyAvLyBlbmQgb2YgdXNlRWZmZWN0IHBhcnRcblxuICBpZiAoYm9va0lESW52YWxpZCkge1xuICAgIHJldHVybiAoPHA+UGxlYXNlIGVudGVyIG9ubHkgdmFsaWQgVVNGTSBib29rIGlkZW50aWZpZXJzIHNlcGFyYXRlZCBieSBjb21tYXMuICgne2Jvb2tJREludmFsaWR9JyBpcyBub3QgdmFsaWQuKTwvcD4pO1xuICB9XG5cbiAgLy8gey8qIDxkaXYgY2xhc3NOYW1lPXtjbGFzc2VzLnJvb3R9PiAqL31cbiAgcmV0dXJuIChcbiAgICA8ZGl2IGNsYXNzTmFtZT1cIndoYXRHb2VzSGVyZVwiPlxuICAgICAge3Jlc3VsdH1cbiAgICA8L2Rpdj5cbiAgKTtcbn1cblxuLy8gQm9va1BhY2thZ2VzQ2hlY2sucHJvcFR5cGVzID0ge1xuLy8gICAvKiogQGlnbm9yZSAqL1xuLy8gICB1c2VybmFtZTogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuLy8gICAvKiogQGlnbm9yZSAqL1xuLy8gICBsYW5ndWFnZUNvZGU6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbi8vICAgYm9va0lEczogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuLy8gICBwcm9wczogUHJvcFR5cGVzLm9iamVjdCxcbi8vIH07XG5cbi8vIGNvbnN0IHN0eWxlcyA9IHRoZW1lID0+ICh7XG4vLyAgIHJvb3Q6IHtcbi8vICAgfSxcbi8vIH0pO1xuXG5leHBvcnQgZGVmYXVsdCBBbGxCb29rUGFja2FnZXNDaGVjaztcbiJdfQ==