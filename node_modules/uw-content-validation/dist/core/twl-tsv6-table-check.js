"use strict";var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");var _typeof = require("@babel/runtime/helpers/typeof");Object.defineProperty(exports, "__esModule", { value: true });exports.checkTWL_TSV6Table = checkTWL_TSV6Table;var _regenerator = _interopRequireDefault(require("@babel/runtime/regenerator"));var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var books = _interopRequireWildcard(require("./books/books"));
var _defaults = require("./defaults");
var _twlTsv6RowCheck = require("./twl-tsv6-row-check");
var _disabledNotices = require("./disabled-notices");

var _utilities = require("./utilities");function _getRequireWildcardCache(nodeInterop) {if (typeof WeakMap !== "function") return null;var cacheBabelInterop = new WeakMap();var cacheNodeInterop = new WeakMap();return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) {return nodeInterop ? cacheNodeInterop : cacheBabelInterop;})(nodeInterop);}function _interopRequireWildcard(obj, nodeInterop) {if (!nodeInterop && obj && obj.__esModule) {return obj;}if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") {return { default: obj };}var cache = _getRequireWildcardCache(nodeInterop);if (cache && cache.has(obj)) {return cache.get(obj);}var newObj = {};var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;for (var key in obj) {if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;if (desc && (desc.get || desc.set)) {Object.defineProperty(newObj, key, desc);} else {newObj[key] = obj[key];}}}newObj.default = obj;if (cache) {cache.set(obj, newObj);}return newObj;}function _createForOfIteratorHelper(o, allowArrayLike) {var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"];if (!it) {if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") {if (it) o = it;var i = 0;var F = function F() {};return { s: F, n: function n() {if (i >= o.length) return { done: true };return { done: false, value: o[i++] };}, e: function e(_e) {throw _e;}, f: F };}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var normalCompletion = true,didErr = false,err;return { s: function s() {it = it.call(o);}, n: function n() {var step = it.next();normalCompletion = step.done;return step;}, e: function e(_e2) {didErr = true;err = _e2;}, f: function f() {try {if (!normalCompletion && it.return != null) it.return();} finally {if (didErr) throw err;}} };}function _unsupportedIterableToArray(o, minLen) {if (!o) return;if (typeof o === "string") return _arrayLikeToArray(o, minLen);var n = Object.prototype.toString.call(o).slice(8, -1);if (n === "Object" && o.constructor) n = o.constructor.name;if (n === "Map" || n === "Set") return Array.from(o);if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);}function _arrayLikeToArray(arr, len) {if (len == null || len > arr.length) len = arr.length;for (var i = 0, arr2 = new Array(len); i < len; i++) {arr2[i] = arr[i];}return arr2;}function ownKeys(object, enumerableOnly) {var keys = Object.keys(object);if (Object.getOwnPropertySymbols) {var symbols = Object.getOwnPropertySymbols(object);if (enumerableOnly) {symbols = symbols.filter(function (sym) {return Object.getOwnPropertyDescriptor(object, sym).enumerable;});}keys.push.apply(keys, symbols);}return keys;}function _objectSpread(target) {for (var i = 1; i < arguments.length; i++) {var source = arguments[i] != null ? arguments[i] : {};if (i % 2) {ownKeys(Object(source), true).forEach(function (key) {(0, _defineProperty2.default)(target, key, source[key]);});} else if (Object.getOwnPropertyDescriptors) {Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));} else {ownKeys(Object(source)).forEach(function (key) {Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));});}}return target;}


var TWL_TABLE_VALIDATOR_VERSION_STRING = '0.1.3';

var NUM_EXPECTED_TWL_TSV_FIELDS = 6; // so expects 5 tabs per line
var EXPECTED_TWL_HEADING_LINE = 'Reference\tID\tTags\tOrigWords\tOccurrence\tTWLink';


/**
 *
 * @param {string} languageCode
 * @param {string} repoCode - 'TWL' or 'OBS-TWL'
 * @param {string} bookID
 * @param {string} filename
 * @param {string} tableText
 * @param {string} givenLocation
 * @param {Object} checkingOptions
 */function
checkTWL_TSV6Table(_x, _x2, _x3, _x4, _x5, _x6, _x7) {return _checkTWL_TSV6Table.apply(this, arguments);}



















































































































































































































































// end of checkTWL_TSV6Table function
function _checkTWL_TSV6Table() {_checkTWL_TSV6Table = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee(languageCode, repoCode, bookID, filename, tableText, givenLocation, checkingOptions) {var ourLocation, carResult, addSuccessMessage, addNoticePartial, excerptLength, lowercaseBookID, numChaptersThisBook, lines, lastC, lastV, rowIDListForVerse, uniqueRowListForVerse, numVersesThisChapter, n, fields, _fields, reference, rowID, tags, quote, occurrence, TWLLink, _reference$split, _reference$split2, C, V, drResultObject, _iterator, _step, drNoticeEntry, _iterator2, _step2, checkedRepoName, _iterator3, _step3, checkedFilenameExtension, uniqueID, intC, lastintC, intV, lastintV, _reference, _C, _V, _rowID, _reference$split3, _reference$split4;return _regenerator.default.wrap(function _callee$(_context) {while (1) {switch (_context.prev = _context.next) {case 0:addNoticePartial = function _addNoticePartial(noticeObject) {// functionLog(`checkTWL_TSV6Table notice: (priority=${priority}) ${message}${characterIndex > 0 ? ` (at character ${characterIndex})` : ""}${excerpt ? ` ${excerpt}` : ""}${location}`);
              //parameterAssert(noticeObject.priority !== undefined, "ATSV addNoticePartial: 'priority' parameter should be defined");
              //parameterAssert(typeof noticeObject.priority === 'number', `TSV addNoticePartial: 'priority' parameter should be a number not a '${typeof noticeObject.priority}': ${noticeObject.priority}`);
              //parameterAssert(noticeObject.message !== undefined, "ATSV addNoticePartial: 'message' parameter should be defined");
              //parameterAssert(typeof noticeObject.message === 'string', `TSV addNoticePartial: 'message' parameter should be a string not a '${typeof noticeObject.message}': ${noticeObject.message}`);
              // //parameterAssert(C !== undefined, "ATSV addNoticePartial: 'C' parameter should be defined");
              if (noticeObject.C) {//parameterAssert(typeof noticeObject.C === 'string', `TSV addNoticePartial: 'C' parameter should be a string not a '${typeof noticeObject.C}': ${noticeObject.C}`);
              } // //parameterAssert(V !== undefined, "ATSV addNoticePartial: 'V' parameter should be defined");
              if (noticeObject.V) {//parameterAssert(typeof noticeObject.V === 'string', `TSV addNoticePartial: 'V' parameter should be a string not a '${typeof noticeObject.V}': ${noticeObject.V}`);
              } // //parameterAssert(characterIndex !== undefined, "ATSV addNoticePartial: 'characterIndex' parameter should be defined");
              if (noticeObject.characterIndex) {//parameterAssert(typeof noticeObject.characterIndex === 'number', `TSV addNoticePartial: 'characterIndex' parameter should be a number not a '${typeof noticeObject.characterIndex}': ${noticeObject.characterIndex}`);
              } // //parameterAssert(excerpt !== undefined, "ATSV addNoticePartial: 'excerpt' parameter should be defined");
              if (noticeObject.excerpt) {//parameterAssert(typeof noticeObject.excerpt === 'string', `TSV addNoticePartial: 'excerpt' parameter should be a string not a '${typeof noticeObject.excerpt}': ${noticeObject.excerpt}`);
              } //parameterAssert(noticeObject.location !== undefined, "ATSV addNoticePartial: 'location' parameter should be defined");
              //parameterAssert(typeof noticeObject.location === 'string', `TSV addNoticePartial: 'location' parameter should be a string not a '${typeof noticeObject.location}': ${noticeObject.location}`);
              if (noticeObject.debugChain) noticeObject.debugChain = "checkTWL_TSV6Table ".concat(noticeObject.debugChain);carResult.noticeList.push(_objectSpread(_objectSpread({}, noticeObject), {}, { bookID: bookID, filename: filename, repoCode: repoCode }));};addSuccessMessage = function _addSuccessMessage(successString) {// functionLog(`checkTWL_TSV6Table success: ${successString}`);
              carResult.successList.push(successString);}; /* This function is optimised for checking the entire file, i.e., all rows.
               It also has the advantage of being able to compare one row with the previous one.
              bookID is a three-character UPPERCASE USFM book identifier or 'OBS'.
              Returns a result object containing a successList and a noticeList
             */ // functionLog(`checkTWL_TSV6Table(${languageCode}, ${repoCode}, ${bookID}, ${tableText.length}, ${givenLocation},${JSON.stringify(checkingOptions)})â€¦`);
            //parameterAssert(languageCode !== undefined, "checkTWL_TSV6Table: 'languageCode' parameter should be defined");
            //parameterAssert(typeof languageCode === 'string', `checkTWL_TSV6Table: 'languageCode' parameter should be a string not a '${typeof languageCode}'`);
            //parameterAssert(repoCode === 'TWL' || repoCode === 'OBS-TWL', `checkTWL_TSV6Table: repoCode expected 'TWL' or 'OBS-TWL' not '${repoCode}'`);
            //parameterAssert(bookID !== undefined, "checkTWL_TSV6Table: 'bookID' parameter should be defined");
            //parameterAssert(typeof bookID === 'string', `checkTWL_TSV6Table: 'bookID' parameter should be a string not a '${typeof bookID}'`);
            //parameterAssert(bookID.length === 3, `checkTWL_TSV6Table: 'bookID' parameter should be three characters long not ${bookID.length}`);
            //parameterAssert(bookID.toUpperCase() === bookID, `checkTWL_TSV6Table: 'bookID' parameter should be UPPERCASE not '${bookID}'`);
            //parameterAssert(bookID === 'OBS' || books.isValidBookID(bookID), `checkTWL_TSV6Table: '${bookID}' is not a valid USFM book identifier`);
            //parameterAssert(givenLocation !== undefined, "checkTWL_TSV6Table: 'givenLocation' parameter should be defined");
            //parameterAssert(typeof givenLocation === 'string', `checkTWL_TSV6Table: 'givenLocation' parameter should be a string not a '${typeof givenLocation}'`);
            ourLocation = givenLocation;if (ourLocation && ourLocation[0] !== ' ') ourLocation = " ".concat(ourLocation);carResult = { successList: [], noticeList: [] };try {excerptLength = checkingOptions === null || checkingOptions === void 0 ? void 0 : checkingOptions.excerptLength;} catch (ttcError) {}if (typeof excerptLength !== 'number' || isNaN(excerptLength)) {excerptLength = _defaults.DEFAULT_EXCERPT_LENGTH; // debugLog(`Using default excerptLength=${excerptLength}`);
            } // else
            // debugLog(`Using supplied excerptLength=${excerptLength}`, `cf. default=${DEFAULT_EXCERPT_LENGTH}`);
            // const excerptHalfLength = Math.floor(excerptLength / 2); // rounded down
            // const excerptHalfLengthPlus = Math.floor((excerptLength + 1) / 2); // rounded up
            // debugLog(`Using excerptHalfLength=${excerptHalfLength}`, `excerptHalfLengthPlus=${excerptHalfLengthPlus}`);
            lowercaseBookID = bookID.toLowerCase();numChaptersThisBook = 0;if (bookID === 'OBS') numChaptersThisBook = 50; // There's 50 Open Bible Stories
            else {//parameterAssert(lowercaseBookID !== 'obs', "Shouldnâ€™t happen in checkTWL_TSV6Table");
                try {numChaptersThisBook = books.chaptersInBook(bookID);} catch (_unused) {if (!books.isValidBookID(bookID)) // must not be in FRT, BAK, etc.
                    addNoticePartial({ priority: 747, message: "Bad function call: should be given a valid book abbreviation", excerpt: bookID, location: " (not '".concat(bookID, "')").concat(ourLocation) });}}lines = tableText.split('\n'); // debugLog(`  '${location}' has ${lines.length.toLocaleString()} total lines (expecting ${NUM_EXPECTED_TN_FIELDS} fields in each line)`);
            lastC = '', lastV = '';rowIDListForVerse = [], uniqueRowListForVerse = [];numVersesThisChapter = 0;n = 0;case 15:if (!(n < lines.length)) {_context.next = 47;break;}if (!(n === 0)) {_context.next = 20;break;}if (lines[0] === EXPECTED_TWL_HEADING_LINE) addSuccessMessage("Checked TSV header ".concat(ourLocation));else addNoticePartial({ priority: 988, message: "Bad TSV header", details: "expected '".concat(EXPECTED_TWL_HEADING_LINE, "'"), excerpt: lines[0], lineNumber: 1, location: ourLocation });_context.next = 44;break;case 20:fields = lines[n].split('\t');if (!(fields.length === NUM_EXPECTED_TWL_TSV_FIELDS)) {_context.next = 43;break;} // eslint-disable-next-line no-unused-vars
            _fields = (0, _slicedToArray2.default)(fields, 6), reference = _fields[0], rowID = _fields[1], tags = _fields[2], quote = _fields[3], occurrence = _fields[4], TWLLink = _fields[5];_reference$split = reference.split(':'), _reference$split2 = (0, _slicedToArray2.default)(_reference$split, 2), C = _reference$split2[0], V = _reference$split2[1]; // Use the row check to do most basic checks
            _context.next = 26;return (0, _twlTsv6RowCheck.checkTWL_TSV6DataRow)(languageCode, repoCode, lines[n], bookID, C, V, ourLocation, checkingOptions);case 26:drResultObject = _context.sent; // Choose only ONE of the following
            // This is the fast way of append the results from this field
            // result.noticeList = result.noticeList.concat(firstResult.noticeList);
            // If we need to put everything through addNoticePartial, e.g., for debugging or filtering
            //  process results line by line
            _iterator = _createForOfIteratorHelper(drResultObject.noticeList);try {for (_iterator.s(); !(_step = _iterator.n()).done;) {drNoticeEntry = _step.value;if (drNoticeEntry.extra) // it must be an indirect check on a TA or TW article from a TN2 check
                  carResult.noticeList.push(drNoticeEntry); // Just copy the complete notice as is
                else if (drNoticeEntry.priority !== 931) // We already caught Missing row ID
                    addNoticePartial(_objectSpread(_objectSpread({}, drNoticeEntry), {}, { lineNumber: n + 1 }));} // The following is needed coz we might be checking the linked TA and/or TW articles
            } catch (err) {_iterator.e(err);} finally {_iterator.f();}if (drResultObject.checkedFileCount && drResultObject.checkedFileCount > 0) if (typeof carResult.checkedFileCount === 'number') carResult.checkedFileCount += drResultObject.checkedFileCount;else carResult.checkedFileCount = drResultObject.checkedFileCount;if (drResultObject.checkedFilesizes && drResultObject.checkedFilesizes > 0) if (typeof carResult.checkedFilesizes === 'number') carResult.checkedFilesizes += drResultObject.checkedFilesizes;else carResult.checkedFilesizes = drResultObject.checkedFilesizes;if (drResultObject.checkedRepoNames && drResultObject.checkedRepoNames.length > 0) {_iterator2 = _createForOfIteratorHelper(drResultObject.checkedRepoNames);try {for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {checkedRepoName = _step2.value;try {if (carResult.checkedRepoNames.indexOf(checkedRepoName) < 0) carResult.checkedRepoNames.push(checkedRepoName);} catch (_unused2) {carResult.checkedRepoNames = [checkedRepoName];}}} catch (err) {_iterator2.e(err);} finally {_iterator2.f();}}if (drResultObject.checkedFilenameExtensions && drResultObject.checkedFilenameExtensions.length > 0) {_iterator3 = _createForOfIteratorHelper(drResultObject.checkedFilenameExtensions);try {for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {checkedFilenameExtension = _step3.value;try {if (carResult.checkedFilenameExtensions.indexOf(checkedFilenameExtension) < 0) carResult.checkedFilenameExtensions.push(checkedFilenameExtension);} catch (_unused3) {carResult.checkedFilenameExtensions = [checkedFilenameExtension];}}} catch (err) {_iterator3.e(err);} finally {_iterator3.f();}} // if (ttResult.checkedFilenameExtensions) userLog("ttResult", JSON.stringify(ttResult));
            // So here we only have to check against the previous and next fields for out-of-order problems and duplicate problems
            if (C !== lastC || V !== lastV) {rowIDListForVerse = []; // ID's only need to be unique within each verse
              uniqueRowListForVerse = []; // Same for these
            } // TODO: Check if we need this at all (even though tC 3.0 canâ€™t display these "duplicate" notes)
            // Check for duplicate notes
            uniqueID = C + V + quote + occurrence; // This combination should not be repeated
            // if (uniqueRowListForVerse.includes(uniqueID))
            //     addNoticePartial({ priority: 880, C, V, message: `Duplicate note`, rowID, lineNumber: n + 1, location: ourLocation });
            // if (uniqueRowListForVerse.includes(uniqueID))
            //     addNoticePartial({ priority: 80, C, V, message: `Note: tC 3.0 wonâ€™t display duplicate note`, rowID, lineNumber: n + 1, location: ourLocation });
            uniqueRowListForVerse.push(uniqueID);if (C) {if (C === 'front') {} else if (/^\d+$/.test(C)) {intC = Number(C);if (C !== lastC) if (lowercaseBookID === 'obs') numVersesThisChapter = 99; // Set to maximum expected number of frames
                else numVersesThisChapter = books.versesInChapter(lowercaseBookID, intC);if (intC === 0) addNoticePartial({ priority: 551, C: C, V: V, message: "Invalid zero chapter number", rowID: rowID, lineNumber: n + 1, excerpt: C, location: ourLocation });if (intC > numChaptersThisBook) addNoticePartial({ priority: 737, C: C, V: V, message: "Invalid large chapter number", rowID: rowID, lineNumber: n + 1, excerpt: C, location: ourLocation });if (/^\d+$/.test(lastC)) {lastintC = Number(lastC);if (intC < lastintC) addNoticePartial({ priority: 736, C: C, V: V, message: "Receding chapter number", details: "'".concat(C, "' after '").concat(lastC, "'"), rowID: rowID, lineNumber: n + 1, location: ourLocation });else if (intC > lastintC + 1) addNoticePartial({ priority: 735, C: C, V: V, message: "Advancing chapter number", details: "'".concat(C, "' after '").concat(lastC, "'").rowID, lineNumber: n + 1, location: ourLocation });}} else addNoticePartial({ priority: 734, C: C, V: V, message: "Bad chapter number", rowID: rowID, lineNumber: n + 1, location: ourLocation });} else addNoticePartial({ priority: 739, C: C, V: V, message: "Missing chapter number", rowID: rowID, lineNumber: n + 1, location: " after ".concat(lastC, ":").concat(V).concat(ourLocation) });if (V) {if (V === 'intro') {} else if (/^\d+$/.test(V)) {intV = Number(V);if (intV === 0 && bookID !== 'PSA') // Psalms have \d titles
                  addNoticePartial({ priority: 552, C: C, V: V, message: "Invalid zero verse number", details: "for chapter ".concat(C), rowID: rowID, lineNumber: n + 1, excerpt: V, location: ourLocation });if (intV > numVersesThisChapter) addNoticePartial({ priority: 734, C: C, V: V, message: "Invalid large verse number", details: "for chapter ".concat(C), rowID: rowID, lineNumber: n + 1, excerpt: V, location: ourLocation });if (/^\d+$/.test(lastV)) {lastintV = Number(lastV);if (C === lastC && intV < lastintV) addNoticePartial({ priority: 733, C: C, V: V, message: "Receding verse number", details: "'".concat(V, "' after '").concat(lastV, " for chapter ").concat(C), rowID: rowID, lineNumber: n + 1, excerpt: V, location: ourLocation }); // else if (intV > lastintV + 1)
                  //   addNoticePartial({priority:556, `Skipped verses with '${V}' verse number after '${lastV}'${withString}`);
                }} else addNoticePartial({ priority: 738, C: C, V: V, message: "Bad verse number", rowID: rowID, lineNumber: n + 1, location: ourLocation });} else addNoticePartial({ priority: 790, C: C, V: V, message: "Missing verse number", rowID: rowID, lineNumber: n + 1, location: " after ".concat(C, ":").concat(lastV).concat(ourLocation) });if (rowID) {if (rowIDListForVerse.includes(rowID)) addNoticePartial({ priority: 831, C: C, V: V, message: "Duplicate '".concat(rowID, "' ID"), fieldName: 'ID', rowID: rowID, lineNumber: n + 1, location: ourLocation });rowIDListForVerse.push(rowID);} else addNoticePartial({ priority: 932, C: C, V: V, message: "Missing row ID", fieldName: 'ID', lineNumber: n + 1, location: ourLocation });lastC = C;lastV = V;_context.next = 44;break;case 43: // wrong number of fields in the row
            // if (n === lines.length - 1) // itâ€™s the last line
            //     userLog(`  Line ${n}: Has ${fields.length} field(s) instead of ${NUM_EXPECTED_TN_FIELDS}: ${EXPECTED_TWL_HEADING_LINE.replace(/\t/g, ', ')}`);
            // else
            if (n !== lines.length - 1) {// itâ€™s not the last line
              // Have a go at getting some of the first fields out of the line
              _reference = '?:?', _C = '?', _V = '?', _rowID = '????';try {_reference = fields[0];} catch (_unused4) {}try {_rowID = fields[1];} catch (_unused5) {}try {_reference$split3 = _reference.split(':');_reference$split4 = (0, _slicedToArray2.default)(_reference$split3, 2);_C = _reference$split4[0];_V = _reference$split4[1];} catch (_unused6) {}addNoticePartial({ priority: 983, message: "Wrong number of tabbed fields (expected ".concat(NUM_EXPECTED_TWL_TSV_FIELDS, ")"), excerpt: "Found ".concat(fields.length, " field").concat(fields.length === 1 ? '' : 's'), C: _C, V: _V, rowID: _rowID, lineNumber: n + 1, location: ourLocation });}case 44:n++;_context.next = 15;break;case 47:if (!(checkingOptions !== null && checkingOptions !== void 0 && checkingOptions.suppressNoticeDisablingFlag)) {// functionLog(`checkTWL_TSV6Table: calling removeDisabledNotices(${carResult.noticeList.length}) having ${JSON.stringify(checkingOptions)}`);
              carResult.noticeList = (0, _disabledNotices.removeDisabledNotices)(carResult.noticeList);}if ((!(checkingOptions !== null && checkingOptions !== void 0 && checkingOptions.cutoffPriorityLevel) || (checkingOptions === null || checkingOptions === void 0 ? void 0 : checkingOptions.cutoffPriorityLevel) < 20) && checkingOptions !== null && checkingOptions !== void 0 && checkingOptions.disableAllLinkFetchingFlag) addNoticePartial({ priority: 20, message: "Note that 'disableAllLinkFetchingFlag' was set so link targets were not checked", location: ourLocation });addSuccessMessage("Checked all ".concat((lines.length - 1).toLocaleString(), " data line").concat(lines.length - 1 === 1 ? '' : 's').concat(ourLocation, "."));if (carResult.noticeList.length) addSuccessMessage("checkTWL_TSV6Table v".concat(TWL_TABLE_VALIDATOR_VERSION_STRING, " finished with ").concat(carResult.noticeList.length ? carResult.noticeList.length.toLocaleString() : "zero", " notice").concat(carResult.noticeList.length === 1 ? '' : 's'));else addSuccessMessage("No errors or warnings found by checkTWL_TSV6Table v".concat(TWL_TABLE_VALIDATOR_VERSION_STRING)); // debugLog(`  checkTWL_TSV6Table returning with ${result.successList.length.toLocaleString()} success(es), ${result.noticeList.length.toLocaleString()} notice(s).`);
            // debugLog("checkTWL_TSV6Table result is", JSON.stringify(carResult));
            return _context.abrupt("return", carResult);case 52:case "end":return _context.stop();}}}, _callee);}));return _checkTWL_TSV6Table.apply(this, arguments);}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb3JlL3R3bC10c3Y2LXRhYmxlLWNoZWNrLmpzIl0sIm5hbWVzIjpbIlRXTF9UQUJMRV9WQUxJREFUT1JfVkVSU0lPTl9TVFJJTkciLCJOVU1fRVhQRUNURURfVFdMX1RTVl9GSUVMRFMiLCJFWFBFQ1RFRF9UV0xfSEVBRElOR19MSU5FIiwiY2hlY2tUV0xfVFNWNlRhYmxlIiwibGFuZ3VhZ2VDb2RlIiwicmVwb0NvZGUiLCJib29rSUQiLCJmaWxlbmFtZSIsInRhYmxlVGV4dCIsImdpdmVuTG9jYXRpb24iLCJjaGVja2luZ09wdGlvbnMiLCJhZGRTdWNjZXNzTWVzc2FnZSIsImFkZE5vdGljZVBhcnRpYWwiLCJub3RpY2VPYmplY3QiLCJDIiwiViIsImNoYXJhY3RlckluZGV4IiwiZXhjZXJwdCIsImRlYnVnQ2hhaW4iLCJjYXJSZXN1bHQiLCJub3RpY2VMaXN0IiwicHVzaCIsInN1Y2Nlc3NTdHJpbmciLCJzdWNjZXNzTGlzdCIsIm91ckxvY2F0aW9uIiwiZXhjZXJwdExlbmd0aCIsInR0Y0Vycm9yIiwiaXNOYU4iLCJERUZBVUxUX0VYQ0VSUFRfTEVOR1RIIiwibG93ZXJjYXNlQm9va0lEIiwidG9Mb3dlckNhc2UiLCJudW1DaGFwdGVyc1RoaXNCb29rIiwiYm9va3MiLCJjaGFwdGVyc0luQm9vayIsImlzVmFsaWRCb29rSUQiLCJwcmlvcml0eSIsIm1lc3NhZ2UiLCJsb2NhdGlvbiIsImxpbmVzIiwic3BsaXQiLCJsYXN0QyIsImxhc3RWIiwicm93SURMaXN0Rm9yVmVyc2UiLCJ1bmlxdWVSb3dMaXN0Rm9yVmVyc2UiLCJudW1WZXJzZXNUaGlzQ2hhcHRlciIsIm4iLCJsZW5ndGgiLCJkZXRhaWxzIiwibGluZU51bWJlciIsImZpZWxkcyIsInJlZmVyZW5jZSIsInJvd0lEIiwidGFncyIsInF1b3RlIiwib2NjdXJyZW5jZSIsIlRXTExpbmsiLCJkclJlc3VsdE9iamVjdCIsImRyTm90aWNlRW50cnkiLCJleHRyYSIsImNoZWNrZWRGaWxlQ291bnQiLCJjaGVja2VkRmlsZXNpemVzIiwiY2hlY2tlZFJlcG9OYW1lcyIsImNoZWNrZWRSZXBvTmFtZSIsImluZGV4T2YiLCJjaGVja2VkRmlsZW5hbWVFeHRlbnNpb25zIiwiY2hlY2tlZEZpbGVuYW1lRXh0ZW5zaW9uIiwidW5pcXVlSUQiLCJ0ZXN0IiwiaW50QyIsIk51bWJlciIsInZlcnNlc0luQ2hhcHRlciIsImxhc3RpbnRDIiwiaW50ViIsImxhc3RpbnRWIiwiaW5jbHVkZXMiLCJmaWVsZE5hbWUiLCJzdXBwcmVzc05vdGljZURpc2FibGluZ0ZsYWciLCJjdXRvZmZQcmlvcml0eUxldmVsIiwiZGlzYWJsZUFsbExpbmtGZXRjaGluZ0ZsYWciLCJ0b0xvY2FsZVN0cmluZyJdLCJtYXBwaW5ncyI6IjBuQkFBQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSx3Qzs7O0FBR0EsSUFBTUEsa0NBQWtDLEdBQUcsT0FBM0M7O0FBRUEsSUFBTUMsMkJBQTJCLEdBQUcsQ0FBcEMsQyxDQUF1QztBQUN2QyxJQUFNQyx5QkFBeUIsR0FBRyxvREFBbEM7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEc7QUFDc0JDLGtCOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBb1B0Qjs4SEFwUE8saUJBQWtDQyxZQUFsQyxFQUFnREMsUUFBaEQsRUFBMERDLE1BQTFELEVBQWtFQyxRQUFsRSxFQUE0RUMsU0FBNUUsRUFBdUZDLGFBQXZGLEVBQXNHQyxlQUF0RywrQkEwQk1DLGlC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LDBCQUR4QixFQUVJbEUsZ0JBQWdCLENBQUMsRUFBRXVCLFFBQVEsRUFBRSxFQUFaLEVBQWdCQyxPQUFPLEVBQUUsaUZBQXpCLEVBQTRHQyxRQUFRLEVBQUViLFdBQXRILEVBQUQsQ0FBaEIsQ0FFSmIsaUJBQWlCLHVCQUFnQixDQUFDMkIsS0FBSyxDQUFDUSxNQUFOLEdBQWUsQ0FBaEIsRUFBbUJpQyxjQUFuQixFQUFoQix1QkFBZ0V6QyxLQUFLLENBQUNRLE1BQU4sR0FBZSxDQUFmLEtBQXFCLENBQXJCLEdBQXlCLEVBQXpCLEdBQThCLEdBQTlGLFNBQW9HdEIsV0FBcEcsT0FBakIsQ0FDQSxJQUFJTCxTQUFTLENBQUNDLFVBQVYsQ0FBcUIwQixNQUF6QixFQUNJbkMsaUJBQWlCLCtCQUF3Qlgsa0NBQXhCLDRCQUE0RW1CLFNBQVMsQ0FBQ0MsVUFBVixDQUFxQjBCLE1BQXJCLEdBQThCM0IsU0FBUyxDQUFDQyxVQUFWLENBQXFCMEIsTUFBckIsQ0FBNEJpQyxjQUE1QixFQUE5QixHQUE2RSxNQUF6SixvQkFBeUs1RCxTQUFTLENBQUNDLFVBQVYsQ0FBcUIwQixNQUFyQixLQUFnQyxDQUFoQyxHQUFvQyxFQUFwQyxHQUF5QyxHQUFsTixFQUFqQixDQURKLEtBR0luQyxpQkFBaUIsOERBQXVEWCxrQ0FBdkQsRUFBakIsQ0EvT0QsQ0FnUEg7QUFDQTtBQWpQRyw2Q0FrUEltQixTQWxQSiwyRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGJvb2tzIGZyb20gJy4vYm9va3MvYm9va3MnO1xuaW1wb3J0IHsgREVGQVVMVF9FWENFUlBUX0xFTkdUSCB9IGZyb20gJy4vZGVmYXVsdHMnXG5pbXBvcnQgeyBjaGVja1RXTF9UU1Y2RGF0YVJvdyB9IGZyb20gJy4vdHdsLXRzdjYtcm93LWNoZWNrJztcbmltcG9ydCB7IHJlbW92ZURpc2FibGVkTm90aWNlcyB9IGZyb20gJy4vZGlzYWJsZWQtbm90aWNlcyc7XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnNcbmltcG9ydCB7IHBhcmFtZXRlckFzc2VydCB9IGZyb20gJy4vdXRpbGl0aWVzJztcblxuXG5jb25zdCBUV0xfVEFCTEVfVkFMSURBVE9SX1ZFUlNJT05fU1RSSU5HID0gJzAuMS4zJztcblxuY29uc3QgTlVNX0VYUEVDVEVEX1RXTF9UU1ZfRklFTERTID0gNjsgLy8gc28gZXhwZWN0cyA1IHRhYnMgcGVyIGxpbmVcbmNvbnN0IEVYUEVDVEVEX1RXTF9IRUFESU5HX0xJTkUgPSAnUmVmZXJlbmNlXFx0SURcXHRUYWdzXFx0T3JpZ1dvcmRzXFx0T2NjdXJyZW5jZVxcdFRXTGluayc7XG5cblxuLyoqXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGxhbmd1YWdlQ29kZVxuICogQHBhcmFtIHtzdHJpbmd9IHJlcG9Db2RlIC0gJ1RXTCcgb3IgJ09CUy1UV0wnXG4gKiBAcGFyYW0ge3N0cmluZ30gYm9va0lEXG4gKiBAcGFyYW0ge3N0cmluZ30gZmlsZW5hbWVcbiAqIEBwYXJhbSB7c3RyaW5nfSB0YWJsZVRleHRcbiAqIEBwYXJhbSB7c3RyaW5nfSBnaXZlbkxvY2F0aW9uXG4gKiBAcGFyYW0ge09iamVjdH0gY2hlY2tpbmdPcHRpb25zXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjaGVja1RXTF9UU1Y2VGFibGUobGFuZ3VhZ2VDb2RlLCByZXBvQ29kZSwgYm9va0lELCBmaWxlbmFtZSwgdGFibGVUZXh0LCBnaXZlbkxvY2F0aW9uLCBjaGVja2luZ09wdGlvbnMpIHtcbiAgICAvKiBUaGlzIGZ1bmN0aW9uIGlzIG9wdGltaXNlZCBmb3IgY2hlY2tpbmcgdGhlIGVudGlyZSBmaWxlLCBpLmUuLCBhbGwgcm93cy5cblxuICAgICAgSXQgYWxzbyBoYXMgdGhlIGFkdmFudGFnZSBvZiBiZWluZyBhYmxlIHRvIGNvbXBhcmUgb25lIHJvdyB3aXRoIHRoZSBwcmV2aW91cyBvbmUuXG5cbiAgICAgYm9va0lEIGlzIGEgdGhyZWUtY2hhcmFjdGVyIFVQUEVSQ0FTRSBVU0ZNIGJvb2sgaWRlbnRpZmllciBvciAnT0JTJy5cblxuICAgICBSZXR1cm5zIGEgcmVzdWx0IG9iamVjdCBjb250YWluaW5nIGEgc3VjY2Vzc0xpc3QgYW5kIGEgbm90aWNlTGlzdFxuICAgICAqL1xuICAgIC8vIGZ1bmN0aW9uTG9nKGBjaGVja1RXTF9UU1Y2VGFibGUoJHtsYW5ndWFnZUNvZGV9LCAke3JlcG9Db2RlfSwgJHtib29rSUR9LCAke3RhYmxlVGV4dC5sZW5ndGh9LCAke2dpdmVuTG9jYXRpb259LCR7SlNPTi5zdHJpbmdpZnkoY2hlY2tpbmdPcHRpb25zKX0p4oCmYCk7XG4gICAgLy9wYXJhbWV0ZXJBc3NlcnQobGFuZ3VhZ2VDb2RlICE9PSB1bmRlZmluZWQsIFwiY2hlY2tUV0xfVFNWNlRhYmxlOiAnbGFuZ3VhZ2VDb2RlJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGRlZmluZWRcIik7XG4gICAgLy9wYXJhbWV0ZXJBc3NlcnQodHlwZW9mIGxhbmd1YWdlQ29kZSA9PT0gJ3N0cmluZycsIGBjaGVja1RXTF9UU1Y2VGFibGU6ICdsYW5ndWFnZUNvZGUnIHBhcmFtZXRlciBzaG91bGQgYmUgYSBzdHJpbmcgbm90IGEgJyR7dHlwZW9mIGxhbmd1YWdlQ29kZX0nYCk7XG4gICAgLy9wYXJhbWV0ZXJBc3NlcnQocmVwb0NvZGUgPT09ICdUV0wnIHx8IHJlcG9Db2RlID09PSAnT0JTLVRXTCcsIGBjaGVja1RXTF9UU1Y2VGFibGU6IHJlcG9Db2RlIGV4cGVjdGVkICdUV0wnIG9yICdPQlMtVFdMJyBub3QgJyR7cmVwb0NvZGV9J2ApO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KGJvb2tJRCAhPT0gdW5kZWZpbmVkLCBcImNoZWNrVFdMX1RTVjZUYWJsZTogJ2Jvb2tJRCcgcGFyYW1ldGVyIHNob3VsZCBiZSBkZWZpbmVkXCIpO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KHR5cGVvZiBib29rSUQgPT09ICdzdHJpbmcnLCBgY2hlY2tUV0xfVFNWNlRhYmxlOiAnYm9va0lEJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGEgc3RyaW5nIG5vdCBhICcke3R5cGVvZiBib29rSUR9J2ApO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KGJvb2tJRC5sZW5ndGggPT09IDMsIGBjaGVja1RXTF9UU1Y2VGFibGU6ICdib29rSUQnIHBhcmFtZXRlciBzaG91bGQgYmUgdGhyZWUgY2hhcmFjdGVycyBsb25nIG5vdCAke2Jvb2tJRC5sZW5ndGh9YCk7XG4gICAgLy9wYXJhbWV0ZXJBc3NlcnQoYm9va0lELnRvVXBwZXJDYXNlKCkgPT09IGJvb2tJRCwgYGNoZWNrVFdMX1RTVjZUYWJsZTogJ2Jvb2tJRCcgcGFyYW1ldGVyIHNob3VsZCBiZSBVUFBFUkNBU0Ugbm90ICcke2Jvb2tJRH0nYCk7XG4gICAgLy9wYXJhbWV0ZXJBc3NlcnQoYm9va0lEID09PSAnT0JTJyB8fCBib29rcy5pc1ZhbGlkQm9va0lEKGJvb2tJRCksIGBjaGVja1RXTF9UU1Y2VGFibGU6ICcke2Jvb2tJRH0nIGlzIG5vdCBhIHZhbGlkIFVTRk0gYm9vayBpZGVudGlmaWVyYCk7XG4gICAgLy9wYXJhbWV0ZXJBc3NlcnQoZ2l2ZW5Mb2NhdGlvbiAhPT0gdW5kZWZpbmVkLCBcImNoZWNrVFdMX1RTVjZUYWJsZTogJ2dpdmVuTG9jYXRpb24nIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgICAvL3BhcmFtZXRlckFzc2VydCh0eXBlb2YgZ2l2ZW5Mb2NhdGlvbiA9PT0gJ3N0cmluZycsIGBjaGVja1RXTF9UU1Y2VGFibGU6ICdnaXZlbkxvY2F0aW9uJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGEgc3RyaW5nIG5vdCBhICcke3R5cGVvZiBnaXZlbkxvY2F0aW9ufSdgKTtcblxuICAgIGxldCBvdXJMb2NhdGlvbiA9IGdpdmVuTG9jYXRpb247XG4gICAgaWYgKG91ckxvY2F0aW9uICYmIG91ckxvY2F0aW9uWzBdICE9PSAnICcpIG91ckxvY2F0aW9uID0gYCAke291ckxvY2F0aW9ufWA7XG5cbiAgICBjb25zdCBjYXJSZXN1bHQgPSB7IHN1Y2Nlc3NMaXN0OiBbXSwgbm90aWNlTGlzdDogW10gfTtcblxuICAgIGZ1bmN0aW9uIGFkZFN1Y2Nlc3NNZXNzYWdlKHN1Y2Nlc3NTdHJpbmcpIHtcbiAgICAgICAgLy8gZnVuY3Rpb25Mb2coYGNoZWNrVFdMX1RTVjZUYWJsZSBzdWNjZXNzOiAke3N1Y2Nlc3NTdHJpbmd9YCk7XG4gICAgICAgIGNhclJlc3VsdC5zdWNjZXNzTGlzdC5wdXNoKHN1Y2Nlc3NTdHJpbmcpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBhZGROb3RpY2VQYXJ0aWFsKG5vdGljZU9iamVjdCkge1xuICAgICAgICAvLyBmdW5jdGlvbkxvZyhgY2hlY2tUV0xfVFNWNlRhYmxlIG5vdGljZTogKHByaW9yaXR5PSR7cHJpb3JpdHl9KSAke21lc3NhZ2V9JHtjaGFyYWN0ZXJJbmRleCA+IDAgPyBgIChhdCBjaGFyYWN0ZXIgJHtjaGFyYWN0ZXJJbmRleH0pYCA6IFwiXCJ9JHtleGNlcnB0ID8gYCAke2V4Y2VycHR9YCA6IFwiXCJ9JHtsb2NhdGlvbn1gKTtcbiAgICAgICAgLy9wYXJhbWV0ZXJBc3NlcnQobm90aWNlT2JqZWN0LnByaW9yaXR5ICE9PSB1bmRlZmluZWQsIFwiQVRTViBhZGROb3RpY2VQYXJ0aWFsOiAncHJpb3JpdHknIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgICAgICAgLy9wYXJhbWV0ZXJBc3NlcnQodHlwZW9mIG5vdGljZU9iamVjdC5wcmlvcml0eSA9PT0gJ251bWJlcicsIGBUU1YgYWRkTm90aWNlUGFydGlhbDogJ3ByaW9yaXR5JyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGEgbnVtYmVyIG5vdCBhICcke3R5cGVvZiBub3RpY2VPYmplY3QucHJpb3JpdHl9JzogJHtub3RpY2VPYmplY3QucHJpb3JpdHl9YCk7XG4gICAgICAgIC8vcGFyYW1ldGVyQXNzZXJ0KG5vdGljZU9iamVjdC5tZXNzYWdlICE9PSB1bmRlZmluZWQsIFwiQVRTViBhZGROb3RpY2VQYXJ0aWFsOiAnbWVzc2FnZScgcGFyYW1ldGVyIHNob3VsZCBiZSBkZWZpbmVkXCIpO1xuICAgICAgICAvL3BhcmFtZXRlckFzc2VydCh0eXBlb2Ygbm90aWNlT2JqZWN0Lm1lc3NhZ2UgPT09ICdzdHJpbmcnLCBgVFNWIGFkZE5vdGljZVBhcnRpYWw6ICdtZXNzYWdlJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGEgc3RyaW5nIG5vdCBhICcke3R5cGVvZiBub3RpY2VPYmplY3QubWVzc2FnZX0nOiAke25vdGljZU9iamVjdC5tZXNzYWdlfWApO1xuICAgICAgICAvLyAvL3BhcmFtZXRlckFzc2VydChDICE9PSB1bmRlZmluZWQsIFwiQVRTViBhZGROb3RpY2VQYXJ0aWFsOiAnQycgcGFyYW1ldGVyIHNob3VsZCBiZSBkZWZpbmVkXCIpO1xuICAgICAgICBpZiAobm90aWNlT2JqZWN0LkMpIHsgLy9wYXJhbWV0ZXJBc3NlcnQodHlwZW9mIG5vdGljZU9iamVjdC5DID09PSAnc3RyaW5nJywgYFRTViBhZGROb3RpY2VQYXJ0aWFsOiAnQycgcGFyYW1ldGVyIHNob3VsZCBiZSBhIHN0cmluZyBub3QgYSAnJHt0eXBlb2Ygbm90aWNlT2JqZWN0LkN9JzogJHtub3RpY2VPYmplY3QuQ31gKTtcbiAgICAgICAgfVxuICAgICAgICAvLyAvL3BhcmFtZXRlckFzc2VydChWICE9PSB1bmRlZmluZWQsIFwiQVRTViBhZGROb3RpY2VQYXJ0aWFsOiAnVicgcGFyYW1ldGVyIHNob3VsZCBiZSBkZWZpbmVkXCIpO1xuICAgICAgICBpZiAobm90aWNlT2JqZWN0LlYpIHsgLy9wYXJhbWV0ZXJBc3NlcnQodHlwZW9mIG5vdGljZU9iamVjdC5WID09PSAnc3RyaW5nJywgYFRTViBhZGROb3RpY2VQYXJ0aWFsOiAnVicgcGFyYW1ldGVyIHNob3VsZCBiZSBhIHN0cmluZyBub3QgYSAnJHt0eXBlb2Ygbm90aWNlT2JqZWN0LlZ9JzogJHtub3RpY2VPYmplY3QuVn1gKTtcbiAgICAgICAgfVxuICAgICAgICAvLyAvL3BhcmFtZXRlckFzc2VydChjaGFyYWN0ZXJJbmRleCAhPT0gdW5kZWZpbmVkLCBcIkFUU1YgYWRkTm90aWNlUGFydGlhbDogJ2NoYXJhY3RlckluZGV4JyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGRlZmluZWRcIik7XG4gICAgICAgIGlmIChub3RpY2VPYmplY3QuY2hhcmFjdGVySW5kZXgpIHsgLy9wYXJhbWV0ZXJBc3NlcnQodHlwZW9mIG5vdGljZU9iamVjdC5jaGFyYWN0ZXJJbmRleCA9PT0gJ251bWJlcicsIGBUU1YgYWRkTm90aWNlUGFydGlhbDogJ2NoYXJhY3RlckluZGV4JyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGEgbnVtYmVyIG5vdCBhICcke3R5cGVvZiBub3RpY2VPYmplY3QuY2hhcmFjdGVySW5kZXh9JzogJHtub3RpY2VPYmplY3QuY2hhcmFjdGVySW5kZXh9YCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gLy9wYXJhbWV0ZXJBc3NlcnQoZXhjZXJwdCAhPT0gdW5kZWZpbmVkLCBcIkFUU1YgYWRkTm90aWNlUGFydGlhbDogJ2V4Y2VycHQnIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgICAgICAgaWYgKG5vdGljZU9iamVjdC5leGNlcnB0KSB7IC8vcGFyYW1ldGVyQXNzZXJ0KHR5cGVvZiBub3RpY2VPYmplY3QuZXhjZXJwdCA9PT0gJ3N0cmluZycsIGBUU1YgYWRkTm90aWNlUGFydGlhbDogJ2V4Y2VycHQnIHBhcmFtZXRlciBzaG91bGQgYmUgYSBzdHJpbmcgbm90IGEgJyR7dHlwZW9mIG5vdGljZU9iamVjdC5leGNlcnB0fSc6ICR7bm90aWNlT2JqZWN0LmV4Y2VycHR9YCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9wYXJhbWV0ZXJBc3NlcnQobm90aWNlT2JqZWN0LmxvY2F0aW9uICE9PSB1bmRlZmluZWQsIFwiQVRTViBhZGROb3RpY2VQYXJ0aWFsOiAnbG9jYXRpb24nIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgICAgICAgLy9wYXJhbWV0ZXJBc3NlcnQodHlwZW9mIG5vdGljZU9iamVjdC5sb2NhdGlvbiA9PT0gJ3N0cmluZycsIGBUU1YgYWRkTm90aWNlUGFydGlhbDogJ2xvY2F0aW9uJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGEgc3RyaW5nIG5vdCBhICcke3R5cGVvZiBub3RpY2VPYmplY3QubG9jYXRpb259JzogJHtub3RpY2VPYmplY3QubG9jYXRpb259YCk7XG5cbiAgICAgICAgaWYgKG5vdGljZU9iamVjdC5kZWJ1Z0NoYWluKSBub3RpY2VPYmplY3QuZGVidWdDaGFpbiA9IGBjaGVja1RXTF9UU1Y2VGFibGUgJHtub3RpY2VPYmplY3QuZGVidWdDaGFpbn1gO1xuICAgICAgICBjYXJSZXN1bHQubm90aWNlTGlzdC5wdXNoKHsgLi4ubm90aWNlT2JqZWN0LCBib29rSUQsIGZpbGVuYW1lLCByZXBvQ29kZSB9KTtcbiAgICB9XG5cblxuICAgIGxldCBleGNlcnB0TGVuZ3RoO1xuICAgIHRyeSB7XG4gICAgICAgIGV4Y2VycHRMZW5ndGggPSBjaGVja2luZ09wdGlvbnM/LmV4Y2VycHRMZW5ndGg7XG4gICAgfSBjYXRjaCAodHRjRXJyb3IpIHsgfVxuICAgIGlmICh0eXBlb2YgZXhjZXJwdExlbmd0aCAhPT0gJ251bWJlcicgfHwgaXNOYU4oZXhjZXJwdExlbmd0aCkpIHtcbiAgICAgICAgZXhjZXJwdExlbmd0aCA9IERFRkFVTFRfRVhDRVJQVF9MRU5HVEg7XG4gICAgICAgIC8vIGRlYnVnTG9nKGBVc2luZyBkZWZhdWx0IGV4Y2VycHRMZW5ndGg9JHtleGNlcnB0TGVuZ3RofWApO1xuICAgIH1cbiAgICAvLyBlbHNlXG4gICAgLy8gZGVidWdMb2coYFVzaW5nIHN1cHBsaWVkIGV4Y2VycHRMZW5ndGg9JHtleGNlcnB0TGVuZ3RofWAsIGBjZi4gZGVmYXVsdD0ke0RFRkFVTFRfRVhDRVJQVF9MRU5HVEh9YCk7XG4gICAgLy8gY29uc3QgZXhjZXJwdEhhbGZMZW5ndGggPSBNYXRoLmZsb29yKGV4Y2VycHRMZW5ndGggLyAyKTsgLy8gcm91bmRlZCBkb3duXG4gICAgLy8gY29uc3QgZXhjZXJwdEhhbGZMZW5ndGhQbHVzID0gTWF0aC5mbG9vcigoZXhjZXJwdExlbmd0aCArIDEpIC8gMik7IC8vIHJvdW5kZWQgdXBcbiAgICAvLyBkZWJ1Z0xvZyhgVXNpbmcgZXhjZXJwdEhhbGZMZW5ndGg9JHtleGNlcnB0SGFsZkxlbmd0aH1gLCBgZXhjZXJwdEhhbGZMZW5ndGhQbHVzPSR7ZXhjZXJwdEhhbGZMZW5ndGhQbHVzfWApO1xuXG4gICAgbGV0IGxvd2VyY2FzZUJvb2tJRCA9IGJvb2tJRC50b0xvd2VyQ2FzZSgpO1xuICAgIGxldCBudW1DaGFwdGVyc1RoaXNCb29rID0gMDtcbiAgICBpZiAoYm9va0lEID09PSAnT0JTJylcbiAgICAgICAgbnVtQ2hhcHRlcnNUaGlzQm9vayA9IDUwOyAvLyBUaGVyZSdzIDUwIE9wZW4gQmlibGUgU3Rvcmllc1xuICAgIGVsc2Uge1xuICAgICAgICAvL3BhcmFtZXRlckFzc2VydChsb3dlcmNhc2VCb29rSUQgIT09ICdvYnMnLCBcIlNob3VsZG7igJl0IGhhcHBlbiBpbiBjaGVja1RXTF9UU1Y2VGFibGVcIik7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBudW1DaGFwdGVyc1RoaXNCb29rID0gYm9va3MuY2hhcHRlcnNJbkJvb2soYm9va0lEKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCB7XG4gICAgICAgICAgICBpZiAoIWJvb2tzLmlzVmFsaWRCb29rSUQoYm9va0lEKSkgLy8gbXVzdCBub3QgYmUgaW4gRlJULCBCQUssIGV0Yy5cbiAgICAgICAgICAgICAgICBhZGROb3RpY2VQYXJ0aWFsKHsgcHJpb3JpdHk6IDc0NywgbWVzc2FnZTogXCJCYWQgZnVuY3Rpb24gY2FsbDogc2hvdWxkIGJlIGdpdmVuIGEgdmFsaWQgYm9vayBhYmJyZXZpYXRpb25cIiwgZXhjZXJwdDogYm9va0lELCBsb2NhdGlvbjogYCAobm90ICcke2Jvb2tJRH0nKSR7b3VyTG9jYXRpb259YCB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGxldCBsaW5lcyA9IHRhYmxlVGV4dC5zcGxpdCgnXFxuJyk7XG4gICAgLy8gZGVidWdMb2coYCAgJyR7bG9jYXRpb259JyBoYXMgJHtsaW5lcy5sZW5ndGgudG9Mb2NhbGVTdHJpbmcoKX0gdG90YWwgbGluZXMgKGV4cGVjdGluZyAke05VTV9FWFBFQ1RFRF9UTl9GSUVMRFN9IGZpZWxkcyBpbiBlYWNoIGxpbmUpYCk7XG5cbiAgICBsZXQgbGFzdEMgPSAnJywgbGFzdFYgPSAnJztcbiAgICBsZXQgcm93SURMaXN0Rm9yVmVyc2UgPSBbXSwgdW5pcXVlUm93TGlzdEZvclZlcnNlID0gW107XG4gICAgbGV0IG51bVZlcnNlc1RoaXNDaGFwdGVyID0gMDtcbiAgICBmb3IgKGxldCBuID0gMDsgbiA8IGxpbmVzLmxlbmd0aDsgbisrKSB7XG4gICAgICAgIC8vIGZ1bmN0aW9uTG9nKGBjaGVja1RXTF9UU1Y2VGFibGUgY2hlY2tpbmcgbGluZSAke259OiAke0pTT04uc3RyaW5naWZ5KGxpbmVzW25dKX1gKTtcbiAgICAgICAgaWYgKG4gPT09IDApIHtcbiAgICAgICAgICAgIGlmIChsaW5lc1swXSA9PT0gRVhQRUNURURfVFdMX0hFQURJTkdfTElORSlcbiAgICAgICAgICAgICAgICBhZGRTdWNjZXNzTWVzc2FnZShgQ2hlY2tlZCBUU1YgaGVhZGVyICR7b3VyTG9jYXRpb259YCk7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgYWRkTm90aWNlUGFydGlhbCh7IHByaW9yaXR5OiA5ODgsIG1lc3NhZ2U6IFwiQmFkIFRTViBoZWFkZXJcIiwgZGV0YWlsczogYGV4cGVjdGVkICcke0VYUEVDVEVEX1RXTF9IRUFESU5HX0xJTkV9J2AsIGV4Y2VycHQ6IGxpbmVzWzBdLCBsaW5lTnVtYmVyOiAxLCBsb2NhdGlvbjogb3VyTG9jYXRpb24gfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSAvLyBub3QgdGhlIGhlYWRlclxuICAgICAgICB7XG4gICAgICAgICAgICBsZXQgZmllbGRzID0gbGluZXNbbl0uc3BsaXQoJ1xcdCcpO1xuICAgICAgICAgICAgaWYgKGZpZWxkcy5sZW5ndGggPT09IE5VTV9FWFBFQ1RFRF9UV0xfVFNWX0ZJRUxEUykge1xuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtdmFyc1xuICAgICAgICAgICAgICAgIGNvbnN0IFtyZWZlcmVuY2UsIHJvd0lELCB0YWdzLCBxdW90ZSwgb2NjdXJyZW5jZSwgVFdMTGlua10gPSBmaWVsZHM7XG4gICAgICAgICAgICAgICAgY29uc3QgW0MsIFZdID0gcmVmZXJlbmNlLnNwbGl0KCc6JylcblxuICAgICAgICAgICAgICAgIC8vIFVzZSB0aGUgcm93IGNoZWNrIHRvIGRvIG1vc3QgYmFzaWMgY2hlY2tzXG4gICAgICAgICAgICAgICAgY29uc3QgZHJSZXN1bHRPYmplY3QgPSBhd2FpdCBjaGVja1RXTF9UU1Y2RGF0YVJvdyhsYW5ndWFnZUNvZGUsIHJlcG9Db2RlLCBsaW5lc1tuXSwgYm9va0lELCBDLCBWLCBvdXJMb2NhdGlvbiwgY2hlY2tpbmdPcHRpb25zKTtcbiAgICAgICAgICAgICAgICAvLyBDaG9vc2Ugb25seSBPTkUgb2YgdGhlIGZvbGxvd2luZ1xuICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgdGhlIGZhc3Qgd2F5IG9mIGFwcGVuZCB0aGUgcmVzdWx0cyBmcm9tIHRoaXMgZmllbGRcbiAgICAgICAgICAgICAgICAvLyByZXN1bHQubm90aWNlTGlzdCA9IHJlc3VsdC5ub3RpY2VMaXN0LmNvbmNhdChmaXJzdFJlc3VsdC5ub3RpY2VMaXN0KTtcbiAgICAgICAgICAgICAgICAvLyBJZiB3ZSBuZWVkIHRvIHB1dCBldmVyeXRoaW5nIHRocm91Z2ggYWRkTm90aWNlUGFydGlhbCwgZS5nLiwgZm9yIGRlYnVnZ2luZyBvciBmaWx0ZXJpbmdcbiAgICAgICAgICAgICAgICAvLyAgcHJvY2VzcyByZXN1bHRzIGxpbmUgYnkgbGluZVxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZHJOb3RpY2VFbnRyeSBvZiBkclJlc3VsdE9iamVjdC5ub3RpY2VMaXN0KVxuICAgICAgICAgICAgICAgICAgICBpZiAoZHJOb3RpY2VFbnRyeS5leHRyYSkgLy8gaXQgbXVzdCBiZSBhbiBpbmRpcmVjdCBjaGVjayBvbiBhIFRBIG9yIFRXIGFydGljbGUgZnJvbSBhIFROMiBjaGVja1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FyUmVzdWx0Lm5vdGljZUxpc3QucHVzaChkck5vdGljZUVudHJ5KTsgLy8gSnVzdCBjb3B5IHRoZSBjb21wbGV0ZSBub3RpY2UgYXMgaXNcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZHJOb3RpY2VFbnRyeS5wcmlvcml0eSAhPT0gOTMxKSAvLyBXZSBhbHJlYWR5IGNhdWdodCBNaXNzaW5nIHJvdyBJRFxuICAgICAgICAgICAgICAgICAgICAgICAgYWRkTm90aWNlUGFydGlhbCh7IC4uLmRyTm90aWNlRW50cnksIGxpbmVOdW1iZXI6IG4gKyAxIH0pO1xuICAgICAgICAgICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgaXMgbmVlZGVkIGNveiB3ZSBtaWdodCBiZSBjaGVja2luZyB0aGUgbGlua2VkIFRBIGFuZC9vciBUVyBhcnRpY2xlc1xuICAgICAgICAgICAgICAgIGlmIChkclJlc3VsdE9iamVjdC5jaGVja2VkRmlsZUNvdW50ICYmIGRyUmVzdWx0T2JqZWN0LmNoZWNrZWRGaWxlQ291bnQgPiAwKVxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGNhclJlc3VsdC5jaGVja2VkRmlsZUNvdW50ID09PSAnbnVtYmVyJykgY2FyUmVzdWx0LmNoZWNrZWRGaWxlQ291bnQgKz0gZHJSZXN1bHRPYmplY3QuY2hlY2tlZEZpbGVDb3VudDtcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBjYXJSZXN1bHQuY2hlY2tlZEZpbGVDb3VudCA9IGRyUmVzdWx0T2JqZWN0LmNoZWNrZWRGaWxlQ291bnQ7XG4gICAgICAgICAgICAgICAgaWYgKGRyUmVzdWx0T2JqZWN0LmNoZWNrZWRGaWxlc2l6ZXMgJiYgZHJSZXN1bHRPYmplY3QuY2hlY2tlZEZpbGVzaXplcyA+IDApXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgY2FyUmVzdWx0LmNoZWNrZWRGaWxlc2l6ZXMgPT09ICdudW1iZXInKSBjYXJSZXN1bHQuY2hlY2tlZEZpbGVzaXplcyArPSBkclJlc3VsdE9iamVjdC5jaGVja2VkRmlsZXNpemVzO1xuICAgICAgICAgICAgICAgICAgICBlbHNlIGNhclJlc3VsdC5jaGVja2VkRmlsZXNpemVzID0gZHJSZXN1bHRPYmplY3QuY2hlY2tlZEZpbGVzaXplcztcbiAgICAgICAgICAgICAgICBpZiAoZHJSZXN1bHRPYmplY3QuY2hlY2tlZFJlcG9OYW1lcyAmJiBkclJlc3VsdE9iamVjdC5jaGVja2VkUmVwb05hbWVzLmxlbmd0aCA+IDApXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY2hlY2tlZFJlcG9OYW1lIG9mIGRyUmVzdWx0T2JqZWN0LmNoZWNrZWRSZXBvTmFtZXMpXG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkgeyBpZiAoY2FyUmVzdWx0LmNoZWNrZWRSZXBvTmFtZXMuaW5kZXhPZihjaGVja2VkUmVwb05hbWUpIDwgMCkgY2FyUmVzdWx0LmNoZWNrZWRSZXBvTmFtZXMucHVzaChjaGVja2VkUmVwb05hbWUpOyB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCB7IGNhclJlc3VsdC5jaGVja2VkUmVwb05hbWVzID0gW2NoZWNrZWRSZXBvTmFtZV07IH1cbiAgICAgICAgICAgICAgICBpZiAoZHJSZXN1bHRPYmplY3QuY2hlY2tlZEZpbGVuYW1lRXh0ZW5zaW9ucyAmJiBkclJlc3VsdE9iamVjdC5jaGVja2VkRmlsZW5hbWVFeHRlbnNpb25zLmxlbmd0aCA+IDApXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY2hlY2tlZEZpbGVuYW1lRXh0ZW5zaW9uIG9mIGRyUmVzdWx0T2JqZWN0LmNoZWNrZWRGaWxlbmFtZUV4dGVuc2lvbnMpXG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkgeyBpZiAoY2FyUmVzdWx0LmNoZWNrZWRGaWxlbmFtZUV4dGVuc2lvbnMuaW5kZXhPZihjaGVja2VkRmlsZW5hbWVFeHRlbnNpb24pIDwgMCkgY2FyUmVzdWx0LmNoZWNrZWRGaWxlbmFtZUV4dGVuc2lvbnMucHVzaChjaGVja2VkRmlsZW5hbWVFeHRlbnNpb24pOyB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCB7IGNhclJlc3VsdC5jaGVja2VkRmlsZW5hbWVFeHRlbnNpb25zID0gW2NoZWNrZWRGaWxlbmFtZUV4dGVuc2lvbl07IH1cbiAgICAgICAgICAgICAgICAvLyBpZiAodHRSZXN1bHQuY2hlY2tlZEZpbGVuYW1lRXh0ZW5zaW9ucykgdXNlckxvZyhcInR0UmVzdWx0XCIsIEpTT04uc3RyaW5naWZ5KHR0UmVzdWx0KSk7XG5cbiAgICAgICAgICAgICAgICAvLyBTbyBoZXJlIHdlIG9ubHkgaGF2ZSB0byBjaGVjayBhZ2FpbnN0IHRoZSBwcmV2aW91cyBhbmQgbmV4dCBmaWVsZHMgZm9yIG91dC1vZi1vcmRlciBwcm9ibGVtcyBhbmQgZHVwbGljYXRlIHByb2JsZW1zXG4gICAgICAgICAgICAgICAgaWYgKEMgIT09IGxhc3RDIHx8IFYgIT09IGxhc3RWKSB7XG4gICAgICAgICAgICAgICAgICAgIHJvd0lETGlzdEZvclZlcnNlID0gW107IC8vIElEJ3Mgb25seSBuZWVkIHRvIGJlIHVuaXF1ZSB3aXRoaW4gZWFjaCB2ZXJzZVxuICAgICAgICAgICAgICAgICAgICB1bmlxdWVSb3dMaXN0Rm9yVmVyc2UgPSBbXTsgLy8gU2FtZSBmb3IgdGhlc2VcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBDaGVjayBpZiB3ZSBuZWVkIHRoaXMgYXQgYWxsIChldmVuIHRob3VnaCB0QyAzLjAgY2Fu4oCZdCBkaXNwbGF5IHRoZXNlIFwiZHVwbGljYXRlXCIgbm90ZXMpXG4gICAgICAgICAgICAgICAgLy8gQ2hlY2sgZm9yIGR1cGxpY2F0ZSBub3Rlc1xuICAgICAgICAgICAgICAgIGNvbnN0IHVuaXF1ZUlEID0gQyArIFYgKyBxdW90ZSArIG9jY3VycmVuY2U7IC8vIFRoaXMgY29tYmluYXRpb24gc2hvdWxkIG5vdCBiZSByZXBlYXRlZFxuICAgICAgICAgICAgICAgIC8vIGlmICh1bmlxdWVSb3dMaXN0Rm9yVmVyc2UuaW5jbHVkZXModW5pcXVlSUQpKVxuICAgICAgICAgICAgICAgIC8vICAgICBhZGROb3RpY2VQYXJ0aWFsKHsgcHJpb3JpdHk6IDg4MCwgQywgViwgbWVzc2FnZTogYER1cGxpY2F0ZSBub3RlYCwgcm93SUQsIGxpbmVOdW1iZXI6IG4gKyAxLCBsb2NhdGlvbjogb3VyTG9jYXRpb24gfSk7XG4gICAgICAgICAgICAgICAgLy8gaWYgKHVuaXF1ZVJvd0xpc3RGb3JWZXJzZS5pbmNsdWRlcyh1bmlxdWVJRCkpXG4gICAgICAgICAgICAgICAgLy8gICAgIGFkZE5vdGljZVBhcnRpYWwoeyBwcmlvcml0eTogODAsIEMsIFYsIG1lc3NhZ2U6IGBOb3RlOiB0QyAzLjAgd29u4oCZdCBkaXNwbGF5IGR1cGxpY2F0ZSBub3RlYCwgcm93SUQsIGxpbmVOdW1iZXI6IG4gKyAxLCBsb2NhdGlvbjogb3VyTG9jYXRpb24gfSk7XG4gICAgICAgICAgICAgICAgdW5pcXVlUm93TGlzdEZvclZlcnNlLnB1c2godW5pcXVlSUQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKEMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKEMgPT09ICdmcm9udCcpIHsgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICgvXlxcZCskLy50ZXN0KEMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgaW50QyA9IE51bWJlcihDKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChDICE9PSBsYXN0QylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobG93ZXJjYXNlQm9va0lEID09PSAnb2JzJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtVmVyc2VzVGhpc0NoYXB0ZXIgPSA5OTsgLy8gU2V0IHRvIG1heGltdW0gZXhwZWN0ZWQgbnVtYmVyIG9mIGZyYW1lc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtVmVyc2VzVGhpc0NoYXB0ZXIgPSBib29rcy52ZXJzZXNJbkNoYXB0ZXIobG93ZXJjYXNlQm9va0lELCBpbnRDKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbnRDID09PSAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZE5vdGljZVBhcnRpYWwoeyBwcmlvcml0eTogNTUxLCBDLCBWLCBtZXNzYWdlOiBgSW52YWxpZCB6ZXJvIGNoYXB0ZXIgbnVtYmVyYCwgcm93SUQsIGxpbmVOdW1iZXI6IG4gKyAxLCBleGNlcnB0OiBDLCBsb2NhdGlvbjogb3VyTG9jYXRpb24gfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW50QyA+IG51bUNoYXB0ZXJzVGhpc0Jvb2spXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkTm90aWNlUGFydGlhbCh7IHByaW9yaXR5OiA3MzcsIEMsIFYsIG1lc3NhZ2U6IFwiSW52YWxpZCBsYXJnZSBjaGFwdGVyIG51bWJlclwiLCByb3dJRCwgbGluZU51bWJlcjogbiArIDEsIGV4Y2VycHQ6IEMsIGxvY2F0aW9uOiBvdXJMb2NhdGlvbiB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgvXlxcZCskLy50ZXN0KGxhc3RDKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBsYXN0aW50QyA9IE51bWJlcihsYXN0Qyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGludEMgPCBsYXN0aW50QylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkTm90aWNlUGFydGlhbCh7IHByaW9yaXR5OiA3MzYsIEMsIFYsIG1lc3NhZ2U6IFwiUmVjZWRpbmcgY2hhcHRlciBudW1iZXJcIiwgZGV0YWlsczogYCcke0N9JyBhZnRlciAnJHtsYXN0Q30nYCwgcm93SUQsIGxpbmVOdW1iZXI6IG4gKyAxLCBsb2NhdGlvbjogb3VyTG9jYXRpb24gfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoaW50QyA+IGxhc3RpbnRDICsgMSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkTm90aWNlUGFydGlhbCh7IHByaW9yaXR5OiA3MzUsIEMsIFYsIG1lc3NhZ2U6IFwiQWR2YW5jaW5nIGNoYXB0ZXIgbnVtYmVyXCIsIGRldGFpbHM6IGAnJHtDfScgYWZ0ZXIgJyR7bGFzdEN9J2Aucm93SUQsIGxpbmVOdW1iZXI6IG4gKyAxLCBsb2NhdGlvbjogb3VyTG9jYXRpb24gfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgYWRkTm90aWNlUGFydGlhbCh7IHByaW9yaXR5OiA3MzQsIEMsIFYsIG1lc3NhZ2U6IFwiQmFkIGNoYXB0ZXIgbnVtYmVyXCIsIHJvd0lELCBsaW5lTnVtYmVyOiBuICsgMSwgbG9jYXRpb246IG91ckxvY2F0aW9uIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIGFkZE5vdGljZVBhcnRpYWwoeyBwcmlvcml0eTogNzM5LCBDLCBWLCBtZXNzYWdlOiBcIk1pc3NpbmcgY2hhcHRlciBudW1iZXJcIiwgcm93SUQsIGxpbmVOdW1iZXI6IG4gKyAxLCBsb2NhdGlvbjogYCBhZnRlciAke2xhc3RDfToke1Z9JHtvdXJMb2NhdGlvbn1gIH0pO1xuXG4gICAgICAgICAgICAgICAgaWYgKFYpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKFYgPT09ICdpbnRybycpIHsgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICgvXlxcZCskLy50ZXN0KFYpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgaW50ViA9IE51bWJlcihWKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbnRWID09PSAwICYmIGJvb2tJRCAhPT0gJ1BTQScpIC8vIFBzYWxtcyBoYXZlIFxcZCB0aXRsZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGROb3RpY2VQYXJ0aWFsKHsgcHJpb3JpdHk6IDU1MiwgQywgViwgbWVzc2FnZTogXCJJbnZhbGlkIHplcm8gdmVyc2UgbnVtYmVyXCIsIGRldGFpbHM6IGBmb3IgY2hhcHRlciAke0N9YCwgcm93SUQsIGxpbmVOdW1iZXI6IG4gKyAxLCBleGNlcnB0OiBWLCBsb2NhdGlvbjogb3VyTG9jYXRpb24gfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW50ViA+IG51bVZlcnNlc1RoaXNDaGFwdGVyKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZE5vdGljZVBhcnRpYWwoeyBwcmlvcml0eTogNzM0LCBDLCBWLCBtZXNzYWdlOiBcIkludmFsaWQgbGFyZ2UgdmVyc2UgbnVtYmVyXCIsIGRldGFpbHM6IGBmb3IgY2hhcHRlciAke0N9YCwgcm93SUQsIGxpbmVOdW1iZXI6IG4gKyAxLCBleGNlcnB0OiBWLCBsb2NhdGlvbjogb3VyTG9jYXRpb24gfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoL15cXGQrJC8udGVzdChsYXN0VikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbGFzdGludFYgPSBOdW1iZXIobGFzdFYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChDID09PSBsYXN0QyAmJiBpbnRWIDwgbGFzdGludFYpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZE5vdGljZVBhcnRpYWwoeyBwcmlvcml0eTogNzMzLCBDLCBWLCBtZXNzYWdlOiBcIlJlY2VkaW5nIHZlcnNlIG51bWJlclwiLCBkZXRhaWxzOiBgJyR7Vn0nIGFmdGVyICcke2xhc3RWfSBmb3IgY2hhcHRlciAke0N9YCwgcm93SUQsIGxpbmVOdW1iZXI6IG4gKyAxLCBleGNlcnB0OiBWLCBsb2NhdGlvbjogb3VyTG9jYXRpb24gfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZWxzZSBpZiAoaW50ViA+IGxhc3RpbnRWICsgMSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgIGFkZE5vdGljZVBhcnRpYWwoe3ByaW9yaXR5OjU1NiwgYFNraXBwZWQgdmVyc2VzIHdpdGggJyR7Vn0nIHZlcnNlIG51bWJlciBhZnRlciAnJHtsYXN0Vn0nJHt3aXRoU3RyaW5nfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZE5vdGljZVBhcnRpYWwoeyBwcmlvcml0eTogNzM4LCBDLCBWLCBtZXNzYWdlOiBcIkJhZCB2ZXJzZSBudW1iZXJcIiwgcm93SUQsIGxpbmVOdW1iZXI6IG4gKyAxLCBsb2NhdGlvbjogb3VyTG9jYXRpb24gfSk7XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBhZGROb3RpY2VQYXJ0aWFsKHsgcHJpb3JpdHk6IDc5MCwgQywgViwgbWVzc2FnZTogXCJNaXNzaW5nIHZlcnNlIG51bWJlclwiLCByb3dJRCwgbGluZU51bWJlcjogbiArIDEsIGxvY2F0aW9uOiBgIGFmdGVyICR7Q306JHtsYXN0Vn0ke291ckxvY2F0aW9ufWAgfSk7XG5cbiAgICAgICAgICAgICAgICBpZiAocm93SUQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJvd0lETGlzdEZvclZlcnNlLmluY2x1ZGVzKHJvd0lEKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZE5vdGljZVBhcnRpYWwoeyBwcmlvcml0eTogODMxLCBDLCBWLCBtZXNzYWdlOiBgRHVwbGljYXRlICcke3Jvd0lEfScgSURgLCBmaWVsZE5hbWU6ICdJRCcsIHJvd0lELCBsaW5lTnVtYmVyOiBuICsgMSwgbG9jYXRpb246IG91ckxvY2F0aW9uIH0pO1xuICAgICAgICAgICAgICAgICAgICByb3dJRExpc3RGb3JWZXJzZS5wdXNoKHJvd0lEKTtcbiAgICAgICAgICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgICAgICAgICAgYWRkTm90aWNlUGFydGlhbCh7IHByaW9yaXR5OiA5MzIsIEMsIFYsIG1lc3NhZ2U6IFwiTWlzc2luZyByb3cgSURcIiwgZmllbGROYW1lOiAnSUQnLCBsaW5lTnVtYmVyOiBuICsgMSwgbG9jYXRpb246IG91ckxvY2F0aW9uIH0pO1xuXG5cbiAgICAgICAgICAgICAgICBsYXN0QyA9IEM7IGxhc3RWID0gVjtcblxuICAgICAgICAgICAgfSBlbHNlIC8vIHdyb25nIG51bWJlciBvZiBmaWVsZHMgaW4gdGhlIHJvd1xuICAgICAgICAgICAgICAgIC8vIGlmIChuID09PSBsaW5lcy5sZW5ndGggLSAxKSAvLyBpdOKAmXMgdGhlIGxhc3QgbGluZVxuICAgICAgICAgICAgICAgIC8vICAgICB1c2VyTG9nKGAgIExpbmUgJHtufTogSGFzICR7ZmllbGRzLmxlbmd0aH0gZmllbGQocykgaW5zdGVhZCBvZiAke05VTV9FWFBFQ1RFRF9UTl9GSUVMRFN9OiAke0VYUEVDVEVEX1RXTF9IRUFESU5HX0xJTkUucmVwbGFjZSgvXFx0L2csICcsICcpfWApO1xuICAgICAgICAgICAgICAgIC8vIGVsc2VcbiAgICAgICAgICAgICAgICBpZiAobiAhPT0gbGluZXMubGVuZ3RoIC0gMSkgeyAvLyBpdOKAmXMgbm90IHRoZSBsYXN0IGxpbmVcbiAgICAgICAgICAgICAgICAgICAgLy8gSGF2ZSBhIGdvIGF0IGdldHRpbmcgc29tZSBvZiB0aGUgZmlyc3QgZmllbGRzIG91dCBvZiB0aGUgbGluZVxuICAgICAgICAgICAgICAgICAgICBsZXQgcmVmZXJlbmNlID0gJz86PycsIEMgPSAnPycsIFYgPSAnPycsIHJvd0lEID0gJz8/Pz8nO1xuICAgICAgICAgICAgICAgICAgICB0cnkgeyByZWZlcmVuY2UgPSBmaWVsZHNbMF07IH0gY2F0Y2ggeyB9XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7IHJvd0lEID0gZmllbGRzWzFdOyB9IGNhdGNoIHsgfVxuICAgICAgICAgICAgICAgICAgICB0cnkgeyBbQywgVl0gPSByZWZlcmVuY2Uuc3BsaXQoJzonKTsgfSBjYXRjaCB7IH1cbiAgICAgICAgICAgICAgICAgICAgYWRkTm90aWNlUGFydGlhbCh7IHByaW9yaXR5OiA5ODMsIG1lc3NhZ2U6IGBXcm9uZyBudW1iZXIgb2YgdGFiYmVkIGZpZWxkcyAoZXhwZWN0ZWQgJHtOVU1fRVhQRUNURURfVFdMX1RTVl9GSUVMRFN9KWAsIGV4Y2VycHQ6IGBGb3VuZCAke2ZpZWxkcy5sZW5ndGh9IGZpZWxkJHtmaWVsZHMubGVuZ3RoID09PSAxID8gJycgOiAncyd9YCwgQywgViwgcm93SUQsIGxpbmVOdW1iZXI6IG4gKyAxLCBsb2NhdGlvbjogb3VyTG9jYXRpb24gfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFjaGVja2luZ09wdGlvbnM/LnN1cHByZXNzTm90aWNlRGlzYWJsaW5nRmxhZykge1xuICAgICAgICAvLyBmdW5jdGlvbkxvZyhgY2hlY2tUV0xfVFNWNlRhYmxlOiBjYWxsaW5nIHJlbW92ZURpc2FibGVkTm90aWNlcygke2NhclJlc3VsdC5ub3RpY2VMaXN0Lmxlbmd0aH0pIGhhdmluZyAke0pTT04uc3RyaW5naWZ5KGNoZWNraW5nT3B0aW9ucyl9YCk7XG4gICAgICAgIGNhclJlc3VsdC5ub3RpY2VMaXN0ID0gcmVtb3ZlRGlzYWJsZWROb3RpY2VzKGNhclJlc3VsdC5ub3RpY2VMaXN0KTtcbiAgICB9XG5cbiAgICBpZiAoKCFjaGVja2luZ09wdGlvbnM/LmN1dG9mZlByaW9yaXR5TGV2ZWwgfHwgY2hlY2tpbmdPcHRpb25zPy5jdXRvZmZQcmlvcml0eUxldmVsIDwgMjApXG4gICAgICAgICYmIGNoZWNraW5nT3B0aW9ucz8uZGlzYWJsZUFsbExpbmtGZXRjaGluZ0ZsYWcpXG4gICAgICAgIGFkZE5vdGljZVBhcnRpYWwoeyBwcmlvcml0eTogMjAsIG1lc3NhZ2U6IFwiTm90ZSB0aGF0ICdkaXNhYmxlQWxsTGlua0ZldGNoaW5nRmxhZycgd2FzIHNldCBzbyBsaW5rIHRhcmdldHMgd2VyZSBub3QgY2hlY2tlZFwiLCBsb2NhdGlvbjogb3VyTG9jYXRpb24gfSk7XG5cbiAgICBhZGRTdWNjZXNzTWVzc2FnZShgQ2hlY2tlZCBhbGwgJHsobGluZXMubGVuZ3RoIC0gMSkudG9Mb2NhbGVTdHJpbmcoKX0gZGF0YSBsaW5lJHtsaW5lcy5sZW5ndGggLSAxID09PSAxID8gJycgOiAncyd9JHtvdXJMb2NhdGlvbn0uYCk7XG4gICAgaWYgKGNhclJlc3VsdC5ub3RpY2VMaXN0Lmxlbmd0aClcbiAgICAgICAgYWRkU3VjY2Vzc01lc3NhZ2UoYGNoZWNrVFdMX1RTVjZUYWJsZSB2JHtUV0xfVEFCTEVfVkFMSURBVE9SX1ZFUlNJT05fU1RSSU5HfSBmaW5pc2hlZCB3aXRoICR7Y2FyUmVzdWx0Lm5vdGljZUxpc3QubGVuZ3RoID8gY2FyUmVzdWx0Lm5vdGljZUxpc3QubGVuZ3RoLnRvTG9jYWxlU3RyaW5nKCkgOiBcInplcm9cIn0gbm90aWNlJHtjYXJSZXN1bHQubm90aWNlTGlzdC5sZW5ndGggPT09IDEgPyAnJyA6ICdzJ31gKTtcbiAgICBlbHNlXG4gICAgICAgIGFkZFN1Y2Nlc3NNZXNzYWdlKGBObyBlcnJvcnMgb3Igd2FybmluZ3MgZm91bmQgYnkgY2hlY2tUV0xfVFNWNlRhYmxlIHYke1RXTF9UQUJMRV9WQUxJREFUT1JfVkVSU0lPTl9TVFJJTkd9YClcbiAgICAvLyBkZWJ1Z0xvZyhgICBjaGVja1RXTF9UU1Y2VGFibGUgcmV0dXJuaW5nIHdpdGggJHtyZXN1bHQuc3VjY2Vzc0xpc3QubGVuZ3RoLnRvTG9jYWxlU3RyaW5nKCl9IHN1Y2Nlc3MoZXMpLCAke3Jlc3VsdC5ub3RpY2VMaXN0Lmxlbmd0aC50b0xvY2FsZVN0cmluZygpfSBub3RpY2UocykuYCk7XG4gICAgLy8gZGVidWdMb2coXCJjaGVja1RXTF9UU1Y2VGFibGUgcmVzdWx0IGlzXCIsIEpTT04uc3RyaW5naWZ5KGNhclJlc3VsdCkpO1xuICAgIHJldHVybiBjYXJSZXN1bHQ7XG59XG4vLyBlbmQgb2YgY2hlY2tUV0xfVFNWNlRhYmxlIGZ1bmN0aW9uXG4iXX0=