"use strict";var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");var _typeof = require("@babel/runtime/helpers/typeof");Object.defineProperty(exports, "__esModule", { value: true });exports.checkNotesTSV7Table = checkNotesTSV7Table;var _regenerator = _interopRequireDefault(require("@babel/runtime/regenerator"));var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var books = _interopRequireWildcard(require("./books/books"));
var _defaults = require("./defaults");
var _notesTsv7RowCheck = require("./notes-tsv7-row-check");
var _disabledNotices = require("./disabled-notices");

var _utilities = require("./utilities");function _getRequireWildcardCache(nodeInterop) {if (typeof WeakMap !== "function") return null;var cacheBabelInterop = new WeakMap();var cacheNodeInterop = new WeakMap();return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) {return nodeInterop ? cacheNodeInterop : cacheBabelInterop;})(nodeInterop);}function _interopRequireWildcard(obj, nodeInterop) {if (!nodeInterop && obj && obj.__esModule) {return obj;}if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") {return { default: obj };}var cache = _getRequireWildcardCache(nodeInterop);if (cache && cache.has(obj)) {return cache.get(obj);}var newObj = {};var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;for (var key in obj) {if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;if (desc && (desc.get || desc.set)) {Object.defineProperty(newObj, key, desc);} else {newObj[key] = obj[key];}}}newObj.default = obj;if (cache) {cache.set(obj, newObj);}return newObj;}function _createForOfIteratorHelper(o, allowArrayLike) {var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"];if (!it) {if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") {if (it) o = it;var i = 0;var F = function F() {};return { s: F, n: function n() {if (i >= o.length) return { done: true };return { done: false, value: o[i++] };}, e: function e(_e) {throw _e;}, f: F };}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var normalCompletion = true,didErr = false,err;return { s: function s() {it = it.call(o);}, n: function n() {var step = it.next();normalCompletion = step.done;return step;}, e: function e(_e2) {didErr = true;err = _e2;}, f: function f() {try {if (!normalCompletion && it.return != null) it.return();} finally {if (didErr) throw err;}} };}function _unsupportedIterableToArray(o, minLen) {if (!o) return;if (typeof o === "string") return _arrayLikeToArray(o, minLen);var n = Object.prototype.toString.call(o).slice(8, -1);if (n === "Object" && o.constructor) n = o.constructor.name;if (n === "Map" || n === "Set") return Array.from(o);if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);}function _arrayLikeToArray(arr, len) {if (len == null || len > arr.length) len = arr.length;for (var i = 0, arr2 = new Array(len); i < len; i++) {arr2[i] = arr[i];}return arr2;}function ownKeys(object, enumerableOnly) {var keys = Object.keys(object);if (Object.getOwnPropertySymbols) {var symbols = Object.getOwnPropertySymbols(object);if (enumerableOnly) {symbols = symbols.filter(function (sym) {return Object.getOwnPropertyDescriptor(object, sym).enumerable;});}keys.push.apply(keys, symbols);}return keys;}function _objectSpread(target) {for (var i = 1; i < arguments.length; i++) {var source = arguments[i] != null ? arguments[i] : {};if (i % 2) {ownKeys(Object(source), true).forEach(function (key) {(0, _defineProperty2.default)(target, key, source[key]);});} else if (Object.getOwnPropertyDescriptors) {Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));} else {ownKeys(Object(source)).forEach(function (key) {Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));});}}return target;}


var NOTES_TABLE_VALIDATOR_VERSION_STRING = '0.3.5';

var NUM_EXPECTED_NOTES_TSV_FIELDS = 7; // so expects 6 tabs per line
var EXPECTED_NOTES_HEADING_LINE = 'Reference\tID\tTags\tSupportReference\tQuote\tOccurrence\tNote';


/**
 *
 * @param {string} languageCode
 * @param {string} repoCode -- 'TN' or 'SN'
 * @param {string} bookID
 * @param {string} filename
 * @param {string} tableText
 * @param {string} givenLocation
 * @param {Object} checkingOptions
 */function
checkNotesTSV7Table(_x, _x2, _x3, _x4, _x5, _x6, _x7) {return _checkNotesTSV7Table.apply(this, arguments);}



















































































































































































































































// end of checkNotesTSV7Table function
function _checkNotesTSV7Table() {_checkNotesTSV7Table = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee(languageCode, repoCode, bookID, filename, tableText, givenLocation, checkingOptions) {var ourLocation, carResult, addSuccessMessage, addNoticePartial, excerptLength, lowercaseBookID, numChaptersThisBook, lines, lastC, lastV, rowIDListForVerse, uniqueRowListForVerse, numVersesThisChapter, n, fields, _fields, reference, rowID, tags, supportReference, quote, occurrence, note, _reference$split, _reference$split2, C, V, drResultObject, _iterator, _step, drNoticeEntry, _iterator2, _step2, checkedRepoName, _iterator3, _step3, checkedFilenameExtension, uniqueID, intC, lastintC, intV, lastintV, _reference, _C, _V, _rowID, _reference$split3, _reference$split4;return _regenerator.default.wrap(function _callee$(_context) {while (1) {switch (_context.prev = _context.next) {case 0:addNoticePartial = function _addNoticePartial(noticeObject) {// functionLog(`checkNotesTSV7Table notice: (priority=${priority}) ${message}${characterIndex > 0 ? ` (at character ${characterIndex})` : ""}${excerpt ? ` ${excerpt}` : ""}${location}`);
              //parameterAssert(noticeObject.priority !== undefined, "ATSV addNoticePartial: 'priority' parameter should be defined");
              //parameterAssert(typeof noticeObject.priority === 'number', `TSV addNoticePartial: 'priority' parameter should be a number not a '${typeof noticeObject.priority}': ${noticeObject.priority}`);
              //parameterAssert(noticeObject.message !== undefined, "ATSV addNoticePartial: 'message' parameter should be defined");
              //parameterAssert(typeof noticeObject.message === 'string', `TSV addNoticePartial: 'message' parameter should be a string not a '${typeof noticeObject.message}': ${noticeObject.message}`);
              // //parameterAssert(C !== undefined, "ATSV addNoticePartial: 'C' parameter should be defined");
              if (noticeObject.C) {//parameterAssert(typeof noticeObject.C === 'string', `TSV addNoticePartial: 'C' parameter should be a string not a '${typeof noticeObject.C}': ${noticeObject.C}`);
              } // //parameterAssert(V !== undefined, "ATSV addNoticePartial: 'V' parameter should be defined");
              if (noticeObject.V) {//parameterAssert(typeof noticeObject.V === 'string', `TSV addNoticePartial: 'V' parameter should be a string not a '${typeof noticeObject.V}': ${noticeObject.V}`);
              } // //parameterAssert(characterIndex !== undefined, "ATSV addNoticePartial: 'characterIndex' parameter should be defined");
              if (noticeObject.characterIndex) {//parameterAssert(typeof noticeObject.characterIndex === 'number', `TSV addNoticePartial: 'characterIndex' parameter should be a number not a '${typeof noticeObject.characterIndex}': ${noticeObject.characterIndex}`);
              } // //parameterAssert(excerpt !== undefined, "ATSV addNoticePartial: 'excerpt' parameter should be defined");
              if (noticeObject.excerpt) {//parameterAssert(typeof noticeObject.excerpt === 'string', `TSV addNoticePartial: 'excerpt' parameter should be a string not a '${typeof noticeObject.excerpt}': ${noticeObject.excerpt}`);
              } //parameterAssert(noticeObject.location !== undefined, "ATSV addNoticePartial: 'location' parameter should be defined");
              //parameterAssert(typeof noticeObject.location === 'string', `TSV addNoticePartial: 'location' parameter should be a string not a '${typeof noticeObject.location}': ${noticeObject.location}`);
              if (noticeObject.debugChain) noticeObject.debugChain = "checkNotesTSV7Table ".concat(noticeObject.debugChain);carResult.noticeList.push(_objectSpread(_objectSpread({}, noticeObject), {}, { bookID: bookID, filename: filename, repoCode: repoCode }));};addSuccessMessage = function _addSuccessMessage(successString) {// functionLog(`checkNotesTSV7Table success: ${successString}`);
              carResult.successList.push(successString);}; /* This function is optimised for checking the entire file, i.e., all rows.
               It also has the advantage of being able to compare one row with the previous one.
              bookID is a three-character UPPERCASE USFM book identifier or 'OBS'.
              Returns a result object containing a successList and a noticeList
             */ // functionLog(`checkNotesTSV7Table(${languageCode}, ${repoCode}, ${bookID}, ${tableText.length}, ${givenLocation},${JSON.stringify(checkingOptions)})â€¦`);
            //parameterAssert(languageCode !== undefined, "checkNotesTSV7Table: 'languageCode' parameter should be defined");
            //parameterAssert(typeof languageCode === 'string', `checkNotesTSV7Table: 'languageCode' parameter should be a string not a '${typeof languageCode}'`);
            //parameterAssert(repoCode.endsWith('TN') || repoCode.endsWith('TN2') || repoCode.endsWith('SN'), `checkNotesTSV7Table: repoCode expected to end with 'TN', 'TN2', or 'SN' not '${repoCode}'`);
            //parameterAssert(bookID !== undefined, "checkNotesTSV7Table: 'bookID' parameter should be defined");
            //parameterAssert(typeof bookID === 'string', `checkNotesTSV7Table: 'bookID' parameter should be a string not a '${typeof bookID}'`);
            //parameterAssert(bookID.length === 3, `checkNotesTSV7Table: 'bookID' parameter should be three characters long not ${bookID.length}`);
            //parameterAssert(bookID.toUpperCase() === bookID, `checkNotesTSV7Table: 'bookID' parameter should be UPPERCASE not '${bookID}'`);
            //parameterAssert(bookID === 'OBS' || books.isValidBookID(bookID), `checkNotesTSV7Table: '${bookID}' is not a valid USFM book identifier`);
            //parameterAssert(givenLocation !== undefined, "checkNotesTSV7Table: 'givenLocation' parameter should be defined");
            //parameterAssert(typeof givenLocation === 'string', `checkNotesTSV7Table: 'givenLocation' parameter should be a string not a '${typeof givenLocation}'`);
            ourLocation = givenLocation;if (ourLocation && ourLocation[0] !== ' ') ourLocation = " ".concat(ourLocation);carResult = { successList: [], noticeList: [] };try {excerptLength = checkingOptions === null || checkingOptions === void 0 ? void 0 : checkingOptions.excerptLength;} catch (ttcError) {}if (typeof excerptLength !== 'number' || isNaN(excerptLength)) {excerptLength = _defaults.DEFAULT_EXCERPT_LENGTH; // debugLog(`Using default excerptLength=${excerptLength}`);
            } // else
            // debugLog(`Using supplied excerptLength=${excerptLength}`, `cf. default=${DEFAULT_EXCERPT_LENGTH}`);
            // const excerptHalfLength = Math.floor(excerptLength / 2); // rounded down
            // const excerptHalfLengthPlus = Math.floor((excerptLength + 1) / 2); // rounded up
            // debugLog(`Using excerptHalfLength=${excerptHalfLength}`, `excerptHalfLengthPlus=${excerptHalfLengthPlus}`);
            lowercaseBookID = bookID.toLowerCase();numChaptersThisBook = 0;if (bookID === 'OBS') numChaptersThisBook = 50; // There's 50 Open Bible Stories
            else {//parameterAssert(lowercaseBookID !== 'obs', "Shouldnâ€™t happen in checkNotesTSV7Table");
                try {numChaptersThisBook = books.chaptersInBook(bookID);} catch (_unused) {if (!books.isValidBookID(bookID)) // must not be in FRT, BAK, etc.
                    addNoticePartial({ priority: 747, message: "Bad function call: should be given a valid book abbreviation", excerpt: bookID, location: " (not '".concat(bookID, "')").concat(ourLocation) });}}lines = tableText.split('\n'); // debugLog(`  '${location}' has ${lines.length.toLocaleString()} total lines (expecting ${NUM_EXPECTED_TN_FIELDS} fields in each line)`);
            lastC = '', lastV = '';rowIDListForVerse = [], uniqueRowListForVerse = [];numVersesThisChapter = 0;n = 0;case 15:if (!(n < lines.length)) {_context.next = 47;break;}if (!(n === 0)) {_context.next = 20;break;}if (lines[0] === EXPECTED_NOTES_HEADING_LINE) addSuccessMessage("Checked TSV header ".concat(ourLocation));else addNoticePartial({ priority: 988, message: "Bad TSV header", details: "expected '".concat(EXPECTED_NOTES_HEADING_LINE, "'"), excerpt: lines[0], lineNumber: 1, location: ourLocation });_context.next = 44;break;case 20:fields = lines[n].split('\t');if (!(fields.length === NUM_EXPECTED_NOTES_TSV_FIELDS)) {_context.next = 43;break;} // eslint-disable-next-line no-unused-vars
            _fields = (0, _slicedToArray2.default)(fields, 7), reference = _fields[0], rowID = _fields[1], tags = _fields[2], supportReference = _fields[3], quote = _fields[4], occurrence = _fields[5], note = _fields[6];_reference$split = reference.split(':'), _reference$split2 = (0, _slicedToArray2.default)(_reference$split, 2), C = _reference$split2[0], V = _reference$split2[1]; // Use the row check to do most basic checks
            _context.next = 26;return (0, _notesTsv7RowCheck.checkNotesTSV7DataRow)(languageCode, repoCode, lines[n], bookID, C, V, ourLocation, checkingOptions);case 26:drResultObject = _context.sent; // Choose only ONE of the following
            // This is the fast way of append the results from this field
            // result.noticeList = result.noticeList.concat(firstResult.noticeList);
            // If we need to put everything through addNoticePartial, e.g., for debugging or filtering
            //  process results line by line
            _iterator = _createForOfIteratorHelper(drResultObject.noticeList);try {for (_iterator.s(); !(_step = _iterator.n()).done;) {drNoticeEntry = _step.value;if (drNoticeEntry.extra) // it must be an indirect check on a TA or TW article from a TN2 check
                  carResult.noticeList.push(drNoticeEntry); // Just copy the complete notice as is
                else if (drNoticeEntry.priority !== 931) // We already caught Missing row ID
                    addNoticePartial(_objectSpread(_objectSpread({}, drNoticeEntry), {}, { lineNumber: n + 1 }));} // The following is needed coz we might be checking the linked TA and/or TW articles
            } catch (err) {_iterator.e(err);} finally {_iterator.f();}if (drResultObject.checkedFileCount && drResultObject.checkedFileCount > 0) if (typeof carResult.checkedFileCount === 'number') carResult.checkedFileCount += drResultObject.checkedFileCount;else carResult.checkedFileCount = drResultObject.checkedFileCount;if (drResultObject.checkedFilesizes && drResultObject.checkedFilesizes > 0) if (typeof carResult.checkedFilesizes === 'number') carResult.checkedFilesizes += drResultObject.checkedFilesizes;else carResult.checkedFilesizes = drResultObject.checkedFilesizes;if (drResultObject.checkedRepoNames && drResultObject.checkedRepoNames.length > 0) {_iterator2 = _createForOfIteratorHelper(drResultObject.checkedRepoNames);try {for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {checkedRepoName = _step2.value;try {if (carResult.checkedRepoNames.indexOf(checkedRepoName) < 0) carResult.checkedRepoNames.push(checkedRepoName);} catch (_unused2) {carResult.checkedRepoNames = [checkedRepoName];}}} catch (err) {_iterator2.e(err);} finally {_iterator2.f();}}if (drResultObject.checkedFilenameExtensions && drResultObject.checkedFilenameExtensions.length > 0) {_iterator3 = _createForOfIteratorHelper(drResultObject.checkedFilenameExtensions);try {for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {checkedFilenameExtension = _step3.value;try {if (carResult.checkedFilenameExtensions.indexOf(checkedFilenameExtension) < 0) carResult.checkedFilenameExtensions.push(checkedFilenameExtension);} catch (_unused3) {carResult.checkedFilenameExtensions = [checkedFilenameExtension];}}} catch (err) {_iterator3.e(err);} finally {_iterator3.f();}} // if (ttResult.checkedFilenameExtensions) userLog("ttResult", JSON.stringify(ttResult));
            // So here we only have to check against the previous and next fields for out-of-order problems and duplicate problems
            if (C !== lastC || V !== lastV) {rowIDListForVerse = []; // ID's only need to be unique within each verse
              uniqueRowListForVerse = []; // Same for these
            } // TODO: Check if we need this at all (even though tC 3.0 canâ€™t display these "duplicate" notes)
            // Check for duplicate notes
            uniqueID = C + V + supportReference + quote + occurrence; // This combination should not be repeated
            // if (uniqueRowListForVerse.includes(uniqueID))
            //     addNoticePartial({ priority: 880, C, V, message: `Duplicate note`, rowID, lineNumber: n + 1, location: ourLocation });
            // if (uniqueRowListForVerse.includes(uniqueID))
            //     addNoticePartial({ priority: 80, C, V, message: `Note: tC 3.0 wonâ€™t display duplicate note`, rowID, lineNumber: n + 1, location: ourLocation });
            uniqueRowListForVerse.push(uniqueID);if (C) {if (C === 'front') {} else if (/^\d+$/.test(C)) {intC = Number(C);if (C !== lastC) if (lowercaseBookID === 'obs') numVersesThisChapter = 99; // Set to maximum expected number of frames
                else numVersesThisChapter = books.versesInChapter(lowercaseBookID, intC);if (intC === 0) addNoticePartial({ priority: 551, C: C, V: V, message: "Invalid zero chapter number", rowID: rowID, lineNumber: n + 1, excerpt: C, location: ourLocation });if (intC > numChaptersThisBook) addNoticePartial({ priority: 737, C: C, V: V, message: "Invalid large chapter number", rowID: rowID, lineNumber: n + 1, excerpt: C, location: ourLocation });if (/^\d+$/.test(lastC)) {lastintC = Number(lastC);if (intC < lastintC) addNoticePartial({ priority: 736, C: C, V: V, message: "Receding chapter number", details: "'".concat(C, "' after '").concat(lastC, "'"), rowID: rowID, lineNumber: n + 1, location: ourLocation });else if (intC > lastintC + 1) addNoticePartial({ priority: 735, C: C, V: V, message: "Advancing chapter number", details: "'".concat(C, "' after '").concat(lastC, "'").rowID, lineNumber: n + 1, location: ourLocation });}} else addNoticePartial({ priority: 734, C: C, V: V, message: "Bad chapter number", rowID: rowID, lineNumber: n + 1, location: ourLocation });} else addNoticePartial({ priority: 739, C: C, V: V, message: "Missing chapter number", rowID: rowID, lineNumber: n + 1, location: " after ".concat(lastC, ":").concat(V).concat(ourLocation) });if (V) {if (V === 'intro') {} else if (/^\d+$/.test(V)) {intV = Number(V);if (intV === 0 && bookID !== 'PSA') // Psalms have \d titles
                  addNoticePartial({ priority: 552, C: C, V: V, message: "Invalid zero verse number", details: "for chapter ".concat(C), rowID: rowID, lineNumber: n + 1, excerpt: V, location: ourLocation });if (intV > numVersesThisChapter) addNoticePartial({ priority: 734, C: C, V: V, message: "Invalid large verse number", details: "for chapter ".concat(C), rowID: rowID, lineNumber: n + 1, excerpt: V, location: ourLocation });if (/^\d+$/.test(lastV)) {lastintV = Number(lastV);if (C === lastC && intV < lastintV) addNoticePartial({ priority: 733, C: C, V: V, message: "Receding verse number", details: "'".concat(V, "' after '").concat(lastV, " for chapter ").concat(C), rowID: rowID, lineNumber: n + 1, excerpt: V, location: ourLocation }); // else if (intV > lastintV + 1)
                  //   addNoticePartial({priority:556, `Skipped verses with '${V}' verse number after '${lastV}'${withString}`);
                }} else addNoticePartial({ priority: 738, C: C, V: V, message: "Bad verse number", rowID: rowID, lineNumber: n + 1, location: ourLocation });} else addNoticePartial({ priority: 790, C: C, V: V, message: "Missing verse number", rowID: rowID, lineNumber: n + 1, location: " after ".concat(C, ":").concat(lastV).concat(ourLocation) });if (rowID) {if (rowIDListForVerse.includes(rowID)) addNoticePartial({ priority: 831, C: C, V: V, message: "Duplicate '".concat(rowID, "' ID"), fieldName: 'ID', rowID: rowID, lineNumber: n + 1, location: ourLocation });rowIDListForVerse.push(rowID);} else addNoticePartial({ priority: 932, C: C, V: V, message: "Missing row ID", fieldName: 'ID', lineNumber: n + 1, location: ourLocation });lastC = C;lastV = V;_context.next = 44;break;case 43: // wrong number of fields in the row
            // if (n === lines.length - 1) // itâ€™s the last line
            //     userLog(`  Line ${n}: Has ${fields.length} field(s) instead of ${NUM_EXPECTED_TN_FIELDS}: ${EXPECTED_TN_HEADING_LINE.replace(/\t/g, ', ')}`);
            // else
            if (n !== lines.length - 1) {// itâ€™s not the last line
              // Have a go at getting some of the first fields out of the line
              _reference = '?:?', _C = '?', _V = '?', _rowID = '????';try {_reference = fields[0];} catch (_unused4) {}try {_rowID = fields[1];} catch (_unused5) {}try {_reference$split3 = _reference.split(':');_reference$split4 = (0, _slicedToArray2.default)(_reference$split3, 2);_C = _reference$split4[0];_V = _reference$split4[1];} catch (_unused6) {}addNoticePartial({ priority: 983, message: "Wrong number of tabbed fields (expected ".concat(NUM_EXPECTED_NOTES_TSV_FIELDS, ")"), excerpt: "Found ".concat(fields.length, " field").concat(fields.length === 1 ? '' : 's'), C: _C, V: _V, rowID: _rowID, lineNumber: n + 1, location: ourLocation });}case 44:n++;_context.next = 15;break;case 47:if (!(checkingOptions !== null && checkingOptions !== void 0 && checkingOptions.suppressNoticeDisablingFlag)) {// functionLog(`checkNotesTSV7Table: calling removeDisabledNotices(${carResult.noticeList.length}) having ${JSON.stringify(checkingOptions)}`);
              carResult.noticeList = (0, _disabledNotices.removeDisabledNotices)(carResult.noticeList);}if ((!(checkingOptions !== null && checkingOptions !== void 0 && checkingOptions.cutoffPriorityLevel) || (checkingOptions === null || checkingOptions === void 0 ? void 0 : checkingOptions.cutoffPriorityLevel) < 20) && checkingOptions !== null && checkingOptions !== void 0 && checkingOptions.disableAllLinkFetchingFlag) addNoticePartial({ priority: 20, message: "Note that 'disableAllLinkFetchingFlag' was set so link targets were not checked", location: ourLocation });addSuccessMessage("Checked all ".concat((lines.length - 1).toLocaleString(), " data line").concat(lines.length - 1 === 1 ? '' : 's').concat(ourLocation, "."));if (carResult.noticeList.length) addSuccessMessage("checkNotesTSV7Table v".concat(NOTES_TABLE_VALIDATOR_VERSION_STRING, " finished with ").concat(carResult.noticeList.length ? carResult.noticeList.length.toLocaleString() : "zero", " notice").concat(carResult.noticeList.length === 1 ? '' : 's'));else addSuccessMessage("No errors or warnings found by checkNotesTSV7Table v".concat(NOTES_TABLE_VALIDATOR_VERSION_STRING)); // debugLog(`  checkNotesTSV7Table returning with ${result.successList.length.toLocaleString()} success(es), ${result.noticeList.length.toLocaleString()} notice(s).`);
            // debugLog("checkNotesTSV7Table result is", JSON.stringify(carResult));
            return _context.abrupt("return", carResult);case 52:case "end":return _context.stop();}}}, _callee);}));return _checkNotesTSV7Table.apply(this, arguments);}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb3JlL25vdGVzLXRzdjctdGFibGUtY2hlY2suanMiXSwibmFtZXMiOlsiTk9URVNfVEFCTEVfVkFMSURBVE9SX1ZFUlNJT05fU1RSSU5HIiwiTlVNX0VYUEVDVEVEX05PVEVTX1RTVl9GSUVMRFMiLCJFWFBFQ1RFRF9OT1RFU19IRUFESU5HX0xJTkUiLCJjaGVja05vdGVzVFNWN1RhYmxlIiwibGFuZ3VhZ2VDb2RlIiwicmVwb0NvZGUiLCJib29rSUQiLCJmaWxlbmFtZSIsInRhYmxlVGV4dCIsImdpdmVuTG9jYXRpb24iLCJjaGVja2luZ09wdGlvbnMiLCJhZGRTdWNjZXNzTWVzc2FnZSIsImFkZE5vdGljZVBhcnRpYWwiLCJub3RpY2VPYmplY3QiLCJDIiwiViIsImNoYXJhY3RlckluZGV4IiwiZXhjZXJwdCIsImRlYnVnQ2hhaW4iLCJjYXJSZXN1bHQiLCJub3RpY2VMaXN0IiwicHVzaCIsInN1Y2Nlc3NTdHJpbmciLCJzdWNjZXNzTGlzdCIsIm91ckxvY2F0aW9uIiwiZXhjZXJwdExlbmd0aCIsInR0Y0Vycm9yIiwiaXNOYU4iLCJERUZBVUxUX0VYQ0VSUFRfTEVOR1RIIiwibG93ZXJjYXNlQm9va0lEIiwidG9Mb3dlckNhc2UiLCJudW1DaGFwdGVyc1RoaXNCb29rIiwiYm9va3MiLCJjaGFwdGVyc0luQm9vayIsImlzVmFsaWRCb29rSUQiLCJwcmlvcml0eSIsIm1lc3NhZ2UiLCJsb2NhdGlvbiIsImxpbmVzIiwic3BsaXQiLCJsYXN0QyIsImxhc3RWIiwicm93SURMaXN0Rm9yVmVyc2UiLCJ1bmlxdWVSb3dMaXN0Rm9yVmVyc2UiLCJudW1WZXJzZXNUaGlzQ2hhcHRlciIsIm4iLCJsZW5ndGgiLCJkZXRhaWxzIiwibGluZU51bWJlciIsImZpZWxkcyIsInJlZmVyZW5jZSIsInJvd0lEIiwidGFncyIsInN1cHBvcnRSZWZlcmVuY2UiLCJxdW90ZSIsIm9jY3VycmVuY2UiLCJub3RlIiwiZHJSZXN1bHRPYmplY3QiLCJkck5vdGljZUVudHJ5IiwiZXh0cmEiLCJjaGVja2VkRmlsZUNvdW50IiwiY2hlY2tlZEZpbGVzaXplcyIsImNoZWNrZWRSZXBvTmFtZXMiLCJjaGVja2VkUmVwb05hbWUiLCJpbmRleE9mIiwiY2hlY2tlZEZpbGVuYW1lRXh0ZW5zaW9ucyIsImNoZWNrZWRGaWxlbmFtZUV4dGVuc2lvbiIsInVuaXF1ZUlEIiwidGVzdCIsImludEMiLCJOdW1iZXIiLCJ2ZXJzZXNJbkNoYXB0ZXIiLCJsYXN0aW50QyIsImludFYiLCJsYXN0aW50ViIsImluY2x1ZGVzIiwiZmllbGROYW1lIiwic3VwcHJlc3NOb3RpY2VEaXNhYmxpbmdGbGFnIiwiY3V0b2ZmUHJpb3JpdHlMZXZlbCIsImRpc2FibGVBbGxMaW5rRmV0Y2hpbmdGbGFnIiwidG9Mb2NhbGVTdHJpbmciXSwibWFwcGluZ3MiOiI0bkJBQUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsd0M7OztBQUdBLElBQU1BLG9DQUFvQyxHQUFHLE9BQTdDOztBQUVBLElBQU1DLDZCQUE2QixHQUFHLENBQXRDLEMsQ0FBeUM7QUFDekMsSUFBTUMsMkJBQTJCLEdBQUcsZ0VBQXBDOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHO0FBQ3NCQyxtQjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQW9QdEI7Z0lBcFBPLGlCQUFtQ0MsWUFBbkMsRUFBaURDLFFBQWpELEVBQTJEQyxNQUEzRCxFQUFtRUMsUUFBbkUsRUFBNkVDLFNBQTdFLEVBQXdGQyxhQUF4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QWpCLElBQXVDLEVBQWpGLEtBQ0dwRSxlQURILGFBQ0dBLGVBREgsZUFDR0EsZUFBZSxDQUFFcUUsMEJBRHhCLEVBRUluRSxnQkFBZ0IsQ0FBQyxFQUFFdUIsUUFBUSxFQUFFLEVBQVosRUFBZ0JDLE9BQU8sRUFBRSxpRkFBekIsRUFBNEdDLFFBQVEsRUFBRWIsV0FBdEgsRUFBRCxDQUFoQixDQUVKYixpQkFBaUIsdUJBQWdCLENBQUMyQixLQUFLLENBQUNRLE1BQU4sR0FBZSxDQUFoQixFQUFtQmtDLGNBQW5CLEVBQWhCLHVCQUFnRTFDLEtBQUssQ0FBQ1EsTUFBTixHQUFlLENBQWYsS0FBcUIsQ0FBckIsR0FBeUIsRUFBekIsR0FBOEIsR0FBOUYsU0FBb0d0QixXQUFwRyxPQUFqQixDQUNBLElBQUlMLFNBQVMsQ0FBQ0MsVUFBVixDQUFxQjBCLE1BQXpCLEVBQ0luQyxpQkFBaUIsZ0NBQXlCWCxvQ0FBekIsNEJBQStFbUIsU0FBUyxDQUFDQyxVQUFWLENBQXFCMEIsTUFBckIsR0FBOEIzQixTQUFTLENBQUNDLFVBQVYsQ0FBcUIwQixNQUFyQixDQUE0QmtDLGNBQTVCLEVBQTlCLEdBQTZFLE1BQTVKLG9CQUE0SzdELFNBQVMsQ0FBQ0MsVUFBVixDQUFxQjBCLE1BQXJCLEtBQWdDLENBQWhDLEdBQW9DLEVBQXBDLEdBQXlDLEdBQXJOLEVBQWpCLENBREosS0FHSW5DLGlCQUFpQiwrREFBd0RYLG9DQUF4RCxFQUFqQixDQS9PRCxDQWdQSDtBQUNBO0FBalBHLDZDQWtQSW1CLFNBbFBKLDJEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgYm9va3MgZnJvbSAnLi9ib29rcy9ib29rcyc7XG5pbXBvcnQgeyBERUZBVUxUX0VYQ0VSUFRfTEVOR1RIIH0gZnJvbSAnLi9kZWZhdWx0cydcbmltcG9ydCB7IGNoZWNrTm90ZXNUU1Y3RGF0YVJvdyB9IGZyb20gJy4vbm90ZXMtdHN2Ny1yb3ctY2hlY2snO1xuaW1wb3J0IHsgcmVtb3ZlRGlzYWJsZWROb3RpY2VzIH0gZnJvbSAnLi9kaXNhYmxlZC1ub3RpY2VzJztcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtdmFyc1xuaW1wb3J0IHsgcGFyYW1ldGVyQXNzZXJ0IH0gZnJvbSAnLi91dGlsaXRpZXMnO1xuXG5cbmNvbnN0IE5PVEVTX1RBQkxFX1ZBTElEQVRPUl9WRVJTSU9OX1NUUklORyA9ICcwLjMuNSc7XG5cbmNvbnN0IE5VTV9FWFBFQ1RFRF9OT1RFU19UU1ZfRklFTERTID0gNzsgLy8gc28gZXhwZWN0cyA2IHRhYnMgcGVyIGxpbmVcbmNvbnN0IEVYUEVDVEVEX05PVEVTX0hFQURJTkdfTElORSA9ICdSZWZlcmVuY2VcXHRJRFxcdFRhZ3NcXHRTdXBwb3J0UmVmZXJlbmNlXFx0UXVvdGVcXHRPY2N1cnJlbmNlXFx0Tm90ZSc7XG5cblxuLyoqXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGxhbmd1YWdlQ29kZVxuICogQHBhcmFtIHtzdHJpbmd9IHJlcG9Db2RlIC0tICdUTicgb3IgJ1NOJ1xuICogQHBhcmFtIHtzdHJpbmd9IGJvb2tJRFxuICogQHBhcmFtIHtzdHJpbmd9IGZpbGVuYW1lXG4gKiBAcGFyYW0ge3N0cmluZ30gdGFibGVUZXh0XG4gKiBAcGFyYW0ge3N0cmluZ30gZ2l2ZW5Mb2NhdGlvblxuICogQHBhcmFtIHtPYmplY3R9IGNoZWNraW5nT3B0aW9uc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2hlY2tOb3Rlc1RTVjdUYWJsZShsYW5ndWFnZUNvZGUsIHJlcG9Db2RlLCBib29rSUQsIGZpbGVuYW1lLCB0YWJsZVRleHQsIGdpdmVuTG9jYXRpb24sIGNoZWNraW5nT3B0aW9ucykge1xuICAgIC8qIFRoaXMgZnVuY3Rpb24gaXMgb3B0aW1pc2VkIGZvciBjaGVja2luZyB0aGUgZW50aXJlIGZpbGUsIGkuZS4sIGFsbCByb3dzLlxuXG4gICAgICBJdCBhbHNvIGhhcyB0aGUgYWR2YW50YWdlIG9mIGJlaW5nIGFibGUgdG8gY29tcGFyZSBvbmUgcm93IHdpdGggdGhlIHByZXZpb3VzIG9uZS5cblxuICAgICBib29rSUQgaXMgYSB0aHJlZS1jaGFyYWN0ZXIgVVBQRVJDQVNFIFVTRk0gYm9vayBpZGVudGlmaWVyIG9yICdPQlMnLlxuXG4gICAgIFJldHVybnMgYSByZXN1bHQgb2JqZWN0IGNvbnRhaW5pbmcgYSBzdWNjZXNzTGlzdCBhbmQgYSBub3RpY2VMaXN0XG4gICAgICovXG4gICAgLy8gZnVuY3Rpb25Mb2coYGNoZWNrTm90ZXNUU1Y3VGFibGUoJHtsYW5ndWFnZUNvZGV9LCAke3JlcG9Db2RlfSwgJHtib29rSUR9LCAke3RhYmxlVGV4dC5sZW5ndGh9LCAke2dpdmVuTG9jYXRpb259LCR7SlNPTi5zdHJpbmdpZnkoY2hlY2tpbmdPcHRpb25zKX0p4oCmYCk7XG4gICAgLy9wYXJhbWV0ZXJBc3NlcnQobGFuZ3VhZ2VDb2RlICE9PSB1bmRlZmluZWQsIFwiY2hlY2tOb3Rlc1RTVjdUYWJsZTogJ2xhbmd1YWdlQ29kZScgcGFyYW1ldGVyIHNob3VsZCBiZSBkZWZpbmVkXCIpO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KHR5cGVvZiBsYW5ndWFnZUNvZGUgPT09ICdzdHJpbmcnLCBgY2hlY2tOb3Rlc1RTVjdUYWJsZTogJ2xhbmd1YWdlQ29kZScgcGFyYW1ldGVyIHNob3VsZCBiZSBhIHN0cmluZyBub3QgYSAnJHt0eXBlb2YgbGFuZ3VhZ2VDb2RlfSdgKTtcbiAgICAvL3BhcmFtZXRlckFzc2VydChyZXBvQ29kZS5lbmRzV2l0aCgnVE4nKSB8fCByZXBvQ29kZS5lbmRzV2l0aCgnVE4yJykgfHwgcmVwb0NvZGUuZW5kc1dpdGgoJ1NOJyksIGBjaGVja05vdGVzVFNWN1RhYmxlOiByZXBvQ29kZSBleHBlY3RlZCB0byBlbmQgd2l0aCAnVE4nLCAnVE4yJywgb3IgJ1NOJyBub3QgJyR7cmVwb0NvZGV9J2ApO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KGJvb2tJRCAhPT0gdW5kZWZpbmVkLCBcImNoZWNrTm90ZXNUU1Y3VGFibGU6ICdib29rSUQnIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgICAvL3BhcmFtZXRlckFzc2VydCh0eXBlb2YgYm9va0lEID09PSAnc3RyaW5nJywgYGNoZWNrTm90ZXNUU1Y3VGFibGU6ICdib29rSUQnIHBhcmFtZXRlciBzaG91bGQgYmUgYSBzdHJpbmcgbm90IGEgJyR7dHlwZW9mIGJvb2tJRH0nYCk7XG4gICAgLy9wYXJhbWV0ZXJBc3NlcnQoYm9va0lELmxlbmd0aCA9PT0gMywgYGNoZWNrTm90ZXNUU1Y3VGFibGU6ICdib29rSUQnIHBhcmFtZXRlciBzaG91bGQgYmUgdGhyZWUgY2hhcmFjdGVycyBsb25nIG5vdCAke2Jvb2tJRC5sZW5ndGh9YCk7XG4gICAgLy9wYXJhbWV0ZXJBc3NlcnQoYm9va0lELnRvVXBwZXJDYXNlKCkgPT09IGJvb2tJRCwgYGNoZWNrTm90ZXNUU1Y3VGFibGU6ICdib29rSUQnIHBhcmFtZXRlciBzaG91bGQgYmUgVVBQRVJDQVNFIG5vdCAnJHtib29rSUR9J2ApO1xuICAgIC8vcGFyYW1ldGVyQXNzZXJ0KGJvb2tJRCA9PT0gJ09CUycgfHwgYm9va3MuaXNWYWxpZEJvb2tJRChib29rSUQpLCBgY2hlY2tOb3Rlc1RTVjdUYWJsZTogJyR7Ym9va0lEfScgaXMgbm90IGEgdmFsaWQgVVNGTSBib29rIGlkZW50aWZpZXJgKTtcbiAgICAvL3BhcmFtZXRlckFzc2VydChnaXZlbkxvY2F0aW9uICE9PSB1bmRlZmluZWQsIFwiY2hlY2tOb3Rlc1RTVjdUYWJsZTogJ2dpdmVuTG9jYXRpb24nIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgICAvL3BhcmFtZXRlckFzc2VydCh0eXBlb2YgZ2l2ZW5Mb2NhdGlvbiA9PT0gJ3N0cmluZycsIGBjaGVja05vdGVzVFNWN1RhYmxlOiAnZ2l2ZW5Mb2NhdGlvbicgcGFyYW1ldGVyIHNob3VsZCBiZSBhIHN0cmluZyBub3QgYSAnJHt0eXBlb2YgZ2l2ZW5Mb2NhdGlvbn0nYCk7XG5cbiAgICBsZXQgb3VyTG9jYXRpb24gPSBnaXZlbkxvY2F0aW9uO1xuICAgIGlmIChvdXJMb2NhdGlvbiAmJiBvdXJMb2NhdGlvblswXSAhPT0gJyAnKSBvdXJMb2NhdGlvbiA9IGAgJHtvdXJMb2NhdGlvbn1gO1xuXG4gICAgY29uc3QgY2FyUmVzdWx0ID0geyBzdWNjZXNzTGlzdDogW10sIG5vdGljZUxpc3Q6IFtdIH07XG5cbiAgICBmdW5jdGlvbiBhZGRTdWNjZXNzTWVzc2FnZShzdWNjZXNzU3RyaW5nKSB7XG4gICAgICAgIC8vIGZ1bmN0aW9uTG9nKGBjaGVja05vdGVzVFNWN1RhYmxlIHN1Y2Nlc3M6ICR7c3VjY2Vzc1N0cmluZ31gKTtcbiAgICAgICAgY2FyUmVzdWx0LnN1Y2Nlc3NMaXN0LnB1c2goc3VjY2Vzc1N0cmluZyk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGFkZE5vdGljZVBhcnRpYWwobm90aWNlT2JqZWN0KSB7XG4gICAgICAgIC8vIGZ1bmN0aW9uTG9nKGBjaGVja05vdGVzVFNWN1RhYmxlIG5vdGljZTogKHByaW9yaXR5PSR7cHJpb3JpdHl9KSAke21lc3NhZ2V9JHtjaGFyYWN0ZXJJbmRleCA+IDAgPyBgIChhdCBjaGFyYWN0ZXIgJHtjaGFyYWN0ZXJJbmRleH0pYCA6IFwiXCJ9JHtleGNlcnB0ID8gYCAke2V4Y2VycHR9YCA6IFwiXCJ9JHtsb2NhdGlvbn1gKTtcbiAgICAgICAgLy9wYXJhbWV0ZXJBc3NlcnQobm90aWNlT2JqZWN0LnByaW9yaXR5ICE9PSB1bmRlZmluZWQsIFwiQVRTViBhZGROb3RpY2VQYXJ0aWFsOiAncHJpb3JpdHknIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgICAgICAgLy9wYXJhbWV0ZXJBc3NlcnQodHlwZW9mIG5vdGljZU9iamVjdC5wcmlvcml0eSA9PT0gJ251bWJlcicsIGBUU1YgYWRkTm90aWNlUGFydGlhbDogJ3ByaW9yaXR5JyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGEgbnVtYmVyIG5vdCBhICcke3R5cGVvZiBub3RpY2VPYmplY3QucHJpb3JpdHl9JzogJHtub3RpY2VPYmplY3QucHJpb3JpdHl9YCk7XG4gICAgICAgIC8vcGFyYW1ldGVyQXNzZXJ0KG5vdGljZU9iamVjdC5tZXNzYWdlICE9PSB1bmRlZmluZWQsIFwiQVRTViBhZGROb3RpY2VQYXJ0aWFsOiAnbWVzc2FnZScgcGFyYW1ldGVyIHNob3VsZCBiZSBkZWZpbmVkXCIpO1xuICAgICAgICAvL3BhcmFtZXRlckFzc2VydCh0eXBlb2Ygbm90aWNlT2JqZWN0Lm1lc3NhZ2UgPT09ICdzdHJpbmcnLCBgVFNWIGFkZE5vdGljZVBhcnRpYWw6ICdtZXNzYWdlJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGEgc3RyaW5nIG5vdCBhICcke3R5cGVvZiBub3RpY2VPYmplY3QubWVzc2FnZX0nOiAke25vdGljZU9iamVjdC5tZXNzYWdlfWApO1xuICAgICAgICAvLyAvL3BhcmFtZXRlckFzc2VydChDICE9PSB1bmRlZmluZWQsIFwiQVRTViBhZGROb3RpY2VQYXJ0aWFsOiAnQycgcGFyYW1ldGVyIHNob3VsZCBiZSBkZWZpbmVkXCIpO1xuICAgICAgICBpZiAobm90aWNlT2JqZWN0LkMpIHsgLy9wYXJhbWV0ZXJBc3NlcnQodHlwZW9mIG5vdGljZU9iamVjdC5DID09PSAnc3RyaW5nJywgYFRTViBhZGROb3RpY2VQYXJ0aWFsOiAnQycgcGFyYW1ldGVyIHNob3VsZCBiZSBhIHN0cmluZyBub3QgYSAnJHt0eXBlb2Ygbm90aWNlT2JqZWN0LkN9JzogJHtub3RpY2VPYmplY3QuQ31gKTtcbiAgICAgICAgfVxuICAgICAgICAvLyAvL3BhcmFtZXRlckFzc2VydChWICE9PSB1bmRlZmluZWQsIFwiQVRTViBhZGROb3RpY2VQYXJ0aWFsOiAnVicgcGFyYW1ldGVyIHNob3VsZCBiZSBkZWZpbmVkXCIpO1xuICAgICAgICBpZiAobm90aWNlT2JqZWN0LlYpIHsgLy9wYXJhbWV0ZXJBc3NlcnQodHlwZW9mIG5vdGljZU9iamVjdC5WID09PSAnc3RyaW5nJywgYFRTViBhZGROb3RpY2VQYXJ0aWFsOiAnVicgcGFyYW1ldGVyIHNob3VsZCBiZSBhIHN0cmluZyBub3QgYSAnJHt0eXBlb2Ygbm90aWNlT2JqZWN0LlZ9JzogJHtub3RpY2VPYmplY3QuVn1gKTtcbiAgICAgICAgfVxuICAgICAgICAvLyAvL3BhcmFtZXRlckFzc2VydChjaGFyYWN0ZXJJbmRleCAhPT0gdW5kZWZpbmVkLCBcIkFUU1YgYWRkTm90aWNlUGFydGlhbDogJ2NoYXJhY3RlckluZGV4JyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGRlZmluZWRcIik7XG4gICAgICAgIGlmIChub3RpY2VPYmplY3QuY2hhcmFjdGVySW5kZXgpIHsgLy9wYXJhbWV0ZXJBc3NlcnQodHlwZW9mIG5vdGljZU9iamVjdC5jaGFyYWN0ZXJJbmRleCA9PT0gJ251bWJlcicsIGBUU1YgYWRkTm90aWNlUGFydGlhbDogJ2NoYXJhY3RlckluZGV4JyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGEgbnVtYmVyIG5vdCBhICcke3R5cGVvZiBub3RpY2VPYmplY3QuY2hhcmFjdGVySW5kZXh9JzogJHtub3RpY2VPYmplY3QuY2hhcmFjdGVySW5kZXh9YCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gLy9wYXJhbWV0ZXJBc3NlcnQoZXhjZXJwdCAhPT0gdW5kZWZpbmVkLCBcIkFUU1YgYWRkTm90aWNlUGFydGlhbDogJ2V4Y2VycHQnIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgICAgICAgaWYgKG5vdGljZU9iamVjdC5leGNlcnB0KSB7IC8vcGFyYW1ldGVyQXNzZXJ0KHR5cGVvZiBub3RpY2VPYmplY3QuZXhjZXJwdCA9PT0gJ3N0cmluZycsIGBUU1YgYWRkTm90aWNlUGFydGlhbDogJ2V4Y2VycHQnIHBhcmFtZXRlciBzaG91bGQgYmUgYSBzdHJpbmcgbm90IGEgJyR7dHlwZW9mIG5vdGljZU9iamVjdC5leGNlcnB0fSc6ICR7bm90aWNlT2JqZWN0LmV4Y2VycHR9YCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9wYXJhbWV0ZXJBc3NlcnQobm90aWNlT2JqZWN0LmxvY2F0aW9uICE9PSB1bmRlZmluZWQsIFwiQVRTViBhZGROb3RpY2VQYXJ0aWFsOiAnbG9jYXRpb24nIHBhcmFtZXRlciBzaG91bGQgYmUgZGVmaW5lZFwiKTtcbiAgICAgICAgLy9wYXJhbWV0ZXJBc3NlcnQodHlwZW9mIG5vdGljZU9iamVjdC5sb2NhdGlvbiA9PT0gJ3N0cmluZycsIGBUU1YgYWRkTm90aWNlUGFydGlhbDogJ2xvY2F0aW9uJyBwYXJhbWV0ZXIgc2hvdWxkIGJlIGEgc3RyaW5nIG5vdCBhICcke3R5cGVvZiBub3RpY2VPYmplY3QubG9jYXRpb259JzogJHtub3RpY2VPYmplY3QubG9jYXRpb259YCk7XG5cbiAgICAgICAgaWYgKG5vdGljZU9iamVjdC5kZWJ1Z0NoYWluKSBub3RpY2VPYmplY3QuZGVidWdDaGFpbiA9IGBjaGVja05vdGVzVFNWN1RhYmxlICR7bm90aWNlT2JqZWN0LmRlYnVnQ2hhaW59YDtcbiAgICAgICAgY2FyUmVzdWx0Lm5vdGljZUxpc3QucHVzaCh7IC4uLm5vdGljZU9iamVjdCwgYm9va0lELCBmaWxlbmFtZSwgcmVwb0NvZGUgfSk7XG4gICAgfVxuXG5cbiAgICBsZXQgZXhjZXJwdExlbmd0aDtcbiAgICB0cnkge1xuICAgICAgICBleGNlcnB0TGVuZ3RoID0gY2hlY2tpbmdPcHRpb25zPy5leGNlcnB0TGVuZ3RoO1xuICAgIH0gY2F0Y2ggKHR0Y0Vycm9yKSB7IH1cbiAgICBpZiAodHlwZW9mIGV4Y2VycHRMZW5ndGggIT09ICdudW1iZXInIHx8IGlzTmFOKGV4Y2VycHRMZW5ndGgpKSB7XG4gICAgICAgIGV4Y2VycHRMZW5ndGggPSBERUZBVUxUX0VYQ0VSUFRfTEVOR1RIO1xuICAgICAgICAvLyBkZWJ1Z0xvZyhgVXNpbmcgZGVmYXVsdCBleGNlcnB0TGVuZ3RoPSR7ZXhjZXJwdExlbmd0aH1gKTtcbiAgICB9XG4gICAgLy8gZWxzZVxuICAgIC8vIGRlYnVnTG9nKGBVc2luZyBzdXBwbGllZCBleGNlcnB0TGVuZ3RoPSR7ZXhjZXJwdExlbmd0aH1gLCBgY2YuIGRlZmF1bHQ9JHtERUZBVUxUX0VYQ0VSUFRfTEVOR1RIfWApO1xuICAgIC8vIGNvbnN0IGV4Y2VycHRIYWxmTGVuZ3RoID0gTWF0aC5mbG9vcihleGNlcnB0TGVuZ3RoIC8gMik7IC8vIHJvdW5kZWQgZG93blxuICAgIC8vIGNvbnN0IGV4Y2VycHRIYWxmTGVuZ3RoUGx1cyA9IE1hdGguZmxvb3IoKGV4Y2VycHRMZW5ndGggKyAxKSAvIDIpOyAvLyByb3VuZGVkIHVwXG4gICAgLy8gZGVidWdMb2coYFVzaW5nIGV4Y2VycHRIYWxmTGVuZ3RoPSR7ZXhjZXJwdEhhbGZMZW5ndGh9YCwgYGV4Y2VycHRIYWxmTGVuZ3RoUGx1cz0ke2V4Y2VycHRIYWxmTGVuZ3RoUGx1c31gKTtcblxuICAgIGxldCBsb3dlcmNhc2VCb29rSUQgPSBib29rSUQudG9Mb3dlckNhc2UoKTtcbiAgICBsZXQgbnVtQ2hhcHRlcnNUaGlzQm9vayA9IDA7XG4gICAgaWYgKGJvb2tJRCA9PT0gJ09CUycpXG4gICAgICAgIG51bUNoYXB0ZXJzVGhpc0Jvb2sgPSA1MDsgLy8gVGhlcmUncyA1MCBPcGVuIEJpYmxlIFN0b3JpZXNcbiAgICBlbHNlIHtcbiAgICAgICAgLy9wYXJhbWV0ZXJBc3NlcnQobG93ZXJjYXNlQm9va0lEICE9PSAnb2JzJywgXCJTaG91bGRu4oCZdCBoYXBwZW4gaW4gY2hlY2tOb3Rlc1RTVjdUYWJsZVwiKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIG51bUNoYXB0ZXJzVGhpc0Jvb2sgPSBib29rcy5jaGFwdGVyc0luQm9vayhib29rSUQpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIHtcbiAgICAgICAgICAgIGlmICghYm9va3MuaXNWYWxpZEJvb2tJRChib29rSUQpKSAvLyBtdXN0IG5vdCBiZSBpbiBGUlQsIEJBSywgZXRjLlxuICAgICAgICAgICAgICAgIGFkZE5vdGljZVBhcnRpYWwoeyBwcmlvcml0eTogNzQ3LCBtZXNzYWdlOiBcIkJhZCBmdW5jdGlvbiBjYWxsOiBzaG91bGQgYmUgZ2l2ZW4gYSB2YWxpZCBib29rIGFiYnJldmlhdGlvblwiLCBleGNlcnB0OiBib29rSUQsIGxvY2F0aW9uOiBgIChub3QgJyR7Ym9va0lEfScpJHtvdXJMb2NhdGlvbn1gIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgbGV0IGxpbmVzID0gdGFibGVUZXh0LnNwbGl0KCdcXG4nKTtcbiAgICAvLyBkZWJ1Z0xvZyhgICAnJHtsb2NhdGlvbn0nIGhhcyAke2xpbmVzLmxlbmd0aC50b0xvY2FsZVN0cmluZygpfSB0b3RhbCBsaW5lcyAoZXhwZWN0aW5nICR7TlVNX0VYUEVDVEVEX1ROX0ZJRUxEU30gZmllbGRzIGluIGVhY2ggbGluZSlgKTtcblxuICAgIGxldCBsYXN0QyA9ICcnLCBsYXN0ViA9ICcnO1xuICAgIGxldCByb3dJRExpc3RGb3JWZXJzZSA9IFtdLCB1bmlxdWVSb3dMaXN0Rm9yVmVyc2UgPSBbXTtcbiAgICBsZXQgbnVtVmVyc2VzVGhpc0NoYXB0ZXIgPSAwO1xuICAgIGZvciAobGV0IG4gPSAwOyBuIDwgbGluZXMubGVuZ3RoOyBuKyspIHtcbiAgICAgICAgLy8gZnVuY3Rpb25Mb2coYGNoZWNrTm90ZXNUU1Y3VGFibGUgY2hlY2tpbmcgbGluZSAke259OiAke0pTT04uc3RyaW5naWZ5KGxpbmVzW25dKX1gKTtcbiAgICAgICAgaWYgKG4gPT09IDApIHtcbiAgICAgICAgICAgIGlmIChsaW5lc1swXSA9PT0gRVhQRUNURURfTk9URVNfSEVBRElOR19MSU5FKVxuICAgICAgICAgICAgICAgIGFkZFN1Y2Nlc3NNZXNzYWdlKGBDaGVja2VkIFRTViBoZWFkZXIgJHtvdXJMb2NhdGlvbn1gKTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBhZGROb3RpY2VQYXJ0aWFsKHsgcHJpb3JpdHk6IDk4OCwgbWVzc2FnZTogXCJCYWQgVFNWIGhlYWRlclwiLCBkZXRhaWxzOiBgZXhwZWN0ZWQgJyR7RVhQRUNURURfTk9URVNfSEVBRElOR19MSU5FfSdgLCBleGNlcnB0OiBsaW5lc1swXSwgbGluZU51bWJlcjogMSwgbG9jYXRpb246IG91ckxvY2F0aW9uIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgLy8gbm90IHRoZSBoZWFkZXJcbiAgICAgICAge1xuICAgICAgICAgICAgbGV0IGZpZWxkcyA9IGxpbmVzW25dLnNwbGl0KCdcXHQnKTtcbiAgICAgICAgICAgIGlmIChmaWVsZHMubGVuZ3RoID09PSBOVU1fRVhQRUNURURfTk9URVNfVFNWX0ZJRUxEUykge1xuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtdmFyc1xuICAgICAgICAgICAgICAgIGNvbnN0IFtyZWZlcmVuY2UsIHJvd0lELCB0YWdzLCBzdXBwb3J0UmVmZXJlbmNlLCBxdW90ZSwgb2NjdXJyZW5jZSwgbm90ZV0gPSBmaWVsZHM7XG4gICAgICAgICAgICAgICAgY29uc3QgW0MsIFZdID0gcmVmZXJlbmNlLnNwbGl0KCc6JylcblxuICAgICAgICAgICAgICAgIC8vIFVzZSB0aGUgcm93IGNoZWNrIHRvIGRvIG1vc3QgYmFzaWMgY2hlY2tzXG4gICAgICAgICAgICAgICAgY29uc3QgZHJSZXN1bHRPYmplY3QgPSBhd2FpdCBjaGVja05vdGVzVFNWN0RhdGFSb3cobGFuZ3VhZ2VDb2RlLCByZXBvQ29kZSwgbGluZXNbbl0sIGJvb2tJRCwgQywgViwgb3VyTG9jYXRpb24sIGNoZWNraW5nT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgLy8gQ2hvb3NlIG9ubHkgT05FIG9mIHRoZSBmb2xsb3dpbmdcbiAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIHRoZSBmYXN0IHdheSBvZiBhcHBlbmQgdGhlIHJlc3VsdHMgZnJvbSB0aGlzIGZpZWxkXG4gICAgICAgICAgICAgICAgLy8gcmVzdWx0Lm5vdGljZUxpc3QgPSByZXN1bHQubm90aWNlTGlzdC5jb25jYXQoZmlyc3RSZXN1bHQubm90aWNlTGlzdCk7XG4gICAgICAgICAgICAgICAgLy8gSWYgd2UgbmVlZCB0byBwdXQgZXZlcnl0aGluZyB0aHJvdWdoIGFkZE5vdGljZVBhcnRpYWwsIGUuZy4sIGZvciBkZWJ1Z2dpbmcgb3IgZmlsdGVyaW5nXG4gICAgICAgICAgICAgICAgLy8gIHByb2Nlc3MgcmVzdWx0cyBsaW5lIGJ5IGxpbmVcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGRyTm90aWNlRW50cnkgb2YgZHJSZXN1bHRPYmplY3Qubm90aWNlTGlzdClcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRyTm90aWNlRW50cnkuZXh0cmEpIC8vIGl0IG11c3QgYmUgYW4gaW5kaXJlY3QgY2hlY2sgb24gYSBUQSBvciBUVyBhcnRpY2xlIGZyb20gYSBUTjIgY2hlY2tcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhclJlc3VsdC5ub3RpY2VMaXN0LnB1c2goZHJOb3RpY2VFbnRyeSk7IC8vIEp1c3QgY29weSB0aGUgY29tcGxldGUgbm90aWNlIGFzIGlzXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGRyTm90aWNlRW50cnkucHJpb3JpdHkgIT09IDkzMSkgLy8gV2UgYWxyZWFkeSBjYXVnaHQgTWlzc2luZyByb3cgSURcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZE5vdGljZVBhcnRpYWwoeyAuLi5kck5vdGljZUVudHJ5LCBsaW5lTnVtYmVyOiBuICsgMSB9KTtcbiAgICAgICAgICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGlzIG5lZWRlZCBjb3ogd2UgbWlnaHQgYmUgY2hlY2tpbmcgdGhlIGxpbmtlZCBUQSBhbmQvb3IgVFcgYXJ0aWNsZXNcbiAgICAgICAgICAgICAgICBpZiAoZHJSZXN1bHRPYmplY3QuY2hlY2tlZEZpbGVDb3VudCAmJiBkclJlc3VsdE9iamVjdC5jaGVja2VkRmlsZUNvdW50ID4gMClcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjYXJSZXN1bHQuY2hlY2tlZEZpbGVDb3VudCA9PT0gJ251bWJlcicpIGNhclJlc3VsdC5jaGVja2VkRmlsZUNvdW50ICs9IGRyUmVzdWx0T2JqZWN0LmNoZWNrZWRGaWxlQ291bnQ7XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgY2FyUmVzdWx0LmNoZWNrZWRGaWxlQ291bnQgPSBkclJlc3VsdE9iamVjdC5jaGVja2VkRmlsZUNvdW50O1xuICAgICAgICAgICAgICAgIGlmIChkclJlc3VsdE9iamVjdC5jaGVja2VkRmlsZXNpemVzICYmIGRyUmVzdWx0T2JqZWN0LmNoZWNrZWRGaWxlc2l6ZXMgPiAwKVxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGNhclJlc3VsdC5jaGVja2VkRmlsZXNpemVzID09PSAnbnVtYmVyJykgY2FyUmVzdWx0LmNoZWNrZWRGaWxlc2l6ZXMgKz0gZHJSZXN1bHRPYmplY3QuY2hlY2tlZEZpbGVzaXplcztcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBjYXJSZXN1bHQuY2hlY2tlZEZpbGVzaXplcyA9IGRyUmVzdWx0T2JqZWN0LmNoZWNrZWRGaWxlc2l6ZXM7XG4gICAgICAgICAgICAgICAgaWYgKGRyUmVzdWx0T2JqZWN0LmNoZWNrZWRSZXBvTmFtZXMgJiYgZHJSZXN1bHRPYmplY3QuY2hlY2tlZFJlcG9OYW1lcy5sZW5ndGggPiAwKVxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNoZWNrZWRSZXBvTmFtZSBvZiBkclJlc3VsdE9iamVjdC5jaGVja2VkUmVwb05hbWVzKVxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsgaWYgKGNhclJlc3VsdC5jaGVja2VkUmVwb05hbWVzLmluZGV4T2YoY2hlY2tlZFJlcG9OYW1lKSA8IDApIGNhclJlc3VsdC5jaGVja2VkUmVwb05hbWVzLnB1c2goY2hlY2tlZFJlcG9OYW1lKTsgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggeyBjYXJSZXN1bHQuY2hlY2tlZFJlcG9OYW1lcyA9IFtjaGVja2VkUmVwb05hbWVdOyB9XG4gICAgICAgICAgICAgICAgaWYgKGRyUmVzdWx0T2JqZWN0LmNoZWNrZWRGaWxlbmFtZUV4dGVuc2lvbnMgJiYgZHJSZXN1bHRPYmplY3QuY2hlY2tlZEZpbGVuYW1lRXh0ZW5zaW9ucy5sZW5ndGggPiAwKVxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNoZWNrZWRGaWxlbmFtZUV4dGVuc2lvbiBvZiBkclJlc3VsdE9iamVjdC5jaGVja2VkRmlsZW5hbWVFeHRlbnNpb25zKVxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsgaWYgKGNhclJlc3VsdC5jaGVja2VkRmlsZW5hbWVFeHRlbnNpb25zLmluZGV4T2YoY2hlY2tlZEZpbGVuYW1lRXh0ZW5zaW9uKSA8IDApIGNhclJlc3VsdC5jaGVja2VkRmlsZW5hbWVFeHRlbnNpb25zLnB1c2goY2hlY2tlZEZpbGVuYW1lRXh0ZW5zaW9uKTsgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggeyBjYXJSZXN1bHQuY2hlY2tlZEZpbGVuYW1lRXh0ZW5zaW9ucyA9IFtjaGVja2VkRmlsZW5hbWVFeHRlbnNpb25dOyB9XG4gICAgICAgICAgICAgICAgLy8gaWYgKHR0UmVzdWx0LmNoZWNrZWRGaWxlbmFtZUV4dGVuc2lvbnMpIHVzZXJMb2coXCJ0dFJlc3VsdFwiLCBKU09OLnN0cmluZ2lmeSh0dFJlc3VsdCkpO1xuXG4gICAgICAgICAgICAgICAgLy8gU28gaGVyZSB3ZSBvbmx5IGhhdmUgdG8gY2hlY2sgYWdhaW5zdCB0aGUgcHJldmlvdXMgYW5kIG5leHQgZmllbGRzIGZvciBvdXQtb2Ytb3JkZXIgcHJvYmxlbXMgYW5kIGR1cGxpY2F0ZSBwcm9ibGVtc1xuICAgICAgICAgICAgICAgIGlmIChDICE9PSBsYXN0QyB8fCBWICE9PSBsYXN0Vikge1xuICAgICAgICAgICAgICAgICAgICByb3dJRExpc3RGb3JWZXJzZSA9IFtdOyAvLyBJRCdzIG9ubHkgbmVlZCB0byBiZSB1bmlxdWUgd2l0aGluIGVhY2ggdmVyc2VcbiAgICAgICAgICAgICAgICAgICAgdW5pcXVlUm93TGlzdEZvclZlcnNlID0gW107IC8vIFNhbWUgZm9yIHRoZXNlXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gVE9ETzogQ2hlY2sgaWYgd2UgbmVlZCB0aGlzIGF0IGFsbCAoZXZlbiB0aG91Z2ggdEMgMy4wIGNhbuKAmXQgZGlzcGxheSB0aGVzZSBcImR1cGxpY2F0ZVwiIG5vdGVzKVxuICAgICAgICAgICAgICAgIC8vIENoZWNrIGZvciBkdXBsaWNhdGUgbm90ZXNcbiAgICAgICAgICAgICAgICBjb25zdCB1bmlxdWVJRCA9IEMgKyBWICsgc3VwcG9ydFJlZmVyZW5jZSArIHF1b3RlICsgb2NjdXJyZW5jZTsgLy8gVGhpcyBjb21iaW5hdGlvbiBzaG91bGQgbm90IGJlIHJlcGVhdGVkXG4gICAgICAgICAgICAgICAgLy8gaWYgKHVuaXF1ZVJvd0xpc3RGb3JWZXJzZS5pbmNsdWRlcyh1bmlxdWVJRCkpXG4gICAgICAgICAgICAgICAgLy8gICAgIGFkZE5vdGljZVBhcnRpYWwoeyBwcmlvcml0eTogODgwLCBDLCBWLCBtZXNzYWdlOiBgRHVwbGljYXRlIG5vdGVgLCByb3dJRCwgbGluZU51bWJlcjogbiArIDEsIGxvY2F0aW9uOiBvdXJMb2NhdGlvbiB9KTtcbiAgICAgICAgICAgICAgICAvLyBpZiAodW5pcXVlUm93TGlzdEZvclZlcnNlLmluY2x1ZGVzKHVuaXF1ZUlEKSlcbiAgICAgICAgICAgICAgICAvLyAgICAgYWRkTm90aWNlUGFydGlhbCh7IHByaW9yaXR5OiA4MCwgQywgViwgbWVzc2FnZTogYE5vdGU6IHRDIDMuMCB3b27igJl0IGRpc3BsYXkgZHVwbGljYXRlIG5vdGVgLCByb3dJRCwgbGluZU51bWJlcjogbiArIDEsIGxvY2F0aW9uOiBvdXJMb2NhdGlvbiB9KTtcbiAgICAgICAgICAgICAgICB1bmlxdWVSb3dMaXN0Rm9yVmVyc2UucHVzaCh1bmlxdWVJRCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoQykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoQyA9PT0gJ2Zyb250JykgeyB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKC9eXFxkKyQvLnRlc3QoQykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpbnRDID0gTnVtYmVyKEMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEMgIT09IGxhc3RDKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsb3dlcmNhc2VCb29rSUQgPT09ICdvYnMnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1WZXJzZXNUaGlzQ2hhcHRlciA9IDk5OyAvLyBTZXQgdG8gbWF4aW11bSBleHBlY3RlZCBudW1iZXIgb2YgZnJhbWVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1WZXJzZXNUaGlzQ2hhcHRlciA9IGJvb2tzLnZlcnNlc0luQ2hhcHRlcihsb3dlcmNhc2VCb29rSUQsIGludEMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGludEMgPT09IDApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkTm90aWNlUGFydGlhbCh7IHByaW9yaXR5OiA1NTEsIEMsIFYsIG1lc3NhZ2U6IGBJbnZhbGlkIHplcm8gY2hhcHRlciBudW1iZXJgLCByb3dJRCwgbGluZU51bWJlcjogbiArIDEsIGV4Y2VycHQ6IEMsIGxvY2F0aW9uOiBvdXJMb2NhdGlvbiB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbnRDID4gbnVtQ2hhcHRlcnNUaGlzQm9vaylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGROb3RpY2VQYXJ0aWFsKHsgcHJpb3JpdHk6IDczNywgQywgViwgbWVzc2FnZTogXCJJbnZhbGlkIGxhcmdlIGNoYXB0ZXIgbnVtYmVyXCIsIHJvd0lELCBsaW5lTnVtYmVyOiBuICsgMSwgZXhjZXJwdDogQywgbG9jYXRpb246IG91ckxvY2F0aW9uIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKC9eXFxkKyQvLnRlc3QobGFzdEMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGxhc3RpbnRDID0gTnVtYmVyKGxhc3RDKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW50QyA8IGxhc3RpbnRDKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGROb3RpY2VQYXJ0aWFsKHsgcHJpb3JpdHk6IDczNiwgQywgViwgbWVzc2FnZTogXCJSZWNlZGluZyBjaGFwdGVyIG51bWJlclwiLCBkZXRhaWxzOiBgJyR7Q30nIGFmdGVyICcke2xhc3RDfSdgLCByb3dJRCwgbGluZU51bWJlcjogbiArIDEsIGxvY2F0aW9uOiBvdXJMb2NhdGlvbiB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChpbnRDID4gbGFzdGludEMgKyAxKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGROb3RpY2VQYXJ0aWFsKHsgcHJpb3JpdHk6IDczNSwgQywgViwgbWVzc2FnZTogXCJBZHZhbmNpbmcgY2hhcHRlciBudW1iZXJcIiwgZGV0YWlsczogYCcke0N9JyBhZnRlciAnJHtsYXN0Q30nYC5yb3dJRCwgbGluZU51bWJlcjogbiArIDEsIGxvY2F0aW9uOiBvdXJMb2NhdGlvbiB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGROb3RpY2VQYXJ0aWFsKHsgcHJpb3JpdHk6IDczNCwgQywgViwgbWVzc2FnZTogXCJCYWQgY2hhcHRlciBudW1iZXJcIiwgcm93SUQsIGxpbmVOdW1iZXI6IG4gKyAxLCBsb2NhdGlvbjogb3VyTG9jYXRpb24gfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgYWRkTm90aWNlUGFydGlhbCh7IHByaW9yaXR5OiA3MzksIEMsIFYsIG1lc3NhZ2U6IFwiTWlzc2luZyBjaGFwdGVyIG51bWJlclwiLCByb3dJRCwgbGluZU51bWJlcjogbiArIDEsIGxvY2F0aW9uOiBgIGFmdGVyICR7bGFzdEN9OiR7Vn0ke291ckxvY2F0aW9ufWAgfSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoVikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoViA9PT0gJ2ludHJvJykgeyB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKC9eXFxkKyQvLnRlc3QoVikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpbnRWID0gTnVtYmVyKFYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGludFYgPT09IDAgJiYgYm9va0lEICE9PSAnUFNBJykgLy8gUHNhbG1zIGhhdmUgXFxkIHRpdGxlc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZE5vdGljZVBhcnRpYWwoeyBwcmlvcml0eTogNTUyLCBDLCBWLCBtZXNzYWdlOiBcIkludmFsaWQgemVybyB2ZXJzZSBudW1iZXJcIiwgZGV0YWlsczogYGZvciBjaGFwdGVyICR7Q31gLCByb3dJRCwgbGluZU51bWJlcjogbiArIDEsIGV4Y2VycHQ6IFYsIGxvY2F0aW9uOiBvdXJMb2NhdGlvbiB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbnRWID4gbnVtVmVyc2VzVGhpc0NoYXB0ZXIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkTm90aWNlUGFydGlhbCh7IHByaW9yaXR5OiA3MzQsIEMsIFYsIG1lc3NhZ2U6IFwiSW52YWxpZCBsYXJnZSB2ZXJzZSBudW1iZXJcIiwgZGV0YWlsczogYGZvciBjaGFwdGVyICR7Q31gLCByb3dJRCwgbGluZU51bWJlcjogbiArIDEsIGV4Y2VycHQ6IFYsIGxvY2F0aW9uOiBvdXJMb2NhdGlvbiB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgvXlxcZCskLy50ZXN0KGxhc3RWKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBsYXN0aW50ViA9IE51bWJlcihsYXN0Vik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEMgPT09IGxhc3RDICYmIGludFYgPCBsYXN0aW50VilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkTm90aWNlUGFydGlhbCh7IHByaW9yaXR5OiA3MzMsIEMsIFYsIG1lc3NhZ2U6IFwiUmVjZWRpbmcgdmVyc2UgbnVtYmVyXCIsIGRldGFpbHM6IGAnJHtWfScgYWZ0ZXIgJyR7bGFzdFZ9IGZvciBjaGFwdGVyICR7Q31gLCByb3dJRCwgbGluZU51bWJlcjogbiArIDEsIGV4Y2VycHQ6IFYsIGxvY2F0aW9uOiBvdXJMb2NhdGlvbiB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBlbHNlIGlmIChpbnRWID4gbGFzdGludFYgKyAxKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgYWRkTm90aWNlUGFydGlhbCh7cHJpb3JpdHk6NTU2LCBgU2tpcHBlZCB2ZXJzZXMgd2l0aCAnJHtWfScgdmVyc2UgbnVtYmVyIGFmdGVyICcke2xhc3RWfScke3dpdGhTdHJpbmd9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgYWRkTm90aWNlUGFydGlhbCh7IHByaW9yaXR5OiA3MzgsIEMsIFYsIG1lc3NhZ2U6IFwiQmFkIHZlcnNlIG51bWJlclwiLCByb3dJRCwgbGluZU51bWJlcjogbiArIDEsIGxvY2F0aW9uOiBvdXJMb2NhdGlvbiB9KTtcblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIGFkZE5vdGljZVBhcnRpYWwoeyBwcmlvcml0eTogNzkwLCBDLCBWLCBtZXNzYWdlOiBcIk1pc3NpbmcgdmVyc2UgbnVtYmVyXCIsIHJvd0lELCBsaW5lTnVtYmVyOiBuICsgMSwgbG9jYXRpb246IGAgYWZ0ZXIgJHtDfToke2xhc3RWfSR7b3VyTG9jYXRpb259YCB9KTtcblxuICAgICAgICAgICAgICAgIGlmIChyb3dJRCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocm93SURMaXN0Rm9yVmVyc2UuaW5jbHVkZXMocm93SUQpKVxuICAgICAgICAgICAgICAgICAgICAgICAgYWRkTm90aWNlUGFydGlhbCh7IHByaW9yaXR5OiA4MzEsIEMsIFYsIG1lc3NhZ2U6IGBEdXBsaWNhdGUgJyR7cm93SUR9JyBJRGAsIGZpZWxkTmFtZTogJ0lEJywgcm93SUQsIGxpbmVOdW1iZXI6IG4gKyAxLCBsb2NhdGlvbjogb3VyTG9jYXRpb24gfSk7XG4gICAgICAgICAgICAgICAgICAgIHJvd0lETGlzdEZvclZlcnNlLnB1c2gocm93SUQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgICAgICAgICBhZGROb3RpY2VQYXJ0aWFsKHsgcHJpb3JpdHk6IDkzMiwgQywgViwgbWVzc2FnZTogXCJNaXNzaW5nIHJvdyBJRFwiLCBmaWVsZE5hbWU6ICdJRCcsIGxpbmVOdW1iZXI6IG4gKyAxLCBsb2NhdGlvbjogb3VyTG9jYXRpb24gfSk7XG5cblxuICAgICAgICAgICAgICAgIGxhc3RDID0gQzsgbGFzdFYgPSBWO1xuXG4gICAgICAgICAgICB9IGVsc2UgLy8gd3JvbmcgbnVtYmVyIG9mIGZpZWxkcyBpbiB0aGUgcm93XG4gICAgICAgICAgICAgICAgLy8gaWYgKG4gPT09IGxpbmVzLmxlbmd0aCAtIDEpIC8vIGl04oCZcyB0aGUgbGFzdCBsaW5lXG4gICAgICAgICAgICAgICAgLy8gICAgIHVzZXJMb2coYCAgTGluZSAke259OiBIYXMgJHtmaWVsZHMubGVuZ3RofSBmaWVsZChzKSBpbnN0ZWFkIG9mICR7TlVNX0VYUEVDVEVEX1ROX0ZJRUxEU306ICR7RVhQRUNURURfVE5fSEVBRElOR19MSU5FLnJlcGxhY2UoL1xcdC9nLCAnLCAnKX1gKTtcbiAgICAgICAgICAgICAgICAvLyBlbHNlXG4gICAgICAgICAgICAgICAgaWYgKG4gIT09IGxpbmVzLmxlbmd0aCAtIDEpIHsgLy8gaXTigJlzIG5vdCB0aGUgbGFzdCBsaW5lXG4gICAgICAgICAgICAgICAgICAgIC8vIEhhdmUgYSBnbyBhdCBnZXR0aW5nIHNvbWUgb2YgdGhlIGZpcnN0IGZpZWxkcyBvdXQgb2YgdGhlIGxpbmVcbiAgICAgICAgICAgICAgICAgICAgbGV0IHJlZmVyZW5jZSA9ICc/Oj8nLCBDID0gJz8nLCBWID0gJz8nLCByb3dJRCA9ICc/Pz8/JztcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHsgcmVmZXJlbmNlID0gZmllbGRzWzBdOyB9IGNhdGNoIHsgfVxuICAgICAgICAgICAgICAgICAgICB0cnkgeyByb3dJRCA9IGZpZWxkc1sxXTsgfSBjYXRjaCB7IH1cbiAgICAgICAgICAgICAgICAgICAgdHJ5IHsgW0MsIFZdID0gcmVmZXJlbmNlLnNwbGl0KCc6Jyk7IH0gY2F0Y2ggeyB9XG4gICAgICAgICAgICAgICAgICAgIGFkZE5vdGljZVBhcnRpYWwoeyBwcmlvcml0eTogOTgzLCBtZXNzYWdlOiBgV3JvbmcgbnVtYmVyIG9mIHRhYmJlZCBmaWVsZHMgKGV4cGVjdGVkICR7TlVNX0VYUEVDVEVEX05PVEVTX1RTVl9GSUVMRFN9KWAsIGV4Y2VycHQ6IGBGb3VuZCAke2ZpZWxkcy5sZW5ndGh9IGZpZWxkJHtmaWVsZHMubGVuZ3RoID09PSAxID8gJycgOiAncyd9YCwgQywgViwgcm93SUQsIGxpbmVOdW1iZXI6IG4gKyAxLCBsb2NhdGlvbjogb3VyTG9jYXRpb24gfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFjaGVja2luZ09wdGlvbnM/LnN1cHByZXNzTm90aWNlRGlzYWJsaW5nRmxhZykge1xuICAgICAgICAvLyBmdW5jdGlvbkxvZyhgY2hlY2tOb3Rlc1RTVjdUYWJsZTogY2FsbGluZyByZW1vdmVEaXNhYmxlZE5vdGljZXMoJHtjYXJSZXN1bHQubm90aWNlTGlzdC5sZW5ndGh9KSBoYXZpbmcgJHtKU09OLnN0cmluZ2lmeShjaGVja2luZ09wdGlvbnMpfWApO1xuICAgICAgICBjYXJSZXN1bHQubm90aWNlTGlzdCA9IHJlbW92ZURpc2FibGVkTm90aWNlcyhjYXJSZXN1bHQubm90aWNlTGlzdCk7XG4gICAgfVxuXG4gICAgaWYgKCghY2hlY2tpbmdPcHRpb25zPy5jdXRvZmZQcmlvcml0eUxldmVsIHx8IGNoZWNraW5nT3B0aW9ucz8uY3V0b2ZmUHJpb3JpdHlMZXZlbCA8IDIwKVxuICAgICAgICAmJiBjaGVja2luZ09wdGlvbnM/LmRpc2FibGVBbGxMaW5rRmV0Y2hpbmdGbGFnKVxuICAgICAgICBhZGROb3RpY2VQYXJ0aWFsKHsgcHJpb3JpdHk6IDIwLCBtZXNzYWdlOiBcIk5vdGUgdGhhdCAnZGlzYWJsZUFsbExpbmtGZXRjaGluZ0ZsYWcnIHdhcyBzZXQgc28gbGluayB0YXJnZXRzIHdlcmUgbm90IGNoZWNrZWRcIiwgbG9jYXRpb246IG91ckxvY2F0aW9uIH0pO1xuXG4gICAgYWRkU3VjY2Vzc01lc3NhZ2UoYENoZWNrZWQgYWxsICR7KGxpbmVzLmxlbmd0aCAtIDEpLnRvTG9jYWxlU3RyaW5nKCl9IGRhdGEgbGluZSR7bGluZXMubGVuZ3RoIC0gMSA9PT0gMSA/ICcnIDogJ3MnfSR7b3VyTG9jYXRpb259LmApO1xuICAgIGlmIChjYXJSZXN1bHQubm90aWNlTGlzdC5sZW5ndGgpXG4gICAgICAgIGFkZFN1Y2Nlc3NNZXNzYWdlKGBjaGVja05vdGVzVFNWN1RhYmxlIHYke05PVEVTX1RBQkxFX1ZBTElEQVRPUl9WRVJTSU9OX1NUUklOR30gZmluaXNoZWQgd2l0aCAke2NhclJlc3VsdC5ub3RpY2VMaXN0Lmxlbmd0aCA/IGNhclJlc3VsdC5ub3RpY2VMaXN0Lmxlbmd0aC50b0xvY2FsZVN0cmluZygpIDogXCJ6ZXJvXCJ9IG5vdGljZSR7Y2FyUmVzdWx0Lm5vdGljZUxpc3QubGVuZ3RoID09PSAxID8gJycgOiAncyd9YCk7XG4gICAgZWxzZVxuICAgICAgICBhZGRTdWNjZXNzTWVzc2FnZShgTm8gZXJyb3JzIG9yIHdhcm5pbmdzIGZvdW5kIGJ5IGNoZWNrTm90ZXNUU1Y3VGFibGUgdiR7Tk9URVNfVEFCTEVfVkFMSURBVE9SX1ZFUlNJT05fU1RSSU5HfWApXG4gICAgLy8gZGVidWdMb2coYCAgY2hlY2tOb3Rlc1RTVjdUYWJsZSByZXR1cm5pbmcgd2l0aCAke3Jlc3VsdC5zdWNjZXNzTGlzdC5sZW5ndGgudG9Mb2NhbGVTdHJpbmcoKX0gc3VjY2VzcyhlcyksICR7cmVzdWx0Lm5vdGljZUxpc3QubGVuZ3RoLnRvTG9jYWxlU3RyaW5nKCl9IG5vdGljZShzKS5gKTtcbiAgICAvLyBkZWJ1Z0xvZyhcImNoZWNrTm90ZXNUU1Y3VGFibGUgcmVzdWx0IGlzXCIsIEpTT04uc3RyaW5naWZ5KGNhclJlc3VsdCkpO1xuICAgIHJldHVybiBjYXJSZXN1bHQ7XG59XG4vLyBlbmQgb2YgY2hlY2tOb3Rlc1RTVjdUYWJsZSBmdW5jdGlvblxuIl19