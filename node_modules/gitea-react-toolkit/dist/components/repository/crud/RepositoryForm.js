"use strict";

function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _react = _interopRequireWildcard(require("react"));

var _styles = require("@material-ui/core/styles");

var _core = require("@material-ui/core");

var _icons = require("@material-ui/icons");

var _ = require("../..");

function _getRequireWildcardCache() { if (typeof WeakMap !== "function") return null; var cache = new WeakMap(); _getRequireWildcardCache = function _getRequireWildcardCache() { return cache; }; return cache; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }

function _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err); } _next(undefined); }); }; }

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _iterableToArrayLimit(arr, i) { if (typeof Symbol === "undefined" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

var useStyles = (0, _styles.makeStyles)(function (theme) {
  return {
    root: {
      display: 'flex',
      flexDirection: 'column',
      alignItems: 'center',
      padding: "".concat(theme.spacing(2), "px ").concat(theme.spacing(3), "px ").concat(theme.spacing(3), "px")
    },
    avatar: {
      margin: theme.spacing(1),
      backgroundColor: theme.palette.primary.main
    },
    form: {
      width: '100%',
      // Fix IE 11 issue.
      marginTop: theme.spacing(1)
    },
    submit: {
      marginTop: theme.spacing(3)
    }
  };
});

function RepositoryForm() {
  var classes = useStyles();

  var _useState = (0, _react.useState)({}),
      _useState2 = _slicedToArray(_useState, 2),
      formData = _useState2[0],
      setFormData = _useState2[1];

  var _useState3 = (0, _react.useState)(),
      _useState4 = _slicedToArray(_useState3, 2),
      errorText = _useState4[0],
      setErrorText = _useState4[1];

  var _useContext = (0, _react.useContext)(_.AuthenticationContext),
      authentication = _useContext.state;

  var _useContext2 = (0, _react.useContext)(_.RepositoryContext),
      repository = _useContext2.state,
      _useContext2$actions = _useContext2.actions,
      create = _useContext2$actions.create,
      save = _useContext2$actions.save;

  var updateFormData = function updateFormData(event) {
    var _event$target = event.target,
        type = _event$target.type,
        name = _event$target.name,
        value = _event$target.value,
        checked = _event$target.checked;

    var _formData = _objectSpread({}, formData);

    if (type === 'checkbox') _formData[value] = checked;else _formData[name] = value;
    setFormData(_formData);
  };

  var mode;
  var authenticated = authentication && authentication.user;

  if (authenticated) {
    var admin = repository && repository.permissions.admin;
    if (!repository) mode = 'create';else if (admin) mode = 'edit';
  } else if (repository) mode = 'view';else mode = 'error';

  var disabled = mode === 'view';
  var handleSubmit = (0, _react.useCallback)( /*#__PURE__*/function () {
    var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(settings) {
      var repo, _repo;

      return regeneratorRuntime.wrap(function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              if (!(mode === 'create')) {
                _context.next = 7;
                break;
              }

              _context.next = 3;
              return create(settings);

            case 3:
              repo = _context.sent;
              if (!repo) setErrorText('Error creating repository.');
              _context.next = 12;
              break;

            case 7:
              if (!(mode === 'edit')) {
                _context.next = 12;
                break;
              }

              _context.next = 10;
              return save(settings);

            case 10:
              _repo = _context.sent;
              if (!_repo) setErrorText('Error editing repository.');

            case 12:
            case "end":
              return _context.stop();
          }
        }
      }, _callee);
    }));

    return function (_x) {
      return _ref.apply(this, arguments);
    };
  }(), [create, mode, save]);
  var actionText;
  if (mode === 'create') actionText = 'Create Repository';else if (mode === 'edit') actionText = 'Edit Repository';else if (mode === 'view') actionText = 'View Repository';else if (mode === 'error') {
    actionText = 'View/Edit/Create Repository';
    if (!errorText) setErrorText('Please login and/or provide a repository');
  }
  return /*#__PURE__*/_react.default.createElement("div", {
    className: classes.root
  }, /*#__PURE__*/_react.default.createElement(_core.Avatar, {
    className: classes.avatar
  }, /*#__PURE__*/_react.default.createElement(_icons.FolderShared, null)), /*#__PURE__*/_react.default.createElement(_core.Typography, {
    component: "h1",
    variant: "h5"
  }, actionText), /*#__PURE__*/_react.default.createElement(_core.Typography, {
    component: "p",
    style: {
      color: 'red'
    }
  }, errorText), /*#__PURE__*/_react.default.createElement("form", {
    className: classes.form
  }, /*#__PURE__*/_react.default.createElement(_core.TextField, {
    name: "name",
    label: "Name",
    type: "text",
    required: true,
    variant: "outlined",
    margin: "normal",
    fullWidth: true,
    onChange: updateFormData,
    helperText: "Name must be alpha-numeric and not include spaces.",
    disabled: disabled,
    defaultValue: repository ? repository.name : ''
  }), /*#__PURE__*/_react.default.createElement(_core.TextField, {
    name: "description",
    label: "Description",
    type: "text",
    variant: "outlined",
    margin: "normal",
    fullWidth: true,
    onChange: updateFormData,
    disabled: disabled,
    defaultValue: repository ? repository.description : ''
  }), /*#__PURE__*/_react.default.createElement(_.FormCheckbox, {
    name: "private",
    label: "Private",
    onChange: updateFormData,
    disabled: disabled,
    checked: repository ? repository.private : false
  }), /*#__PURE__*/_react.default.createElement(_core.Button, {
    type: "button",
    fullWidth: true,
    variant: "contained",
    color: "primary",
    className: classes.submit,
    disabled: disabled,
    onClick: function onClick() {
      return handleSubmit(formData);
    }
  }, actionText)));
}

RepositoryForm.propTypes = {};
RepositoryForm.defaultProps = {
  actionText: 'Repository Settings'
};
var _default = RepositoryForm;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3JlcG9zaXRvcnkvY3J1ZC9SZXBvc2l0b3J5Rm9ybS5qcyJdLCJuYW1lcyI6WyJ1c2VTdHlsZXMiLCJ0aGVtZSIsInJvb3QiLCJkaXNwbGF5IiwiZmxleERpcmVjdGlvbiIsImFsaWduSXRlbXMiLCJwYWRkaW5nIiwic3BhY2luZyIsImF2YXRhciIsIm1hcmdpbiIsImJhY2tncm91bmRDb2xvciIsInBhbGV0dGUiLCJwcmltYXJ5IiwibWFpbiIsImZvcm0iLCJ3aWR0aCIsIm1hcmdpblRvcCIsInN1Ym1pdCIsIlJlcG9zaXRvcnlGb3JtIiwiY2xhc3NlcyIsImZvcm1EYXRhIiwic2V0Rm9ybURhdGEiLCJlcnJvclRleHQiLCJzZXRFcnJvclRleHQiLCJBdXRoZW50aWNhdGlvbkNvbnRleHQiLCJhdXRoZW50aWNhdGlvbiIsInN0YXRlIiwiUmVwb3NpdG9yeUNvbnRleHQiLCJyZXBvc2l0b3J5IiwiYWN0aW9ucyIsImNyZWF0ZSIsInNhdmUiLCJ1cGRhdGVGb3JtRGF0YSIsImV2ZW50IiwidGFyZ2V0IiwidHlwZSIsIm5hbWUiLCJ2YWx1ZSIsImNoZWNrZWQiLCJfZm9ybURhdGEiLCJtb2RlIiwiYXV0aGVudGljYXRlZCIsInVzZXIiLCJhZG1pbiIsInBlcm1pc3Npb25zIiwiZGlzYWJsZWQiLCJoYW5kbGVTdWJtaXQiLCJzZXR0aW5ncyIsInJlcG8iLCJhY3Rpb25UZXh0IiwiY29sb3IiLCJkZXNjcmlwdGlvbiIsInByaXZhdGUiLCJwcm9wVHlwZXMiLCJkZWZhdWx0UHJvcHMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQU1BOztBQUlBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBTUEsSUFBTUEsU0FBUyxHQUFHLHdCQUFXLFVBQUFDLEtBQUs7QUFBQSxTQUFLO0FBQ3JDQyxJQUFBQSxJQUFJLEVBQUU7QUFDSkMsTUFBQUEsT0FBTyxFQUFFLE1BREw7QUFFSkMsTUFB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QUFFbkIsY0FGWjtBQUU0QixJQUFBLFFBQVEsRUFBRWEsUUFGdEM7QUFHRSxJQUFBLE9BQU8sRUFBRWpCLFVBQVUsR0FBR0EsVUFBVSxDQUFDd0IsT0FBZCxHQUF3QjtBQUg3QyxJQWRGLGVBbUJFLDZCQUFDLFlBQUQ7QUFBUSxJQUFBLElBQUksRUFBQyxRQUFiO0FBQXNCLElBQUEsU0FBUyxNQUEvQjtBQUFnQyxJQUFBLE9BQU8sRUFBQyxXQUF4QztBQUFvRCxJQUFBLEtBQUssRUFBQyxTQUExRDtBQUNFLElBQUEsU0FBUyxFQUFFakMsT0FBTyxDQUFDRixNQURyQjtBQUM2QixJQUFBLFFBQVEsRUFBRTRCLFFBRHZDO0FBRUUsSUFBQSxPQUFPLEVBQUc7QUFBQSxhQUFNQyxZQUFZLENBQUMxQixRQUFELENBQWxCO0FBQUE7QUFGWixLQUlHNkIsVUFKSCxDQW5CRixDQVZGLENBREY7QUF1Q0Q7O0FBRUQvQixjQUFjLENBQUNtQyxTQUFmLEdBQTJCLEVBQTNCO0FBRUFuQyxjQUFjLENBQUNvQyxZQUFmLEdBQThCO0FBQzVCTCxFQUFBQSxVQUFVLEVBQUU7QUFEZ0IsQ0FBOUI7ZUFJZS9CLGMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUsIHVzZUNvbnRleHQsIHVzZUNhbGxiYWNrIH0gZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBtYWtlU3R5bGVzIH0gZnJvbSAnQG1hdGVyaWFsLXVpL2NvcmUvc3R5bGVzJztcclxuaW1wb3J0IHtcclxuICBBdmF0YXIsXHJcbiAgQnV0dG9uLFxyXG4gIFR5cG9ncmFwaHksXHJcbiAgVGV4dEZpZWxkLFxyXG59IGZyb20gJ0BtYXRlcmlhbC11aS9jb3JlJztcclxuaW1wb3J0IHtcclxuICBGb2xkZXJTaGFyZWQsXHJcbn0gZnJvbSAnQG1hdGVyaWFsLXVpL2ljb25zJztcclxuXHJcbmltcG9ydCB7XHJcbiAgRm9ybUNoZWNrYm94LFxyXG4gIFJlcG9zaXRvcnlDb250ZXh0LFxyXG4gIEF1dGhlbnRpY2F0aW9uQ29udGV4dCxcclxufSBmcm9tICcuLi8uLic7XHJcblxyXG5jb25zdCB1c2VTdHlsZXMgPSBtYWtlU3R5bGVzKHRoZW1lID0+ICh7XHJcbiAgcm9vdDoge1xyXG4gICAgZGlzcGxheTogJ2ZsZXgnLFxyXG4gICAgZmxleERpcmVjdGlvbjogJ2NvbHVtbicsXHJcbiAgICBhbGlnbkl0ZW1zOiAnY2VudGVyJyxcclxuICAgIHBhZGRpbmc6IGAke3RoZW1lLnNwYWNpbmcoMil9cHggJHt0aGVtZS5zcGFjaW5nKDMpfXB4ICR7dGhlbWUuc3BhY2luZygzKX1weGAsXHJcbiAgfSxcclxuICBhdmF0YXI6IHtcclxuICAgIG1hcmdpbjogdGhlbWUuc3BhY2luZygxKSxcclxuICAgIGJhY2tncm91bmRDb2xvcjogdGhlbWUucGFsZXR0ZS5wcmltYXJ5Lm1haW4sXHJcbiAgfSxcclxuICBmb3JtOiB7XHJcbiAgICB3aWR0aDogJzEwMCUnLCAvLyBGaXggSUUgMTEgaXNzdWUuXHJcbiAgICBtYXJnaW5Ub3A6IHRoZW1lLnNwYWNpbmcoMSksXHJcbiAgfSxcclxuICBzdWJtaXQ6IHtcclxuICAgIG1hcmdpblRvcDogdGhlbWUuc3BhY2luZygzKSxcclxuICB9LFxyXG59KSk7XHJcblxyXG5mdW5jdGlvbiBSZXBvc2l0b3J5Rm9ybSgpIHtcclxuICBjb25zdCBjbGFzc2VzID0gdXNlU3R5bGVzKCk7XHJcbiAgY29uc3QgW2Zvcm1EYXRhLCBzZXRGb3JtRGF0YV0gPSB1c2VTdGF0ZSh7fSk7XHJcbiAgY29uc3QgW2Vycm9yVGV4dCwgc2V0RXJyb3JUZXh0XSA9IHVzZVN0YXRlKCk7XHJcbiAgY29uc3QgeyBzdGF0ZTogYXV0aGVudGljYXRpb24gfSA9IHVzZUNvbnRleHQoQXV0aGVudGljYXRpb25Db250ZXh0KTtcclxuICBjb25zdCB7IHN0YXRlOiByZXBvc2l0b3J5LCBhY3Rpb25zOiB7IGNyZWF0ZSwgc2F2ZSB9IH0gPSB1c2VDb250ZXh0KFJlcG9zaXRvcnlDb250ZXh0KTtcclxuXHJcbiAgY29uc3QgdXBkYXRlRm9ybURhdGEgPSAoZXZlbnQpID0+IHtcclxuICAgIGNvbnN0IHsgdHlwZSwgbmFtZSwgdmFsdWUsIGNoZWNrZWQgfSA9IGV2ZW50LnRhcmdldDtcclxuICAgIGNvbnN0IF9mb3JtRGF0YSA9IHsgLi4uZm9ybURhdGEgfTtcclxuXHJcbiAgICBpZiAodHlwZSA9PT0gJ2NoZWNrYm94JykgX2Zvcm1EYXRhW3ZhbHVlXSA9IGNoZWNrZWQ7XHJcbiAgICBlbHNlIF9mb3JtRGF0YVtuYW1lXSA9IHZhbHVlO1xyXG4gICAgc2V0Rm9ybURhdGEoX2Zvcm1EYXRhKTtcclxuICB9O1xyXG5cclxuICBsZXQgbW9kZTtcclxuICBjb25zdCBhdXRoZW50aWNhdGVkID0gKGF1dGhlbnRpY2F0aW9uICYmIGF1dGhlbnRpY2F0aW9uLnVzZXIpO1xyXG5cclxuICBpZiAoYXV0aGVudGljYXRlZCkge1xyXG4gICAgY29uc3QgYWRtaW4gPSByZXBvc2l0b3J5ICYmIHJlcG9zaXRvcnkucGVybWlzc2lvbnMuYWRtaW47XHJcblxyXG4gICAgaWYgKCFyZXBvc2l0b3J5KSBtb2RlID0gJ2NyZWF0ZSc7XHJcbiAgICBlbHNlIGlmIChhZG1pbikgbW9kZSA9ICdlZGl0JztcclxuICB9IGVsc2UgaWYgKHJlcG9zaXRvcnkpIG1vZGUgPSAndmlldyc7XHJcbiAgZWxzZSBtb2RlID0gJ2Vycm9yJztcclxuXHJcbiAgY29uc3QgZGlzYWJsZWQgPSAobW9kZSA9PT0gJ3ZpZXcnKTtcclxuXHJcbiAgY29uc3QgaGFuZGxlU3VibWl0ID0gdXNlQ2FsbGJhY2soYXN5bmMgKHNldHRpbmdzKSA9PiB7XHJcbiAgICBpZiAobW9kZSA9PT0gJ2NyZWF0ZScpIHtcclxuICAgICAgY29uc3QgcmVwbyA9IGF3YWl0IGNyZWF0ZShzZXR0aW5ncyk7XHJcblxyXG4gICAgICBpZiAoIXJlcG8pIHNldEVycm9yVGV4dCgnRXJyb3IgY3JlYXRpbmcgcmVwb3NpdG9yeS4nKTtcclxuICAgIH0gZWxzZSBpZiAobW9kZSA9PT0gJ2VkaXQnKSB7XHJcbiAgICAgIGNvbnN0IHJlcG8gPSBhd2FpdCBzYXZlKHNldHRpbmdzKTtcclxuXHJcbiAgICAgIGlmICghcmVwbykgc2V0RXJyb3JUZXh0KCdFcnJvciBlZGl0aW5nIHJlcG9zaXRvcnkuJyk7XHJcbiAgICB9XHJcbiAgfSwgW2NyZWF0ZSwgbW9kZSwgc2F2ZV0pO1xyXG5cclxuICBsZXQgYWN0aW9uVGV4dDtcclxuXHJcbiAgaWYgKG1vZGUgPT09ICdjcmVhdGUnKSBhY3Rpb25UZXh0ID0gJ0NyZWF0ZSBSZXBvc2l0b3J5JztcclxuICBlbHNlIGlmIChtb2RlID09PSAnZWRpdCcpIGFjdGlvblRleHQgPSAnRWRpdCBSZXBvc2l0b3J5JztcclxuICBlbHNlIGlmIChtb2RlID09PSAndmlldycpIGFjdGlvblRleHQgPSAnVmlldyBSZXBvc2l0b3J5JztcclxuICBlbHNlIGlmIChtb2RlID09PSAnZXJyb3InKSB7XHJcbiAgICBhY3Rpb25UZXh0ID0gJ1ZpZXcvRWRpdC9DcmVhdGUgUmVwb3NpdG9yeSc7XHJcblxyXG4gICAgaWYgKCFlcnJvclRleHQpIHNldEVycm9yVGV4dCgnUGxlYXNlIGxvZ2luIGFuZC9vciBwcm92aWRlIGEgcmVwb3NpdG9yeScpO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIChcclxuICAgIDxkaXYgY2xhc3NOYW1lPXtjbGFzc2VzLnJvb3R9PlxyXG4gICAgICA8QXZhdGFyIGNsYXNzTmFtZT17Y2xhc3Nlcy5hdmF0YXJ9PlxyXG4gICAgICAgIDxGb2xkZXJTaGFyZWQgLz5cclxuICAgICAgPC9BdmF0YXI+XHJcbiAgICAgIDxUeXBvZ3JhcGh5IGNvbXBvbmVudD1cImgxXCIgdmFyaWFudD1cImg1XCI+XHJcbiAgICAgICAge2FjdGlvblRleHR9XHJcbiAgICAgIDwvVHlwb2dyYXBoeT5cclxuICAgICAgPFR5cG9ncmFwaHkgY29tcG9uZW50PVwicFwiIHN0eWxlPXt7IGNvbG9yOiAncmVkJyB9fT5cclxuICAgICAgICB7ZXJyb3JUZXh0fVxyXG4gICAgICA8L1R5cG9ncmFwaHk+XHJcbiAgICAgIDxmb3JtIGNsYXNzTmFtZT17Y2xhc3Nlcy5mb3JtfT5cclxuICAgICAgICA8VGV4dEZpZWxkIG5hbWU9XCJuYW1lXCIgbGFiZWw9XCJOYW1lXCIgdHlwZT1cInRleHRcIiByZXF1aXJlZFxyXG4gICAgICAgICAgdmFyaWFudD1cIm91dGxpbmVkXCIgbWFyZ2luPVwibm9ybWFsXCIgZnVsbFdpZHRoXHJcbiAgICAgICAgICBvbkNoYW5nZT17dXBkYXRlRm9ybURhdGF9XHJcbiAgICAgICAgICBoZWxwZXJUZXh0PVwiTmFtZSBtdXN0IGJlIGFscGhhLW51bWVyaWMgYW5kIG5vdCBpbmNsdWRlIHNwYWNlcy5cIlxyXG4gICAgICAgICAgZGlzYWJsZWQ9e2Rpc2FibGVkfVxyXG4gICAgICAgICAgZGVmYXVsdFZhbHVlPXtyZXBvc2l0b3J5ID8gcmVwb3NpdG9yeS5uYW1lIDogJyd9XHJcbiAgICAgICAgLz5cclxuICAgICAgICA8VGV4dEZpZWxkIG5hbWU9XCJkZXNjcmlwdGlvblwiIGxhYmVsPVwiRGVzY3JpcHRpb25cIiB0eXBlPVwidGV4dFwiXHJcbiAgICAgICAgICB2YXJpYW50PVwib3V0bGluZWRcIiBtYXJnaW49XCJub3JtYWxcIiBmdWxsV2lkdGhcclxuICAgICAgICAgIG9uQ2hhbmdlPXt1cGRhdGVGb3JtRGF0YX1cclxuICAgICAgICAgIGRpc2FibGVkPXtkaXNhYmxlZH1cclxuICAgICAgICAgIGRlZmF1bHRWYWx1ZT17cmVwb3NpdG9yeSA/IHJlcG9zaXRvcnkuZGVzY3JpcHRpb24gOiAnJ31cclxuICAgICAgICAvPlxyXG4gICAgICAgIDxGb3JtQ2hlY2tib3hcclxuICAgICAgICAgIG5hbWU9XCJwcml2YXRlXCIgbGFiZWw9XCJQcml2YXRlXCJcclxuICAgICAgICAgIG9uQ2hhbmdlPXt1cGRhdGVGb3JtRGF0YX0gZGlzYWJsZWQ9e2Rpc2FibGVkfVxyXG4gICAgICAgICAgY2hlY2tlZD17cmVwb3NpdG9yeSA/IHJlcG9zaXRvcnkucHJpdmF0ZSA6IGZhbHNlfVxyXG4gICAgICAgIC8+XHJcbiAgICAgICAgPEJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgZnVsbFdpZHRoIHZhcmlhbnQ9XCJjb250YWluZWRcIiBjb2xvcj1cInByaW1hcnlcIlxyXG4gICAgICAgICAgY2xhc3NOYW1lPXtjbGFzc2VzLnN1Ym1pdH0gZGlzYWJsZWQ9e2Rpc2FibGVkfVxyXG4gICAgICAgICAgb25DbGljaz17ICgpID0+IGhhbmRsZVN1Ym1pdChmb3JtRGF0YSkgfVxyXG4gICAgICAgID5cclxuICAgICAgICAgIHthY3Rpb25UZXh0fVxyXG4gICAgICAgIDwvQnV0dG9uPlxyXG4gICAgICA8L2Zvcm0+XHJcbiAgICA8L2Rpdj5cclxuICApO1xyXG59XHJcblxyXG5SZXBvc2l0b3J5Rm9ybS5wcm9wVHlwZXMgPSB7fTtcclxuXHJcblJlcG9zaXRvcnlGb3JtLmRlZmF1bHRQcm9wcyA9IHtcclxuICBhY3Rpb25UZXh0OiAnUmVwb3NpdG9yeSBTZXR0aW5ncycsXHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBSZXBvc2l0b3J5Rm9ybTtcclxuIl19