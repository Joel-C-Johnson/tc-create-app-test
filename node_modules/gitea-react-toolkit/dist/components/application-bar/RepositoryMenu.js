"use strict";

function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _react = _interopRequireWildcard(require("react"));

var _core = require("@material-ui/core");

var _icons = require("@material-ui/icons");

var _useStyles = require("./useStyles");

var _ = require("..");

function _getRequireWildcardCache() { if (typeof WeakMap !== "function") return null; var cache = new WeakMap(); _getRequireWildcardCache = function _getRequireWildcardCache() { return cache; }; return cache; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _iterableToArrayLimit(arr, i) { if (typeof Symbol === "undefined" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

function RepositoryMenu() {
  var classes = (0, _useStyles.useStyles)();

  var _useState = (0, _react.useState)(false),
      _useState2 = _slicedToArray(_useState, 2),
      modal = _useState2[0],
      setModal = _useState2[1];

  var _ref = (0, _react.useContext)(_.RepositoryContext) || {},
      repository = _ref.state,
      actions = _ref.actions,
      repositoryComponent = _ref.component;

  var _ref2 = (0, _react.useContext)(_.FileContext) || {},
      file = _ref2.state,
      fileStateValues = _ref2.stateValues,
      fileActions = _ref2.actions;

  var _ref3 = repository || {},
      name = _ref3.name,
      avatar_url = _ref3.avatar_url,
      owner = _ref3.owner,
      full_name = _ref3.full_name;

  var _onDelete = (0, _react.useCallback)(function () {
    if (actions !== null && actions !== void 0 && actions.close) {
      if (fileActions !== null && fileActions !== void 0 && fileActions.onConfirmClose) {
        if (fileActions.onConfirmClose()) {
          actions.close();
        }
      } else {
        actions.close();
      }
    }
  }, [actions.close, file, fileActions === null || fileActions === void 0 ? void 0 : fileActions.onConfirmClose]);

  var handleOpen = (0, _react.useCallback)(function () {
    setModal(true);
  }, []);
  var button;

  if (name && owner) {
    var avatarComponent = /*#__PURE__*/_react.default.createElement(_core.Avatar, {
      src: avatar_url || owner.avatar_url
    });

    button = /*#__PURE__*/_react.default.createElement(_core.Chip, {
      id: "chip_".concat(name),
      "data-test": "repository-item-icon",
      "aria-label": "repository-item-icon",
      avatar: avatarComponent,
      label: /*#__PURE__*/_react.default.createElement("span", {
        "data-test": "repository-item-chip"
      }, name),
      onDelete: _onDelete,
      color: "primary"
    });
  } else {
    button = /*#__PURE__*/_react.default.createElement(_core.IconButton, {
      onClick: handleOpen,
      color: "inherit"
    }, /*#__PURE__*/_react.default.createElement(_icons.FolderShared, null));
  }

  ;

  var modalComponent = /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null);

  if (modal && !full_name) {
    modalComponent = /*#__PURE__*/_react.default.createElement(_core.Modal, {
      "data-test": "repository-menu-modal",
      open: true,
      onClose: function onClose() {
        return setModal(false);
      }
    }, /*#__PURE__*/_react.default.createElement(_core.Paper, {
      className: classes.modal
    }, repositoryComponent));
  }

  ;
  return /*#__PURE__*/_react.default.createElement("div", {
    "data-test": "repository-menu"
  }, button, modalComponent);
}

;
RepositoryMenu.propTypes = {};
var _default = RepositoryMenu;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21wb25lbnRzL2FwcGxpY2F0aW9uLWJhci9SZXBvc2l0b3J5TWVudS5qcyJdLCJuYW1lcyI6WyJSZXBvc2l0b3J5TWVudSIsImNsYXNzZXMiLCJtb2RhbCIsInNldE1vZGFsIiwiUmVwb3NpdG9yeUNvbnRleHQiLCJyZXBvc2l0b3J5Iiwic3RhdGUiLCJhY3Rpb25zIiwicmVwb3NpdG9yeUNvbXBvbmVudCIsImNvbXBvbmVudCIsIkZpbGVDb250ZXh0IiwiZmlsZSIsImZpbGVTdGF0ZVZhbHVlcyIsInN0YXRlVmFsdWVzIiwiZmlsZUFjdGlvbnMiLCJuYW1lIiwiYXZhdGFyX3VybCIsIm93bmVyIiwiZnVsbF9uYW1lIiwiX29uRGVsZXRlIiwiY2xvc2UiLCJvbkNvbmZpcm1DbG9zZSIsImhhbmRsZU9wZW4iLCJidXR0b24iLCJhdmF0YXJDb21wb25lbnQiLCJtb2RhbENvbXBvbmVudCIsInByb3BUeXBlcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQ0E7O0FBR0E7O0FBT0E7O0FBRUE7O0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUVBLFNBQVNBLGNBQVQsR0FBMEI7QUFDeEIsTUFBTUMsT0FBTyxHQUFHLDJCQUFoQjs7QUFEd0Isa0JBRUUscUJBQVMsS0FBVCxDQUZGO0FBQUE7QUFBQSxNQUVqQkMsS0FGaUI7QUFBQSxNQUVWQyxRQUZVOztBQUFBLGFBT3BCLHVCQUFXQyxtQkFBWCxLQUFpQyxFQVBiO0FBQUEsTUFJZkMsVUFKZSxRQUl0QkMsS0FKc0I7QUFBQSxNQUt0QkMsT0FMc0IsUUFLdEJBLE9BTHNCO0FBQUEsTUFNWEMsbUJBTlcsUUFNdEJDLFNBTnNCOztBQUFBLGNBU29ELHVCQUFXQyxhQUFYLEtBQTJCLEVBVC9FO0FBQUEsTUFTVEMsSUFUUyxTQVNoQkwsS0FUZ0I7QUFBQSxNQVNVTSxlQVRWLFNBU0hDLFdBVEc7QUFBQSxNQVNvQ0MsV0FUcEMsU0FTMkJQLE9BVDNCOztBQUFBLGNBZ0JwQkYsVUFBVSxJQUFJLEVBaEJNO0FBQUEsTUFZdEJVLElBWnNCLFNBWXRCQSxJQVpzQjtBQUFBLE1BYXRCQyxVQWJzQixTQWF0QkEsVUFic0I7QUFBQSxNQWN0QkMsS0Fkc0IsU0FjdEJBLEtBZHNCO0FBQUEsTUFldEJDLFNBZnNCLFNBZXRCQSxTQWZzQjs7QUFrQnhCLE1BQU1DLFNBQVMsR0FBRyx3QkFBWSxZQUFNO0FBQ2xDLFFBQUlaLE9BQUosYUFBSUEsT0FBSixlQUFJQSxPQUFPLENBQUVhLEtBQWIsRUFBb0I7QUFDbEIsVUFBSU4sV0FBSixhQUFJQSxXQUFKLGVBQUlBLFdBQVcsQ0FBRU8sY0FBakIsRUFBaUM7QUFDL0IsWUFBSVAsV0FBVyxDQUFDTyxjQUFaLEVBQUosRUFDQTtBQUNFZCxVQUFBQSxPQUFPLENBQUNhLEtBQVI7QUFDRDtBQUNGLE9BTEQsTUFPQTtBQUNFYixRQUFBQSxPQUFPLENBQUNhLEtBQVI7QUFDRDtBQUNGO0FBQ0YsR0FiaUIsRUFhaEIsQ0FBQ2IsT0FBTyxDQUFDYSxLQUFULEVBQWdCVCxJQUFoQixFQUFzQkcsV0FBdEIsYUFBc0JBLFdBQXRCLHVCQUFzQkEsV0FBVyxDQUFFTyxjQUFuQyxDQWJnQixDQUFsQjs7QUFlQSxNQUFNQyxVQUFVLEdBQUcsd0JBQVksWUFBTTtBQUNuQ25CLElBQUFBLFFBQVEsQ0FBQyxJQUFELENBQVI7QUFDRCxHQUZrQixFQUVoQixFQUZnQixDQUFuQjtBQUlBLE1BQUlvQixNQUFKOztBQUVBLE1BQUlSLElBQUksSUFBSUUsS0FBWixFQUFtQjtBQUNqQixRQUFNTyxlQUFlLGdCQUFHLDZCQUFDLFlBQUQ7QUFBUSxNQUFBLEdBQUcsRUFBRVIsVUFBVSxJQUFJQyxLQUFLLENBQUNEO0FBQWpDLE1BQXhCOztBQUVBTyxJQUFBQSxNQUFNLGdCQUNKLDZCQUFDLFVBQUQ7QUFDRSxNQUFBLEVBQUUsaUJBQVVSLElBQVYsQ0FESjtBQUVFLG1CQUFVLHNCQUZaO0FBR0Usb0JBQVcsc0JBSGI7QUFJRSxNQUFBLE1BQU0sRUFBRVMsZUFKVjtBQUtFLE1BQUEsS0FBSyxlQUFFO0FBQU0scUJBQVU7QUFBaEIsU0FBd0NULElBQXhDLENBTFQ7QUFNRSxNQUFBLFFBQVEsRUFBRUksU0FOWjtBQU9FLE1BQUEsS0FBSyxFQUFDO0FBUFIsTUFERjtBQVdELEdBZEQsTUFjTztBQUNMSSxJQUFBQSxNQUFNLGdCQUNKLDZCQUFDLGdCQUFEO0FBQVksTUFBQSxPQUFPLEVBQUVELFVBQXJCO0FBQWlDLE1BQUEsS0FBSyxFQUFDO0FBQXZDLG9CQUNFLDZCQUFDLG1CQUFELE9BREYsQ0FERjtBQUtEOztBQUFBOztBQUVELE1BQUlHLGNBQWMsZ0JBQUcsMkRBQXJCOztBQUVBLE1BQUl2QixLQUFLLElBQUksQ0FBQ2dCLFNBQWQsRUFBeUI7QUFDdkJPLElBQUFBLGNBQWMsZ0JBQ1osNkJBQUMsV0FBRDtBQUFPLG1CQUFVLHVCQUFqQjtBQUF5QyxNQUFBLElBQUksRUFBRSxJQUEvQztBQUFxRCxNQUFBLE9BQU8sRUFBRTtBQUFBLGVBQU10QixRQUFRLENBQUMsS0FBRCxDQUFkO0FBQUE7QUFBOUQsb0JBQ0UsNkJBQUMsV0FBRDtBQUFPLE1BQUEsU0FBUyxFQUFFRixPQUFPLENBQUNDO0FBQTFCLE9BQ0dNLG1CQURILENBREYsQ0FERjtBQU9EOztBQUFBO0FBRUQsc0JBQ0U7QUFBSyxpQkFBVTtBQUFmLEtBQ0dlLE1BREgsRUFFR0UsY0FGSCxDQURGO0FBTUQ7O0FBQUE7QUFFRHpCLGNBQWMsQ0FBQzBCLFNBQWYsR0FBMkIsRUFBM0I7ZUFHZTFCLGMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBlc2xpbnQtZGlzYWJsZSBjYW1lbGNhc2UgKi9cbmltcG9ydCBSZWFjdCwge1xuICB1c2VTdGF0ZSwgdXNlQ2FsbGJhY2ssIHVzZUNvbnRleHQsXG59IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7XG4gIEljb25CdXR0b24sXG4gIEF2YXRhcixcbiAgTW9kYWwsXG4gIFBhcGVyLFxuICBDaGlwLFxufSBmcm9tICdAbWF0ZXJpYWwtdWkvY29yZSc7XG5pbXBvcnQgeyBGb2xkZXJTaGFyZWQgfSBmcm9tICdAbWF0ZXJpYWwtdWkvaWNvbnMnO1xuXG5pbXBvcnQgeyB1c2VTdHlsZXMgfSBmcm9tICcuL3VzZVN0eWxlcyc7XG5pbXBvcnQgeyBSZXBvc2l0b3J5Q29udGV4dCwgRmlsZUNvbnRleHQgfSBmcm9tICcuLic7XG5cbmZ1bmN0aW9uIFJlcG9zaXRvcnlNZW51KCkge1xuICBjb25zdCBjbGFzc2VzID0gdXNlU3R5bGVzKCk7XG4gIGNvbnN0IFttb2RhbCwgc2V0TW9kYWxdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCB7XG4gICAgc3RhdGU6IHJlcG9zaXRvcnksXG4gICAgYWN0aW9ucyxcbiAgICBjb21wb25lbnQ6IHJlcG9zaXRvcnlDb21wb25lbnQsXG4gIH0gPSB1c2VDb250ZXh0KFJlcG9zaXRvcnlDb250ZXh0KSB8fCB7fTtcbiAgXG4gIGNvbnN0IHsgc3RhdGU6IGZpbGUsIHN0YXRlVmFsdWVzOiBmaWxlU3RhdGVWYWx1ZXMsIGFjdGlvbnM6IGZpbGVBY3Rpb25zIH0gPSB1c2VDb250ZXh0KEZpbGVDb250ZXh0KSB8fCB7fTtcblxuICBjb25zdCB7XG4gICAgbmFtZSxcbiAgICBhdmF0YXJfdXJsLFxuICAgIG93bmVyLFxuICAgIGZ1bGxfbmFtZSxcbiAgfSA9IHJlcG9zaXRvcnkgfHwge307XG5cbiAgY29uc3QgX29uRGVsZXRlID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGlmIChhY3Rpb25zPy5jbG9zZSkge1xuICAgICAgaWYgKGZpbGVBY3Rpb25zPy5vbkNvbmZpcm1DbG9zZSkge1xuICAgICAgICBpZiAoZmlsZUFjdGlvbnMub25Db25maXJtQ2xvc2UoKSlcbiAgICAgICAge1xuICAgICAgICAgIGFjdGlvbnMuY2xvc2UoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZWxzZVxuICAgICAge1xuICAgICAgICBhY3Rpb25zLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfVxuICB9LFthY3Rpb25zLmNsb3NlLCBmaWxlLCBmaWxlQWN0aW9ucz8ub25Db25maXJtQ2xvc2VdKTtcblxuICBjb25zdCBoYW5kbGVPcGVuID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIHNldE1vZGFsKHRydWUpO1xuICB9LCBbXSk7XG5cbiAgbGV0IGJ1dHRvbjtcblxuICBpZiAobmFtZSAmJiBvd25lcikge1xuICAgIGNvbnN0IGF2YXRhckNvbXBvbmVudCA9IDxBdmF0YXIgc3JjPXthdmF0YXJfdXJsIHx8IG93bmVyLmF2YXRhcl91cmx9IC8+O1xuXG4gICAgYnV0dG9uID0gKFxuICAgICAgPENoaXBcbiAgICAgICAgaWQ9e2BjaGlwXyR7bmFtZX1gfVxuICAgICAgICBkYXRhLXRlc3Q9XCJyZXBvc2l0b3J5LWl0ZW0taWNvblwiXG4gICAgICAgIGFyaWEtbGFiZWw9XCJyZXBvc2l0b3J5LWl0ZW0taWNvblwiXG4gICAgICAgIGF2YXRhcj17YXZhdGFyQ29tcG9uZW50fVxuICAgICAgICBsYWJlbD17PHNwYW4gZGF0YS10ZXN0PVwicmVwb3NpdG9yeS1pdGVtLWNoaXBcIj57bmFtZX08L3NwYW4+fVxuICAgICAgICBvbkRlbGV0ZT17X29uRGVsZXRlfVxuICAgICAgICBjb2xvcj1cInByaW1hcnlcIlxuICAgICAgLz5cbiAgICApO1xuICB9IGVsc2Uge1xuICAgIGJ1dHRvbiA9IChcbiAgICAgIDxJY29uQnV0dG9uIG9uQ2xpY2s9e2hhbmRsZU9wZW59IGNvbG9yPVwiaW5oZXJpdFwiPlxuICAgICAgICA8Rm9sZGVyU2hhcmVkIC8+XG4gICAgICA8L0ljb25CdXR0b24+XG4gICAgKTtcbiAgfTtcblxuICBsZXQgbW9kYWxDb21wb25lbnQgPSA8PjwvPjtcblxuICBpZiAobW9kYWwgJiYgIWZ1bGxfbmFtZSkge1xuICAgIG1vZGFsQ29tcG9uZW50ID0gKFxuICAgICAgPE1vZGFsIGRhdGEtdGVzdD1cInJlcG9zaXRvcnktbWVudS1tb2RhbFwiIG9wZW49e3RydWV9IG9uQ2xvc2U9eygpID0+IHNldE1vZGFsKGZhbHNlKX0+XG4gICAgICAgIDxQYXBlciBjbGFzc05hbWU9e2NsYXNzZXMubW9kYWx9PlxuICAgICAgICAgIHtyZXBvc2l0b3J5Q29tcG9uZW50fVxuICAgICAgICA8L1BhcGVyPlxuICAgICAgPC9Nb2RhbD5cbiAgICApO1xuICB9O1xuXG4gIHJldHVybiAoXG4gICAgPGRpdiBkYXRhLXRlc3Q9XCJyZXBvc2l0b3J5LW1lbnVcIj5cbiAgICAgIHtidXR0b259XG4gICAgICB7bW9kYWxDb21wb25lbnR9XG4gICAgPC9kaXY+XG4gICk7XG59O1xuXG5SZXBvc2l0b3J5TWVudS5wcm9wVHlwZXMgPSB7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBSZXBvc2l0b3J5TWVudTtcbiJdfQ==