"use strict";

function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _react = _interopRequireWildcard(require("react"));

var _core = require("@material-ui/core");

var _icons = require("@material-ui/icons");

var _useStyles = require("./useStyles");

var _ = require("..");

function _getRequireWildcardCache() { if (typeof WeakMap !== "function") return null; var cache = new WeakMap(); _getRequireWildcardCache = function _getRequireWildcardCache() { return cache; }; return cache; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _iterableToArrayLimit(arr, i) { if (typeof Symbol === "undefined" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

function RepositoryMenu() {
  var classes = (0, _useStyles.useStyles)();

  var _useState = (0, _react.useState)(false),
      _useState2 = _slicedToArray(_useState, 2),
      modal = _useState2[0],
      setModal = _useState2[1];

  var _ref = (0, _react.useContext)(_.RepositoryContext) || {},
      repository = _ref.state,
      actions = _ref.actions,
      repositoryComponent = _ref.component;

  var _ref2 = (0, _react.useContext)(_.FileContext) || {},
      file = _ref2.state,
      fileStateValues = _ref2.stateValues,
      fileActions = _ref2.actions;

  var _ref3 = repository || {},
      name = _ref3.name,
      avatar_url = _ref3.avatar_url,
      owner = _ref3.owner,
      full_name = _ref3.full_name;

  var _onDelete = (0, _react.useCallback)(function () {
    if (file && actions !== null && actions !== void 0 && actions.close) {
      if (fileActions !== null && fileActions !== void 0 && fileActions.onConfirmClose) {
        if (fileActions.onConfirmClose()) {
          actions.close();
        }
      } else {
        actions.close();
      }
    }
  }, [actions.close, file, fileActions === null || fileActions === void 0 ? void 0 : fileActions.onConfirmClose]);

  var handleOpen = (0, _react.useCallback)(function () {
    setModal(true);
  }, []);
  var button;

  if (name && owner) {
    var avatarComponent = /*#__PURE__*/_react.default.createElement(_core.Avatar, {
      src: avatar_url || owner.avatar_url
    });

    button = /*#__PURE__*/_react.default.createElement(_core.Chip, {
      "data-test": "repository-item-icon",
      "aria-label": "repository-item-icon",
      avatar: avatarComponent,
      label: /*#__PURE__*/_react.default.createElement("span", {
        "data-test": "repository-item-chip"
      }, name),
      onDelete: _onDelete,
      color: "primary"
    });
  } else {
    button = /*#__PURE__*/_react.default.createElement(_core.IconButton, {
      onClick: handleOpen,
      color: "inherit"
    }, /*#__PURE__*/_react.default.createElement(_icons.FolderShared, null));
  }

  ;

  var modalComponent = /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null);

  if (modal && !full_name) {
    modalComponent = /*#__PURE__*/_react.default.createElement(_core.Modal, {
      "data-test": "repository-menu-modal",
      open: true,
      onClose: function onClose() {
        return setModal(false);
      }
    }, /*#__PURE__*/_react.default.createElement(_core.Paper, {
      className: classes.modal
    }, repositoryComponent));
  }

  ;
  return /*#__PURE__*/_react.default.createElement("div", {
    "data-test": "repository-menu"
  }, button, modalComponent);
}

;
RepositoryMenu.propTypes = {};
var _default = RepositoryMenu;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21wb25lbnRzL2FwcGxpY2F0aW9uLWJhci9SZXBvc2l0b3J5TWVudS5qcyJdLCJuYW1lcyI6WyJSZXBvc2l0b3J5TWVudSIsImNsYXNzZXMiLCJtb2RhbCIsInNldE1vZGFsIiwiUmVwb3NpdG9yeUNvbnRleHQiLCJyZXBvc2l0b3J5Iiwic3RhdGUiLCJhY3Rpb25zIiwicmVwb3NpdG9yeUNvbXBvbmVudCIsImNvbXBvbmVudCIsIkZpbGVDb250ZXh0IiwiZmlsZSIsImZpbGVTdGF0ZVZhbHVlcyIsInN0YXRlVmFsdWVzIiwiZmlsZUFjdGlvbnMiLCJuYW1lIiwiYXZhdGFyX3VybCIsIm93bmVyIiwiZnVsbF9uYW1lIiwiX29uRGVsZXRlIiwiY2xvc2UiLCJvbkNvbmZpcm1DbG9zZSIsImhhbmRsZU9wZW4iLCJidXR0b24iLCJhdmF0YXJDb21wb25lbnQiLCJtb2RhbENvbXBvbmVudCIsInByb3BUeXBlcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQ0E7O0FBR0E7O0FBT0E7O0FBRUE7O0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUVBLFNBQVNBLGNBQVQsR0FBMEI7QUFDeEIsTUFBTUMsT0FBTyxHQUFHLDJCQUFoQjs7QUFEd0Isa0JBRUUscUJBQVMsS0FBVCxDQUZGO0FBQUE7QUFBQSxNQUVqQkMsS0FGaUI7QUFBQSxNQUVWQyxRQUZVOztBQUFBLGFBT3BCLHVCQUFXQyxtQkFBWCxLQUFpQyxFQVBiO0FBQUEsTUFJZkMsVUFKZSxRQUl0QkMsS0FKc0I7QUFBQSxNQUt0QkMsT0FMc0IsUUFLdEJBLE9BTHNCO0FBQUEsTUFNWEMsbUJBTlcsUUFNdEJDLFNBTnNCOztBQUFBLGNBU29ELHVCQUFXQyxhQUFYLEtBQTJCLEVBVC9FO0FBQUEsTUFTVEMsSUFUUyxTQVNoQkwsS0FUZ0I7QUFBQSxNQVNVTSxlQVRWLFNBU0hDLFdBVEc7QUFBQSxNQVNvQ0MsV0FUcEMsU0FTMkJQLE9BVDNCOztBQUFBLGNBZ0JwQkYsVUFBVSxJQUFJLEVBaEJNO0FBQUEsTUFZdEJVLElBWnNCLFNBWXRCQSxJQVpzQjtBQUFBLE1BYXRCQyxVQWJzQixTQWF0QkEsVUFic0I7QUFBQSxNQWN0QkMsS0Fkc0IsU0FjdEJBLEtBZHNCO0FBQUEsTUFldEJDLFNBZnNCLFNBZXRCQSxTQWZzQjs7QUFrQnhCLE1BQU1DLFNBQVMsR0FBRyx3QkFBWSxZQUFNO0FBQ2xDLFFBQUlSLElBQUksSUFBSUosT0FBSixhQUFJQSxPQUFKLGVBQUlBLE9BQU8sQ0FBRWEsS0FBckIsRUFBNEI7QUFDMUIsVUFBSU4sV0FBSixhQUFJQSxXQUFKLGVBQUlBLFdBQVcsQ0FBRU8sY0FBakIsRUFBaUM7QUFDL0IsWUFBSVAsV0FBVyxDQUFDTyxjQUFaLEVBQUosRUFDQTtBQUNFZCxVQUFBQSxPQUFPLENBQUNhLEtBQVI7QUFDRDtBQUNGLE9BTEQsTUFPQTtBQUNFYixRQUFBQSxPQUFPLENBQUNhLEtBQVI7QUFDRDtBQUNGO0FBQ0YsR0FiaUIsRUFhaEIsQ0FBQ2IsT0FBTyxDQUFDYSxLQUFULEVBQWdCVCxJQUFoQixFQUFzQkcsV0FBdEIsYUFBc0JBLFdBQXRCLHVCQUFzQkEsV0FBVyxDQUFFTyxjQUFuQyxDQWJnQixDQUFsQjs7QUFlQSxNQUFNQyxVQUFVLEdBQUcsd0JBQVksWUFBTTtBQUNuQ25CLElBQUFBLFFBQVEsQ0FBQyxJQUFELENBQVI7QUFDRCxHQUZrQixFQUVoQixFQUZnQixDQUFuQjtBQUlBLE1BQUlvQixNQUFKOztBQUVBLE1BQUlSLElBQUksSUFBSUUsS0FBWixFQUFtQjtBQUNqQixRQUFNTyxlQUFlLGdCQUFHLDZCQUFDLFlBQUQ7QUFBUSxNQUFBLEdBQUcsRUFBRVIsVUFBVSxJQUFJQyxLQUFLLENBQUNEO0FBQWpDLE1BQXhCOztBQUVBTyxJQUFBQSxNQUFNLGdCQUNKLDZCQUFDLFVBQUQ7QUFDRSxtQkFBVSxzQkFEWjtBQUVFLG9CQUFXLHNCQUZiO0FBR0UsTUFBQSxNQUFNLEVBQUVDLGVBSFY7QUFJRSxNQUFBLEtBQUssZUFBRTtBQUFNLHFCQUFVO0FBQWhCLFNBQXdDVCxJQUF4QyxDQUpUO0FBS0UsTUFBQSxRQUFRLEVBQUVJLFNBTFo7QUFNRSxNQUFBLEtBQUssRUFBQztBQU5SLE1BREY7QUFVRCxHQWJELE1BYU87QUFDTEksSUFBQUEsTUFBTSxnQkFDSiw2QkFBQyxnQkFBRDtBQUFZLE1BQUEsT0FBTyxFQUFFRCxVQUFyQjtBQUFpQyxNQUFBLEtBQUssRUFBQztBQUF2QyxvQkFDRSw2QkFBQyxtQkFBRCxPQURGLENBREY7QUFLRDs7QUFBQTs7QUFFRCxNQUFJRyxjQUFjLGdCQUFHLDJEQUFyQjs7QUFFQSxNQUFJdkIsS0FBSyxJQUFJLENBQUNnQixTQUFkLEVBQXlCO0FBQ3ZCTyxJQUFBQSxjQUFjLGdCQUNaLDZCQUFDLFdBQUQ7QUFBTyxtQkFBVSx1QkFBakI7QUFBeUMsTUFBQSxJQUFJLEVBQUUsSUFBL0M7QUFBcUQsTUFBQSxPQUFPLEVBQUU7QUFBQSxlQUFNdEIsUUFBUSxDQUFDLEtBQUQsQ0FBZDtBQUFBO0FBQTlELG9CQUNFLDZCQUFDLFdBQUQ7QUFBTyxNQUFBLFNBQVMsRUFBRUYsT0FBTyxDQUFDQztBQUExQixPQUNHTSxtQkFESCxDQURGLENBREY7QUFPRDs7QUFBQTtBQUVELHNCQUNFO0FBQUssaUJBQVU7QUFBZixLQUNHZSxNQURILEVBRUdFLGNBRkgsQ0FERjtBQU1EOztBQUFBO0FBRUR6QixjQUFjLENBQUMwQixTQUFmLEdBQTJCLEVBQTNCO2VBR2UxQixjIiwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgY2FtZWxjYXNlICovXHJcbmltcG9ydCBSZWFjdCwge1xyXG4gIHVzZVN0YXRlLCB1c2VDYWxsYmFjaywgdXNlQ29udGV4dCxcclxufSBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7XHJcbiAgSWNvbkJ1dHRvbixcclxuICBBdmF0YXIsXHJcbiAgTW9kYWwsXHJcbiAgUGFwZXIsXHJcbiAgQ2hpcCxcclxufSBmcm9tICdAbWF0ZXJpYWwtdWkvY29yZSc7XHJcbmltcG9ydCB7IEZvbGRlclNoYXJlZCB9IGZyb20gJ0BtYXRlcmlhbC11aS9pY29ucyc7XHJcblxyXG5pbXBvcnQgeyB1c2VTdHlsZXMgfSBmcm9tICcuL3VzZVN0eWxlcyc7XHJcbmltcG9ydCB7IFJlcG9zaXRvcnlDb250ZXh0LCBGaWxlQ29udGV4dCB9IGZyb20gJy4uJztcclxuXHJcbmZ1bmN0aW9uIFJlcG9zaXRvcnlNZW51KCkge1xyXG4gIGNvbnN0IGNsYXNzZXMgPSB1c2VTdHlsZXMoKTtcclxuICBjb25zdCBbbW9kYWwsIHNldE1vZGFsXSA9IHVzZVN0YXRlKGZhbHNlKTtcclxuICBjb25zdCB7XHJcbiAgICBzdGF0ZTogcmVwb3NpdG9yeSxcclxuICAgIGFjdGlvbnMsXHJcbiAgICBjb21wb25lbnQ6IHJlcG9zaXRvcnlDb21wb25lbnQsXHJcbiAgfSA9IHVzZUNvbnRleHQoUmVwb3NpdG9yeUNvbnRleHQpIHx8IHt9O1xyXG4gIFxyXG4gIGNvbnN0IHsgc3RhdGU6IGZpbGUsIHN0YXRlVmFsdWVzOiBmaWxlU3RhdGVWYWx1ZXMsIGFjdGlvbnM6IGZpbGVBY3Rpb25zIH0gPSB1c2VDb250ZXh0KEZpbGVDb250ZXh0KSB8fCB7fTtcclxuXHJcbiAgY29uc3Qge1xyXG4gICAgbmFtZSxcclxuICAgIGF2YXRhcl91cmwsXHJcbiAgICBvd25lcixcclxuICAgIGZ1bGxfbmFtZSxcclxuICB9ID0gcmVwb3NpdG9yeSB8fCB7fTtcclxuXHJcbiAgY29uc3QgX29uRGVsZXRlID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xyXG4gICAgaWYgKGZpbGUgJiYgYWN0aW9ucz8uY2xvc2UpIHtcclxuICAgICAgaWYgKGZpbGVBY3Rpb25zPy5vbkNvbmZpcm1DbG9zZSkge1xyXG4gICAgICAgIGlmIChmaWxlQWN0aW9ucy5vbkNvbmZpcm1DbG9zZSgpKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgIGFjdGlvbnMuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZWxzZVxyXG4gICAgICB7XHJcbiAgICAgICAgYWN0aW9ucy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSxbYWN0aW9ucy5jbG9zZSwgZmlsZSwgZmlsZUFjdGlvbnM/Lm9uQ29uZmlybUNsb3NlXSk7XHJcblxyXG4gIGNvbnN0IGhhbmRsZU9wZW4gPSB1c2VDYWxsYmFjaygoKSA9PiB7XHJcbiAgICBzZXRNb2RhbCh0cnVlKTtcclxuICB9LCBbXSk7XHJcblxyXG4gIGxldCBidXR0b247XHJcblxyXG4gIGlmIChuYW1lICYmIG93bmVyKSB7XHJcbiAgICBjb25zdCBhdmF0YXJDb21wb25lbnQgPSA8QXZhdGFyIHNyYz17YXZhdGFyX3VybCB8fCBvd25lci5hdmF0YXJfdXJsfSAvPjtcclxuXHJcbiAgICBidXR0b24gPSAoXHJcbiAgICAgIDxDaGlwXHJcbiAgICAgICAgZGF0YS10ZXN0PVwicmVwb3NpdG9yeS1pdGVtLWljb25cIlxyXG4gICAgICAgIGFyaWEtbGFiZWw9XCJyZXBvc2l0b3J5LWl0ZW0taWNvblwiXHJcbiAgICAgICAgYXZhdGFyPXthdmF0YXJDb21wb25lbnR9XHJcbiAgICAgICAgbGFiZWw9ezxzcGFuIGRhdGEtdGVzdD1cInJlcG9zaXRvcnktaXRlbS1jaGlwXCI+e25hbWV9PC9zcGFuPn1cclxuICAgICAgICBvbkRlbGV0ZT17X29uRGVsZXRlfVxyXG4gICAgICAgIGNvbG9yPVwicHJpbWFyeVwiXHJcbiAgICAgIC8+XHJcbiAgICApO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBidXR0b24gPSAoXHJcbiAgICAgIDxJY29uQnV0dG9uIG9uQ2xpY2s9e2hhbmRsZU9wZW59IGNvbG9yPVwiaW5oZXJpdFwiPlxyXG4gICAgICAgIDxGb2xkZXJTaGFyZWQgLz5cclxuICAgICAgPC9JY29uQnV0dG9uPlxyXG4gICAgKTtcclxuICB9O1xyXG5cclxuICBsZXQgbW9kYWxDb21wb25lbnQgPSA8PjwvPjtcclxuXHJcbiAgaWYgKG1vZGFsICYmICFmdWxsX25hbWUpIHtcclxuICAgIG1vZGFsQ29tcG9uZW50ID0gKFxyXG4gICAgICA8TW9kYWwgZGF0YS10ZXN0PVwicmVwb3NpdG9yeS1tZW51LW1vZGFsXCIgb3Blbj17dHJ1ZX0gb25DbG9zZT17KCkgPT4gc2V0TW9kYWwoZmFsc2UpfT5cclxuICAgICAgICA8UGFwZXIgY2xhc3NOYW1lPXtjbGFzc2VzLm1vZGFsfT5cclxuICAgICAgICAgIHtyZXBvc2l0b3J5Q29tcG9uZW50fVxyXG4gICAgICAgIDwvUGFwZXI+XHJcbiAgICAgIDwvTW9kYWw+XHJcbiAgICApO1xyXG4gIH07XHJcblxyXG4gIHJldHVybiAoXHJcbiAgICA8ZGl2IGRhdGEtdGVzdD1cInJlcG9zaXRvcnktbWVudVwiPlxyXG4gICAgICB7YnV0dG9ufVxyXG4gICAgICB7bW9kYWxDb21wb25lbnR9XHJcbiAgICA8L2Rpdj5cclxuICApO1xyXG59O1xyXG5cclxuUmVwb3NpdG9yeU1lbnUucHJvcFR5cGVzID0ge1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgUmVwb3NpdG9yeU1lbnU7XHJcbiJdfQ==