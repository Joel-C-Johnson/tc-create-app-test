"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.markdownFromSections = exports.sectionsFromMarkdown = exports.markdownFromBlocks = exports.blocksFromMarkdown = void 0;

var blocksFromMarkdown = function blocksFromMarkdown(_ref) {
  var markdown = _ref.markdown;
  var blocks = markdown.replace(/<br>/gi, '\n').split(/\n\n/g);
  var _blocks = [];
  blocks.forEach(function (block) {
    // Delete a block by emptying it.
    if (block.length > 0) {
      _blocks.push(block);
    }
  });

  if (_blocks.length == 0) {
    _blocks.push("");
  }

  return _blocks;
};

exports.blocksFromMarkdown = blocksFromMarkdown;

var markdownFromBlocks = function markdownFromBlocks(_ref2) {
  var blocks = _ref2.blocks;
  return blocks.join("\n\n");
};

exports.markdownFromBlocks = markdownFromBlocks;

var sectionsFromMarkdown = function sectionsFromMarkdown(_ref3) {
  var markdown = _ref3.markdown;
  var sections = [];
  var section = [];
  var blocks = markdown.replace(/<br>/gi, '\n').split(/\n\n/g);
  blocks.forEach(function (block) {
    var headingRegex = /^\s?#+/;
    var heading = headingRegex.test(block);

    if (section.length > 0 && heading) {
      sections.push(section);
      section = [];
    } // Delete a block by emptying it.


    if (block.length > 0) {
      section.push(block);
    }
  }); // don't leave a dangling section (orphaned)

  if (section !== []) {
    sections.push(section);
    section = [];
  } // Don't allow empty section,
  // (since originalBlocks will be compared to translationBlock).


  if (sections.length == 0) {
    sections.push("");
  }

  sections = sections.map(function (blocks) {
    return blocks.join("\n\n");
  });
  return sections;
};

exports.sectionsFromMarkdown = sectionsFromMarkdown;

var markdownFromSections = function markdownFromSections(_ref4) {
  var sections = _ref4.sections;
  return sections.join("\n\n");
};

exports.markdownFromSections = markdownFromSections;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb3JlL21hcmtkb3duLnRzIl0sIm5hbWVzIjpbImJsb2Nrc0Zyb21NYXJrZG93biIsIm1hcmtkb3duIiwiYmxvY2tzIiwicmVwbGFjZSIsInNwbGl0IiwiX2Jsb2NrcyIsImZvckVhY2giLCJibG9jayIsImxlbmd0aCIsInB1c2giLCJtYXJrZG93bkZyb21CbG9ja3MiLCJqb2luIiwic2VjdGlvbnNGcm9tTWFya2Rvd24iLCJzZWN0aW9ucyIsInNlY3Rpb24iLCJoZWFkaW5nUmVnZXgiLCJoZWFkaW5nIiwidGVzdCIsIm1hcCIsIm1hcmtkb3duRnJvbVNlY3Rpb25zIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQU8sSUFBTUEsa0JBQWtCLEdBQUcsU0FBckJBLGtCQUFxQixPQUFrQjtBQUFBLE1BQWZDLFFBQWUsUUFBZkEsUUFBZTtBQUNsRCxNQUFNQyxNQUFNLEdBQUdELFFBQVEsQ0FBQ0UsT0FBVCxDQUFpQixRQUFqQixFQUEyQixJQUEzQixFQUFpQ0MsS0FBakMsQ0FBdUMsT0FBdkMsQ0FBZjtBQUVBLE1BQU1DLE9BQU8sR0FBRyxFQUFoQjtBQUNBSCxFQUFBQSxNQUFNLENBQUNJLE9BQVAsQ0FBZSxVQUFDQyxLQUFELEVBQVc7QUFDeEI7QUFDQSxRQUFJQSxLQUFLLENBQUNDLE1BQU4sR0FBZSxDQUFuQixFQUFzQjtBQUNwQkgsTUFBQUEsT0FBTyxDQUFDSSxJQUFSLENBQWFGLEtBQWI7QUFDRDtBQUNGLEdBTEQ7O0FBT0EsTUFBSUYsT0FBTyxDQUFDRyxNQUFSLElBQWtCLENBQXRCLEVBQXlCO0FBQ3ZCSCxJQUFBQSxPQUFPLENBQUNJLElBQVIsQ0FBYSxFQUFiO0FBQ0Q7O0FBRUQsU0FBT0osT0FBUDtBQUNELENBaEJNOzs7O0FBa0JBLElBQU1LLGtCQUFrQixHQUFHLFNBQXJCQSxrQkFBcUI7QUFBQSxNQUFHUixNQUFILFNBQUdBLE1BQUg7QUFBQSxTQUFnQkEsTUFBTSxDQUFDUyxJQUFQLFFBQWhCO0FBQUEsQ0FBM0I7Ozs7QUFFQSxJQUFNQyxvQkFBb0IsR0FBRyxTQUF2QkEsb0JBQXVCLFFBQWtCO0FBQUEsTUFBZlgsUUFBZSxTQUFmQSxRQUFlO0FBQ3BELE1BQUlZLFFBQWEsR0FBRyxFQUFwQjtBQUNBLE1BQUlDLE9BQWlCLEdBQUcsRUFBeEI7QUFDQSxNQUFNWixNQUFNLEdBQUdELFFBQVEsQ0FBQ0UsT0FBVCxDQUFpQixRQUFqQixFQUEyQixJQUEzQixFQUFpQ0MsS0FBakMsQ0FBdUMsT0FBdkMsQ0FBZjtBQUVBRixFQUFBQSxNQUFNLENBQUNJLE9BQVAsQ0FBZSxVQUFDQyxLQUFELEVBQVc7QUFDeEIsUUFBTVEsWUFBWSxHQUFHLFFBQXJCO0FBQ0EsUUFBTUMsT0FBTyxHQUFHRCxZQUFZLENBQUNFLElBQWIsQ0FBa0JWLEtBQWxCLENBQWhCOztBQUVBLFFBQUlPLE9BQU8sQ0FBQ04sTUFBUixHQUFpQixDQUFqQixJQUFzQlEsT0FBMUIsRUFBbUM7QUFDakNILE1BQUFBLFFBQVEsQ0FBQ0osSUFBVCxDQUFjSyxPQUFkO0FBQ0FBLE1BQUFBLE9BQU8sR0FBRyxFQUFWO0FBQ0QsS0FQdUIsQ0FReEI7OztBQUNBLFFBQUlQLEtBQUssQ0FBQ0MsTUFBTixHQUFlLENBQW5CLEVBQXNCO0FBQ3BCTSxNQUFBQSxPQUFPLENBQUNMLElBQVIsQ0FBYUYsS0FBYjtBQUNEO0FBQ0YsR0FaRCxFQUxvRCxDQWtCcEQ7O0FBQ0EsTUFBSU8sT0FBTyxLQUFLLEVBQWhCLEVBQW9CO0FBQ2xCRCxJQUFBQSxRQUFRLENBQUNKLElBQVQsQ0FBY0ssT0FBZDtBQUNBQSxJQUFBQSxPQUFPLEdBQUcsRUFBVjtBQUNELEdBdEJtRCxDQXVCcEQ7QUFDQTs7O0FBQ0EsTUFBSUQsUUFBUSxDQUFDTCxNQUFULElBQW1CLENBQXZCLEVBQTBCO0FBQ3hCSyxJQUFBQSxRQUFRLENBQUNKLElBQVQsQ0FBYyxFQUFkO0FBQ0Q7O0FBRURJLEVBQUFBLFFBQVEsR0FBR0EsUUFBUSxDQUFDSyxHQUFULENBQWEsVUFBQ2hCLE1BQUQ7QUFBQSxXQUFZQSxNQUFNLENBQUNTLElBQVAsUUFBWjtBQUFBLEdBQWIsQ0FBWDtBQUVBLFNBQU9FLFFBQVA7QUFDRCxDQWhDTTs7OztBQWtDQSxJQUFNTSxvQkFBb0IsR0FBRyxTQUF2QkEsb0JBQXVCO0FBQUEsTUFBR04sUUFBSCxTQUFHQSxRQUFIO0FBQUEsU0FBa0JBLFFBQVEsQ0FBQ0YsSUFBVCxRQUFsQjtBQUFBLENBQTdCIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IGJsb2Nrc0Zyb21NYXJrZG93biA9ICh7IG1hcmtkb3duIH0pID0+IHtcclxuICBjb25zdCBibG9ja3MgPSBtYXJrZG93bi5yZXBsYWNlKC88YnI+L2dpLCAnXFxuJykuc3BsaXQoL1xcblxcbi9nKTtcclxuXHJcbiAgY29uc3QgX2Jsb2NrcyA9IFtdO1xyXG4gIGJsb2Nrcy5mb3JFYWNoKChibG9jaykgPT4ge1xyXG4gICAgLy8gRGVsZXRlIGEgYmxvY2sgYnkgZW1wdHlpbmcgaXQuXHJcbiAgICBpZiAoYmxvY2subGVuZ3RoID4gMCkge1xyXG4gICAgICBfYmxvY2tzLnB1c2goYmxvY2spO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICBpZiAoX2Jsb2Nrcy5sZW5ndGggPT0gMCkge1xyXG4gICAgX2Jsb2Nrcy5wdXNoKFwiXCIpO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIF9ibG9ja3M7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgbWFya2Rvd25Gcm9tQmxvY2tzID0gKHsgYmxvY2tzIH0pID0+IGJsb2Nrcy5qb2luKGBcXG5cXG5gKTtcclxuXHJcbmV4cG9ydCBjb25zdCBzZWN0aW9uc0Zyb21NYXJrZG93biA9ICh7IG1hcmtkb3duIH0pID0+IHtcclxuICBsZXQgc2VjdGlvbnM6IGFueSA9IFtdO1xyXG4gIGxldCBzZWN0aW9uOiBzdHJpbmdbXSA9IFtdO1xyXG4gIGNvbnN0IGJsb2NrcyA9IG1hcmtkb3duLnJlcGxhY2UoLzxicj4vZ2ksICdcXG4nKS5zcGxpdCgvXFxuXFxuL2cpO1xyXG5cclxuICBibG9ja3MuZm9yRWFjaCgoYmxvY2spID0+IHtcclxuICAgIGNvbnN0IGhlYWRpbmdSZWdleCA9IC9eXFxzPyMrLztcclxuICAgIGNvbnN0IGhlYWRpbmcgPSBoZWFkaW5nUmVnZXgudGVzdChibG9jayk7XHJcblxyXG4gICAgaWYgKHNlY3Rpb24ubGVuZ3RoID4gMCAmJiBoZWFkaW5nKSB7XHJcbiAgICAgIHNlY3Rpb25zLnB1c2goc2VjdGlvbik7XHJcbiAgICAgIHNlY3Rpb24gPSBbXTtcclxuICAgIH1cclxuICAgIC8vIERlbGV0ZSBhIGJsb2NrIGJ5IGVtcHR5aW5nIGl0LlxyXG4gICAgaWYgKGJsb2NrLmxlbmd0aCA+IDApIHtcclxuICAgICAgc2VjdGlvbi5wdXNoKGJsb2NrKTtcclxuICAgIH1cclxuICB9KTtcclxuICAvLyBkb24ndCBsZWF2ZSBhIGRhbmdsaW5nIHNlY3Rpb24gKG9ycGhhbmVkKVxyXG4gIGlmIChzZWN0aW9uICE9PSBbXSkge1xyXG4gICAgc2VjdGlvbnMucHVzaChzZWN0aW9uKTtcclxuICAgIHNlY3Rpb24gPSBbXTtcclxuICB9XHJcbiAgLy8gRG9uJ3QgYWxsb3cgZW1wdHkgc2VjdGlvbixcclxuICAvLyAoc2luY2Ugb3JpZ2luYWxCbG9ja3Mgd2lsbCBiZSBjb21wYXJlZCB0byB0cmFuc2xhdGlvbkJsb2NrKS5cclxuICBpZiAoc2VjdGlvbnMubGVuZ3RoID09IDApIHtcclxuICAgIHNlY3Rpb25zLnB1c2goXCJcIik7XHJcbiAgfVxyXG5cclxuICBzZWN0aW9ucyA9IHNlY3Rpb25zLm1hcCgoYmxvY2tzKSA9PiBibG9ja3Muam9pbihgXFxuXFxuYCkpO1xyXG5cclxuICByZXR1cm4gc2VjdGlvbnM7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgbWFya2Rvd25Gcm9tU2VjdGlvbnMgPSAoeyBzZWN0aW9ucyB9KSA9PiBzZWN0aW9ucy5qb2luKGBcXG5cXG5gKTtcclxuIl19