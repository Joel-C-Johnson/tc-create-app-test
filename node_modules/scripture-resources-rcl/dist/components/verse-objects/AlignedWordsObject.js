"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _react = _interopRequireWildcard(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _styles = require("@material-ui/core/styles");

var _core = require("@material-ui/core");

var _Selections = require("../selections/Selections.context");

var _ = require(".");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _getRequireWildcardCache() { if (typeof WeakMap !== "function") return null; var cache = new WeakMap(); _getRequireWildcardCache = function _getRequireWildcardCache() { return cache; }; return cache; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function cov_280equv70u() {
  var path = "D:\\Projects-unfoldingWord\\scripture-resources-rcl\\src\\components\\verse-objects\\AlignedWordsObject.js";
  var hash = "980fd11493b39964ead116890d92b37f76291cae";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "D:\\Projects-unfoldingWord\\scripture-resources-rcl\\src\\components\\verse-objects\\AlignedWordsObject.js",
    statementMap: {
      "0": {
        start: {
          line: 11,
          column: 18
        },
        end: {
          line: 11,
          column: 29
        }
      },
      "1": {
        start: {
          line: 12,
          column: 34
        },
        end: {
          line: 12,
          column: 48
        }
      },
      "2": {
        start: {
          line: 14,
          column: 21
        },
        end: {
          line: 16,
          column: 3
        }
      },
      "3": {
        start: {
          line: 15,
          column: 4
        },
        end: {
          line: 15,
          column: 37
        }
      },
      "4": {
        start: {
          line: 18,
          column: 22
        },
        end: {
          line: 20,
          column: 3
        }
      },
      "5": {
        start: {
          line: 19,
          column: 4
        },
        end: {
          line: 19,
          column: 22
        }
      },
      "6": {
        start: {
          line: 25,
          column: 29
        },
        end: {
          line: 25,
          column: 58
        }
      },
      "7": {
        start: {
          line: 27,
          column: 2
        },
        end: {
          line: 33,
          column: 3
        }
      },
      "8": {
        start: {
          line: 31,
          column: 8
        },
        end: {
          line: 31,
          column: 26
        }
      },
      "9": {
        start: {
          line: 32,
          column: 4
        },
        end: {
          line: 32,
          column: 42
        }
      },
      "10": {
        start: {
          line: 35,
          column: 16
        },
        end: {
          line: 47,
          column: 4
        }
      },
      "11": {
        start: {
          line: 36,
          column: 4
        },
        end: {
          line: 46,
          column: 11
        }
      },
      "12": {
        start: {
          line: 49,
          column: 18
        },
        end: {
          line: 49,
          column: 23
        }
      },
      "13": {
        start: {
          line: 51,
          column: 2
        },
        end: {
          line: 90,
          column: 3
        }
      },
      "14": {
        start: {
          line: 52,
          column: 17
        },
        end: {
          line: 52,
          column: 34
        }
      },
      "15": {
        start: {
          line: 53,
          column: 15
        },
        end: {
          line: 53,
          column: 43
        }
      },
      "16": {
        start: {
          line: 54,
          column: 27
        },
        end: {
          line: 56,
          column: 6
        }
      },
      "17": {
        start: {
          line: 55,
          column: 6
        },
        end: {
          line: 55,
          column: 66
        }
      },
      "18": {
        start: {
          line: 58,
          column: 4
        },
        end: {
          line: 89,
          column: 6
        }
      },
      "19": {
        start: {
          line: 92,
          column: 2
        },
        end: {
          line: 92,
          column: 26
        }
      },
      "20": {
        start: {
          line: 95,
          column: 0
        },
        end: {
          line: 100,
          column: 2
        }
      },
      "21": {
        start: {
          line: 102,
          column: 18
        },
        end: {
          line: 108,
          column: 3
        }
      },
      "22": {
        start: {
          line: 102,
          column: 41
        },
        end: {
          line: 108,
          column: 1
        }
      }
    },
    fnMap: {
      "0": {
        name: "AlignedWordsObject",
        decl: {
          start: {
            line: 10,
            column: 9
          },
          end: {
            line: 10,
            column: 27
          }
        },
        loc: {
          start: {
            line: 10,
            column: 77
          },
          end: {
            line: 93,
            column: 1
          }
        },
        line: 10
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 14,
            column: 21
          },
          end: {
            line: 14,
            column: 22
          }
        },
        loc: {
          start: {
            line: 14,
            column: 32
          },
          end: {
            line: 16,
            column: 3
          }
        },
        line: 14
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 18,
            column: 22
          },
          end: {
            line: 18,
            column: 23
          }
        },
        loc: {
          start: {
            line: 18,
            column: 28
          },
          end: {
            line: 20,
            column: 3
          }
        },
        line: 18
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 35,
            column: 29
          },
          end: {
            line: 35,
            column: 30
          }
        },
        loc: {
          start: {
            line: 36,
            column: 4
          },
          end: {
            line: 46,
            column: 11
          }
        },
        line: 36
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 54,
            column: 45
          },
          end: {
            line: 54,
            column: 46
          }
        },
        loc: {
          start: {
            line: 55,
            column: 6
          },
          end: {
            line: 55,
            column: 66
          }
        },
        line: 55
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 102,
            column: 29
          },
          end: {
            line: 102,
            column: 30
          }
        },
        loc: {
          start: {
            line: 102,
            column: 41
          },
          end: {
            line: 108,
            column: 1
          }
        },
        line: 102
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 27,
            column: 2
          },
          end: {
            line: 33,
            column: 3
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 27,
            column: 2
          },
          end: {
            line: 33,
            column: 3
          }
        }, {
          start: {
            line: 27,
            column: 2
          },
          end: {
            line: 33,
            column: 3
          }
        }],
        line: 27
      },
      "1": {
        loc: {
          start: {
            line: 40,
            column: 17
          },
          end: {
            line: 40,
            column: 56
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 40,
            column: 28
          },
          end: {
            line: 40,
            column: 44
          }
        }, {
          start: {
            line: 40,
            column: 47
          },
          end: {
            line: 40,
            column: 56
          }
        }],
        line: 40
      },
      "2": {
        loc: {
          start: {
            line: 51,
            column: 2
          },
          end: {
            line: 90,
            column: 3
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 51,
            column: 2
          },
          end: {
            line: 90,
            column: 3
          }
        }, {
          start: {
            line: 51,
            column: 2
          },
          end: {
            line: 90,
            column: 3
          }
        }],
        line: 51
      },
      "3": {
        loc: {
          start: {
            line: 53,
            column: 15
          },
          end: {
            line: 53,
            column: 43
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 53,
            column: 22
          },
          end: {
            line: 53,
            column: 31
          }
        }, {
          start: {
            line: 53,
            column: 34
          },
          end: {
            line: 53,
            column: 43
          }
        }],
        line: 53
      },
      "4": {
        loc: {
          start: {
            line: 65,
            column: 21
          },
          end: {
            line: 65,
            column: 57
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 65,
            column: 28
          },
          end: {
            line: 65,
            column: 40
          }
        }, {
          start: {
            line: 65,
            column: 43
          },
          end: {
            line: 65,
            column: 57
          }
        }],
        line: 65
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "980fd11493b39964ead116890d92b37f76291cae"
  };
  var coverage = global[gcv] || (global[gcv] = {});

  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }

  var actualCoverage = coverage[path];

  cov_280equv70u = function () {
    return actualCoverage;
  };

  return actualCoverage;
}

cov_280equv70u();

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance"); }

function _iterableToArrayLimit(arr, i) { if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === "[object Arguments]")) { return; } var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

function AlignedWordsObject({
  children,
  originalWords,
  disableWordPopover
}) {
  cov_280equv70u().f[0]++;
  var classes = (cov_280equv70u().s[0]++, useStyles());

  var _ref = (cov_280equv70u().s[1]++, (0, _react.useState)(null)),
      _ref2 = _slicedToArray(_ref, 2),
      anchorEl = _ref2[0],
      setAnchorEl = _ref2[1];

  cov_280equv70u().s[2]++;

  var handleOpen = event => {
    cov_280equv70u().f[1]++;
    cov_280equv70u().s[3]++;
    setAnchorEl(event.currentTarget);
  };

  cov_280equv70u().s[4]++;

  var handleClose = () => {
    cov_280equv70u().f[2]++;
    cov_280equv70u().s[5]++;
    setAnchorEl(null);
  };

  var selected;

  var _selectionsContext = (cov_280equv70u().s[6]++, (0, _react.useContext)(_Selections.SelectionsContext));

  cov_280equv70u().s[7]++;

  if (_selectionsContext) {
    cov_280equv70u().b[0][0]++;

    var _ref3 = (cov_280equv70u().s[8]++, _selectionsContext),
        selections = _ref3.state,
        _ref3$actions = _ref3.actions,
        areSelected = _ref3$actions.areSelected,
        addSelections = _ref3$actions.addSelections,
        removeSelections = _ref3$actions.removeSelections;

    cov_280equv70u().s[9]++;
    selected = areSelected(originalWords);
  } else {
    cov_280equv70u().b[0][1]++;
  }

  var words = (cov_280equv70u().s[10]++, children.map((verseObject, index) => {
    cov_280equv70u().f[3]++;
    cov_280equv70u().s[11]++;
    return _react.default.createElement("span", {
      "data-test": "aligned-word-object",
      "data-testselected": selected,
      key: index,
      className: selected ? (cov_280equv70u().b[1][0]++, classes.selected) : (cov_280equv70u().b[1][1]++, undefined)
    }, _react.default.createElement(_.WordObject, {
      verseObject: verseObject,
      disableWordPopover: disableWordPopover
    }));
  }));
  var component = (cov_280equv70u().s[12]++, words);
  cov_280equv70u().s[13]++;

  if (!disableWordPopover) {
    cov_280equv70u().b[2][0]++;
    var open = (cov_280equv70u().s[14]++, Boolean(anchorEl));
    var id = (cov_280equv70u().s[15]++, open ? (cov_280equv70u().b[3][0]++, 'popover') : (cov_280equv70u().b[3][1]++, undefined));

    var _originalWords = (cov_280equv70u().s[16]++, originalWords.map((verseObject, index) => {
      cov_280equv70u().f[4]++;
      cov_280equv70u().s[17]++;
      return _react.default.createElement(_.OriginalWordObject, {
        key: index,
        verseObject: verseObject
      });
    }));

    cov_280equv70u().s[18]++;
    component = _react.default.createElement(_react.default.Fragment, null, _react.default.createElement("span", {
      "aria-describedby": id,
      "aria-haspopup": "true",
      onMouseEnter: handleOpen,
      onMouseLeave: handleClose,
      className: open ? (cov_280equv70u().b[4][0]++, classes.open) : (cov_280equv70u().b[4][1]++, classes.closed)
    }, words), _react.default.createElement(_core.Popover, {
      id: id,
      open: open,
      anchorEl: anchorEl,
      onClose: handleClose,
      className: classes.popover,
      classes: {
        paper: classes.paper
      },
      anchorOrigin: {
        vertical: 'bottom',
        horizontal: 'left'
      },
      transformOrigin: {
        vertical: 'top',
        horizontal: 'left'
      },
      disableRestoreFocus: true
    }, _react.default.createElement(_react.default.Fragment, null, _originalWords)));
  } else {
    cov_280equv70u().b[2][1]++;
  }

  cov_280equv70u().s[19]++;
  return _react.default.createElement(_react.default.Fragment, null, component);
}

cov_280equv70u().s[20]++;
AlignedWordsObject.propTypes = {
  children: _propTypes.default.arrayOf(_propTypes.default.object).isRequired,
  originalWords: _propTypes.default.arrayOf(_propTypes.default.object),

  /** disable popovers for aligned and original language words */
  disableWordPopover: _propTypes.default.bool
};
var useStyles = (cov_280equv70u().s[21]++, (0, _styles.makeStyles)(theme => {
  cov_280equv70u().f[5]++;
  cov_280equv70u().s[22]++;
  return {
    open: {
      backgroundColor: 'lightgoldenrodyellow'
    },
    closed: {},
    popover: {
      pointerEvents: 'none'
    },
    paper: {
      padding: theme.spacing(1)
    },
    selected: {
      backgroundColor: 'yellow'
    }
  };
}));
var _default = AlignedWordsObject;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3ZlcnNlLW9iamVjdHMvQWxpZ25lZFdvcmRzT2JqZWN0LmpzIl0sIm5hbWVzIjpbIkFsaWduZWRXb3Jkc09iamVjdCIsImNoaWxkcmVuIiwib3JpZ2luYWxXb3JkcyIsImRpc2FibGVXb3JkUG9wb3ZlciIsImNsYXNzZXMiLCJ1c2VTdHlsZXMiLCJhbmNob3JFbCIsInNldEFuY2hvckVsIiwiaGFuZGxlT3BlbiIsImV2ZW50IiwiY3VycmVudFRhcmdldCIsImhhbmRsZUNsb3NlIiwic2VsZWN0ZWQiLCJfc2VsZWN0aW9uc0NvbnRleHQiLCJTZWxlY3Rpb25zQ29udGV4dCIsInNlbGVjdGlvbnMiLCJzdGF0ZSIsImFjdGlvbnMiLCJhcmVTZWxlY3RlZCIsImFkZFNlbGVjdGlvbnMiLCJyZW1vdmVTZWxlY3Rpb25zIiwid29yZHMiLCJtYXAiLCJ2ZXJzZU9iamVjdCIsImluZGV4IiwidW5kZWZpbmVkIiwiY29tcG9uZW50Iiwib3BlbiIsIkJvb2xlYW4iLCJpZCIsIl9vcmlnaW5hbFdvcmRzIiwiY2xvc2VkIiwicG9wb3ZlciIsInBhcGVyIiwidmVydGljYWwiLCJob3Jpem9udGFsIiwicHJvcFR5cGVzIiwiUHJvcFR5cGVzIiwiYXJyYXlPZiIsIm9iamVjdCIsImlzUmVxdWlyZWQiLCJib29sIiwidGhlbWUiLCJiYWNrZ3JvdW5kQ29sb3IiLCJwb2ludGVyRXZlbnRzIiwicGFkZGluZyIsInNwYWNpbmciXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7QUFFQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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LE1BQTVCLEVBQW9DQyxVQURqQjtBQUU3QnRDLEVBQUFBLGFBQWEsRUFBRW1DLG1CQUFVQyxPQUFWLENBQWtCRCxtQkFBVUUsTUFBNUIsQ0FGYzs7QUFHN0I7QUFDQXBDLEVBQUFBLGtCQUFrQixFQUFFa0MsbUJBQVVJO0FBSkQsQ0FBL0I7QUFPQSxJQUFNcEMsU0FBUyw4QkFBRyx3QkFBWXFDLEtBQUQsSUFBWTtBQUFBO0FBQUE7QUFBQTtBQUN2Q2YsSUFBQUEsSUFBSSxFQUFFO0FBQUVnQixNQUFBQSxlQUFlLEVBQUU7QUFBbkIsS0FEaUM7QUFFdkNaLElBQUFBLE1BQU0sRUFBRSxFQUYrQjtBQUd2Q0MsSUFBQUEsT0FBTyxFQUFFO0FBQUVZLE1BQUFBLGFBQWEsRUFBRTtBQUFqQixLQUg4QjtBQUl2Q1gsSUFBQUEsS0FBSyxFQUFFO0FBQUVZLE1BQUFBLE9BQU8sRUFBRUgsS0FBSyxDQUFDSSxPQUFOLENBQWMsQ0FBZDtBQUFYLEtBSmdDO0FBS3ZDbEMsSUFBQUEsUUFBUSxFQUFFO0FBQUUrQixNQUFBQSxlQUFlLEVBQUU7QUFBbkI7QUFMNkI7QUFNeEMsQ0FOaUIsQ0FBSCxDQUFmO2VBUWUzQyxrQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSwgdXNlQ29udGV4dCB9IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcclxuaW1wb3J0IHsgbWFrZVN0eWxlcyB9IGZyb20gJ0BtYXRlcmlhbC11aS9jb3JlL3N0eWxlcyc7XHJcbmltcG9ydCB7IFBvcG92ZXIgfSBmcm9tICdAbWF0ZXJpYWwtdWkvY29yZSc7XHJcblxyXG5pbXBvcnQgeyBTZWxlY3Rpb25zQ29udGV4dCB9IGZyb20gJy4uL3NlbGVjdGlvbnMvU2VsZWN0aW9ucy5jb250ZXh0JztcclxuXHJcbmltcG9ydCB7IFdvcmRPYmplY3QsIE9yaWdpbmFsV29yZE9iamVjdCB9IGZyb20gJy4nO1xyXG5cclxuZnVuY3Rpb24gQWxpZ25lZFdvcmRzT2JqZWN0KHsgY2hpbGRyZW4sIG9yaWdpbmFsV29yZHMsIGRpc2FibGVXb3JkUG9wb3ZlciB9KSB7XHJcbiAgY29uc3QgY2xhc3NlcyA9IHVzZVN0eWxlcygpO1xyXG4gIGNvbnN0IFthbmNob3JFbCwgc2V0QW5jaG9yRWxdID0gdXNlU3RhdGUobnVsbCk7XHJcblxyXG4gIGNvbnN0IGhhbmRsZU9wZW4gPSAoZXZlbnQpID0+IHtcclxuICAgIHNldEFuY2hvckVsKGV2ZW50LmN1cnJlbnRUYXJnZXQpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGhhbmRsZUNsb3NlID0gKCkgPT4ge1xyXG4gICAgc2V0QW5jaG9yRWwobnVsbCk7XHJcbiAgfTtcclxuXHJcblxyXG4gIGxldCBzZWxlY3RlZDtcclxuXHJcbiAgY29uc3QgX3NlbGVjdGlvbnNDb250ZXh0ID0gdXNlQ29udGV4dChTZWxlY3Rpb25zQ29udGV4dCk7XHJcblxyXG4gIGlmIChfc2VsZWN0aW9uc0NvbnRleHQpIHtcclxuICAgIGNvbnN0IHtcclxuICAgICAgc3RhdGU6IHNlbGVjdGlvbnMsXHJcbiAgICAgIGFjdGlvbnM6IHsgYXJlU2VsZWN0ZWQsIGFkZFNlbGVjdGlvbnMsIHJlbW92ZVNlbGVjdGlvbnMgfSxcclxuICAgIH0gPSBfc2VsZWN0aW9uc0NvbnRleHQ7XHJcbiAgICBzZWxlY3RlZCA9IGFyZVNlbGVjdGVkKG9yaWdpbmFsV29yZHMpO1xyXG4gIH1cclxuXHJcbiAgY29uc3Qgd29yZHMgPSBjaGlsZHJlbi5tYXAoKHZlcnNlT2JqZWN0LCBpbmRleCkgPT4gKFxyXG4gICAgPHNwYW5cclxuICAgICAgZGF0YS10ZXN0PVwiYWxpZ25lZC13b3JkLW9iamVjdFwiXHJcbiAgICAgIGRhdGEtdGVzdHNlbGVjdGVkPXtzZWxlY3RlZH1cclxuICAgICAga2V5PXtpbmRleH1cclxuICAgICAgY2xhc3NOYW1lPXtzZWxlY3RlZCA/IGNsYXNzZXMuc2VsZWN0ZWQgOiB1bmRlZmluZWR9XHJcbiAgICA+XHJcbiAgICAgIDxXb3JkT2JqZWN0XHJcbiAgICAgICAgdmVyc2VPYmplY3Q9e3ZlcnNlT2JqZWN0fVxyXG4gICAgICAgIGRpc2FibGVXb3JkUG9wb3Zlcj17ZGlzYWJsZVdvcmRQb3BvdmVyfVxyXG4gICAgICAvPlxyXG4gICAgPC9zcGFuPlxyXG4gICkpO1xyXG5cclxuICBsZXQgY29tcG9uZW50ID0gd29yZHM7XHJcblxyXG4gIGlmICghZGlzYWJsZVdvcmRQb3BvdmVyKSB7XHJcbiAgICBjb25zdCBvcGVuID0gQm9vbGVhbihhbmNob3JFbCk7XHJcbiAgICBjb25zdCBpZCA9IG9wZW4gPyAncG9wb3ZlcicgOiB1bmRlZmluZWQ7XHJcbiAgICBjb25zdCBfb3JpZ2luYWxXb3JkcyA9IG9yaWdpbmFsV29yZHMubWFwKCh2ZXJzZU9iamVjdCwgaW5kZXgpID0+IChcclxuICAgICAgPE9yaWdpbmFsV29yZE9iamVjdCBrZXk9e2luZGV4fSB2ZXJzZU9iamVjdD17dmVyc2VPYmplY3R9IC8+XHJcbiAgICApKTtcclxuXHJcbiAgICBjb21wb25lbnQgPSAoXHJcbiAgICAgIDw+XHJcbiAgICAgICAgPHNwYW5cclxuICAgICAgICAgIGFyaWEtZGVzY3JpYmVkYnk9e2lkfVxyXG4gICAgICAgICAgYXJpYS1oYXNwb3B1cD1cInRydWVcIlxyXG4gICAgICAgICAgb25Nb3VzZUVudGVyPXtoYW5kbGVPcGVufVxyXG4gICAgICAgICAgb25Nb3VzZUxlYXZlPXtoYW5kbGVDbG9zZX1cclxuICAgICAgICAgIGNsYXNzTmFtZT17b3BlbiA/IGNsYXNzZXMub3BlbiA6IGNsYXNzZXMuY2xvc2VkfVxyXG4gICAgICAgID5cclxuICAgICAgICAgIHt3b3Jkc31cclxuICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgPFBvcG92ZXJcclxuICAgICAgICAgIGlkPXtpZH1cclxuICAgICAgICAgIG9wZW49e29wZW59XHJcbiAgICAgICAgICBhbmNob3JFbD17YW5jaG9yRWx9XHJcbiAgICAgICAgICBvbkNsb3NlPXtoYW5kbGVDbG9zZX1cclxuICAgICAgICAgIGNsYXNzTmFtZT17Y2xhc3Nlcy5wb3BvdmVyfVxyXG4gICAgICAgICAgY2xhc3Nlcz17eyBwYXBlcjogY2xhc3Nlcy5wYXBlciB9fVxyXG4gICAgICAgICAgYW5jaG9yT3JpZ2luPXt7XHJcbiAgICAgICAgICAgIHZlcnRpY2FsOiAnYm90dG9tJyxcclxuICAgICAgICAgICAgaG9yaXpvbnRhbDogJ2xlZnQnLFxyXG4gICAgICAgICAgfX1cclxuICAgICAgICAgIHRyYW5zZm9ybU9yaWdpbj17e1xyXG4gICAgICAgICAgICB2ZXJ0aWNhbDogJ3RvcCcsXHJcbiAgICAgICAgICAgIGhvcml6b250YWw6ICdsZWZ0JyxcclxuICAgICAgICAgIH19XHJcbiAgICAgICAgICBkaXNhYmxlUmVzdG9yZUZvY3VzXHJcbiAgICAgICAgPlxyXG4gICAgICAgICAgPD57X29yaWdpbmFsV29yZHN9PC8+XHJcbiAgICAgICAgPC9Qb3BvdmVyPlxyXG4gICAgICA8Lz5cclxuICAgICk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gPD57Y29tcG9uZW50fTwvPjtcclxufVxyXG5cclxuQWxpZ25lZFdvcmRzT2JqZWN0LnByb3BUeXBlcyA9IHtcclxuICBjaGlsZHJlbjogUHJvcFR5cGVzLmFycmF5T2YoUHJvcFR5cGVzLm9iamVjdCkuaXNSZXF1aXJlZCxcclxuICBvcmlnaW5hbFdvcmRzOiBQcm9wVHlwZXMuYXJyYXlPZihQcm9wVHlwZXMub2JqZWN0KSxcclxuICAvKiogZGlzYWJsZSBwb3BvdmVycyBmb3IgYWxpZ25lZCBhbmQgb3JpZ2luYWwgbGFuZ3VhZ2Ugd29yZHMgKi9cclxuICBkaXNhYmxlV29yZFBvcG92ZXI6IFByb3BUeXBlcy5ib29sLFxyXG59O1xyXG5cclxuY29uc3QgdXNlU3R5bGVzID0gbWFrZVN0eWxlcygodGhlbWUpID0+ICh7XHJcbiAgb3BlbjogeyBiYWNrZ3JvdW5kQ29sb3I6ICdsaWdodGdvbGRlbnJvZHllbGxvdycgfSxcclxuICBjbG9zZWQ6IHt9LFxyXG4gIHBvcG92ZXI6IHsgcG9pbnRlckV2ZW50czogJ25vbmUnIH0sXHJcbiAgcGFwZXI6IHsgcGFkZGluZzogdGhlbWUuc3BhY2luZygxKSB9LFxyXG4gIHNlbGVjdGVkOiB7IGJhY2tncm91bmRDb2xvcjogJ3llbGxvdycgfSxcclxufSkpO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgQWxpZ25lZFdvcmRzT2JqZWN0O1xyXG4iXX0=