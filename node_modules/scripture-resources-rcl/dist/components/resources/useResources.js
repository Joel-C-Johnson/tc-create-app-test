"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _react = require("react");

var _propTypes = _interopRequireDefault(require("prop-types"));

var _deepFreeze = _interopRequireDefault(require("deep-freeze"));

var _useDeepCompareEffect = _interopRequireDefault(require("use-deep-compare-effect"));

var _core = require("../../core");

var _resourcesHelper = require("./resourcesHelper");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function cov_1bmnq3gam6() {
  var path = "D:\\Projects-unfoldingWord\\scripture-resources-rcl\\src\\components\\resources\\useResources.js";
  var hash = "3d7ecd7be71eb442e0e20e08895ac22046726aef";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "D:\\Projects-unfoldingWord\\scripture-resources-rcl\\src\\components\\resources\\useResources.js",
    statementMap: {
      "0": {
        start: {
          line: 18,
          column: 52
        },
        end: {
          line: 18,
          column: 62
        }
      },
      "1": {
        start: {
          line: 19,
          column: 44
        },
        end: {
          line: 19,
          column: 54
        }
      },
      "2": {
        start: {
          line: 20,
          column: 28
        },
        end: {
          line: 20,
          column: 38
        }
      },
      "3": {
        start: {
          line: 21,
          column: 32
        },
        end: {
          line: 21,
          column: 47
        }
      },
      "4": {
        start: {
          line: 23,
          column: 2
        },
        end: {
          line: 31,
          column: 49
        }
      },
      "5": {
        start: {
          line: 24,
          column: 4
        },
        end: {
          line: 30,
          column: 6
        }
      },
      "6": {
        start: {
          line: 28,
          column: 8
        },
        end: {
          line: 28,
          column: 27
        }
      },
      "7": {
        start: {
          line: 33,
          column: 17
        },
        end: {
          line: 39,
          column: 3
        }
      },
      "8": {
        start: {
          line: 35,
          column: 26
        },
        end: {
          line: 35,
          column: 62
        }
      },
      "9": {
        start: {
          line: 36,
          column: 6
        },
        end: {
          line: 36,
          column: 31
        }
      },
      "10": {
        start: {
          line: 41,
          column: 17
        },
        end: {
          line: 47,
          column: 3
        }
      },
      "11": {
        start: {
          line: 43,
          column: 27
        },
        end: {
          line: 43,
          column: 67
        }
      },
      "12": {
        start: {
          line: 44,
          column: 6
        },
        end: {
          line: 44,
          column: 38
        }
      },
      "13": {
        start: {
          line: 49,
          column: 26
        },
        end: {
          line: 62,
          column: 3
        }
      },
      "14": {
        start: {
          line: 51,
          column: 24
        },
        end: {
          line: 57,
          column: 7
        }
      },
      "15": {
        start: {
          line: 59,
          column: 6
        },
        end: {
          line: 59,
          column: 23
        }
      },
      "16": {
        start: {
          line: 64,
          column: 32
        },
        end: {
          line: 67,
          column: 3
        }
      },
      "17": {
        start: {
          line: 65,
          column: 4
        },
        end: {
          line: 66,
          column: 48
        }
      },
      "18": {
        start: {
          line: 69,
          column: 20
        },
        end: {
          line: 95,
          column: 51
        }
      },
      "19": {
        start: {
          line: 70,
          column: 19
        },
        end: {
          line: 70,
          column: 32
        }
      },
      "20": {
        start: {
          line: 72,
          column: 4
        },
        end: {
          line: 91,
          column: 5
        }
      },
      "21": {
        start: {
          line: 73,
          column: 26
        },
        end: {
          line: 73,
          column: 38
        }
      },
      "22": {
        start: {
          line: 75,
          column: 6
        },
        end: {
          line: 90,
          column: 7
        }
      },
      "23": {
        start: {
          line: 76,
          column: 8
        },
        end: {
          line: 76,
          column: 25
        }
      },
      "24": {
        start: {
          line: 77,
          column: 25
        },
        end: {
          line: 85,
          column: 61
        }
      },
      "25": {
        start: {
          line: 79,
          column: 12
        },
        end: {
          line: 83,
          column: 13
        }
      },
      "26": {
        start: {
          line: 80,
          column: 14
        },
        end: {
          line: 80,
          column: 50
        }
      },
      "27": {
        start: {
          line: 82,
          column: 14
        },
        end: {
          line: 82,
          column: 26
        }
      },
      "28": {
        start: {
          line: 85,
          column: 38
        },
        end: {
          line: 85,
          column: 60
        }
      },
      "29": {
        start: {
          line: 86,
          column: 26
        },
        end: {
          line: 86,
          column: 53
        }
      },
      "30": {
        start: {
          line: 87,
          column: 8
        },
        end: {
          line: 87,
          column: 36
        }
      },
      "31": {
        start: {
          line: 88,
          column: 8
        },
        end: {
          line: 88,
          column: 49
        }
      },
      "32": {
        start: {
          line: 89,
          column: 8
        },
        end: {
          line: 89,
          column: 29
        }
      },
      "33": {
        start: {
          line: 92,
          column: 4
        },
        end: {
          line: 92,
          column: 22
        }
      },
      "34": {
        start: {
          line: 93,
          column: 4
        },
        end: {
          line: 93,
          column: 20
        }
      },
      "35": {
        start: {
          line: 97,
          column: 2
        },
        end: {
          line: 99,
          column: 37
        }
      },
      "36": {
        start: {
          line: 98,
          column: 4
        },
        end: {
          line: 98,
          column: 31
        }
      },
      "37": {
        start: {
          line: 101,
          column: 2
        },
        end: {
          line: 110,
          column: 4
        }
      },
      "38": {
        start: {
          line: 113,
          column: 0
        },
        end: {
          line: 131,
          column: 2
        }
      }
    },
    fnMap: {
      "0": {
        name: "useResources",
        decl: {
          start: {
            line: 9,
            column: 9
          },
          end: {
            line: 9,
            column: 21
          }
        },
        loc: {
          start: {
            line: 17,
            column: 3
          },
          end: {
            line: 111,
            column: 1
          }
        },
        line: 17
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 16,
            column: 20
          },
          end: {
            line: 16,
            column: 21
          }
        },
        loc: {
          start: {
            line: 16,
            column: 26
          },
          end: {
            line: 16,
            column: 29
          }
        },
        line: 16
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 23,
            column: 12
          },
          end: {
            line: 23,
            column: 13
          }
        },
        loc: {
          start: {
            line: 23,
            column: 18
          },
          end: {
            line: 31,
            column: 3
          }
        },
        line: 23
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 27,
            column: 6
          },
          end: {
            line: 27,
            column: 7
          }
        },
        loc: {
          start: {
            line: 27,
            column: 22
          },
          end: {
            line: 29,
            column: 7
          }
        },
        line: 27
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 34,
            column: 4
          },
          end: {
            line: 34,
            column: 5
          }
        },
        loc: {
          start: {
            line: 34,
            column: 20
          },
          end: {
            line: 37,
            column: 5
          }
        },
        line: 34
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 42,
            column: 4
          },
          end: {
            line: 42,
            column: 5
          }
        },
        loc: {
          start: {
            line: 42,
            column: 15
          },
          end: {
            line: 45,
            column: 5
          }
        },
        line: 42
      },
      "6": {
        name: "(anonymous_6)",
        decl: {
          start: {
            line: 50,
            column: 4
          },
          end: {
            line: 50,
            column: 5
          }
        },
        loc: {
          start: {
            line: 50,
            column: 31
          },
          end: {
            line: 60,
            column: 5
          }
        },
        line: 50
      },
      "7": {
        name: "(anonymous_7)",
        decl: {
          start: {
            line: 64,
            column: 32
          },
          end: {
            line: 64,
            column: 33
          }
        },
        loc: {
          start: {
            line: 65,
            column: 4
          },
          end: {
            line: 66,
            column: 48
          }
        },
        line: 65
      },
      "8": {
        name: "(anonymous_8)",
        decl: {
          start: {
            line: 69,
            column: 32
          },
          end: {
            line: 69,
            column: 33
          }
        },
        loc: {
          start: {
            line: 69,
            column: 44
          },
          end: {
            line: 95,
            column: 3
          }
        },
        line: 69
      },
      "9": {
        name: "(anonymous_9)",
        decl: {
          start: {
            line: 78,
            column: 15
          },
          end: {
            line: 78,
            column: 16
          }
        },
        loc: {
          start: {
            line: 78,
            column: 29
          },
          end: {
            line: 84,
            column: 11
          }
        },
        line: 78
      },
      "10": {
        name: "(anonymous_10)",
        decl: {
          start: {
            line: 85,
            column: 18
          },
          end: {
            line: 85,
            column: 19
          }
        },
        loc: {
          start: {
            line: 85,
            column: 38
          },
          end: {
            line: 85,
            column: 60
          }
        },
        line: 85
      },
      "11": {
        name: "(anonymous_11)",
        decl: {
          start: {
            line: 97,
            column: 12
          },
          end: {
            line: 97,
            column: 13
          }
        },
        loc: {
          start: {
            line: 97,
            column: 18
          },
          end: {
            line: 99,
            column: 3
          }
        },
        line: 97
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 16,
            column: 2
          },
          end: {
            line: 16,
            column: 29
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 16,
            column: 20
          },
          end: {
            line: 16,
            column: 29
          }
        }],
        line: 16
      },
      "1": {
        loc: {
          start: {
            line: 35,
            column: 26
          },
          end: {
            line: 35,
            column: 62
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 35,
            column: 26
          },
          end: {
            line: 35,
            column: 36
          }
        }, {
          start: {
            line: 35,
            column: 40
          },
          end: {
            line: 35,
            column: 62
          }
        }],
        line: 35
      },
      "2": {
        loc: {
          start: {
            line: 65,
            column: 4
          },
          end: {
            line: 66,
            column: 48
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 65,
            column: 4
          },
          end: {
            line: 65,
            column: 32
          }
        }, {
          start: {
            line: 66,
            column: 4
          },
          end: {
            line: 66,
            column: 48
          }
        }],
        line: 65
      },
      "3": {
        loc: {
          start: {
            line: 72,
            column: 4
          },
          end: {
            line: 91,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 72,
            column: 4
          },
          end: {
            line: 91,
            column: 5
          }
        }, {
          start: {
            line: 72,
            column: 4
          },
          end: {
            line: 91,
            column: 5
          }
        }],
        line: 72
      },
      "4": {
        loc: {
          start: {
            line: 72,
            column: 8
          },
          end: {
            line: 72,
            column: 57
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 72,
            column: 8
          },
          end: {
            line: 72,
            column: 17
          }
        }, {
          start: {
            line: 72,
            column: 21
          },
          end: {
            line: 72,
            column: 33
          }
        }, {
          start: {
            line: 72,
            column: 37
          },
          end: {
            line: 72,
            column: 57
          }
        }],
        line: 72
      },
      "5": {
        loc: {
          start: {
            line: 75,
            column: 6
          },
          end: {
            line: 90,
            column: 7
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 75,
            column: 6
          },
          end: {
            line: 90,
            column: 7
          }
        }, {
          start: {
            line: 75,
            column: 6
          },
          end: {
            line: 90,
            column: 7
          }
        }],
        line: 75
      },
      "6": {
        loc: {
          start: {
            line: 75,
            column: 10
          },
          end: {
            line: 75,
            column: 130
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 75,
            column: 10
          },
          end: {
            line: 75,
            column: 18
          }
        }, {
          start: {
            line: 75,
            column: 23
          },
          end: {
            line: 75,
            column: 63
          }
        }, {
          start: {
            line: 75,
            column: 67
          },
          end: {
            line: 75,
            column: 81
          }
        }, {
          start: {
            line: 75,
            column: 85
          },
          end: {
            line: 75,
            column: 129
          }
        }],
        line: 75
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0,
      "33": 0,
      "34": 0,
      "35": 0,
      "36": 0,
      "37": 0,
      "38": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0
    },
    b: {
      "0": [0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0, 0],
      "5": [0, 0],
      "6": [0, 0, 0, 0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "3d7ecd7be71eb442e0e20e08895ac22046726aef"
  };
  var coverage = global[gcv] || (global[gcv] = {});

  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }

  var actualCoverage = coverage[path];

  cov_1bmnq3gam6 = function () {
    return actualCoverage;
  };

  return actualCoverage;
}

cov_1bmnq3gam6();

function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }

function _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err); } _next(undefined); }); }; }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance"); }

function _iterableToArrayLimit(arr, i) { if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === "[object Arguments]")) { return; } var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

function useResources({
  resources,
  resourceLinks,
  defaultResourceLinks,
  reference,
  config,
  onResources,
  onResourceLinks = (cov_1bmnq3gam6().b[0][0]++, () => {
    cov_1bmnq3gam6().f[1]++;
  })
}) {
  cov_1bmnq3gam6().f[0]++;

  var _ref = (cov_1bmnq3gam6().s[0]++, (0, _react.useState)()),
      _ref2 = _slicedToArray(_ref, 2),
      projectIdentifier = _ref2[0],
      setProjectIdentifier = _ref2[1];

  var _ref3 = (cov_1bmnq3gam6().s[1]++, (0, _react.useState)()),
      _ref4 = _slicedToArray(_ref3, 2),
      usfmJsonArray = _ref4[0],
      setUsfmJsonArray = _ref4[1];

  var _ref5 = (cov_1bmnq3gam6().s[2]++, (0, _react.useState)()),
      _ref6 = _slicedToArray(_ref5, 2),
      books = _ref6[0],
      setBooks = _ref6[1];

  var _ref7 = (cov_1bmnq3gam6().s[3]++, (0, _react.useState)(false)),
      _ref8 = _slicedToArray(_ref7, 2),
      loading = _ref8[0],
      setLoading = _ref8[1];

  cov_1bmnq3gam6().s[4]++;
  (0, _useDeepCompareEffect.default)(() => {
    cov_1bmnq3gam6().f[2]++;
    cov_1bmnq3gam6().s[5]++;
    (0, _core.resourcesFromResourceLinks)({
      resourceLinks,
      reference,
      config
    }).then(_resources => {
      cov_1bmnq3gam6().f[3]++;
      cov_1bmnq3gam6().s[6]++;
      update(_resources);
    });
  }, [resourceLinks, reference, config, update]);
  var update = (cov_1bmnq3gam6().s[7]++, (0, _react.useCallback)(_resources => {
    cov_1bmnq3gam6().f[4]++;

    var __resources = (cov_1bmnq3gam6().s[8]++, (cov_1bmnq3gam6().b[1][0]++, _resources) && (cov_1bmnq3gam6().b[1][1]++, (0, _deepFreeze.default)(_resources)));

    cov_1bmnq3gam6().s[9]++;
    onResources(__resources);
  }, [onResources]));
  var remove = (cov_1bmnq3gam6().s[10]++, (0, _react.useCallback)(index => {
    cov_1bmnq3gam6().f[5]++;

    var _resourceLinks = (cov_1bmnq3gam6().s[11]++, (0, _resourcesHelper.removeResourceLink)(resourceLinks, index));

    cov_1bmnq3gam6().s[12]++;
    onResourceLinks(_resourceLinks);
  }, [resourceLinks, onResourceLinks]));
  var addResourceLink = (cov_1bmnq3gam6().s[13]++, (0, _react.useCallback)( /*#__PURE__*/function () {
    var _ref9 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(newResourceLink) {
      var isSuccess;
      return regeneratorRuntime.wrap(function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              cov_1bmnq3gam6().f[6]++;
              cov_1bmnq3gam6().s[14]++;
              _context.next = 4;
              return (0, _resourcesHelper.tryAddResourceLink)(resourceLinks, newResourceLink, reference, config, onResourceLinks);

            case 4:
              isSuccess = _context.sent;
              cov_1bmnq3gam6().s[15]++;
              return _context.abrupt("return", isSuccess);

            case 7:
            case "end":
              return _context.stop();
          }
        }
      }, _callee);
    }));

    return function (_x) {
      return _ref9.apply(this, arguments);
    };
  }(), [config, onResourceLinks, reference, resourceLinks]));
  cov_1bmnq3gam6().s[16]++;

  var isDefaultResourceLink = _resourceLink => {
    cov_1bmnq3gam6().f[7]++;
    cov_1bmnq3gam6().s[17]++;
    return (cov_1bmnq3gam6().b[2][0]++, defaultResourceLinks != null) && (cov_1bmnq3gam6().b[2][1]++, defaultResourceLinks.includes(_resourceLink));
  };

  var parseUsfm = (cov_1bmnq3gam6().s[18]++, (0, _react.useCallback)( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {
    var response, _ref11, project, promises, jsonArray;

    return regeneratorRuntime.wrap(function _callee2$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            cov_1bmnq3gam6().f[8]++;
            response = (cov_1bmnq3gam6().s[19]++, usfmJsonArray);
            cov_1bmnq3gam6().s[20]++;

            if (!((cov_1bmnq3gam6().b[4][0]++, resources) && (cov_1bmnq3gam6().b[4][1]++, resources[0]) && (cov_1bmnq3gam6().b[4][2]++, resources[0].project))) {
              _context2.next = 27;
              break;
            }

            cov_1bmnq3gam6().b[3][0]++;
            _ref11 = (cov_1bmnq3gam6().s[21]++, resources[0]), project = _ref11.project;
            cov_1bmnq3gam6().s[22]++;

            if (!((cov_1bmnq3gam6().b[6][0]++, !loading) && ((cov_1bmnq3gam6().b[6][1]++, project.identifier !== projectIdentifier) || (cov_1bmnq3gam6().b[6][2]++, !usfmJsonArray) || (cov_1bmnq3gam6().b[6][3]++, usfmJsonArray.length != resourceLinks.length)))) {
              _context2.next = 24;
              break;
            }

            cov_1bmnq3gam6().b[5][0]++;
            cov_1bmnq3gam6().s[23]++;
            setLoading(true);
            promises = (cov_1bmnq3gam6().s[24]++, resources.map(resource => {
              cov_1bmnq3gam6().f[9]++;
              cov_1bmnq3gam6().s[25]++;

              try {
                cov_1bmnq3gam6().s[26]++;
                return resource.project.parseUsfm();
              } catch (_unused) {
                cov_1bmnq3gam6().s[27]++;
                return null;
              }
            }).filter(currentPromise => {
              cov_1bmnq3gam6().f[10]++;
              cov_1bmnq3gam6().s[28]++;
              return currentPromise != null;
            }));
            cov_1bmnq3gam6().s[29]++;
            _context2.next = 15;
            return Promise.all(promises);

          case 15:
            jsonArray = _context2.sent;
            cov_1bmnq3gam6().s[30]++;
            setUsfmJsonArray(jsonArray);
            cov_1bmnq3gam6().s[31]++;
            setProjectIdentifier(project.identifier);
            cov_1bmnq3gam6().s[32]++;
            response = jsonArray;
            _context2.next = 25;
            break;

          case 24:
            cov_1bmnq3gam6().b[5][1]++;

          case 25:
            _context2.next = 28;
            break;

          case 27:
            cov_1bmnq3gam6().b[3][1]++;

          case 28:
            cov_1bmnq3gam6().s[33]++;
            setLoading(false);
            cov_1bmnq3gam6().s[34]++;
            return _context2.abrupt("return", response);

          case 32:
          case "end":
            return _context2.stop();
        }
      }
    }, _callee2);
  })), [projectIdentifier, resources, usfmJsonArray]));
  cov_1bmnq3gam6().s[35]++;
  (0, _useDeepCompareEffect.default)(() => {
    cov_1bmnq3gam6().f[11]++;
    cov_1bmnq3gam6().s[36]++;
    parseUsfm().then(setBooks);
  }, [parseUsfm, projectIdentifier]);
  cov_1bmnq3gam6().s[37]++;
  return {
    state: {
      resources,
      books
    },
    actions: {
      addResourceLink,
      isDefaultResourceLink,
      parseUsfm,
      update,
      remove
    }
  };
}

cov_1bmnq3gam6().s[38]++;
useResources.propTypes = {
  /** the resources  */
  resources: _propTypes.default.arrayOf(_propTypes.default.object),

  /** references: chapter and verse */
  reference: _propTypes.default.object,

  /** The link to parse and fetch the resource manifest */
  resourceLinks: _propTypes.default.arrayOf(_propTypes.default.string.isRequired).isRequired,

  /** The configuration of the server, and fetching */
  config: _propTypes.default.shape({
    server: _propTypes.default.string.isRequired,

    /** the overriding cache settings */
    cache: _propTypes.default.shape({
      /** cache age in ms */
      maxAge: _propTypes.default.number
    })
  }),

  /** action taken after a resource is acquired */
  onResources: _propTypes.default.func.isRequired
};
var _default = useResources;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3Jlc291cmNlcy91c2VSZXNvdXJjZXMuanMiXSwibmFtZXMiOlsidXNlUmVzb3VyY2VzIiwicmVzb3VyY2VzIiwicmVzb3VyY2VMaW5rcyIsImRlZmF1bHRSZXNvdXJjZUxpbmtzIiwicmVmZXJlbmNlIiwiY29uZmlnIiwib25SZXNvdXJjZXMiLCJvblJlc291cmNlTGlua3MiLCJwcm9qZWN0SWRlbnRpZmllciIsInNldFByb2plY3RJZGVudGlmaWVyIiwidXNmbUpzb25BcnJheSIsInNldFVzZm1Kc29uQXJyYXkiLCJib29rcyIsInNldEJvb2tzIiwibG9hZGluZyIsInNldExvYWRpbmciLCJ0aGVuIiwiX3Jlc291cmNlcyIsInVwZGF0ZSIsIl9fcmVzb3VyY2VzIiwicmVtb3ZlIiwiaW5kZXgiLCJfcmVzb3VyY2VMaW5rcyIsImFkZFJlc291cmNlTGluayIsIm5ld1Jlc291cmNlTGluayIsImlzU3VjY2VzcyIsImlzRGVmYXVsdFJlc291cmNlTGluayIsIl9yZXNvdXJjZUxpbmsiLCJpbmNsdWRlcyIsInBhcnNlVXNmbSIsInJlc3BvbnNlIiwicHJvamVjdCIsImlkZW50aWZpZXIiLCJsZW5ndGgiLCJwcm9taXNlcyIsIm1hcCIsInJlc291cmNlIiwiZmlsdGVyIiwiY3VycmVudFByb21pc2UiLCJQcm9taXNlIiwiYWxsIiwianNvbkFycmF5Iiwic3RhdGUiLCJhY3Rpb25zIiwicHJvcFR5cGVzIiwiUHJvcFR5cGVzIiwiYXJyYXlPZiIsIm9iamVjdCIsInN0cmluZyIsImlzUmVxdWlyZWQiLCJzaGFwZSIsInNlcnZlciIsImNhY2hlIiwibWF4QWdlIiwibnVtYmVyIiwiZnVuYyJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUVBOztBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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QSxNQUFNLEVBQUVSLG1CQUFVUztBQUZHLEtBQWhCO0FBSGUsR0FBaEIsQ0FSZTs7QUFnQnZCO0FBQ0FoRCxFQUFBQSxXQUFXLEVBQUV1QyxtQkFBVVUsSUFBVixDQUFlTjtBQWpCTCxDQUF6QjtlQW9CZWpELFkiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB1c2VTdGF0ZSwgdXNlQ2FsbGJhY2sgfSBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XHJcbmltcG9ydCBkZWVwRnJlZXplIGZyb20gJ2RlZXAtZnJlZXplJztcclxuaW1wb3J0IHVzZUVmZmVjdCBmcm9tICd1c2UtZGVlcC1jb21wYXJlLWVmZmVjdCc7XHJcblxyXG5pbXBvcnQgeyByZXNvdXJjZXNGcm9tUmVzb3VyY2VMaW5rcyB9IGZyb20gJy4uLy4uL2NvcmUnO1xyXG5pbXBvcnQgeyByZW1vdmVSZXNvdXJjZUxpbmssIHRyeUFkZFJlc291cmNlTGluayB9IGZyb20gJy4vcmVzb3VyY2VzSGVscGVyJztcclxuXHJcbmZ1bmN0aW9uIHVzZVJlc291cmNlcyh7XHJcbiAgcmVzb3VyY2VzLFxyXG4gIHJlc291cmNlTGlua3MsXHJcbiAgZGVmYXVsdFJlc291cmNlTGlua3MsXHJcbiAgcmVmZXJlbmNlLFxyXG4gIGNvbmZpZyxcclxuICBvblJlc291cmNlcyxcclxuICBvblJlc291cmNlTGlua3MgPSAoKSA9PiB7IH0sXHJcbn0pIHtcclxuICBjb25zdCBbcHJvamVjdElkZW50aWZpZXIsIHNldFByb2plY3RJZGVudGlmaWVyXSA9IHVzZVN0YXRlKCk7XHJcbiAgY29uc3QgW3VzZm1Kc29uQXJyYXksIHNldFVzZm1Kc29uQXJyYXldID0gdXNlU3RhdGUoKTtcclxuICBjb25zdCBbYm9va3MsIHNldEJvb2tzXSA9IHVzZVN0YXRlKCk7XHJcbiAgY29uc3QgW2xvYWRpbmcsIHNldExvYWRpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xyXG5cclxuICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgcmVzb3VyY2VzRnJvbVJlc291cmNlTGlua3Moe1xyXG4gICAgICByZXNvdXJjZUxpbmtzLCByZWZlcmVuY2UsIGNvbmZpZyxcclxuICAgIH0pLnRoZW4oXHJcbiAgICAgIChfcmVzb3VyY2VzKSA9PiB7XHJcbiAgICAgICAgdXBkYXRlKF9yZXNvdXJjZXMpO1xyXG4gICAgICB9LFxyXG4gICAgKTtcclxuICB9LCBbcmVzb3VyY2VMaW5rcywgcmVmZXJlbmNlLCBjb25maWcsIHVwZGF0ZV0pO1xyXG5cclxuICBjb25zdCB1cGRhdGUgPSB1c2VDYWxsYmFjayhcclxuICAgIChfcmVzb3VyY2VzKSA9PiB7XHJcbiAgICAgIGNvbnN0IF9fcmVzb3VyY2VzID0gX3Jlc291cmNlcyAmJiBkZWVwRnJlZXplKF9yZXNvdXJjZXMpO1xyXG4gICAgICBvblJlc291cmNlcyhfX3Jlc291cmNlcyk7XHJcbiAgICB9LFxyXG4gICAgW29uUmVzb3VyY2VzXSxcclxuICApO1xyXG5cclxuICBjb25zdCByZW1vdmUgPSB1c2VDYWxsYmFjayhcclxuICAgIChpbmRleCkgPT4ge1xyXG4gICAgICBsZXQgX3Jlc291cmNlTGlua3MgPSByZW1vdmVSZXNvdXJjZUxpbmsocmVzb3VyY2VMaW5rcywgaW5kZXgpO1xyXG4gICAgICBvblJlc291cmNlTGlua3MoX3Jlc291cmNlTGlua3MpO1xyXG4gICAgfSxcclxuICAgIFtyZXNvdXJjZUxpbmtzLCBvblJlc291cmNlTGlua3NdLFxyXG4gICk7XHJcblxyXG4gIGNvbnN0IGFkZFJlc291cmNlTGluayA9IHVzZUNhbGxiYWNrKFxyXG4gICAgYXN5bmMgKG5ld1Jlc291cmNlTGluaykgPT4ge1xyXG4gICAgICBjb25zdCBpc1N1Y2Nlc3MgPSBhd2FpdCB0cnlBZGRSZXNvdXJjZUxpbmsoXHJcbiAgICAgICAgcmVzb3VyY2VMaW5rcyxcclxuICAgICAgICBuZXdSZXNvdXJjZUxpbmssXHJcbiAgICAgICAgcmVmZXJlbmNlLFxyXG4gICAgICAgIGNvbmZpZyxcclxuICAgICAgICBvblJlc291cmNlTGlua3MsXHJcbiAgICAgICk7XHJcbiAgICAgIFxyXG4gICAgICByZXR1cm4gaXNTdWNjZXNzO1xyXG4gICAgfSxcclxuICAgIFtjb25maWcsIG9uUmVzb3VyY2VMaW5rcywgcmVmZXJlbmNlLCByZXNvdXJjZUxpbmtzXSxcclxuICApO1xyXG5cclxuICBjb25zdCBpc0RlZmF1bHRSZXNvdXJjZUxpbmsgPSAoX3Jlc291cmNlTGluaykgPT4gKFxyXG4gICAgZGVmYXVsdFJlc291cmNlTGlua3MgIT0gbnVsbCAmJlxyXG4gICAgZGVmYXVsdFJlc291cmNlTGlua3MuaW5jbHVkZXMoX3Jlc291cmNlTGluaylcclxuICApO1xyXG5cclxuICBjb25zdCBwYXJzZVVzZm0gPSB1c2VDYWxsYmFjayhhc3luYyAoKSA9PiB7XHJcbiAgICBsZXQgcmVzcG9uc2UgPSB1c2ZtSnNvbkFycmF5O1xyXG5cclxuICAgIGlmIChyZXNvdXJjZXMgJiYgcmVzb3VyY2VzWzBdICYmIHJlc291cmNlc1swXS5wcm9qZWN0KSB7XHJcbiAgICAgIGNvbnN0IHsgcHJvamVjdCB9ID0gcmVzb3VyY2VzWzBdO1xyXG5cclxuICAgICAgaWYgKCFsb2FkaW5nICYmIChwcm9qZWN0LmlkZW50aWZpZXIgIT09IHByb2plY3RJZGVudGlmaWVyIHx8ICF1c2ZtSnNvbkFycmF5IHx8IHVzZm1Kc29uQXJyYXkubGVuZ3RoICE9IHJlc291cmNlTGlua3MubGVuZ3RoKSkge1xyXG4gICAgICAgIHNldExvYWRpbmcodHJ1ZSk7XHJcbiAgICAgICAgY29uc3QgcHJvbWlzZXMgPSByZXNvdXJjZXNcclxuICAgICAgICAgIC5tYXAoKHJlc291cmNlKSA9PiB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHJlc291cmNlLnByb2plY3QucGFyc2VVc2ZtKCk7XHJcbiAgICAgICAgICAgIH0gY2F0Y2gge1xyXG4gICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLmZpbHRlcigoY3VycmVudFByb21pc2UpID0+IGN1cnJlbnRQcm9taXNlICE9IG51bGwpO1xyXG4gICAgICAgIGNvbnN0IGpzb25BcnJheSA9IGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKTtcclxuICAgICAgICBzZXRVc2ZtSnNvbkFycmF5KGpzb25BcnJheSk7XHJcbiAgICAgICAgc2V0UHJvamVjdElkZW50aWZpZXIocHJvamVjdC5pZGVudGlmaWVyKTtcclxuICAgICAgICByZXNwb25zZSA9IGpzb25BcnJheTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgc2V0TG9hZGluZyhmYWxzZSk7XHJcbiAgICByZXR1cm4gcmVzcG9uc2U7XHJcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzXHJcbiAgfSwgW3Byb2plY3RJZGVudGlmaWVyLCByZXNvdXJjZXMsIHVzZm1Kc29uQXJyYXldKTtcclxuXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIHBhcnNlVXNmbSgpLnRoZW4oc2V0Qm9va3MpO1xyXG4gIH0sIFtwYXJzZVVzZm0sIHByb2plY3RJZGVudGlmaWVyXSk7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBzdGF0ZTogeyByZXNvdXJjZXMsIGJvb2tzIH0sXHJcbiAgICBhY3Rpb25zOiB7XHJcbiAgICAgIGFkZFJlc291cmNlTGluayxcclxuICAgICAgaXNEZWZhdWx0UmVzb3VyY2VMaW5rLFxyXG4gICAgICBwYXJzZVVzZm0sXHJcbiAgICAgIHVwZGF0ZSxcclxuICAgICAgcmVtb3ZlLFxyXG4gICAgfSxcclxuICB9O1xyXG59XHJcblxyXG51c2VSZXNvdXJjZXMucHJvcFR5cGVzID0ge1xyXG4gIC8qKiB0aGUgcmVzb3VyY2VzICAqL1xyXG4gIHJlc291cmNlczogUHJvcFR5cGVzLmFycmF5T2YoUHJvcFR5cGVzLm9iamVjdCksXHJcbiAgLyoqIHJlZmVyZW5jZXM6IGNoYXB0ZXIgYW5kIHZlcnNlICovXHJcbiAgcmVmZXJlbmNlOiBQcm9wVHlwZXMub2JqZWN0LFxyXG4gIC8qKiBUaGUgbGluayB0byBwYXJzZSBhbmQgZmV0Y2ggdGhlIHJlc291cmNlIG1hbmlmZXN0ICovXHJcbiAgcmVzb3VyY2VMaW5rczogUHJvcFR5cGVzLmFycmF5T2YoUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkKS5pc1JlcXVpcmVkLFxyXG4gIC8qKiBUaGUgY29uZmlndXJhdGlvbiBvZiB0aGUgc2VydmVyLCBhbmQgZmV0Y2hpbmcgKi9cclxuICBjb25maWc6IFByb3BUeXBlcy5zaGFwZSh7XHJcbiAgICBzZXJ2ZXI6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcclxuICAgIC8qKiB0aGUgb3ZlcnJpZGluZyBjYWNoZSBzZXR0aW5ncyAqL1xyXG4gICAgY2FjaGU6IFByb3BUeXBlcy5zaGFwZSh7XHJcbiAgICAgIC8qKiBjYWNoZSBhZ2UgaW4gbXMgKi9cclxuICAgICAgbWF4QWdlOiBQcm9wVHlwZXMubnVtYmVyLFxyXG4gICAgfSksXHJcbiAgfSksXHJcbiAgLyoqIGFjdGlvbiB0YWtlbiBhZnRlciBhIHJlc291cmNlIGlzIGFjcXVpcmVkICovXHJcbiAgb25SZXNvdXJjZXM6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCB1c2VSZXNvdXJjZXM7XHJcbiJdfQ==