"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.Verse = void 0;

var _react = _interopRequireWildcard(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _styles = require("@material-ui/core/styles");

var _lab = require("@material-ui/lab");

var _reactWaypoint = require("react-waypoint");

var _verseObjects = require("../verse-objects");

var _helpers = require("./helpers");

var _ReferenceSelectedContext = require("../reference/ReferenceSelectedContext");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _getRequireWildcardCache() { if (typeof WeakMap !== "function") return null; var cache = new WeakMap(); _getRequireWildcardCache = function _getRequireWildcardCache() { return cache; }; return cache; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function cov_2liq3mmde4() {
  var path = "D:\\Projects-unfoldingWord\\scripture-resources-rcl\\src\\components\\verses\\Verse.js";
  var hash = "14882834ab6b5f690dc5fe9dff3ffe7e9ab7b5a9";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "D:\\Projects-unfoldingWord\\scripture-resources-rcl\\src\\components\\verses\\Verse.js",
    statementMap: {
      "0": {
        start: {
          line: 11,
          column: 21
        },
        end: {
          line: 78,
          column: 1
        }
      },
      "1": {
        start: {
          line: 21,
          column: 35
        },
        end: {
          line: 21,
          column: 71
        }
      },
      "2": {
        start: {
          line: 22,
          column: 17
        },
        end: {
          line: 22,
          column: 58
        }
      },
      "3": {
        start: {
          line: 24,
          column: 19
        },
        end: {
          line: 24,
          column: 31
        }
      },
      "4": {
        start: {
          line: 25,
          column: 2
        },
        end: {
          line: 25,
          column: 33
        }
      },
      "5": {
        start: {
          line: 27,
          column: 18
        },
        end: {
          line: 27,
          column: 29
        }
      },
      "6": {
        start: {
          line: 29,
          column: 23
        },
        end: {
          line: 31,
          column: 3
        }
      },
      "7": {
        start: {
          line: 30,
          column: 4
        },
        end: {
          line: 30,
          column: 35
        }
      },
      "8": {
        start: {
          line: 30,
          column: 19
        },
        end: {
          line: 30,
          column: 35
        }
      },
      "9": {
        start: {
          line: 32,
          column: 16
        },
        end: {
          line: 32,
          column: 61
        }
      },
      "10": {
        start: {
          line: 34,
          column: 4
        },
        end: {
          line: 37,
          column: 7
        }
      },
      "11": {
        start: {
          line: 39,
          column: 28
        },
        end: {
          line: 39,
          column: 46
        }
      },
      "12": {
        start: {
          line: 40,
          column: 30
        },
        end: {
          line: 40,
          column: 56
        }
      },
      "13": {
        start: {
          line: 42,
          column: 2
        },
        end: {
          line: 62,
          column: 88
        }
      },
      "14": {
        start: {
          line: 43,
          column: 4
        },
        end: {
          line: 61,
          column: 5
        }
      },
      "15": {
        start: {
          line: 45,
          column: 6
        },
        end: {
          line: 47,
          column: 7
        }
      },
      "16": {
        start: {
          line: 46,
          column: 8
        },
        end: {
          line: 46,
          column: 45
        }
      },
      "17": {
        start: {
          line: 50,
          column: 8
        },
        end: {
          line: 58,
          column: 11
        }
      },
      "18": {
        start: {
          line: 60,
          column: 6
        },
        end: {
          line: 60,
          column: 23
        }
      },
      "19": {
        start: {
          line: 64,
          column: 22
        },
        end: {
          line: 68,
          column: 14
        }
      },
      "20": {
        start: {
          line: 65,
          column: 23
        },
        end: {
          line: 65,
          column: 65
        }
      },
      "21": {
        start: {
          line: 66,
          column: 4
        },
        end: {
          line: 66,
          column: 35
        }
      },
      "22": {
        start: {
          line: 66,
          column: 16
        },
        end: {
          line: 66,
          column: 35
        }
      },
      "23": {
        start: {
          line: 70,
          column: 16
        },
        end: {
          line: 70,
          column: 18
        }
      },
      "24": {
        start: {
          line: 71,
          column: 2
        },
        end: {
          line: 71,
          column: 43
        }
      },
      "25": {
        start: {
          line: 71,
          column: 18
        },
        end: {
          line: 71,
          column: 43
        }
      },
      "26": {
        start: {
          line: 73,
          column: 2
        },
        end: {
          line: 77,
          column: 4
        }
      },
      "27": {
        start: {
          line: 74,
          column: 95
        },
        end: {
          line: 74,
          column: 117
        }
      },
      "28": {
        start: {
          line: 80,
          column: 0
        },
        end: {
          line: 91,
          column: 2
        }
      },
      "29": {
        start: {
          line: 93,
          column: 18
        },
        end: {
          line: 96,
          column: 3
        }
      },
      "30": {
        start: {
          line: 93,
          column: 39
        },
        end: {
          line: 96,
          column: 1
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 11,
            column: 21
          },
          end: {
            line: 11,
            column: 22
          }
        },
        loc: {
          start: {
            line: 20,
            column: 6
          },
          end: {
            line: 78,
            column: 1
          }
        },
        line: 20
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 29,
            column: 23
          },
          end: {
            line: 29,
            column: 24
          }
        },
        loc: {
          start: {
            line: 29,
            column: 38
          },
          end: {
            line: 31,
            column: 3
          }
        },
        line: 29
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 42,
            column: 12
          },
          end: {
            line: 42,
            column: 13
          }
        },
        loc: {
          start: {
            line: 42,
            column: 18
          },
          end: {
            line: 62,
            column: 3
          }
        },
        line: 42
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 64,
            column: 34
          },
          end: {
            line: 64,
            column: 35
          }
        },
        loc: {
          start: {
            line: 64,
            column: 47
          },
          end: {
            line: 68,
            column: 3
          }
        },
        line: 64
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 74,
            column: 89
          },
          end: {
            line: 74,
            column: 90
          }
        },
        loc: {
          start: {
            line: 74,
            column: 95
          },
          end: {
            line: 74,
            column: 117
          }
        },
        line: 74
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 93,
            column: 29
          },
          end: {
            line: 93,
            column: 30
          }
        },
        loc: {
          start: {
            line: 93,
            column: 39
          },
          end: {
            line: 96,
            column: 1
          }
        },
        line: 93
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 30,
            column: 4
          },
          end: {
            line: 30,
            column: 35
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 30,
            column: 4
          },
          end: {
            line: 30,
            column: 35
          }
        }, {
          start: {
            line: 30,
            column: 4
          },
          end: {
            line: 30,
            column: 35
          }
        }],
        line: 30
      },
      "1": {
        loc: {
          start: {
            line: 43,
            column: 4
          },
          end: {
            line: 61,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 43,
            column: 4
          },
          end: {
            line: 61,
            column: 5
          }
        }, {
          start: {
            line: 43,
            column: 4
          },
          end: {
            line: 61,
            column: 5
          }
        }],
        line: 43
      },
      "2": {
        loc: {
          start: {
            line: 45,
            column: 6
          },
          end: {
            line: 47,
            column: 7
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 45,
            column: 6
          },
          end: {
            line: 47,
            column: 7
          }
        }, {
          start: {
            line: 45,
            column: 6
          },
          end: {
            line: 47,
            column: 7
          }
        }],
        line: 45
      },
      "3": {
        loc: {
          start: {
            line: 66,
            column: 4
          },
          end: {
            line: 66,
            column: 35
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 66,
            column: 4
          },
          end: {
            line: 66,
            column: 35
          }
        }, {
          start: {
            line: 66,
            column: 4
          },
          end: {
            line: 66,
            column: 35
          }
        }],
        line: 66
      },
      "4": {
        loc: {
          start: {
            line: 71,
            column: 2
          },
          end: {
            line: 71,
            column: 43
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 71,
            column: 2
          },
          end: {
            line: 71,
            column: 43
          }
        }, {
          start: {
            line: 71,
            column: 2
          },
          end: {
            line: 71,
            column: 43
          }
        }],
        line: 71
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "14882834ab6b5f690dc5fe9dff3ffe7e9ab7b5a9"
  };
  var coverage = global[gcv] || (global[gcv] = {});

  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }

  var actualCoverage = coverage[path];

  cov_2liq3mmde4 = function () {
    return actualCoverage;
  };

  return actualCoverage;
}

cov_2liq3mmde4();

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance"); }

function _iterableToArrayLimit(arr, i) { if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === "[object Arguments]")) { return; } var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

cov_2liq3mmde4().s[0]++;

var Verse = ({
  verseKey,
  verseObjects,
  paragraphs,
  showUnsupported,
  disableWordPopover,
  direction,
  renderOffscreen,
  reference
}) => {
  var _referenceSelectedCon;

  cov_2liq3mmde4().f[0]++;
  var referenceSelectedContext = (cov_2liq3mmde4().s[1]++, (0, _react.useContext)(_ReferenceSelectedContext.ReferenceSelectedContext));
  var update = (cov_2liq3mmde4().s[2]++, referenceSelectedContext === null || referenceSelectedContext === void 0 ? void 0 : (_referenceSelectedCon = referenceSelectedContext.actions) === null || _referenceSelectedCon === void 0 ? void 0 : _referenceSelectedCon.update);
  var verseRef = (cov_2liq3mmde4().s[3]++, (0, _react.useRef)(null));
  cov_2liq3mmde4().s[4]++;
  (0, _helpers.useHandleCopy)(verseRef.current);
  var classes = (cov_2liq3mmde4().s[5]++, useStyles());
  cov_2liq3mmde4().s[6]++;

  var onVisibility = isVisible => {
    cov_2liq3mmde4().f[1]++;
    cov_2liq3mmde4().s[7]++;

    if (isVisible) {
      cov_2liq3mmde4().b[0][0]++;
      cov_2liq3mmde4().s[8]++;
      setViewed(true);
    } else {
      cov_2liq3mmde4().b[0][1]++;
    }
  };

  var width = (cov_2liq3mmde4().s[9]++, "".concat(((Math.random() + 1) / 2 * 100).toFixed(0), "%"));
  var skeleton = (cov_2liq3mmde4().s[10]++, _react.default.createElement(_react.default.Fragment, null, _react.default.createElement(_reactWaypoint.Waypoint, {
    onEnter: onVisibility
  }), _react.default.createElement(_lab.Skeleton, {
    height: 6,
    width: width
  })));

  var _ref = (cov_2liq3mmde4().s[11]++, (0, _react.useState)(skeleton)),
      _ref2 = _slicedToArray(_ref, 2),
      verse = _ref2[0],
      setVerse = _ref2[1];

  var _ref3 = (cov_2liq3mmde4().s[12]++, (0, _react.useState)(!renderOffscreen)),
      _ref4 = _slicedToArray(_ref3, 2),
      viewed = _ref4[0],
      setViewed = _ref4[1];

  cov_2liq3mmde4().s[13]++;
  (0, _react.useEffect)(() => {
    cov_2liq3mmde4().f[2]++;
    cov_2liq3mmde4().s[14]++;

    if (viewed) {
      cov_2liq3mmde4().b[1][0]++;
      var verseNumber;
      cov_2liq3mmde4().s[15]++;

      if (!['front', 'back'].includes(verseKey)) {
        cov_2liq3mmde4().b[2][0]++;
        cov_2liq3mmde4().s[16]++;
        verseNumber = _react.default.createElement("sup", null, verseKey, " ");
      } else {
        cov_2liq3mmde4().b[2][1]++;
      }

      var _verse = (cov_2liq3mmde4().s[17]++, _react.default.createElement(_react.default.Fragment, null, verseNumber, _react.default.createElement(_verseObjects.VerseObjects, {
        verseObjects: verseObjects,
        paragraphs: paragraphs,
        showUnsupported: showUnsupported,
        disableWordPopover: disableWordPopover
      })));

      cov_2liq3mmde4().s[18]++;
      setVerse(_verse);
    } else {
      cov_2liq3mmde4().b[1][1]++;
    }
  }, [verseKey, verseObjects, paragraphs, showUnsupported, disableWordPopover, viewed]);
  var handleClick = (cov_2liq3mmde4().s[19]++, (0, _react.useCallback)(reference => {
    cov_2liq3mmde4().f[3]++;

    var _reference = (cov_2liq3mmde4().s[20]++, _objectSpread(_objectSpread({}, reference), {}, {
      verse: parseInt(verseKey)
    }));

    cov_2liq3mmde4().s[21]++;

    if (update) {
      cov_2liq3mmde4().b[3][0]++;
      cov_2liq3mmde4().s[22]++;
      update(_reference);
    } else {
      cov_2liq3mmde4().b[3][1]++;
    }
    /** WARN: ReferenceSelectedContext is not part of useCallback dependencies! */

  }, [update]));
  var style = (cov_2liq3mmde4().s[23]++, {});
  cov_2liq3mmde4().s[24]++;

  if (paragraphs) {
    cov_2liq3mmde4().b[4][0]++;
    cov_2liq3mmde4().s[25]++;
    style.display = 'inline';
  } else {
    cov_2liq3mmde4().b[4][1]++;
  }

  cov_2liq3mmde4().s[26]++;
  return _react.default.createElement("div", {
    ref: verseRef,
    className: classes.verse,
    style: style,
    dir: direction,
    onClick: () => {
      cov_2liq3mmde4().f[4]++;
      cov_2liq3mmde4().s[27]++;
      return handleClick(reference);
    }
  }, verse);
};

exports.Verse = Verse;
cov_2liq3mmde4().s[28]++;
Verse.propTypes = {
  verseKey: _propTypes.default.string.isRequired,
  verseObjects: _propTypes.default.array.isRequired,

  /** render verses paragraphs, use explicit paragraphs */
  paragraphs: _propTypes.default.bool,

  /** bypass rendering only when visible */
  renderOffscreen: _propTypes.default.bool,

  /** render unsupported usfm markers */
  showUnsupported: _propTypes.default.bool,

  /** disable popovers for aligned and original language words */
  disableWordPopover: _propTypes.default.bool
};
var useStyles = (cov_2liq3mmde4().s[29]++, (0, _styles.makeStyles)(theme => {
  cov_2liq3mmde4().f[5]++;
  cov_2liq3mmde4().s[30]++;
  return {
    verse: {}
  };
}));
var _default = Verse;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3ZlcnNlcy9WZXJzZS5qcyJdLCJuYW1lcyI6WyJWZXJzZSIsInZlcnNlS2V5IiwidmVyc2VPYmplY3RzIiwicGFyYWdyYXBocyIsInNob3dVbnN1cHBvcnRlZCIsImRpc2FibGVXb3JkUG9wb3ZlciIsImRpcmVjdGlvbiIsInJlbmRlck9mZnNjcmVlbiIsInJlZmVyZW5jZSIsInJlZmVyZW5jZVNlbGVjdGVkQ29udGV4dCIsIlJlZmVyZW5jZVNlbGVjdGVkQ29udGV4dCIsInVwZGF0ZSIsImFjdGlvbnMiLCJ2ZXJzZVJlZiIsImN1cnJlbnQiLCJjbGFzc2VzIiwidXNlU3R5bGVzIiwib25WaXNpYmlsaXR5IiwiaXNWaXNpYmxlIiwic2V0Vmlld2VkIiwid2lkdGgiLCJNYXRoIiwicmFuZG9tIiwidG9GaXhlZCIsInNrZWxldG9uIiwidmVyc2UiLCJzZXRWZXJzZSIsInZpZXdlZCIsInZlcnNlTnVtYmVyIiwiaW5jbHVkZXMiLCJfdmVyc2UiLCJoYW5kbGVDbGljayIsIl9yZWZlcmVuY2UiLCJwYXJzZUludCIsInN0eWxlIiwiZGlzcGxheSIsInByb3BUeXBlcyIsIlByb3BUeXBlcyIsInN0cmluZyIsImlzUmVxdWlyZWQiLCJhcnJheSIsImJvb2wiLCJ0aGVtZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBOztBQUNBOztBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRU8sSUFBTUEsS0FBSyxHQUFHLENBQUM7QUFDcEJDLEVBQUFBLFFBRG9CO0FBRXBCQyxFQUFBQSxZQUZvQjtBQUdwQkMsRUFBQUEsVUFIb0I7QUFJcEJDLEVBQUFBLGVBSm9CO0FBS3BCQyxFQUFBQSxrQkFMb0I7QUFNcEJDLEVBQUFBLFNBTm9CO0FBT3BCQyxFQUFBQSxlQVBvQjtBQVFwQkMsRUFBQUE7QUFSb0IsQ0FBRCxLQVNmO0FBQUE7O0FBQUE7QUFDSixNQUFNQyx3QkFBd0IsNkJBQUcsdUJBQVdDLGtEQUFYLENBQUgsQ0FBOUI7QUFDQSxNQUFNQyxNQUFNLDZCQUFHRix3QkFBSCxhQUFHQSx3QkFBSCxnREFBR0Esd0JBQXdCLENBQUVHLE9BQTdCLDBEQUFHLHNCQUFtQ0QsTUFBdEMsQ0FBWjtBQUVBLE1BQU1FLFFBQVEsNkJBQUcsbUJBQU8sSUFBUCxDQUFILENBQWQ7QUFKSTtBQUtKLDhCQUFjQSxRQUFRLENBQUNDLE9BQXZCO0FBRUEsTUFBTUMsT0FBTyw2QkFBR0MsU0FBUyxFQUFaLENBQWI7QUFQSTs7QUFTSixNQUFNQyxZQUFZLEdBQUlDLFNBQUQsSUFBZTtBQUFBO0FBQUE7O0FBQ2xDLFFBQUlBLFNBQUosRUFBZTtBQUFBO0FBQUE7QUFBQUMsTUFBQUEsU0FBUyxDQUFDLElBQUQsQ0FBVDtBQUFnQixLQUEvQjtBQUFBO0FBQUE7QUFDRCxHQUZEOztBQUdBLE1BQU1DLEtBQUssdUNBQU0sQ0FBQyxDQUFDQyxJQUFJLENBQUNDLE1BQUwsS0FBZSxDQUFoQixJQUFtQixDQUFuQixHQUF1QixHQUF4QixFQUE2QkMsT0FBN0IsQ0FBcUMsQ0FBckMsQ0FBTixPQUFYO0FBQ0EsTUFBTUMsUUFBUSw4QkFDWiw0REFDRSw2QkFBQyx1QkFBRDtBQUFVLElBQUEsT0FBTyxFQUFFUDtBQUFuQixJQURGLEVBRUUsNkJBQUMsYUFBRDtBQUFVLElBQUEsTUFBTSxFQUFFLENBQWxCO0FBQXFCLElBQUEsS0FBSyxFQUFFRztBQUE1QixJQUZGLENBRFksQ0FBZDs7QUFiSSx3Q0FtQnNCLHFCQUFTSSxRQUFULENBbkJ0QjtBQUFBO0FBQUEsTUFtQkdDLEtBbkJIO0FBQUEsTUFtQlVDLFFBbkJWOztBQUFBLHlDQW9Cd0IscUJBQVMsQ0FBQ25CLGVBQVYsQ0FwQnhCO0FBQUE7QUFBQSxNQW9CR29CLE1BcEJIO0FBQUEsTUFvQldSLFNBcEJYOztBQUFBO0FBc0JKLHdCQUFVLE1BQU07QUFBQTtBQUFBOztBQUNkLFFBQUlRLE1BQUosRUFBWTtBQUFBO0FBQ1YsVUFBSUMsV0FBSjtBQURVOztBQUVWLFVBQUksQ0FBQyxDQUFDLE9BQUQsRUFBUyxNQUFULEVBQWlCQyxRQUFqQixDQUEwQjVCLFFBQTFCLENBQUwsRUFBMEM7QUFBQTtBQUFBO0FBQ3hDMkIsUUFBQUEsV0FBVyxHQUFHLDBDQUFNM0IsUUFBTixNQUFkO0FBQ0QsT0FGRDtBQUFBO0FBQUE7O0FBSUEsVUFBTTZCLE1BQU0sOEJBQ1YsNERBQ0dGLFdBREgsRUFFRSw2QkFBQywwQkFBRDtBQUNFLFFBQUEsWUFBWSxFQUFFMUIsWUFEaEI7QUFFRSxRQUFBLFVBQVUsRUFBRUMsVUFGZDtBQUdFLFFBQUEsZUFBZSxFQUFFQyxlQUhuQjtBQUlFLFFBQUEsa0JBQWtCLEVBQUVDO0FBSnRCLFFBRkYsQ0FEVSxDQUFaOztBQU5VO0FBaUJWcUIsTUFBQUEsUUFBUSxDQUFDSSxNQUFELENBQVI7QUFDRCxLQWxCRDtBQUFBO0FBQUE7QUFtQkQsR0FwQkQsRUFvQkcsQ0FBQzdCLFFBQUQsRUFBV0MsWUFBWCxFQUF5QkMsVUFBekIsRUFBcUNDLGVBQXJDLEVBQXNEQyxrQkFBdEQsRUFBMEVzQixNQUExRSxDQXBCSDtBQXNCQSxNQUFNSSxXQUFXLDhCQUFHLHdCQUFZdkIsU0FBUyxJQUFJO0FBQUE7O0FBQzNDLFFBQU13QixVQUFVLDhEQUFPeEIsU0FBUDtBQUFrQmlCLE1BQUFBLEtBQUssRUFBRVEsUUFBUSxDQUFDaEMsUUFBRDtBQUFqQyxPQUFoQjs7QUFEMkM7O0FBRTNDLFFBQUlVLE1BQUosRUFBWTtBQUFBO0FBQUE7QUFBQUEsTUFBQUEsTUFBTSxDQUFDcUIsVUFBRCxDQUFOO0FBQW1CLEtBQS9CO0FBQUE7QUFBQTtBQUNBOztBQUNELEdBSm1CLEVBSWpCLENBQUNyQixNQUFELENBSmlCLENBQUgsQ0FBakI7QUFNQSxNQUFNdUIsS0FBSyw4QkFBRyxFQUFILENBQVg7QUFsREk7O0FBbURKLE1BQUkvQixVQUFKLEVBQWdCO0FBQUE7QUFBQTtBQUFBK0IsSUFBQUEsS0FBSyxDQUFDQyxPQUFOLEdBQWdCLFFBQWhCO0FBQXlCLEdBQXpDO0FBQUE7QUFBQTs7QUFuREk7QUFxREosU0FDRTtBQUFLLElBQUEsR0FBRyxFQUFFdEIsUUFBVjtBQUFvQixJQUFBLFNBQVMsRUFBRUUsT0FBTyxDQUFDVSxLQUF2QztBQUE4QyxJQUFBLEtBQUssRUFBRVMsS0FBckQ7QUFBNEQsSUFBQSxHQUFHLEVBQUU1QixTQUFqRTtBQUE0RSxJQUFBLE9BQU8sRUFBRSxNQUFNO0FBQUE7QUFBQTtBQUFBLGFBQUF5QixXQUFXLENBQUN2QixTQUFELENBQVg7QUFBc0I7QUFBakgsS0FDR2lCLEtBREgsQ0FERjtBQUtELENBbkVNOzs7O0FBcUVQekIsS0FBSyxDQUFDb0MsU0FBTixHQUFrQjtBQUNoQm5DLEVBQUFBLFFBQVEsRUFBRW9DLG1CQUFVQyxNQUFWLENBQWlCQyxVQURYO0FBRWhCckMsRUFBQUEsWUFBWSxFQUFFbUMsbUJBQVVHLEtBQVYsQ0FBZ0JELFVBRmQ7O0FBR2hCO0FBQ0FwQyxFQUFBQSxVQUFVLEVBQUVrQyxtQkFBVUksSUFKTjs7QUFLaEI7QUFDQWxDLEVBQUFBLGVBQWUsRUFBRThCLG1CQUFVSSxJQU5YOztBQU9oQjtBQUNBckMsRUFBQUEsZUFBZSxFQUFFaUMsbUJBQVVJLElBUlg7O0FBU2hCO0FBQ0FwQyxFQUFBQSxrQkFBa0IsRUFBRWdDLG1CQUFVSTtBQVZkLENBQWxCO0FBYUEsSUFBTXpCLFNBQVMsOEJBQUcsd0JBQVcwQixLQUFLLElBQUs7QUFBQTtBQUFBO0FBQUE7QUFDckNqQixJQUFBQSxLQUFLLEVBQUU7QUFEOEI7QUFHdEMsQ0FIaUIsQ0FBSCxDQUFmO2VBS2V6QixLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7dXNlQ2FsbGJhY2ssIHVzZUNvbnRleHQsIHVzZVN0YXRlLCB1c2VFZmZlY3QsIHVzZVJlZn0gZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xyXG5pbXBvcnQge21ha2VTdHlsZXN9IGZyb20gJ0BtYXRlcmlhbC11aS9jb3JlL3N0eWxlcyc7XHJcbmltcG9ydCB7U2tlbGV0b259IGZyb20gJ0BtYXRlcmlhbC11aS9sYWInO1xyXG5pbXBvcnQge1dheXBvaW50fSBmcm9tICdyZWFjdC13YXlwb2ludCc7XHJcblxyXG5pbXBvcnQge1ZlcnNlT2JqZWN0c30gZnJvbSAnLi4vdmVyc2Utb2JqZWN0cyc7XHJcbmltcG9ydCB7IHVzZUhhbmRsZUNvcHkgfSBmcm9tICcuL2hlbHBlcnMnO1xyXG5pbXBvcnQgeyBSZWZlcmVuY2VTZWxlY3RlZENvbnRleHQgfSBmcm9tICcuLi9yZWZlcmVuY2UvUmVmZXJlbmNlU2VsZWN0ZWRDb250ZXh0JztcclxuXHJcbmV4cG9ydCBjb25zdCBWZXJzZSA9ICh7XHJcbiAgdmVyc2VLZXksXHJcbiAgdmVyc2VPYmplY3RzLFxyXG4gIHBhcmFncmFwaHMsXHJcbiAgc2hvd1Vuc3VwcG9ydGVkLFxyXG4gIGRpc2FibGVXb3JkUG9wb3ZlcixcclxuICBkaXJlY3Rpb24sXHJcbiAgcmVuZGVyT2Zmc2NyZWVuLFxyXG4gIHJlZmVyZW5jZVxyXG59KSA9PiB7XHJcbiAgY29uc3QgcmVmZXJlbmNlU2VsZWN0ZWRDb250ZXh0ID0gdXNlQ29udGV4dChSZWZlcmVuY2VTZWxlY3RlZENvbnRleHQpO1xyXG4gIGNvbnN0IHVwZGF0ZSA9IHJlZmVyZW5jZVNlbGVjdGVkQ29udGV4dD8uYWN0aW9ucz8udXBkYXRlO1xyXG5cclxuICBjb25zdCB2ZXJzZVJlZiA9IHVzZVJlZihudWxsKTtcclxuICB1c2VIYW5kbGVDb3B5KHZlcnNlUmVmLmN1cnJlbnQpXHJcblxyXG4gIGNvbnN0IGNsYXNzZXMgPSB1c2VTdHlsZXMoKTtcclxuXHJcbiAgY29uc3Qgb25WaXNpYmlsaXR5ID0gKGlzVmlzaWJsZSkgPT4ge1xyXG4gICAgaWYgKGlzVmlzaWJsZSkgc2V0Vmlld2VkKHRydWUpO1xyXG4gIH07XHJcbiAgY29uc3Qgd2lkdGggPSBgJHsoKE1hdGgucmFuZG9tKCkgKzEpLzIgKiAxMDApLnRvRml4ZWQoMCl9JWA7XHJcbiAgY29uc3Qgc2tlbGV0b24gPSAoXHJcbiAgICA8PlxyXG4gICAgICA8V2F5cG9pbnQgb25FbnRlcj17b25WaXNpYmlsaXR5fSAvPlxyXG4gICAgICA8U2tlbGV0b24gaGVpZ2h0PXs2fSB3aWR0aD17d2lkdGh9IC8+XHJcbiAgICA8Lz5cclxuICApO1xyXG4gIGNvbnN0IFt2ZXJzZSwgc2V0VmVyc2VdID0gdXNlU3RhdGUoc2tlbGV0b24pO1xyXG4gIGNvbnN0IFt2aWV3ZWQsIHNldFZpZXdlZF0gPSB1c2VTdGF0ZSghcmVuZGVyT2Zmc2NyZWVuKTtcclxuXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIGlmICh2aWV3ZWQpIHtcclxuICAgICAgbGV0IHZlcnNlTnVtYmVyO1xyXG4gICAgICBpZiAoIVsnZnJvbnQnLCdiYWNrJ10uaW5jbHVkZXModmVyc2VLZXkpKSB7XHJcbiAgICAgICAgdmVyc2VOdW1iZXIgPSA8c3VwPnt2ZXJzZUtleX0gPC9zdXA+O1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCBfdmVyc2UgPSAoXHJcbiAgICAgICAgPD5cclxuICAgICAgICAgIHt2ZXJzZU51bWJlcn1cclxuICAgICAgICAgIDxWZXJzZU9iamVjdHNcclxuICAgICAgICAgICAgdmVyc2VPYmplY3RzPXt2ZXJzZU9iamVjdHN9XHJcbiAgICAgICAgICAgIHBhcmFncmFwaHM9e3BhcmFncmFwaHN9XHJcbiAgICAgICAgICAgIHNob3dVbnN1cHBvcnRlZD17c2hvd1Vuc3VwcG9ydGVkfVxyXG4gICAgICAgICAgICBkaXNhYmxlV29yZFBvcG92ZXI9e2Rpc2FibGVXb3JkUG9wb3Zlcn1cclxuICAgICAgICAgIC8+XHJcbiAgICAgICAgPC8+XHJcbiAgICAgICk7XHJcbiAgICAgIHNldFZlcnNlKF92ZXJzZSk7XHJcbiAgICB9XHJcbiAgfSwgW3ZlcnNlS2V5LCB2ZXJzZU9iamVjdHMsIHBhcmFncmFwaHMsIHNob3dVbnN1cHBvcnRlZCwgZGlzYWJsZVdvcmRQb3BvdmVyLCB2aWV3ZWRdKTtcclxuXHJcbiAgY29uc3QgaGFuZGxlQ2xpY2sgPSB1c2VDYWxsYmFjayhyZWZlcmVuY2UgPT4ge1xyXG4gICAgY29uc3QgX3JlZmVyZW5jZSA9IHsuLi5yZWZlcmVuY2UsIHZlcnNlOiBwYXJzZUludCh2ZXJzZUtleSkgfTtcclxuICAgIGlmICh1cGRhdGUpIHVwZGF0ZShfcmVmZXJlbmNlKTtcclxuICAgIC8qKiBXQVJOOiBSZWZlcmVuY2VTZWxlY3RlZENvbnRleHQgaXMgbm90IHBhcnQgb2YgdXNlQ2FsbGJhY2sgZGVwZW5kZW5jaWVzISAqL1xyXG4gIH0sIFt1cGRhdGVdKTtcclxuXHJcbiAgY29uc3Qgc3R5bGUgPSB7fTtcclxuICBpZiAocGFyYWdyYXBocykgc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUnO1xyXG5cclxuICByZXR1cm4gKFxyXG4gICAgPGRpdiByZWY9e3ZlcnNlUmVmfSBjbGFzc05hbWU9e2NsYXNzZXMudmVyc2V9IHN0eWxlPXtzdHlsZX0gZGlyPXtkaXJlY3Rpb259IG9uQ2xpY2s9eygpID0+IGhhbmRsZUNsaWNrKHJlZmVyZW5jZSl9PlxyXG4gICAgICB7dmVyc2V9XHJcbiAgICA8L2Rpdj5cclxuICApO1xyXG59O1xyXG5cclxuVmVyc2UucHJvcFR5cGVzID0ge1xyXG4gIHZlcnNlS2V5OiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXHJcbiAgdmVyc2VPYmplY3RzOiBQcm9wVHlwZXMuYXJyYXkuaXNSZXF1aXJlZCxcclxuICAvKiogcmVuZGVyIHZlcnNlcyBwYXJhZ3JhcGhzLCB1c2UgZXhwbGljaXQgcGFyYWdyYXBocyAqL1xyXG4gIHBhcmFncmFwaHM6IFByb3BUeXBlcy5ib29sLFxyXG4gIC8qKiBieXBhc3MgcmVuZGVyaW5nIG9ubHkgd2hlbiB2aXNpYmxlICovXHJcbiAgcmVuZGVyT2Zmc2NyZWVuOiBQcm9wVHlwZXMuYm9vbCxcclxuICAvKiogcmVuZGVyIHVuc3VwcG9ydGVkIHVzZm0gbWFya2VycyAqLyBcclxuICBzaG93VW5zdXBwb3J0ZWQ6IFByb3BUeXBlcy5ib29sLFxyXG4gIC8qKiBkaXNhYmxlIHBvcG92ZXJzIGZvciBhbGlnbmVkIGFuZCBvcmlnaW5hbCBsYW5ndWFnZSB3b3JkcyAqL1xyXG4gIGRpc2FibGVXb3JkUG9wb3ZlcjogUHJvcFR5cGVzLmJvb2wsXHJcbn07XHJcblxyXG5jb25zdCB1c2VTdHlsZXMgPSBtYWtlU3R5bGVzKHRoZW1lID0+ICh7XHJcbiAgdmVyc2U6IHtcclxuICB9LFxyXG59KSk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBWZXJzZTtcclxuIl19