"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.occurrenceInjectVerseObjects = exports.getOccurrences = exports.getOccurrence = exports.getWordText = exports.verseObjectsToString = exports.flattenVerseObjects = void 0;

var _stringPunctuationTokenizer = _interopRequireDefault(require("string-punctuation-tokenizer"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function cov_kkofcvm31() {
  var path = "D:\\Projects-unfoldingWord\\scripture-resources-rcl\\src\\core\\selections\\verseObjects.js";
  var hash = "cd5729df9efc282982ddae9d39d0cbe687b8776b";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "D:\\Projects-unfoldingWord\\scripture-resources-rcl\\src\\core\\selections\\verseObjects.js",
    statementMap: {
      "0": {
        start: {
          line: 13,
          column: 35
        },
        end: {
          line: 27,
          column: 1
        }
      },
      "1": {
        start: {
          line: 14,
          column: 22
        },
        end: {
          line: 14,
          column: 39
        }
      },
      "2": {
        start: {
          line: 15,
          column: 2
        },
        end: {
          line: 25,
          column: 3
        }
      },
      "3": {
        start: {
          line: 16,
          column: 19
        },
        end: {
          line: 16,
          column: 40
        }
      },
      "4": {
        start: {
          line: 17,
          column: 4
        },
        end: {
          line: 24,
          column: 5
        }
      },
      "5": {
        start: {
          line: 18,
          column: 6
        },
        end: {
          line: 23,
          column: 7
        }
      },
      "6": {
        start: {
          line: 19,
          column: 22
        },
        end: {
          line: 19,
          column: 58
        }
      },
      "7": {
        start: {
          line: 20,
          column: 8
        },
        end: {
          line: 20,
          column: 53
        }
      },
      "8": {
        start: {
          line: 20,
          column: 33
        },
        end: {
          line: 20,
          column: 51
        }
      },
      "9": {
        start: {
          line: 22,
          column: 8
        },
        end: {
          line: 22,
          column: 26
        }
      },
      "10": {
        start: {
          line: 26,
          column: 2
        },
        end: {
          line: 26,
          column: 14
        }
      },
      "11": {
        start: {
          line: 29,
          column: 36
        },
        end: {
          line: 33,
          column: 1
        }
      },
      "12": {
        start: {
          line: 30,
          column: 32
        },
        end: {
          line: 30,
          column: 65
        }
      },
      "13": {
        start: {
          line: 31,
          column: 17
        },
        end: {
          line: 31,
          column: 85
        }
      },
      "14": {
        start: {
          line: 31,
          column: 58
        },
        end: {
          line: 31,
          column: 74
        }
      },
      "15": {
        start: {
          line: 32,
          column: 2
        },
        end: {
          line: 32,
          column: 16
        }
      },
      "16": {
        start: {
          line: 45,
          column: 27
        },
        end: {
          line: 50,
          column: 1
        }
      },
      "17": {
        start: {
          line: 46,
          column: 2
        },
        end: {
          line: 48,
          column: 3
        }
      },
      "18": {
        start: {
          line: 47,
          column: 4
        },
        end: {
          line: 47,
          column: 27
        }
      },
      "19": {
        start: {
          line: 49,
          column: 2
        },
        end: {
          line: 49,
          column: 50
        }
      },
      "20": {
        start: {
          line: 59,
          column: 29
        },
        end: {
          line: 71,
          column: 1
        }
      },
      "21": {
        start: {
          line: 60,
          column: 2
        },
        end: {
          line: 62,
          column: 3
        }
      },
      "22": {
        start: {
          line: 61,
          column: 4
        },
        end: {
          line: 61,
          column: 76
        }
      },
      "23": {
        start: {
          line: 64,
          column: 19
        },
        end: {
          line: 64,
          column: 20
        }
      },
      "24": {
        start: {
          line: 65,
          column: 2
        },
        end: {
          line: 69,
          column: 3
        }
      },
      "25": {
        start: {
          line: 66,
          column: 4
        },
        end: {
          line: 68,
          column: 7
        }
      },
      "26": {
        start: {
          line: 67,
          column: 6
        },
        end: {
          line: 67,
          column: 85
        }
      },
      "27": {
        start: {
          line: 67,
          column: 72
        },
        end: {
          line: 67,
          column: 85
        }
      },
      "28": {
        start: {
          line: 70,
          column: 2
        },
        end: {
          line: 70,
          column: 20
        }
      },
      "29": {
        start: {
          line: 79,
          column: 30
        },
        end: {
          line: 91,
          column: 1
        }
      },
      "30": {
        start: {
          line: 80,
          column: 2
        },
        end: {
          line: 82,
          column: 3
        }
      },
      "31": {
        start: {
          line: 81,
          column: 4
        },
        end: {
          line: 81,
          column: 59
        }
      },
      "32": {
        start: {
          line: 84,
          column: 20
        },
        end: {
          line: 84,
          column: 21
        }
      },
      "33": {
        start: {
          line: 85,
          column: 2
        },
        end: {
          line: 89,
          column: 3
        }
      },
      "34": {
        start: {
          line: 86,
          column: 4
        },
        end: {
          line: 88,
          column: 7
        }
      },
      "35": {
        start: {
          line: 87,
          column: 6
        },
        end: {
          line: 87,
          column: 57
        }
      },
      "36": {
        start: {
          line: 87,
          column: 43
        },
        end: {
          line: 87,
          column: 57
        }
      },
      "37": {
        start: {
          line: 90,
          column: 2
        },
        end: {
          line: 90,
          column: 21
        }
      },
      "38": {
        start: {
          line: 98,
          column: 44
        },
        end: {
          line: 113,
          column: 1
        }
      },
      "39": {
        start: {
          line: 99,
          column: 22
        },
        end: {
          line: 99,
          column: 24
        }
      },
      "40": {
        start: {
          line: 100,
          column: 2
        },
        end: {
          line: 111,
          column: 3
        }
      },
      "41": {
        start: {
          line: 101,
          column: 34
        },
        end: {
          line: 101,
          column: 67
        }
      },
      "42": {
        start: {
          line: 102,
          column: 4
        },
        end: {
          line: 110,
          column: 7
        }
      },
      "43": {
        start: {
          line: 103,
          column: 25
        },
        end: {
          line: 103,
          column: 43
        }
      },
      "44": {
        start: {
          line: 104,
          column: 6
        },
        end: {
          line: 108,
          column: 7
        }
      },
      "45": {
        start: {
          line: 105,
          column: 27
        },
        end: {
          line: 105,
          column: 88
        }
      },
      "46": {
        start: {
          line: 106,
          column: 28
        },
        end: {
          line: 106,
          column: 83
        }
      },
      "47": {
        start: {
          line: 107,
          column: 8
        },
        end: {
          line: 107,
          column: 67
        }
      },
      "48": {
        start: {
          line: 109,
          column: 6
        },
        end: {
          line: 109,
          column: 26
        }
      },
      "49": {
        start: {
          line: 112,
          column: 2
        },
        end: {
          line: 112,
          column: 23
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 13,
            column: 35
          },
          end: {
            line: 13,
            column: 36
          }
        },
        loc: {
          start: {
            line: 13,
            column: 64
          },
          end: {
            line: 27,
            column: 1
          }
        },
        line: 13
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 20,
            column: 22
          },
          end: {
            line: 20,
            column: 23
          }
        },
        loc: {
          start: {
            line: 20,
            column: 33
          },
          end: {
            line: 20,
            column: 51
          }
        },
        line: 20
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 29,
            column: 36
          },
          end: {
            line: 29,
            column: 37
          }
        },
        loc: {
          start: {
            line: 29,
            column: 54
          },
          end: {
            line: 33,
            column: 1
          }
        },
        line: 29
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 31,
            column: 43
          },
          end: {
            line: 31,
            column: 44
          }
        },
        loc: {
          start: {
            line: 31,
            column: 58
          },
          end: {
            line: 31,
            column: 74
          }
        },
        line: 31
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 45,
            column: 27
          },
          end: {
            line: 45,
            column: 28
          }
        },
        loc: {
          start: {
            line: 45,
            column: 43
          },
          end: {
            line: 50,
            column: 1
          }
        },
        line: 45
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 59,
            column: 29
          },
          end: {
            line: 59,
            column: 30
          }
        },
        loc: {
          start: {
            line: 59,
            column: 69
          },
          end: {
            line: 71,
            column: 1
          }
        },
        line: 59
      },
      "6": {
        name: "(anonymous_6)",
        decl: {
          start: {
            line: 66,
            column: 18
          },
          end: {
            line: 66,
            column: 19
          }
        },
        loc: {
          start: {
            line: 66,
            column: 35
          },
          end: {
            line: 68,
            column: 5
          }
        },
        line: 66
      },
      "7": {
        name: "(anonymous_7)",
        decl: {
          start: {
            line: 79,
            column: 30
          },
          end: {
            line: 79,
            column: 31
          }
        },
        loc: {
          start: {
            line: 79,
            column: 52
          },
          end: {
            line: 91,
            column: 1
          }
        },
        line: 79
      },
      "8": {
        name: "(anonymous_8)",
        decl: {
          start: {
            line: 86,
            column: 18
          },
          end: {
            line: 86,
            column: 19
          }
        },
        loc: {
          start: {
            line: 86,
            column: 26
          },
          end: {
            line: 88,
            column: 5
          }
        },
        line: 86
      },
      "9": {
        name: "(anonymous_9)",
        decl: {
          start: {
            line: 98,
            column: 44
          },
          end: {
            line: 98,
            column: 45
          }
        },
        loc: {
          start: {
            line: 98,
            column: 62
          },
          end: {
            line: 113,
            column: 1
          }
        },
        line: 98
      },
      "10": {
        name: "(anonymous_10)",
        decl: {
          start: {
            line: 102,
            column: 46
          },
          end: {
            line: 102,
            column: 47
          }
        },
        loc: {
          start: {
            line: 102,
            column: 70
          },
          end: {
            line: 110,
            column: 5
          }
        },
        line: 102
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 13,
            column: 50
          },
          end: {
            line: 13,
            column: 59
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 13,
            column: 57
          },
          end: {
            line: 13,
            column: 59
          }
        }],
        line: 13
      },
      "1": {
        loc: {
          start: {
            line: 17,
            column: 4
          },
          end: {
            line: 24,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 17,
            column: 4
          },
          end: {
            line: 24,
            column: 5
          }
        }, {
          start: {
            line: 17,
            column: 4
          },
          end: {
            line: 24,
            column: 5
          }
        }],
        line: 17
      },
      "2": {
        loc: {
          start: {
            line: 18,
            column: 6
          },
          end: {
            line: 23,
            column: 7
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 18,
            column: 6
          },
          end: {
            line: 23,
            column: 7
          }
        }, {
          start: {
            line: 18,
            column: 6
          },
          end: {
            line: 23,
            column: 7
          }
        }],
        line: 18
      },
      "3": {
        loc: {
          start: {
            line: 46,
            column: 2
          },
          end: {
            line: 48,
            column: 3
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 46,
            column: 2
          },
          end: {
            line: 48,
            column: 3
          }
        }, {
          start: {
            line: 46,
            column: 2
          },
          end: {
            line: 48,
            column: 3
          }
        }],
        line: 46
      },
      "4": {
        loc: {
          start: {
            line: 46,
            column: 6
          },
          end: {
            line: 46,
            column: 48
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 46,
            column: 6
          },
          end: {
            line: 46,
            column: 16
          }
        }, {
          start: {
            line: 46,
            column: 21
          },
          end: {
            line: 46,
            column: 47
          }
        }],
        line: 46
      },
      "5": {
        loc: {
          start: {
            line: 49,
            column: 9
          },
          end: {
            line: 49,
            column: 49
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 49,
            column: 22
          },
          end: {
            line: 49,
            column: 37
          }
        }, {
          start: {
            line: 49,
            column: 40
          },
          end: {
            line: 49,
            column: 49
          }
        }],
        line: 49
      },
      "6": {
        loc: {
          start: {
            line: 60,
            column: 2
          },
          end: {
            line: 62,
            column: 3
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 60,
            column: 2
          },
          end: {
            line: 62,
            column: 3
          }
        }, {
          start: {
            line: 60,
            column: 2
          },
          end: {
            line: 62,
            column: 3
          }
        }],
        line: 60
      },
      "7": {
        loc: {
          start: {
            line: 65,
            column: 2
          },
          end: {
            line: 69,
            column: 3
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 65,
            column: 2
          },
          end: {
            line: 69,
            column: 3
          }
        }, {
          start: {
            line: 65,
            column: 2
          },
          end: {
            line: 69,
            column: 3
          }
        }],
        line: 65
      },
      "8": {
        loc: {
          start: {
            line: 67,
            column: 6
          },
          end: {
            line: 67,
            column: 85
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 67,
            column: 6
          },
          end: {
            line: 67,
            column: 85
          }
        }, {
          start: {
            line: 67,
            column: 6
          },
          end: {
            line: 67,
            column: 85
          }
        }],
        line: 67
      },
      "9": {
        loc: {
          start: {
            line: 67,
            column: 10
          },
          end: {
            line: 67,
            column: 70
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 67,
            column: 10
          },
          end: {
            line: 67,
            column: 35
          }
        }, {
          start: {
            line: 67,
            column: 39
          },
          end: {
            line: 67,
            column: 70
          }
        }],
        line: 67
      },
      "10": {
        loc: {
          start: {
            line: 80,
            column: 2
          },
          end: {
            line: 82,
            column: 3
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 80,
            column: 2
          },
          end: {
            line: 82,
            column: 3
          }
        }, {
          start: {
            line: 80,
            column: 2
          },
          end: {
            line: 82,
            column: 3
          }
        }],
        line: 80
      },
      "11": {
        loc: {
          start: {
            line: 85,
            column: 2
          },
          end: {
            line: 89,
            column: 3
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 85,
            column: 2
          },
          end: {
            line: 89,
            column: 3
          }
        }, {
          start: {
            line: 85,
            column: 2
          },
          end: {
            line: 89,
            column: 3
          }
        }],
        line: 85
      },
      "12": {
        loc: {
          start: {
            line: 87,
            column: 6
          },
          end: {
            line: 87,
            column: 57
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 87,
            column: 6
          },
          end: {
            line: 87,
            column: 57
          }
        }, {
          start: {
            line: 87,
            column: 6
          },
          end: {
            line: 87,
            column: 57
          }
        }],
        line: 87
      },
      "13": {
        loc: {
          start: {
            line: 100,
            column: 2
          },
          end: {
            line: 111,
            column: 3
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 100,
            column: 2
          },
          end: {
            line: 111,
            column: 3
          }
        }, {
          start: {
            line: 100,
            column: 2
          },
          end: {
            line: 111,
            column: 3
          }
        }],
        line: 100
      },
      "14": {
        loc: {
          start: {
            line: 100,
            column: 6
          },
          end: {
            line: 100,
            column: 45
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 100,
            column: 6
          },
          end: {
            line: 100,
            column: 18
          }
        }, {
          start: {
            line: 100,
            column: 22
          },
          end: {
            line: 100,
            column: 45
          }
        }],
        line: 100
      },
      "15": {
        loc: {
          start: {
            line: 104,
            column: 6
          },
          end: {
            line: 108,
            column: 7
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 104,
            column: 6
          },
          end: {
            line: 108,
            column: 7
          }
        }, {
          start: {
            line: 104,
            column: 6
          },
          end: {
            line: 108,
            column: 7
          }
        }],
        line: 104
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0,
      "33": 0,
      "34": 0,
      "35": 0,
      "36": 0,
      "37": 0,
      "38": 0,
      "39": 0,
      "40": 0,
      "41": 0,
      "42": 0,
      "43": 0,
      "44": 0,
      "45": 0,
      "46": 0,
      "47": 0,
      "48": 0,
      "49": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0
    },
    b: {
      "0": [0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0],
      "6": [0, 0],
      "7": [0, 0],
      "8": [0, 0],
      "9": [0, 0],
      "10": [0, 0],
      "11": [0, 0],
      "12": [0, 0],
      "13": [0, 0],
      "14": [0, 0],
      "15": [0, 0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "cd5729df9efc282982ddae9d39d0cbe687b8776b"
  };
  var coverage = global[gcv] || (global[gcv] = {});

  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }

  var actualCoverage = coverage[path];

  cov_kkofcvm31 = function () {
    return actualCoverage;
  };

  return actualCoverage;
}

cov_kkofcvm31();

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

cov_kkofcvm31().s[0]++;

/**
 * Borrowed and adapted from:
 * https://github.com/unfoldingWord/word-aligner/blob/develop/src/js/utils/verseObjects.js
 */

/**
 * @description flatten verse objects from nested format to flat array
 * @param {array} verseObjects - source array of nested verseObjects
 * @param {array} flat - output array that will be filled with flattened verseObjects
 */
var flattenVerseObjects = (verseObjects, flat = (cov_kkofcvm31().b[0][0]++, [])) => {
  cov_kkofcvm31().f[0]++;

  var _verseObjects = (cov_kkofcvm31().s[1]++, [...verseObjects]);

  cov_kkofcvm31().s[2]++;

  while (_verseObjects.length > 0) {
    var object = (cov_kkofcvm31().s[3]++, _verseObjects.shift());
    cov_kkofcvm31().s[4]++;

    if (object) {
      cov_kkofcvm31().b[1][0]++;
      cov_kkofcvm31().s[5]++;

      if (object.type === 'milestone') {
        cov_kkofcvm31().b[2][0]++;

        // get children of milestone
        var _flat = (cov_kkofcvm31().s[6]++, flattenVerseObjects(object.children));

        cov_kkofcvm31().s[7]++;

        _flat.forEach(_object => {
          cov_kkofcvm31().f[1]++;
          cov_kkofcvm31().s[8]++;
          return flat.push(_object);
        });
      } else {
        cov_kkofcvm31().b[2][1]++;
        cov_kkofcvm31().s[9]++;
        flat.push(object);
      }
    } else {
      cov_kkofcvm31().b[1][1]++;
    }
  }

  cov_kkofcvm31().s[10]++;
  return flat;
};

exports.flattenVerseObjects = flattenVerseObjects;
cov_kkofcvm31().s[11]++;

var verseObjectsToString = verseObjects => {
  cov_kkofcvm31().f[2]++;
  var flattenedVerseObjects = (cov_kkofcvm31().s[12]++, flattenVerseObjects(verseObjects));
  var string = (cov_kkofcvm31().s[13]++, flattenedVerseObjects.map(verseObject => {
    cov_kkofcvm31().f[3]++;
    cov_kkofcvm31().s[14]++;
    return verseObject.text;
  }).join(' '));
  cov_kkofcvm31().s[15]++;
  return string;
};
/**
 * Below borrowed and adapted from:
 * https://github.com/unfoldingWord/word-aligner/blob/develop/src/js/utils/verseObjects.js
 */

/**
 * get text from word type verse object or word object
 * @param {WordObject} wordObject - an object containing information about the word
 * @return {string|undefined} text from word object
 */


exports.verseObjectsToString = verseObjectsToString;
cov_kkofcvm31().s[16]++;

var getWordText = wordObject => {
  cov_kkofcvm31().f[4]++;
  cov_kkofcvm31().s[17]++;

  if ((cov_kkofcvm31().b[4][0]++, wordObject) && (cov_kkofcvm31().b[4][1]++, wordObject.type === 'word')) {
    cov_kkofcvm31().b[3][0]++;
    cov_kkofcvm31().s[18]++;
    return wordObject.text;
  } else {
    cov_kkofcvm31().b[3][1]++;
  }

  cov_kkofcvm31().s[19]++;
  return wordObject ? (cov_kkofcvm31().b[5][0]++, wordObject.word) : (cov_kkofcvm31().b[5][1]++, undefined);
};
/**
 * Gets the occurrence of a subString in words by counting up to subString index
 * @param {String|Array} words - word list or string to search
 * @param {Number} currentWordIndex - index of desired word in words
 * @param {String} subString - The sub string to search for
 * @return {Integer} - the occurrence of the word at currentWordIndex
 */


exports.getWordText = getWordText;
cov_kkofcvm31().s[20]++;

var getOccurrence = (words, currentWordIndex, subString) => {
  cov_kkofcvm31().f[5]++;
  cov_kkofcvm31().s[21]++;

  if (typeof words === 'string') {
    cov_kkofcvm31().b[6][0]++;
    cov_kkofcvm31().s[22]++;
    return _stringPunctuationTokenizer.default.occurrenceInString(words, currentWordIndex, subString);
  } else {
    cov_kkofcvm31().b[6][1]++;
  }

  var occurrence = (cov_kkofcvm31().s[23]++, 0);
  cov_kkofcvm31().s[24]++;

  if (Array.isArray(words)) {
    cov_kkofcvm31().b[7][0]++;
    cov_kkofcvm31().s[25]++;
    words.forEach((word, index) => {
      cov_kkofcvm31().f[6]++;
      cov_kkofcvm31().s[26]++;

      if ((cov_kkofcvm31().b[9][0]++, index <= currentWordIndex) && (cov_kkofcvm31().b[9][1]++, getWordText(word) === subString)) {
        cov_kkofcvm31().b[8][0]++;
        cov_kkofcvm31().s[27]++;
        occurrence++;
      } else {
        cov_kkofcvm31().b[8][1]++;
      }
    });
  } else {
    cov_kkofcvm31().b[7][1]++;
  }

  cov_kkofcvm31().s[28]++;
  return occurrence;
};
/**
 * Function that count occurrences of a substring in words
 * @param {String|Array} words - word list or string to search
 * @param {String} subString - The sub string to search for
 * @return {Integer} - the count of the occurrences
 */


exports.getOccurrence = getOccurrence;
cov_kkofcvm31().s[29]++;

var getOccurrences = (words, subString) => {
  cov_kkofcvm31().f[7]++;
  cov_kkofcvm31().s[30]++;

  if (typeof words === 'string') {
    cov_kkofcvm31().b[10][0]++;
    cov_kkofcvm31().s[31]++;
    return _stringPunctuationTokenizer.default.occurrencesInString(words, subString);
  } else {
    cov_kkofcvm31().b[10][1]++;
  }

  var occurrences = (cov_kkofcvm31().s[32]++, 0);
  cov_kkofcvm31().s[33]++;

  if (Array.isArray(words)) {
    cov_kkofcvm31().b[11][0]++;
    cov_kkofcvm31().s[34]++;
    words.forEach(word => {
      cov_kkofcvm31().f[8]++;
      cov_kkofcvm31().s[35]++;

      if (getWordText(word) === subString) {
        cov_kkofcvm31().b[12][0]++;
        cov_kkofcvm31().s[36]++;
        occurrences++;
      } else {
        cov_kkofcvm31().b[12][1]++;
      }
    });
  } else {
    cov_kkofcvm31().b[11][1]++;
  }

  cov_kkofcvm31().s[37]++;
  return occurrences;
};
/**
 * @description verseObjects with occurrences from verseObjects
 * @param {Array} verseObjects - Word list to add occurrence(s) to
 * @return {verseObjects: Array} - clone of verseObjects and word map
 */


exports.getOccurrences = getOccurrences;
cov_kkofcvm31().s[38]++;

var occurrenceInjectVerseObjects = verseObjects => {
  cov_kkofcvm31().f[9]++;

  var _verseObjects = (cov_kkofcvm31().s[39]++, []);

  cov_kkofcvm31().s[40]++;

  if ((cov_kkofcvm31().b[14][0]++, verseObjects) && (cov_kkofcvm31().b[14][1]++, verseObjects.length > 0)) {
    cov_kkofcvm31().b[13][0]++;
    var flattenedVerseObjects = (cov_kkofcvm31().s[41]++, flattenVerseObjects(verseObjects));
    cov_kkofcvm31().s[42]++;
    _verseObjects = flattenedVerseObjects.map((verseObject, index) => {
      cov_kkofcvm31().f[10]++;

      var _verseObject = (cov_kkofcvm31().s[43]++, _objectSpread({}, verseObject));

      cov_kkofcvm31().s[44]++;

      if (verseObject.type === 'word') {
        cov_kkofcvm31().b[15][0]++;
        var occurrence = (cov_kkofcvm31().s[45]++, getOccurrence(flattenedVerseObjects, index, verseObject.text));
        var occurrences = (cov_kkofcvm31().s[46]++, getOccurrences(flattenedVerseObjects, verseObject.text));
        cov_kkofcvm31().s[47]++;
        _verseObject = _objectSpread(_objectSpread({}, verseObject), {}, {
          occurrence,
          occurrences
        });
      } else {
        cov_kkofcvm31().b[15][1]++;
      }

      cov_kkofcvm31().s[48]++;
      return _verseObject;
    });
  } else {
    cov_kkofcvm31().b[13][1]++;
  }

  cov_kkofcvm31().s[49]++;
  return _verseObjects;
};

exports.occurrenceInjectVerseObjects = occurrenceInjectVerseObjects;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb3JlL3NlbGVjdGlvbnMvdmVyc2VPYmplY3RzLmpzIl0sIm5hbWVzIjpbImZsYXR0ZW5WZXJzZU9iamVjdHMiLCJ2ZXJzZU9iamVjdHMiLCJmbGF0IiwiX3ZlcnNlT2JqZWN0cyIsImxlbmd0aCIsIm9iamVjdCIsInNoaWZ0IiwidHlwZSIsIl9mbGF0IiwiY2hpbGRyZW4iLCJmb3JFYWNoIiwiX29iamVjdCIsInB1c2giLCJ2ZXJzZU9iamVjdHNUb1N0cmluZyIsImZsYXR0ZW5lZFZlcnNlT2JqZWN0cyIsInN0cmluZyIsIm1hcCIsInZlcnNlT2JqZWN0IiwidGV4dCIsImpvaW4iLCJnZXRXb3JkVGV4dCIsIndvcmRPYmplY3QiLCJ3b3JkIiwidW5kZWZpbmVkIiwiZ2V0T2NjdXJyZW5jZSIsIndvcmRzIiwiY3VycmVudFdvcmRJbmRleCIsInN1YlN0cmluZyIsInRva2VuaXplciIsIm9jY3VycmVuY2VJblN0cmluZyIsIm9jY3VycmVuY2UiLCJBcnJheSIsImlzQXJyYXkiLCJpbmRleCIsImdldE9jY3VycmVuY2VzIiwib2NjdXJyZW5jZXNJblN0cmluZyIsIm9jY3VycmVuY2VzIiwib2NjdXJyZW5jZUluamVjdFZlcnNlT2JqZWN0cyIsIl92ZXJzZU9iamVjdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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RUFBNkM7QUFBQTtBQUMzQyxRQUFNVSxxQkFBcUIsNkJBQUdkLG1CQUFtQixDQUFDQyxZQUFELENBQXRCLENBQTNCO0FBRDJDO0FBRTNDRSxJQUFBQSxhQUFhLEdBQUdXLHFCQUFxQixDQUFDRSxHQUF0QixDQUEwQixDQUFDQyxXQUFELEVBQWNnQixLQUFkLEtBQXdCO0FBQUE7O0FBQ2hFLFVBQUlLLFlBQVksK0NBQVFyQixXQUFSLEVBQWhCOztBQURnRTs7QUFFaEUsVUFBSUEsV0FBVyxDQUFDVixJQUFaLEtBQXFCLE1BQXpCLEVBQWlDO0FBQUE7QUFDL0IsWUFBTXVCLFVBQVUsNkJBQUdOLGFBQWEsQ0FBQ1YscUJBQUQsRUFBd0JtQixLQUF4QixFQUErQmhCLFdBQVcsQ0FBQ0MsSUFBM0MsQ0FBaEIsQ0FBaEI7QUFDQSxZQUFNa0IsV0FBVyw2QkFBR0YsY0FBYyxDQUFDcEIscUJBQUQsRUFBd0JHLFdBQVcsQ0FBQ0MsSUFBcEMsQ0FBakIsQ0FBakI7QUFGK0I7QUFHL0JvQixRQUFBQSxZQUFZLG1DQUFRckIsV0FBUjtBQUFxQmEsVUFBQUEsVUFBckI7QUFBaUNNLFVBQUFBO0FBQWpDLFVBQVo7QUFDRCxPQUpEO0FBQUE7QUFBQTs7QUFGZ0U7QUFPaEUsYUFBT0UsWUFBUDtBQUNELEtBUmUsQ0FBaEI7QUFTRCxHQVhEO0FBQUE7QUFBQTs7QUFGNEQ7QUFjNUQsU0FBT25DLGFBQVA7QUFDRCxDQWZNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHRva2VuaXplciBmcm9tICdzdHJpbmctcHVuY3R1YXRpb24tdG9rZW5pemVyJztcclxuXHJcbi8qKlxyXG4gKiBCb3Jyb3dlZCBhbmQgYWRhcHRlZCBmcm9tOlxyXG4gKiBodHRwczovL2dpdGh1Yi5jb20vdW5mb2xkaW5nV29yZC93b3JkLWFsaWduZXIvYmxvYi9kZXZlbG9wL3NyYy9qcy91dGlscy92ZXJzZU9iamVjdHMuanNcclxuICovXHJcblxyXG4vKipcclxuICogQGRlc2NyaXB0aW9uIGZsYXR0ZW4gdmVyc2Ugb2JqZWN0cyBmcm9tIG5lc3RlZCBmb3JtYXQgdG8gZmxhdCBhcnJheVxyXG4gKiBAcGFyYW0ge2FycmF5fSB2ZXJzZU9iamVjdHMgLSBzb3VyY2UgYXJyYXkgb2YgbmVzdGVkIHZlcnNlT2JqZWN0c1xyXG4gKiBAcGFyYW0ge2FycmF5fSBmbGF0IC0gb3V0cHV0IGFycmF5IHRoYXQgd2lsbCBiZSBmaWxsZWQgd2l0aCBmbGF0dGVuZWQgdmVyc2VPYmplY3RzXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgZmxhdHRlblZlcnNlT2JqZWN0cyA9ICh2ZXJzZU9iamVjdHMsIGZsYXQgPSBbXSkgPT4ge1xyXG4gIGxldCBfdmVyc2VPYmplY3RzID0gWy4uLnZlcnNlT2JqZWN0c107XHJcbiAgd2hpbGUgKF92ZXJzZU9iamVjdHMubGVuZ3RoID4gMCkge1xyXG4gICAgY29uc3Qgb2JqZWN0ID0gX3ZlcnNlT2JqZWN0cy5zaGlmdCgpO1xyXG4gICAgaWYgKG9iamVjdCkge1xyXG4gICAgICBpZiAob2JqZWN0LnR5cGUgPT09ICdtaWxlc3RvbmUnKSB7IC8vIGdldCBjaGlsZHJlbiBvZiBtaWxlc3RvbmVcclxuICAgICAgICBjb25zdCBfZmxhdCA9IGZsYXR0ZW5WZXJzZU9iamVjdHMob2JqZWN0LmNoaWxkcmVuKTtcclxuICAgICAgICBfZmxhdC5mb3JFYWNoKF9vYmplY3QgPT4gZmxhdC5wdXNoKF9vYmplY3QpKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBmbGF0LnB1c2gob2JqZWN0KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuICByZXR1cm4gZmxhdDtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCB2ZXJzZU9iamVjdHNUb1N0cmluZyA9ICh2ZXJzZU9iamVjdHMpID0+IHtcclxuICBjb25zdCBmbGF0dGVuZWRWZXJzZU9iamVjdHMgPSBmbGF0dGVuVmVyc2VPYmplY3RzKHZlcnNlT2JqZWN0cyk7XHJcbiAgY29uc3Qgc3RyaW5nID0gZmxhdHRlbmVkVmVyc2VPYmplY3RzLm1hcCh2ZXJzZU9iamVjdCA9PiB2ZXJzZU9iamVjdC50ZXh0KS5qb2luKCcgJyk7XHJcbiAgcmV0dXJuIHN0cmluZztcclxufTtcclxuXHJcbi8qKlxyXG4gKiBCZWxvdyBib3Jyb3dlZCBhbmQgYWRhcHRlZCBmcm9tOlxyXG4gKiBodHRwczovL2dpdGh1Yi5jb20vdW5mb2xkaW5nV29yZC93b3JkLWFsaWduZXIvYmxvYi9kZXZlbG9wL3NyYy9qcy91dGlscy92ZXJzZU9iamVjdHMuanNcclxuICovXHJcblxyXG4vKipcclxuICogZ2V0IHRleHQgZnJvbSB3b3JkIHR5cGUgdmVyc2Ugb2JqZWN0IG9yIHdvcmQgb2JqZWN0XHJcbiAqIEBwYXJhbSB7V29yZE9iamVjdH0gd29yZE9iamVjdCAtIGFuIG9iamVjdCBjb250YWluaW5nIGluZm9ybWF0aW9uIGFib3V0IHRoZSB3b3JkXHJcbiAqIEByZXR1cm4ge3N0cmluZ3x1bmRlZmluZWR9IHRleHQgZnJvbSB3b3JkIG9iamVjdFxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IGdldFdvcmRUZXh0ID0gKHdvcmRPYmplY3QpID0+IHtcclxuICBpZiAod29yZE9iamVjdCAmJiAod29yZE9iamVjdC50eXBlID09PSAnd29yZCcpKSB7XHJcbiAgICByZXR1cm4gd29yZE9iamVjdC50ZXh0O1xyXG4gIH1cclxuICByZXR1cm4gd29yZE9iamVjdCA/IHdvcmRPYmplY3Qud29yZCA6IHVuZGVmaW5lZDtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBHZXRzIHRoZSBvY2N1cnJlbmNlIG9mIGEgc3ViU3RyaW5nIGluIHdvcmRzIGJ5IGNvdW50aW5nIHVwIHRvIHN1YlN0cmluZyBpbmRleFxyXG4gKiBAcGFyYW0ge1N0cmluZ3xBcnJheX0gd29yZHMgLSB3b3JkIGxpc3Qgb3Igc3RyaW5nIHRvIHNlYXJjaFxyXG4gKiBAcGFyYW0ge051bWJlcn0gY3VycmVudFdvcmRJbmRleCAtIGluZGV4IG9mIGRlc2lyZWQgd29yZCBpbiB3b3Jkc1xyXG4gKiBAcGFyYW0ge1N0cmluZ30gc3ViU3RyaW5nIC0gVGhlIHN1YiBzdHJpbmcgdG8gc2VhcmNoIGZvclxyXG4gKiBAcmV0dXJuIHtJbnRlZ2VyfSAtIHRoZSBvY2N1cnJlbmNlIG9mIHRoZSB3b3JkIGF0IGN1cnJlbnRXb3JkSW5kZXhcclxuICovXHJcbmV4cG9ydCBjb25zdCBnZXRPY2N1cnJlbmNlID0gKHdvcmRzLCBjdXJyZW50V29yZEluZGV4LCBzdWJTdHJpbmcpID0+IHtcclxuICBpZiAodHlwZW9mIHdvcmRzID09PSAnc3RyaW5nJykge1xyXG4gICAgcmV0dXJuIHRva2VuaXplci5vY2N1cnJlbmNlSW5TdHJpbmcod29yZHMsIGN1cnJlbnRXb3JkSW5kZXgsIHN1YlN0cmluZyk7XHJcbiAgfVxyXG5cclxuICBsZXQgb2NjdXJyZW5jZSA9IDA7XHJcbiAgaWYgKEFycmF5LmlzQXJyYXkod29yZHMpKSB7XHJcbiAgICB3b3Jkcy5mb3JFYWNoKCh3b3JkLCBpbmRleCkgPT4ge1xyXG4gICAgICBpZiAoaW5kZXggPD0gY3VycmVudFdvcmRJbmRleCAmJiBnZXRXb3JkVGV4dCh3b3JkKSA9PT0gc3ViU3RyaW5nKSBvY2N1cnJlbmNlKys7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgcmV0dXJuIG9jY3VycmVuY2U7XHJcbn07XHJcblxyXG4vKipcclxuICogRnVuY3Rpb24gdGhhdCBjb3VudCBvY2N1cnJlbmNlcyBvZiBhIHN1YnN0cmluZyBpbiB3b3Jkc1xyXG4gKiBAcGFyYW0ge1N0cmluZ3xBcnJheX0gd29yZHMgLSB3b3JkIGxpc3Qgb3Igc3RyaW5nIHRvIHNlYXJjaFxyXG4gKiBAcGFyYW0ge1N0cmluZ30gc3ViU3RyaW5nIC0gVGhlIHN1YiBzdHJpbmcgdG8gc2VhcmNoIGZvclxyXG4gKiBAcmV0dXJuIHtJbnRlZ2VyfSAtIHRoZSBjb3VudCBvZiB0aGUgb2NjdXJyZW5jZXNcclxuICovXHJcbmV4cG9ydCBjb25zdCBnZXRPY2N1cnJlbmNlcyA9ICh3b3Jkcywgc3ViU3RyaW5nKSA9PiB7XHJcbiAgaWYgKHR5cGVvZiB3b3JkcyA9PT0gJ3N0cmluZycpIHtcclxuICAgIHJldHVybiB0b2tlbml6ZXIub2NjdXJyZW5jZXNJblN0cmluZyh3b3Jkcywgc3ViU3RyaW5nKTtcclxuICB9XHJcblxyXG4gIGxldCBvY2N1cnJlbmNlcyA9IDA7XHJcbiAgaWYgKEFycmF5LmlzQXJyYXkod29yZHMpKSB7XHJcbiAgICB3b3Jkcy5mb3JFYWNoKHdvcmQgPT4ge1xyXG4gICAgICBpZiAoZ2V0V29yZFRleHQod29yZCkgPT09IHN1YlN0cmluZykgb2NjdXJyZW5jZXMrKztcclxuICAgIH0pO1xyXG4gIH1cclxuICByZXR1cm4gb2NjdXJyZW5jZXM7XHJcbn07XHJcblxyXG4vKipcclxuICogQGRlc2NyaXB0aW9uIHZlcnNlT2JqZWN0cyB3aXRoIG9jY3VycmVuY2VzIGZyb20gdmVyc2VPYmplY3RzXHJcbiAqIEBwYXJhbSB7QXJyYXl9IHZlcnNlT2JqZWN0cyAtIFdvcmQgbGlzdCB0byBhZGQgb2NjdXJyZW5jZShzKSB0b1xyXG4gKiBAcmV0dXJuIHt2ZXJzZU9iamVjdHM6IEFycmF5fSAtIGNsb25lIG9mIHZlcnNlT2JqZWN0cyBhbmQgd29yZCBtYXBcclxuICovXHJcbmV4cG9ydCBjb25zdCBvY2N1cnJlbmNlSW5qZWN0VmVyc2VPYmplY3RzID0gKHZlcnNlT2JqZWN0cykgPT4ge1xyXG4gIGxldCBfdmVyc2VPYmplY3RzID0gW107XHJcbiAgaWYgKHZlcnNlT2JqZWN0cyAmJiB2ZXJzZU9iamVjdHMubGVuZ3RoID4gMCkge1xyXG4gICAgY29uc3QgZmxhdHRlbmVkVmVyc2VPYmplY3RzID0gZmxhdHRlblZlcnNlT2JqZWN0cyh2ZXJzZU9iamVjdHMpO1xyXG4gICAgX3ZlcnNlT2JqZWN0cyA9IGZsYXR0ZW5lZFZlcnNlT2JqZWN0cy5tYXAoKHZlcnNlT2JqZWN0LCBpbmRleCkgPT4ge1xyXG4gICAgICBsZXQgX3ZlcnNlT2JqZWN0ID0geyAuLi52ZXJzZU9iamVjdCB9O1xyXG4gICAgICBpZiAodmVyc2VPYmplY3QudHlwZSA9PT0gJ3dvcmQnKSB7XHJcbiAgICAgICAgY29uc3Qgb2NjdXJyZW5jZSA9IGdldE9jY3VycmVuY2UoZmxhdHRlbmVkVmVyc2VPYmplY3RzLCBpbmRleCwgdmVyc2VPYmplY3QudGV4dCk7XHJcbiAgICAgICAgY29uc3Qgb2NjdXJyZW5jZXMgPSBnZXRPY2N1cnJlbmNlcyhmbGF0dGVuZWRWZXJzZU9iamVjdHMsIHZlcnNlT2JqZWN0LnRleHQpO1xyXG4gICAgICAgIF92ZXJzZU9iamVjdCA9IHsgLi4udmVyc2VPYmplY3QsIG9jY3VycmVuY2UsIG9jY3VycmVuY2VzIH07XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIF92ZXJzZU9iamVjdDtcclxuICAgIH0pO1xyXG4gIH1cclxuICByZXR1cm4gX3ZlcnNlT2JqZWN0cztcclxufTtcclxuIl19